Mon Apr 29 00:48:11 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/cola_mod2_0.6
nvidia-smi output:
Mon Apr 29 00:48:11 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:65:00.0 Off |                    0 |
| N/A   39C    P0              34W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/29/2024 00:48:15 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/29/2024 00:48:15 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/runs/Apr29_00-48-15_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/29/2024 00:48:15 - INFO - __main__ - Model Arguments:
04/29/2024 00:48:15 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/29/2024 00:48:15 - INFO - __main__ - config_name = None
04/29/2024 00:48:15 - INFO - __main__ - tokenizer_name = None
04/29/2024 00:48:15 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/29/2024 00:48:15 - INFO - __main__ - use_fast_tokenizer = True
04/29/2024 00:48:15 - INFO - __main__ - model_revision = main
04/29/2024 00:48:15 - INFO - __main__ - use_auth_token = False
04/29/2024 00:48:15 - INFO - __main__ - Data Arguments:
04/29/2024 00:48:15 - INFO - __main__ - task_name = cola
04/29/2024 00:48:15 - INFO - __main__ - dataset_name = None
04/29/2024 00:48:15 - INFO - __main__ - t_name = None
04/29/2024 00:48:15 - INFO - __main__ - dataset_config_name = None
04/29/2024 00:48:15 - INFO - __main__ - max_seq_length = 128
04/29/2024 00:48:15 - INFO - __main__ - overwrite_cache = False
04/29/2024 00:48:15 - INFO - __main__ - pad_to_max_length = True
04/29/2024 00:48:15 - INFO - __main__ - max_train_samples = None
04/29/2024 00:48:15 - INFO - __main__ - max_eval_samples = None
04/29/2024 00:48:15 - INFO - __main__ - max_predict_samples = None
04/29/2024 00:48:15 - INFO - __main__ - train_file = None
04/29/2024 00:48:15 - INFO - __main__ - validation_file = None
04/29/2024 00:48:15 - INFO - __main__ - test_file = None
04/29/2024 00:48:15 - INFO - __main__ - Training Arguments:
04/29/2024 00:48:15 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6
04/29/2024 00:48:15 - INFO - __main__ - overwrite_output_dir = True
04/29/2024 00:48:15 - INFO - __main__ - do_train = True
04/29/2024 00:48:15 - INFO - __main__ - do_eval = True
04/29/2024 00:48:15 - INFO - __main__ - do_predict = False
04/29/2024 00:48:15 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/29/2024 00:48:15 - INFO - __main__ - prediction_loss_only = False
04/29/2024 00:48:15 - INFO - __main__ - per_device_train_batch_size = 32
04/29/2024 00:48:15 - INFO - __main__ - per_device_eval_batch_size = 32
04/29/2024 00:48:15 - INFO - __main__ - per_gpu_train_batch_size = None
04/29/2024 00:48:15 - INFO - __main__ - per_gpu_eval_batch_size = None
04/29/2024 00:48:15 - INFO - __main__ - gradient_accumulation_steps = 1
04/29/2024 00:48:15 - INFO - __main__ - eval_accumulation_steps = None
04/29/2024 00:48:15 - INFO - __main__ - learning_rate = 2e-05
04/29/2024 00:48:15 - INFO - __main__ - weight_decay = 0.0
04/29/2024 00:48:15 - INFO - __main__ - adam_beta1 = 0.9
04/29/2024 00:48:15 - INFO - __main__ - adam_beta2 = 0.999
04/29/2024 00:48:15 - INFO - __main__ - adam_epsilon = 1e-08
04/29/2024 00:48:15 - INFO - __main__ - max_grad_norm = 1.0
04/29/2024 00:48:15 - INFO - __main__ - num_train_epochs = 100.0
04/29/2024 00:48:15 - INFO - __main__ - max_steps = -1
04/29/2024 00:48:15 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/29/2024 00:48:15 - INFO - __main__ - warmup_ratio = 0.0
04/29/2024 00:48:15 - INFO - __main__ - warmup_steps = 0
04/29/2024 00:48:15 - INFO - __main__ - log_level = -1
04/29/2024 00:48:15 - INFO - __main__ - log_level_replica = -1
04/29/2024 00:48:15 - INFO - __main__ - log_on_each_node = True
04/29/2024 00:48:15 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/runs/Apr29_00-48-15_adroit-h11g2
04/29/2024 00:48:15 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/29/2024 00:48:15 - INFO - __main__ - logging_first_step = False
04/29/2024 00:48:15 - INFO - __main__ - logging_steps = 100
04/29/2024 00:48:15 - INFO - __main__ - logging_nan_inf_filter = True
04/29/2024 00:48:15 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/29/2024 00:48:15 - INFO - __main__ - save_steps = 0
04/29/2024 00:48:15 - INFO - __main__ - save_total_limit = None
04/29/2024 00:48:15 - INFO - __main__ - save_on_each_node = False
04/29/2024 00:48:15 - INFO - __main__ - no_cuda = False
04/29/2024 00:48:15 - INFO - __main__ - seed = 57
04/29/2024 00:48:15 - INFO - __main__ - bf16 = False
04/29/2024 00:48:15 - INFO - __main__ - fp16 = False
04/29/2024 00:48:15 - INFO - __main__ - fp16_opt_level = O1
04/29/2024 00:48:15 - INFO - __main__ - half_precision_backend = auto
04/29/2024 00:48:15 - INFO - __main__ - bf16_full_eval = False
04/29/2024 00:48:15 - INFO - __main__ - fp16_full_eval = False
04/29/2024 00:48:15 - INFO - __main__ - tf32 = None
04/29/2024 00:48:15 - INFO - __main__ - local_rank = -1
04/29/2024 00:48:15 - INFO - __main__ - xpu_backend = None
04/29/2024 00:48:15 - INFO - __main__ - tpu_num_cores = None
04/29/2024 00:48:15 - INFO - __main__ - tpu_metrics_debug = False
04/29/2024 00:48:15 - INFO - __main__ - debug = []
04/29/2024 00:48:15 - INFO - __main__ - dataloader_drop_last = False
04/29/2024 00:48:15 - INFO - __main__ - eval_steps = 50
04/29/2024 00:48:15 - INFO - __main__ - dataloader_num_workers = 0
04/29/2024 00:48:15 - INFO - __main__ - past_index = -1
04/29/2024 00:48:15 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6
04/29/2024 00:48:15 - INFO - __main__ - disable_tqdm = False
04/29/2024 00:48:15 - INFO - __main__ - remove_unused_columns = True
04/29/2024 00:48:15 - INFO - __main__ - label_names = None
04/29/2024 00:48:15 - INFO - __main__ - load_best_model_at_end = False
04/29/2024 00:48:15 - INFO - __main__ - metric_for_best_model = None
04/29/2024 00:48:15 - INFO - __main__ - greater_is_better = None
04/29/2024 00:48:15 - INFO - __main__ - ignore_data_skip = False
04/29/2024 00:48:15 - INFO - __main__ - sharded_ddp = []
04/29/2024 00:48:15 - INFO - __main__ - deepspeed = None
04/29/2024 00:48:15 - INFO - __main__ - label_smoothing_factor = 0.0
04/29/2024 00:48:15 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/29/2024 00:48:15 - INFO - __main__ - adafactor = False
04/29/2024 00:48:15 - INFO - __main__ - group_by_length = False
04/29/2024 00:48:15 - INFO - __main__ - length_column_name = length
04/29/2024 00:48:15 - INFO - __main__ - report_to = []
04/29/2024 00:48:15 - INFO - __main__ - ddp_find_unused_parameters = None
04/29/2024 00:48:15 - INFO - __main__ - ddp_bucket_cap_mb = None
04/29/2024 00:48:15 - INFO - __main__ - dataloader_pin_memory = True
04/29/2024 00:48:15 - INFO - __main__ - skip_memory_metrics = True
04/29/2024 00:48:15 - INFO - __main__ - use_legacy_prediction_loop = False
04/29/2024 00:48:15 - INFO - __main__ - push_to_hub = False
04/29/2024 00:48:15 - INFO - __main__ - resume_from_checkpoint = None
04/29/2024 00:48:15 - INFO - __main__ - hub_model_id = None
04/29/2024 00:48:15 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/29/2024 00:48:15 - INFO - __main__ - hub_token = None
04/29/2024 00:48:15 - INFO - __main__ - gradient_checkpointing = False
04/29/2024 00:48:15 - INFO - __main__ - fp16_backend = auto
04/29/2024 00:48:15 - INFO - __main__ - push_to_hub_model_id = None
04/29/2024 00:48:15 - INFO - __main__ - push_to_hub_organization = None
04/29/2024 00:48:15 - INFO - __main__ - push_to_hub_token = None
04/29/2024 00:48:15 - INFO - __main__ - mp_parameters = 
04/29/2024 00:48:15 - INFO - __main__ - _n_gpu = 1
04/29/2024 00:48:15 - INFO - __main__ - __cached__setup_devices = cuda:0
04/29/2024 00:48:15 - INFO - __main__ - Additional Arguments:
04/29/2024 00:48:15 - INFO - __main__ - test = False
04/29/2024 00:48:15 - INFO - __main__ - ex_name = CoLA_sparsity0.6
04/29/2024 00:48:15 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/29/2024 00:48:15 - INFO - __main__ - reg_learning_rate = 0.01
04/29/2024 00:48:15 - INFO - __main__ - scheduler_type = linear
04/29/2024 00:48:15 - INFO - __main__ - freeze_embeddings = True
04/29/2024 00:48:15 - INFO - __main__ - pretrained_pruned_model = None
04/29/2024 00:48:15 - INFO - __main__ - droprate_init = 0.5
04/29/2024 00:48:15 - INFO - __main__ - temperature = 0.6666666666666666
04/29/2024 00:48:15 - INFO - __main__ - prepruning_finetune_epochs = 4
04/29/2024 00:48:15 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/29/2024 00:48:15 - INFO - __main__ - target_sparsity = 0.6
04/29/2024 00:48:15 - INFO - __main__ - sparsity_epsilon = 0
04/29/2024 00:48:15 - INFO - __main__ - distillation_path = mofyrt/bert-base-uncased-finetuned-cola
04/29/2024 00:48:15 - INFO - __main__ - do_distill = True
04/29/2024 00:48:15 - INFO - __main__ - do_layer_distill = True
04/29/2024 00:48:15 - INFO - __main__ - layer_distill_version = 4
04/29/2024 00:48:15 - INFO - __main__ - distill_loss_alpha = 0.9
04/29/2024 00:48:15 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/29/2024 00:48:15 - INFO - __main__ - distill_temp = 2.0
04/29/2024 00:48:15 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/29/2024 00:48:15 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/29/2024 00:48:15 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/29/2024 00:48:15 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 658.86it/s]
[INFO|configuration_utils.py:648] 2024-04-29 00:48:15,661 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-29 00:48:15,662 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "cola",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-29 00:48:15,663 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-29 00:48:15,664 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-29 00:48:15,667 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-29 00:48:15,667 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-29 00:48:15,667 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-29 00:48:15,667 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-29 00:48:15,670 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-29 00:48:15,671 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/29/2024 00:48:24 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/29/2024 00:48:24 - INFO - __main__ - Model size: 85054464
04/29/2024 00:48:24 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x1514e044d040> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/29/2024 00:48:24 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/29/2024 00:48:24 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x1514e044d4c0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/29/2024 00:48:24 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/29/2024 00:48:24 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x1514e044d040> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/29/2024 00:48:24 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/29/2024 00:48:24 - INFO - __main__ - Sample 8423 of the training set: {'sentence': 'Anson saw Anson.', 'label': 1, 'idx': 8423, 'input_ids': [101, 25435, 2387, 25435, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/29/2024 00:48:24 - INFO - __main__ - Sample 5262 of the training set: {'sentence': 'The men would not have all been working.', 'label': 1, 'idx': 5262, 'input_ids': [101, 1996, 2273, 2052, 2025, 2031, 2035, 2042, 2551, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/29/2024 00:48:24 - INFO - __main__ - Sample 7821 of the training set: {'sentence': 'Anson very happily demonized David.', 'label': 1, 'idx': 7821, 'input_ids': [101, 25435, 2200, 11361, 5698, 3550, 2585, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/29/2024 00:48:24 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/29/2024 00:48:24 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/29/2024 00:48:25 - INFO - __main__ - ************* 8551 Training Examples Loaded *************
04/29/2024 00:48:25 - INFO - __main__ - ************* 1043 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-29 00:48:25,572 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 - Prepruning finetune steps: 100
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 - Lagrangian warmup steps: 5360
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 - ***** Running training *****
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 -   Num examples = 8551
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 -   Num Epochs = 100
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 -   Instantaneous batch size per device = 32
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 -   Gradient Accumulation steps = 1
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 -   Total optimization steps = 26800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-29 00:48:25,577 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:48:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32

Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A
Evaluation:   3%|▎         | 1/33 [00:00<00:04,  6.41it/s][A
Evaluation:   9%|▉         | 3/33 [00:00<00:02, 10.28it/s][A
Evaluation:  15%|█▌        | 5/33 [00:00<00:02, 12.94it/s][A
Evaluation:  21%|██        | 7/33 [00:00<00:01, 14.52it/s][A
Evaluation:  27%|██▋       | 9/33 [00:00<00:01, 15.38it/s][A
Evaluation:  33%|███▎      | 11/33 [00:00<00:01, 15.92it/s][A
Evaluation:  39%|███▉      | 13/33 [00:00<00:01, 16.30it/s][A
Evaluation:  45%|████▌     | 15/33 [00:01<00:01, 16.58it/s][A
Evaluation:  52%|█████▏    | 17/33 [00:01<00:00, 16.75it/s][A
Evaluation:  58%|█████▊    | 19/33 [00:01<00:00, 16.84it/s][A
Evaluation:  64%|██████▎   | 21/33 [00:01<00:00, 16.86it/s][A
Evaluation:  70%|██████▉   | 23/33 [00:01<00:00, 16.93it/s][A
Evaluation:  76%|███████▌  | 25/33 [00:01<00:00, 17.00it/s][A
Evaluation:  82%|████████▏ | 27/33 [00:01<00:00, 17.02it/s][A
Evaluation:  88%|████████▊ | 29/33 [00:01<00:00, 17.03it/s][A
Evaluation:  94%|█████████▍| 31/33 [00:01<00:00, 17.02it/s][AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 16.15it/s]04/29/2024 00:48:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:48:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': -0.015667329278145823, 'eval_loss': 0.6626569, 'step': 0}


Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/29/2024 00:48:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:39,  6.81it/s][A
Iteration:   1%|          | 3/268 [00:00<00:26, 10.18it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:21, 11.98it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:21, 12.39it/s][A
Iteration:   3%|▎         | 9/268 [00:00<00:24, 10.61it/s][A
Iteration:   4%|▍         | 11/268 [00:00<00:22, 11.47it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:20, 12.34it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:20, 12.51it/s][A
Iteration:   6%|▋         | 17/268 [00:01<00:19, 12.91it/s][A
Iteration:   7%|▋         | 19/268 [00:01<00:18, 13.55it/s][A
Iteration:   8%|▊         | 21/268 [00:01<00:17, 13.76it/s][A
Iteration:   9%|▊         | 23/268 [00:01<00:17, 14.27it/s][A
Iteration:   9%|▉         | 25/268 [00:01<00:17, 13.74it/s][A
Iteration:  10%|█         | 27/268 [00:02<00:18, 12.83it/s][A
Iteration:  11%|█         | 29/268 [00:02<00:18, 13.13it/s][A
Iteration:  12%|█▏        | 31/268 [00:02<00:17, 13.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:02<00:17, 13.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:02<00:17, 13.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:02<00:16, 13.70it/s][A
Iteration:  15%|█▍        | 39/268 [00:03<00:16, 14.11it/s][A
Iteration:  15%|█▌        | 41/268 [00:03<00:16, 14.04it/s][A
Iteration:  16%|█▌        | 43/268 [00:03<00:16, 13.67it/s][A
Iteration:  17%|█▋        | 45/268 [00:03<00:16, 13.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:03<00:15, 14.04it/s][A
Iteration:  18%|█▊        | 49/268 [00:03<00:15, 14.25it/s][A[INFO|trainer.py:570] 2024-04-29 00:48:31,477 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:48:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:48:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:48:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.22it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.19it/s]04/29/2024 00:48:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:48:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.45335145054692777, 'eval_loss': 0.6140724, 'step': 50}


Iteration:  19%|█▉        | 51/268 [00:05<01:19,  2.74it/s][A
Iteration:  20%|█▉        | 53/268 [00:05<00:59,  3.60it/s][A
Iteration:  21%|██        | 55/268 [00:06<00:45,  4.66it/s][A
Iteration:  21%|██▏       | 57/268 [00:06<00:36,  5.80it/s][A
Iteration:  22%|██▏       | 59/268 [00:06<00:29,  7.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:06<00:24,  8.44it/s][A
Iteration:  24%|██▎       | 63/268 [00:06<00:21,  9.63it/s][A
Iteration:  24%|██▍       | 65/268 [00:06<00:18, 10.78it/s][A
Iteration:  25%|██▌       | 67/268 [00:06<00:17, 11.65it/s][A
Iteration:  26%|██▌       | 69/268 [00:07<00:15, 12.54it/s][A
Iteration:  26%|██▋       | 71/268 [00:07<00:15, 13.01it/s][A
Iteration:  27%|██▋       | 73/268 [00:07<00:14, 13.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:07<00:14, 13.69it/s][A
Iteration:  29%|██▊       | 77/268 [00:07<00:13, 13.70it/s][A
Iteration:  29%|██▉       | 79/268 [00:07<00:13, 14.07it/s][A
Iteration:  30%|███       | 81/268 [00:07<00:13, 14.31it/s][A
Iteration:  31%|███       | 83/268 [00:08<00:12, 14.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:08<00:12, 14.44it/s][A
Iteration:  32%|███▏      | 87/268 [00:08<00:12, 13.97it/s][A
Iteration:  33%|███▎      | 89/268 [00:08<00:12, 13.93it/s][A
Iteration:  34%|███▍      | 91/268 [00:08<00:12, 13.89it/s][A
Iteration:  35%|███▍      | 93/268 [00:08<00:12, 13.87it/s][A
Iteration:  35%|███▌      | 95/268 [00:08<00:12, 13.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:09<00:13, 12.99it/s][A
Iteration:  37%|███▋      | 99/268 [00:09<00:12, 13.35it/s][A[INFO|trainer.py:570] 2024-04-29 00:48:36,966 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:48:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:48:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:48:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.24it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.02it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.21it/s]04/29/2024 00:48:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:48:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48886510271911465, 'eval_loss': 0.53403676, 'step': 100}
04/29/2024 00:48:38 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/29/2024 00:48:38 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/29/2024 00:48:38 - INFO - trainer.trainer_mod_2 - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/29/2024 00:48:38 - INFO - trainer.trainer_mod_2 - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/29/2024 00:48:38 - INFO - trainer.trainer_mod_2 - Starting l0 regularization!
04/29/2024 00:48:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')


Iteration:  38%|███▊      | 101/268 [00:11<01:03,  2.61it/s][A
Iteration:  38%|███▊      | 102/268 [00:11<00:56,  2.92it/s][A
Iteration:  38%|███▊      | 103/268 [00:11<00:50,  3.26it/s][A
Iteration:  39%|███▉      | 104/268 [00:11<00:44,  3.67it/s][A
Iteration:  39%|███▉      | 105/268 [00:12<00:39,  4.08it/s][A
Iteration:  40%|███▉      | 106/268 [00:12<00:36,  4.50it/s][A
Iteration:  40%|███▉      | 107/268 [00:12<00:32,  4.90it/s][A
Iteration:  40%|████      | 108/268 [00:12<00:30,  5.25it/s][A
Iteration:  41%|████      | 109/268 [00:12<00:28,  5.55it/s][A
Iteration:  41%|████      | 110/268 [00:12<00:27,  5.76it/s][A
Iteration:  41%|████▏     | 111/268 [00:12<00:26,  5.95it/s][A
Iteration:  42%|████▏     | 112/268 [00:13<00:25,  6.04it/s][A
Iteration:  42%|████▏     | 113/268 [00:13<00:25,  6.08it/s][A
Iteration:  43%|████▎     | 114/268 [00:13<00:25,  6.12it/s][A
Iteration:  43%|████▎     | 115/268 [00:13<00:24,  6.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:13<00:24,  6.29it/s][A
Iteration:  44%|████▎     | 117/268 [00:13<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:14<00:24,  6.23it/s][A
Iteration:  44%|████▍     | 119/268 [00:14<00:23,  6.29it/s][A
Iteration:  45%|████▍     | 120/268 [00:14<00:23,  6.22it/s][A
Iteration:  45%|████▌     | 121/268 [00:14<00:23,  6.30it/s][A
Iteration:  46%|████▌     | 122/268 [00:14<00:23,  6.29it/s][A
Iteration:  46%|████▌     | 123/268 [00:14<00:22,  6.36it/s][A
Iteration:  46%|████▋     | 124/268 [00:15<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:15<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 126/268 [00:15<00:22,  6.36it/s][A
Iteration:  47%|████▋     | 127/268 [00:15<00:22,  6.37it/s][A
Iteration:  48%|████▊     | 128/268 [00:15<00:22,  6.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:15<00:21,  6.39it/s][A
Iteration:  49%|████▊     | 130/268 [00:15<00:21,  6.50it/s][A
Iteration:  49%|████▉     | 131/268 [00:16<00:20,  6.53it/s][A
Iteration:  49%|████▉     | 132/268 [00:16<00:20,  6.50it/s][A
Iteration:  50%|████▉     | 133/268 [00:16<00:20,  6.48it/s][A
Iteration:  50%|█████     | 134/268 [00:16<00:20,  6.41it/s][A
Iteration:  50%|█████     | 135/268 [00:16<00:20,  6.52it/s][A
Iteration:  51%|█████     | 136/268 [00:16<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:17<00:20,  6.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:17<00:20,  6.31it/s][A
Iteration:  52%|█████▏    | 139/268 [00:17<00:20,  6.37it/s][A
Iteration:  52%|█████▏    | 140/268 [00:17<00:20,  6.31it/s][A
Iteration:  53%|█████▎    | 141/268 [00:17<00:20,  6.34it/s][A
Iteration:  53%|█████▎    | 142/268 [00:17<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:18<00:19,  6.53it/s][A
Iteration:  54%|█████▎    | 144/268 [00:18<00:19,  6.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:18<00:18,  6.50it/s][A
Iteration:  54%|█████▍    | 146/268 [00:18<00:18,  6.49it/s][A
Iteration:  55%|█████▍    | 147/268 [00:18<00:18,  6.57it/s][A
Iteration:  55%|█████▌    | 148/268 [00:18<00:18,  6.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:18<00:17,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 00:48:46,727 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:48:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:48:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:48:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:48:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.57it/s]04/29/2024 00:48:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:48:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0928457264044978, 'eval_loss': 0.94900215, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2589, 2588, 2586, 2586, 2587, 2583, 2579, 2578, 2586, 2590, 2600, 2604], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9201984, 'remaining_params': 75815616, 'pruned_model_sparsity': 0.10823622402890695, 'expected_sparsity': 0.1098, 'target_sparsity': 0.005597014925373134, 'step': 150}


Iteration:  56%|█████▌    | 150/268 [00:21<01:35,  1.24it/s][A
Iteration:  56%|█████▋    | 151/268 [00:21<01:11,  1.64it/s][A
Iteration:  57%|█████▋    | 152/268 [00:21<00:55,  2.10it/s][A
Iteration:  57%|█████▋    | 153/268 [00:21<00:43,  2.62it/s][A
Iteration:  57%|█████▋    | 154/268 [00:21<00:35,  3.17it/s][A
Iteration:  58%|█████▊    | 155/268 [00:22<00:30,  3.74it/s][A
Iteration:  58%|█████▊    | 156/268 [00:22<00:26,  4.20it/s][A
Iteration:  59%|█████▊    | 157/268 [00:22<00:24,  4.60it/s][A
Iteration:  59%|█████▉    | 158/268 [00:22<00:22,  4.97it/s][A
Iteration:  59%|█████▉    | 159/268 [00:22<00:20,  5.36it/s][A
Iteration:  60%|█████▉    | 160/268 [00:22<00:19,  5.63it/s][A
Iteration:  60%|██████    | 161/268 [00:23<00:17,  5.96it/s][A
Iteration:  60%|██████    | 162/268 [00:23<00:17,  6.13it/s][A
Iteration:  61%|██████    | 163/268 [00:23<00:16,  6.22it/s][A
Iteration:  61%|██████    | 164/268 [00:23<00:16,  6.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:23<00:16,  6.37it/s][A
Iteration:  62%|██████▏   | 166/268 [00:23<00:16,  6.12it/s][A
Iteration:  62%|██████▏   | 167/268 [00:23<00:16,  6.22it/s][A
Iteration:  63%|██████▎   | 168/268 [00:24<00:15,  6.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:24<00:15,  6.20it/s][A
Iteration:  63%|██████▎   | 170/268 [00:24<00:15,  6.29it/s][A
Iteration:  64%|██████▍   | 171/268 [00:24<00:15,  6.34it/s][A
Iteration:  64%|██████▍   | 172/268 [00:24<00:15,  6.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:24<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:25<00:14,  6.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:25<00:14,  6.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:25<00:14,  6.25it/s][A
Iteration:  66%|██████▌   | 177/268 [00:25<00:14,  6.24it/s][A
Iteration:  66%|██████▋   | 178/268 [00:25<00:14,  6.26it/s][A
Iteration:  67%|██████▋   | 179/268 [00:25<00:14,  6.25it/s][A
Iteration:  67%|██████▋   | 180/268 [00:26<00:13,  6.32it/s][A
Iteration:  68%|██████▊   | 181/268 [00:26<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:26<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:26<00:13,  6.41it/s][A
Iteration:  69%|██████▊   | 184/268 [00:26<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:26<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:26<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:27<00:12,  6.35it/s][A
Iteration:  70%|███████   | 188/268 [00:27<00:12,  6.39it/s][A
Iteration:  71%|███████   | 189/268 [00:27<00:12,  6.43it/s][A
Iteration:  71%|███████   | 190/268 [00:27<00:12,  6.44it/s][A
Iteration:  71%|███████▏  | 191/268 [00:27<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 192/268 [00:27<00:12,  6.31it/s][A
Iteration:  72%|███████▏  | 193/268 [00:28<00:11,  6.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:28<00:11,  6.36it/s][A
Iteration:  73%|███████▎  | 195/268 [00:28<00:11,  6.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:28<00:11,  6.45it/s][A
Iteration:  74%|███████▎  | 197/268 [00:28<00:11,  6.38it/s][A
Iteration:  74%|███████▍  | 198/268 [00:28<00:11,  6.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:28<00:10,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 00:48:56,768 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:48:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:48:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:48:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:48:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.59it/s]04/29/2024 00:48:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:48:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.20521028256276466, 'eval_loss': 0.8903064, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2617, 2613, 2608, 2605, 2606, 2601, 2597, 2598, 2627, 2640, 2665, 2682], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8584588, 'remaining_params': 76433012, 'pruned_model_sparsity': 0.10097424533273111, 'expected_sparsity': 0.10258, 'target_sparsity': 0.011194029850746268, 'step': 200}


Iteration:  75%|███████▍  | 200/268 [00:31<00:54,  1.24it/s][A04/29/2024 00:48:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:31<00:41,  1.62it/s][A
Iteration:  75%|███████▌  | 202/268 [00:31<00:31,  2.09it/s][A
Iteration:  76%|███████▌  | 203/268 [00:31<00:25,  2.60it/s][A
Iteration:  76%|███████▌  | 204/268 [00:31<00:20,  3.14it/s][A
Iteration:  76%|███████▋  | 205/268 [00:32<00:17,  3.67it/s][A
Iteration:  77%|███████▋  | 206/268 [00:32<00:14,  4.27it/s][A
Iteration:  77%|███████▋  | 207/268 [00:32<00:12,  4.76it/s][A
Iteration:  78%|███████▊  | 208/268 [00:32<00:11,  5.19it/s][A
Iteration:  78%|███████▊  | 209/268 [00:32<00:10,  5.51it/s][A
Iteration:  78%|███████▊  | 210/268 [00:32<00:10,  5.79it/s][A
Iteration:  79%|███████▊  | 211/268 [00:33<00:09,  5.98it/s][A
Iteration:  79%|███████▉  | 212/268 [00:33<00:09,  6.10it/s][A
Iteration:  79%|███████▉  | 213/268 [00:33<00:08,  6.22it/s][A
Iteration:  80%|███████▉  | 214/268 [00:33<00:08,  6.17it/s][A
Iteration:  80%|████████  | 215/268 [00:33<00:08,  6.24it/s][A
Iteration:  81%|████████  | 216/268 [00:33<00:08,  6.24it/s][A
Iteration:  81%|████████  | 217/268 [00:33<00:08,  6.31it/s][A
Iteration:  81%|████████▏ | 218/268 [00:34<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:34<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:34<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:34<00:07,  6.59it/s][A
Iteration:  83%|████████▎ | 222/268 [00:34<00:07,  6.53it/s][A
Iteration:  83%|████████▎ | 223/268 [00:34<00:07,  6.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:35<00:06,  6.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:35<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:35<00:06,  6.41it/s][A
Iteration:  85%|████████▍ | 227/268 [00:35<00:06,  6.36it/s][A
Iteration:  85%|████████▌ | 228/268 [00:35<00:06,  6.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:35<00:06,  6.28it/s][A
Iteration:  86%|████████▌ | 230/268 [00:35<00:05,  6.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:36<00:05,  6.38it/s][A
Iteration:  87%|████████▋ | 232/268 [00:36<00:05,  6.41it/s][A
Iteration:  87%|████████▋ | 233/268 [00:36<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:36<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:36<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:36<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:37<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:37<00:04,  6.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:37<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:37<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 241/268 [00:37<00:04,  6.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:37<00:03,  6.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:38<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:38<00:03,  6.52it/s][A
Iteration:  91%|█████████▏| 245/268 [00:38<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:38<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:38<00:03,  6.25it/s][A
Iteration:  93%|█████████▎| 248/268 [00:38<00:03,  6.34it/s][A
Iteration:  93%|█████████▎| 249/268 [00:38<00:03,  6.31it/s][A[INFO|trainer.py:570] 2024-04-29 00:49:06,756 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:49:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:49:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:49:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:49:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.57it/s]04/29/2024 00:49:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:49:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2506631076007346, 'eval_loss': 0.8152554, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2642, 2637, 2631, 2627, 2627, 2621, 2616, 2622, 2673, 2700, 2735, 2763], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7918168, 'remaining_params': 77099432, 'pruned_model_sparsity': 0.09313563309244204, 'expected_sparsity': 0.09474, 'target_sparsity': 0.016791044776119403, 'step': 250}


Iteration:  93%|█████████▎| 250/268 [00:41<00:14,  1.23it/s][A
Iteration:  94%|█████████▎| 251/268 [00:41<00:10,  1.62it/s][A
Iteration:  94%|█████████▍| 252/268 [00:41<00:07,  2.09it/s][A
Iteration:  94%|█████████▍| 253/268 [00:41<00:05,  2.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:41<00:04,  3.20it/s][A
Iteration:  95%|█████████▌| 255/268 [00:42<00:03,  3.75it/s][A
Iteration:  96%|█████████▌| 256/268 [00:42<00:02,  4.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:42<00:02,  4.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:42<00:01,  5.12it/s][A
Iteration:  97%|█████████▋| 259/268 [00:42<00:01,  5.45it/s][A
Iteration:  97%|█████████▋| 260/268 [00:42<00:01,  5.73it/s][A
Iteration:  97%|█████████▋| 261/268 [00:43<00:01,  5.83it/s][A
Iteration:  98%|█████████▊| 262/268 [00:43<00:01,  5.92it/s][A
Iteration:  98%|█████████▊| 263/268 [00:43<00:00,  6.06it/s][A
Iteration:  99%|█████████▊| 264/268 [00:43<00:00,  6.21it/s][A
Iteration:  99%|█████████▉| 265/268 [00:43<00:00,  6.28it/s][A
Iteration:  99%|█████████▉| 266/268 [00:43<00:00,  6.23it/s][A
Iteration: 100%|█████████▉| 267/268 [00:43<00:00,  6.23it/s][A
Iteration: 100%|██████████| 268/268 [00:44<00:00,  6.56it/s][A04/29/2024 00:49:11 - INFO - trainer.trainer_mod_2 - Epoch 0 finished. Took 44.11 seconds.
Iteration: 100%|██████████| 268/268 [00:44<00:00,  6.08it/s]
Epoch:   1%|          | 1/100 [00:46<1:16:12, 46.18s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.08it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.27it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.27it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.49it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.51it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.50it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.62it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.56it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.55it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.50it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.47it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.35it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.26it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.32it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.27it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.35it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.33it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.30it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.37it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:38,  6.22it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.29it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.28it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:38,  6.26it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 00:49:16,767 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:49:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:49:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:49:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:49:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.55it/s]04/29/2024 00:49:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:49:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.24741488402600495, 'eval_loss': 1.04263, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2670, 2664, 2655, 2649, 2649, 2644, 2638, 2649, 2718, 2756, 2797, 2831], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7265536, 'remaining_params': 77752064, 'pruned_model_sparsity': 0.08545919903643481, 'expected_sparsity': 0.08705, 'target_sparsity': 0.022388059701492536, 'step': 300}


Iteration:  12%|█▏        | 32/268 [00:07<03:12,  1.23it/s][A04/29/2024 00:49:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:07<02:24,  1.62it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:51,  2.09it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:28,  2.63it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:12,  3.22it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:00,  3.79it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:53,  4.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:48,  4.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:44,  5.09it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:41,  5.45it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:39,  5.70it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:38,  5.91it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:36,  6.15it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.23it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.24it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.43it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.43it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.39it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.44it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.27it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.47it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.34it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.30it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.33it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.41it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.44it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.47it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.46it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.53it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.39it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.34it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.25it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.44it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 00:49:26,750 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:49:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:49:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:49:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:49:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.54it/s]04/29/2024 00:49:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:49:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.26357566347479533, 'eval_loss': 1.1165249, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2697, 2690, 2679, 2671, 2670, 2665, 2659, 2673, 2760, 2803, 2847, 2882], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6689504, 'remaining_params': 78328096, 'pruned_model_sparsity': 0.07868375489310449, 'expected_sparsity': 0.08032, 'target_sparsity': 0.027985074626865673, 'step': 350}


Iteration:  31%|███       | 82/268 [00:17<02:31,  1.23it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:54,  1.62it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<01:28,  2.07it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<01:09,  2.62it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:57,  3.19it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:47,  3.79it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:41,  4.32it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:37,  4.77it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:34,  5.19it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:32,  5.53it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:30,  5.77it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:30,  5.81it/s][A
Iteration:  35%|███▌      | 94/268 [00:19<00:29,  5.86it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:28,  6.02it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:28,  6.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:28,  6.02it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.13it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.22it/s][A
Iteration:  37%|███▋      | 100/268 [00:20<00:26,  6.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.25it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.19it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.24it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.28it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.32it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:25,  6.37it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.23it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.29it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:24,  6.43it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.24it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.29it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.28it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:23,  6.32it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.35it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.33it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.41it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 00:49:36,819 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:49:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:49:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:49:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:49:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.56it/s]04/29/2024 00:49:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:49:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3287265348590058, 'eval_loss': 1.0105201, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2722, 2713, 2700, 2690, 2690, 2687, 2680, 2699, 2795, 2842, 2885, 2919], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6190072, 'remaining_params': 78827528, 'pruned_model_sparsity': 0.07280930066245107, 'expected_sparsity': 0.07445, 'target_sparsity': 0.033582089552238806, 'step': 400}


Iteration:  49%|████▉     | 132/268 [00:27<01:50,  1.23it/s][A04/29/2024 00:49:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:27<01:23,  1.62it/s][A
Iteration:  50%|█████     | 134/268 [00:27<01:03,  2.10it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:50,  2.64it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:41,  3.19it/s][A
Iteration:  51%|█████     | 137/268 [00:28<00:35,  3.74it/s][A
Iteration:  51%|█████▏    | 138/268 [00:28<00:30,  4.26it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:27,  4.76it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:24,  5.16it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:23,  5.40it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:22,  5.65it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:21,  5.95it/s][A
Iteration:  54%|█████▎    | 144/268 [00:29<00:20,  6.03it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:20,  6.11it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.34it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 150/268 [00:30<00:18,  6.41it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:18,  6.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.44it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.28it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.23it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:16,  6.50it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.52it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.48it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.39it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:16,  6.45it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.42it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.33it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.61it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.49it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.40it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 00:49:46,786 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:49:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:49:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:49:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:49:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.55it/s]04/29/2024 00:49:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:49:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.258099917391379, 'eval_loss': 1.071632, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2745, 2734, 2720, 2709, 2708, 2705, 2699, 2721, 2823, 2871, 2913, 2945], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5774900, 'remaining_params': 79242700, 'pruned_model_sparsity': 0.06792593533574225, 'expected_sparsity': 0.06955, 'target_sparsity': 0.039179104477611935, 'step': 450}


Iteration:  68%|██████▊   | 182/268 [00:37<01:09,  1.23it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:52,  1.62it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:39,  2.10it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:31,  2.61it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:25,  3.16it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:21,  3.73it/s][A
Iteration:  70%|███████   | 188/268 [00:38<00:18,  4.28it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:17,  4.59it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:15,  5.09it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:14,  5.50it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:13,  5.70it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.01it/s][A
Iteration:  72%|███████▏  | 194/268 [00:39<00:12,  6.13it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:11,  6.21it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.41it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▍  | 200/268 [00:40<00:10,  6.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:10,  6.40it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.36it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.43it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.32it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.28it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:08,  6.36it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.39it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.45it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.43it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.35it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.24it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.23it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.28it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.36it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.37it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.39it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.19it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.00it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.14it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.33it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.45it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 00:49:56,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:49:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:49:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:49:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:49:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.35it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.54it/s]04/29/2024 00:49:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:49:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3178256922603006, 'eval_loss': 0.85937166, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2765, 2754, 2738, 2727, 2725, 2722, 2716, 2740, 2846, 2896, 2935, 2965], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5413348, 'remaining_params': 79604252, 'pruned_model_sparsity': 0.06367326294790726, 'expected_sparsity': 0.06534, 'target_sparsity': 0.04477611940298507, 'step': 500}


Iteration:  87%|████████▋ | 232/268 [00:47<00:29,  1.23it/s][A04/29/2024 00:49:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:47<00:21,  1.62it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:16,  2.08it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:12,  2.62it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:10,  3.18it/s][A
Iteration:  88%|████████▊ | 237/268 [00:48<00:08,  3.76it/s][A
Iteration:  89%|████████▉ | 238/268 [00:48<00:06,  4.30it/s][A
Iteration:  89%|████████▉ | 239/268 [00:48<00:06,  4.78it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:05,  5.18it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  5.44it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.79it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  6.00it/s][A
Iteration:  91%|█████████ | 244/268 [00:49<00:03,  6.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:49<00:03,  6.34it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.21it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.31it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.42it/s][A
Iteration:  93%|█████████▎| 250/268 [00:50<00:02,  6.43it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:02,  6.00it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.08it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.16it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.25it/s][A
Iteration:  96%|█████████▌| 256/268 [00:51<00:01,  6.29it/s][A
Iteration:  96%|█████████▌| 257/268 [00:51<00:01,  6.47it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  6.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.39it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:52<00:00,  6.20it/s][A
Iteration:  99%|█████████▊| 264/268 [00:52<00:00,  6.26it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.29it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.34it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.40it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.72it/s][A04/29/2024 00:50:04 - INFO - trainer.trainer_mod_2 - Epoch 1 finished. Took 52.89 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.07it/s]
Epoch:   2%|▏         | 2/100 [01:39<1:21:52, 50.13s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.54it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:43,  6.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.36it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.37it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.34it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:42,  6.09it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:41,  6.21it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:41,  6.21it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.28it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 00:50:06,866 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:50:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:50:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:50:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:50:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.54it/s]04/29/2024 00:50:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:50:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.30499605871033847, 'eval_loss': 1.0016791, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2784, 2773, 2757, 2744, 2740, 2737, 2732, 2759, 2867, 2915, 2953, 2981], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5087032, 'remaining_params': 79930568, 'pruned_model_sparsity': 0.05983504591990364, 'expected_sparsity': 0.0615, 'target_sparsity': 0.05037313432835821, 'step': 550}


Iteration:   5%|▌         | 14/268 [00:04<03:27,  1.23it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:35,  1.62it/s][A
Iteration:   6%|▌         | 16/268 [00:04<02:00,  2.09it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:35,  2.62it/s][A
Iteration:   7%|▋         | 18/268 [00:05<01:18,  3.19it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:06,  3.75it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:57,  4.29it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:51,  4.78it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:47,  5.17it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:43,  5.57it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.81it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:40,  6.07it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:40,  6.04it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:39,  6.10it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.19it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.24it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.45it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.39it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.23it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:37,  6.13it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.13it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.16it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.26it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.30it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▊        | 50/268 [00:10<00:33,  6.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.55it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.36it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.37it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.30it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.35it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.32it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 00:50:16,860 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:50:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:50:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:50:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:50:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.30it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.53it/s]04/29/2024 00:50:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:50:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2420937606062148, 'eval_loss': 1.2380501, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2800, 2789, 2773, 2758, 2755, 2752, 2746, 2775, 2884, 2932, 2968, 2993], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4806676, 'remaining_params': 80210924, 'pruned_model_sparsity': 0.05653742283950617, 'expected_sparsity': 0.05821, 'target_sparsity': 0.055970149253731345, 'step': 600}


Iteration:  24%|██▍       | 64/268 [00:14<02:44,  1.24it/s][A04/29/2024 00:50:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:14<02:04,  1.63it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:35,  2.11it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:15,  2.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:15<01:01,  3.23it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:52,  3.80it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:46,  4.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:41,  4.75it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:38,  5.12it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:35,  5.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:33,  5.72it/s][A
Iteration:  28%|██▊       | 75/268 [00:16<00:32,  5.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:32,  5.98it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:31,  6.12it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:30,  6.22it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.21it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.26it/s][A
Iteration:  30%|███       | 81/268 [00:17<00:29,  6.31it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.35it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.13it/s][A
Iteration:  32%|███▏      | 87/268 [00:18<00:29,  6.20it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:28,  6.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.21it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.29it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.28it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.21it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.27it/s][A
Iteration:  35%|███▌      | 94/268 [00:19<00:27,  6.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.39it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:20<00:26,  6.46it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.37it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.40it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:25,  6.43it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.45it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.45it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.48it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.42it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:24,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 00:50:26,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:50:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:50:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:50:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:50:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.55it/s]04/29/2024 00:50:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:50:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2374542443304678, 'eval_loss': 1.1793524, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2814, 2803, 2786, 2770, 2767, 2765, 2759, 2789, 2899, 2945, 2979, 3003], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4570748, 'remaining_params': 80446852, 'pruned_model_sparsity': 0.05376237390846131, 'expected_sparsity': 0.05544, 'target_sparsity': 0.061567164179104475, 'step': 650}


Iteration:  43%|████▎     | 114/268 [00:24<02:05,  1.23it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<01:34,  1.61it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<01:13,  2.08it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:57,  2.61it/s][A
Iteration:  44%|████▍     | 118/268 [00:25<00:47,  3.17it/s][A
Iteration:  44%|████▍     | 119/268 [00:25<00:39,  3.74it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:34,  4.30it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:30,  4.78it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:28,  5.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:26,  5.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:25,  5.64it/s][A
Iteration:  47%|████▋     | 125/268 [00:26<00:24,  5.86it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:24,  5.91it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:23,  6.07it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.21it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.26it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.36it/s][A
Iteration:  49%|████▉     | 131/268 [00:27<00:21,  6.38it/s][A
Iteration:  49%|████▉     | 132/268 [00:27<00:20,  6.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.39it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.33it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.29it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.37it/s][A
Iteration:  51%|█████     | 137/268 [00:28<00:20,  6.30it/s][A
Iteration:  51%|█████▏    | 138/268 [00:28<00:20,  6.37it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.33it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.38it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:29<00:21,  5.94it/s][A
Iteration:  54%|█████▎    | 144/268 [00:29<00:20,  6.11it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.19it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.18it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.27it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.30it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:30<00:18,  6.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:18,  6.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.49it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.25it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:17,  6.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:17,  6.39it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.31it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.55it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.40it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:16,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 00:50:36,948 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:50:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:50:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:50:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:50:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.54it/s]04/29/2024 00:50:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:50:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.26357566347479533, 'eval_loss': 1.0741272, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2826, 2815, 2796, 2781, 2778, 2777, 2772, 2803, 2910, 2956, 2988, 3011], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4365460, 'remaining_params': 80652140, 'pruned_model_sparsity': 0.051347720942487206, 'expected_sparsity': 0.05305, 'target_sparsity': 0.06716417910447761, 'step': 700}


Iteration:  61%|██████    | 164/268 [00:34<01:24,  1.23it/s][A04/29/2024 00:50:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:34<01:03,  1.62it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:48,  2.09it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:38,  2.61it/s][A
Iteration:  63%|██████▎   | 168/268 [00:35<00:31,  3.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:35<00:26,  3.78it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:22,  4.32it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:20,  4.81it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:18,  5.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:17,  5.50it/s][A
Iteration:  65%|██████▍   | 174/268 [00:36<00:16,  5.74it/s][A
Iteration:  65%|██████▌   | 175/268 [00:36<00:15,  5.86it/s][A
Iteration:  66%|██████▌   | 176/268 [00:36<00:15,  6.03it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.09it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.20it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.13it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:14,  6.24it/s][A
Iteration:  68%|██████▊   | 181/268 [00:37<00:13,  6.31it/s][A
Iteration:  68%|██████▊   | 182/268 [00:37<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.44it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:38<00:12,  6.33it/s][A
Iteration:  70%|███████   | 188/268 [00:38<00:12,  6.37it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:12,  6.39it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 194/268 [00:39<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:11,  6.42it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.31it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:40<00:10,  6.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:10,  6.40it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.27it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.23it/s][A
Iteration:  77%|███████▋  | 206/268 [00:41<00:09,  6.27it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:09,  6.32it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.37it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:08,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 00:50:46,963 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:50:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:50:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:50:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:50:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.53it/s]04/29/2024 00:50:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:50:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2727397758301279, 'eval_loss': 1.0849572, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2837, 2826, 2806, 2792, 2788, 2787, 2782, 2813, 2920, 2965, 2995, 3017], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4189280, 'remaining_params': 80828320, 'pruned_model_sparsity': 0.04927544414333032, 'expected_sparsity': 0.05099, 'target_sparsity': 0.07276119402985075, 'step': 750}


Iteration:  80%|███████▉  | 214/268 [00:44<00:43,  1.23it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:32,  1.62it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:24,  2.09it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:19,  2.63it/s][A
Iteration:  81%|████████▏ | 218/268 [00:45<00:15,  3.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:45<00:13,  3.75it/s][A
Iteration:  82%|████████▏ | 220/268 [00:45<00:11,  4.26it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:10,  4.67it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:09,  5.08it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:08,  5.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:46<00:07,  5.56it/s][A
Iteration:  84%|████████▍ | 225/268 [00:46<00:07,  5.81it/s][A
Iteration:  84%|████████▍ | 226/268 [00:46<00:06,  6.08it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.16it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.19it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:47<00:05,  6.40it/s][A
Iteration:  86%|████████▌ | 231/268 [00:47<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 232/268 [00:47<00:05,  6.52it/s][A
Iteration:  87%|████████▋ | 233/268 [00:47<00:05,  6.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.42it/s][A
Iteration:  88%|████████▊ | 237/268 [00:48<00:04,  6.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:48<00:04,  6.44it/s][A
Iteration:  89%|████████▉ | 239/268 [00:48<00:04,  6.46it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.39it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:49<00:03,  6.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:49<00:03,  6.45it/s][A
Iteration:  91%|█████████▏| 245/268 [00:49<00:03,  6.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.45it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.45it/s][A
Iteration:  93%|█████████▎| 250/268 [00:50<00:02,  6.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:02,  6.33it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:02,  6.32it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.37it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.27it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.25it/s][A
Iteration:  96%|█████████▌| 256/268 [00:51<00:01,  6.12it/s][A
Iteration:  96%|█████████▌| 257/268 [00:51<00:01,  6.22it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  6.19it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  5.96it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.01it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.09it/s][A
Iteration:  98%|█████████▊| 262/268 [00:52<00:00,  6.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:52<00:00,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 00:50:56,994 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:50:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:50:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:50:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:50:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.53it/s]04/29/2024 00:50:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:50:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.40877537453722057, 'eval_loss': 0.9543911, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2846, 2835, 2816, 2802, 2798, 2797, 2792, 2823, 2928, 2972, 3001, 3021], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4031484, 'remaining_params': 80986116, 'pruned_model_sparsity': 0.0474194049232159, 'expected_sparsity': 0.04914, 'target_sparsity': 0.07835820895522387, 'step': 800}


Iteration:  99%|█████████▊| 264/268 [00:54<00:03,  1.24it/s][A04/29/2024 00:50:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:54<00:01,  1.63it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  2.10it/s][A
Iteration: 100%|█████████▉| 267/268 [00:55<00:00,  2.61it/s][A
Iteration: 100%|██████████| 268/268 [00:55<00:00,  3.26it/s][A04/29/2024 00:50:59 - INFO - trainer.trainer_mod_2 - Epoch 2 finished. Took 55.14 seconds.
Iteration: 100%|██████████| 268/268 [00:55<00:00,  4.86it/s]
Epoch:   3%|▎         | 3/100 [02:34<1:24:44, 52.41s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.22it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.23it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.30it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.25it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.37it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.36it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.42it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.41it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.36it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.35it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.48it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.30it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:40,  6.21it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.36it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.41it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.40it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:39,  6.12it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:39,  6.20it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.30it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.23it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:38,  6.21it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:38,  6.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.32it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.39it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.30it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.37it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:36,  6.31it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.37it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.30it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:34,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 00:51:07,024 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:51:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:51:07 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:51:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:51:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:02, 15.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.53it/s]04/29/2024 00:51:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:51:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3007930418319595, 'eval_loss': 1.1561768, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2854, 2843, 2824, 2809, 2805, 2804, 2797, 2830, 2934, 2977, 3005, 3025], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3915052, 'remaining_params': 81102548, 'pruned_model_sparsity': 0.046049900255947004, 'expected_sparsity': 0.04774, 'target_sparsity': 0.08395522388059701, 'step': 850}


Iteration:  17%|█▋        | 46/268 [00:09<02:59,  1.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<02:15,  1.63it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:44,  2.10it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:22,  2.64it/s][A
Iteration:  19%|█▊        | 50/268 [00:10<01:07,  3.23it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:57,  3.76it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:49,  4.34it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:44,  4.81it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:40,  5.22it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:38,  5.53it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:36,  5.79it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:35,  5.93it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:34,  6.06it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:34,  6.12it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.23it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.28it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.27it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:33,  6.16it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.16it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:33,  6.07it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.20it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.30it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.28it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.40it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.44it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.45it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:30,  6.19it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.30it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:29,  6.26it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.46it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.47it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.59it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.51it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.63it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.53it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.55it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:27,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 00:51:17,001 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:51:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:51:17 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:51:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:51:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.55it/s]04/29/2024 00:51:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:51:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.28710292511754365, 'eval_loss': 1.2449224, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2861, 2850, 2830, 2815, 2811, 2809, 2801, 2835, 2939, 2981, 3008, 3028], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3821600, 'remaining_params': 81196000, 'pruned_model_sparsity': 0.04495069256248118, 'expected_sparsity': 0.04666, 'target_sparsity': 0.08955223880597014, 'step': 900}


Iteration:  36%|███▌      | 96/268 [00:19<02:19,  1.23it/s][A04/29/2024 00:51:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:19<01:45,  1.62it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<01:21,  2.08it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:04,  2.61it/s][A
Iteration:  37%|███▋      | 100/268 [00:20<00:52,  3.18it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:44,  3.75it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:39,  4.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:34,  4.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:32,  5.08it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:30,  5.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:28,  5.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:27,  5.92it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:26,  6.00it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:26,  6.03it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.15it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.33it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.39it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.26it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:22,  6.51it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.49it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.58it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.69it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.56it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:21,  6.52it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.57it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.54it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.62it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.59it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.59it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.67it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.42it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 00:51:26,927 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:51:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:51:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:51:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:51:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.60it/s]04/29/2024 00:51:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:51:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3786418079451158, 'eval_loss': 1.0292902, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2864, 2855, 2835, 2820, 2815, 2813, 2805, 2839, 2943, 2984, 3010, 3030], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3752660, 'remaining_params': 81264940, 'pruned_model_sparsity': 0.044139801641071966, 'expected_sparsity': 0.04586, 'target_sparsity': 0.0951492537313433, 'step': 950}


Iteration:  54%|█████▍    | 146/268 [00:29<01:38,  1.24it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<01:13,  1.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:56,  2.13it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:44,  2.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:36,  3.20it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:31,  3.75it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:27,  4.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:23,  4.82it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:22,  5.18it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:20,  5.61it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:19,  5.87it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:18,  5.94it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:18,  6.08it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.13it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.31it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.16it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.15it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.24it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.39it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.43it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.47it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.27it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.17it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:15,  6.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.35it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:13,  6.55it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:13,  6.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.58it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.54it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.66it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:11,  6.71it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.68it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.56it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.56it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 00:51:36,879 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:51:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:51:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:51:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:51:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.59it/s]04/29/2024 00:51:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:51:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3012027598774727, 'eval_loss': 1.3043249, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2867, 2858, 2839, 2824, 2819, 2816, 2807, 2841, 2945, 2986, 3012, 3031], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3703636, 'remaining_params': 81313964, 'pruned_model_sparsity': 0.043563168096958746, 'expected_sparsity': 0.04532, 'target_sparsity': 0.10074626865671642, 'step': 1000}


Iteration:  73%|███████▎  | 196/268 [00:39<00:58,  1.24it/s][A04/29/2024 00:51:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:39<00:43,  1.64it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:33,  2.10it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:26,  2.64it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:21,  3.21it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:17,  3.76it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:15,  4.25it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:13,  4.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:12,  5.22it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:11,  5.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  5.72it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  5.74it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:10,  5.89it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:10,  5.90it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  5.99it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.12it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  6.14it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.25it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.32it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.35it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.40it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.28it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.31it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.44it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.38it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.35it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.48it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.57it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:06,  6.10it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.20it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.38it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.40it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.50it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.46it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.37it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.39it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 00:51:46,889 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:51:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:51:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:51:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:51:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.57it/s]04/29/2024 00:51:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:51:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2989463121855086, 'eval_loss': 1.1158645, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2868, 2859, 2841, 2825, 2820, 2818, 2808, 2841, 2946, 2986, 3012, 3031], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3688316, 'remaining_params': 81329284, 'pruned_model_sparsity': 0.043382970114423366, 'expected_sparsity': 0.0451, 'target_sparsity': 0.10634328358208955, 'step': 1050}


Iteration:  92%|█████████▏| 246/268 [00:49<00:17,  1.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:12,  1.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:09,  2.10it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:07,  2.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:05,  3.21it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:04,  3.78it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:03,  4.29it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:03,  4.75it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.12it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  5.48it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.52it/s][A
Iteration:  96%|█████████▌| 257/268 [00:51<00:01,  5.79it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  5.89it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.09it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.22it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.17it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.20it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.31it/s][A
Iteration:  99%|█████████▊| 264/268 [00:52<00:00,  6.34it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.44it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.44it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.79it/s][A04/29/2024 00:51:52 - INFO - trainer.trainer_mod_2 - Epoch 3 finished. Took 52.7 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.09it/s]
Epoch:   4%|▍         | 4/100 [03:26<1:24:02, 52.53s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.47it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.31it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.35it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:42,  6.21it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.27it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.31it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.55it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.66it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.41it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.35it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.31it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.41it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.43it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.43it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.44it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.37it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.44it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.46it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 00:51:56,847 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:51:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:51:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:51:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:51:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.56it/s]04/29/2024 00:51:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:51:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3288085794748123, 'eval_loss': 1.3051217, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2868, 2858, 2842, 2825, 2821, 2819, 2809, 2840, 2946, 2985, 3011, 3031], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3688316, 'remaining_params': 81329284, 'pruned_model_sparsity': 0.043382970114423366, 'expected_sparsity': 0.04517, 'target_sparsity': 0.11194029850746269, 'step': 1100}


Iteration:  10%|█         | 28/268 [00:06<03:13,  1.24it/s][A04/29/2024 00:51:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 1100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:26,  1.63it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:53,  2.10it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<01:29,  2.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:13,  3.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:02,  3.78it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:54,  4.32it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:48,  4.81it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:44,  5.22it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:41,  5.55it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:39,  5.75it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:38,  5.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.08it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.18it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.29it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.28it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.34it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.46it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.53it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.43it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.31it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.38it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.43it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.48it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.38it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.47it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.37it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.40it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.52it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.31it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:32,  6.10it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.29it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.33it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:30,  6.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 00:52:06,840 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:52:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:52:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:52:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:52:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.31it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.31it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.53it/s]04/29/2024 00:52:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:52:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.32688211378387777, 'eval_loss': 1.2081164, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2866, 2857, 2840, 2823, 2819, 2817, 2807, 2837, 2944, 2983, 3009, 3030], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3723552, 'remaining_params': 81294048, 'pruned_model_sparsity': 0.04379742547425474, 'expected_sparsity': 0.04564, 'target_sparsity': 0.11753731343283583, 'step': 1150}


Iteration:  29%|██▉       | 78/268 [00:16<02:36,  1.22it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:57,  1.61it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<01:30,  2.08it/s][A
Iteration:  30%|███       | 81/268 [00:16<01:11,  2.62it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:58,  3.17it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:49,  3.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:43,  4.27it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:38,  4.77it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:35,  5.14it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:33,  5.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:31,  5.72it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:30,  5.89it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:30,  5.87it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:29,  6.03it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.07it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.28it/s][A
Iteration:  35%|███▌      | 94/268 [00:19<00:27,  6.22it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.28it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.35it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.20it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.37it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.36it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:25,  6.40it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.39it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.34it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.31it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.24it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.28it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:24,  6.21it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:23,  6.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.41it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.43it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.43it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:23,  6.13it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:22,  6.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 00:52:16,891 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:52:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:52:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:52:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:52:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.55it/s]04/29/2024 00:52:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:52:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.36831418626741114, 'eval_loss': 1.1811088, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2862, 2852, 2837, 2820, 2816, 2814, 2802, 2833, 2941, 2978, 3005, 3028], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3790960, 'remaining_params': 81226640, 'pruned_model_sparsity': 0.04459029659741042, 'expected_sparsity': 0.04662, 'target_sparsity': 0.12313432835820895, 'step': 1200}


Iteration:  48%|████▊     | 128/268 [00:26<01:53,  1.23it/s][A04/29/2024 00:52:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 1200, Alignment: tensor([ 2,  7,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:26<01:25,  1.63it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<01:05,  2.11it/s][A
Iteration:  49%|████▉     | 131/268 [00:27<00:52,  2.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:27<00:43,  3.16it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:36,  3.72it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:31,  4.27it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:28,  4.69it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:25,  5.12it/s][A
Iteration:  51%|█████     | 137/268 [00:28<00:24,  5.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:28<00:22,  5.71it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:21,  5.90it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:21,  6.04it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.28it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.29it/s][A
Iteration:  54%|█████▎    | 144/268 [00:29<00:19,  6.22it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.38it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.33it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:30<00:18,  6.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.41it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.42it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.31it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:17,  6.29it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.35it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.38it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.22it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.39it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:16,  6.42it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.35it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.34it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:16,  6.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.29it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.32it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.28it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.36it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.35it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.37it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.26it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.27it/s][A[INFO|trainer.py:570] 2024-04-29 00:52:26,936 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:52:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:52:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:52:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:52:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.38it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.39it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.53it/s]04/29/2024 00:52:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:52:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3863103724936849, 'eval_loss': 1.1459684, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2855, 2846, 2831, 2814, 2810, 2809, 2796, 2825, 2935, 2971, 2998, 3023], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 3905860, 'remaining_params': 81111740, 'pruned_model_sparsity': 0.045941781466425774, 'expected_sparsity': 0.04831, 'target_sparsity': 0.1287313432835821, 'step': 1250}


Iteration:  66%|██████▋   | 178/268 [00:36<01:13,  1.23it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:54,  1.62it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:42,  2.09it/s][A
Iteration:  68%|██████▊   | 181/268 [00:37<00:33,  2.62it/s][A
Iteration:  68%|██████▊   | 182/268 [00:37<00:27,  3.17it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:22,  3.74it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:19,  4.32it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:17,  4.76it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:15,  5.14it/s][A
Iteration:  70%|██████▉   | 187/268 [00:38<00:14,  5.47it/s][A
Iteration:  70%|███████   | 188/268 [00:38<00:13,  5.73it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:13,  5.86it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.05it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.11it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:39<00:11,  6.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:11,  6.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.35it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.37it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.36it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:40<00:10,  6.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:10,  6.30it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.36it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.38it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:41<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.30it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.33it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:08,  6.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.37it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.43it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.44it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.46it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.31it/s][A
Iteration:  82%|████████▏ | 219/268 [00:43<00:07,  6.29it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.31it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.18it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.22it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.14it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.11it/s][A
Iteration:  84%|████████▍ | 225/268 [00:44<00:06,  6.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 00:52:36,977 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:52:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:52:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:52:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:52:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.38it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.34it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.54it/s]04/29/2024 00:52:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:52:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42977561534848874, 'eval_loss': 0.9836559, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2846, 2837, 2823, 2805, 2801, 2801, 2787, 2815, 2927, 2959, 2987, 3016], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4072848, 'remaining_params': 80944752, 'pruned_model_sparsity': 0.04790593947606143, 'expected_sparsity': 0.05233, 'target_sparsity': 0.13432835820895522, 'step': 1300}


Iteration:  85%|████████▌ | 228/268 [00:46<00:32,  1.24it/s][A04/29/2024 00:52:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 1300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:46<00:23,  1.63it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:18,  2.10it/s][A
Iteration:  86%|████████▌ | 231/268 [00:47<00:14,  2.63it/s][A
Iteration:  87%|████████▋ | 232/268 [00:47<00:11,  3.20it/s][A
Iteration:  87%|████████▋ | 233/268 [00:47<00:09,  3.77it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:07,  4.31it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:06,  4.74it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:06,  5.16it/s][A
Iteration:  88%|████████▊ | 237/268 [00:48<00:05,  5.50it/s][A
Iteration:  89%|████████▉ | 238/268 [00:48<00:05,  5.65it/s][A
Iteration:  89%|████████▉ | 239/268 [00:48<00:04,  5.90it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  5.94it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.08it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.19it/s][A
Iteration:  91%|█████████ | 243/268 [00:49<00:04,  6.16it/s][A
Iteration:  91%|█████████ | 244/268 [00:49<00:03,  6.22it/s][A
Iteration:  91%|█████████▏| 245/268 [00:49<00:03,  6.13it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.18it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.25it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.32it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.36it/s][A
Iteration:  93%|█████████▎| 250/268 [00:50<00:02,  6.40it/s][A
Iteration:  94%|█████████▎| 251/268 [00:50<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.30it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.39it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.39it/s][A
Iteration:  96%|█████████▌| 256/268 [00:51<00:01,  6.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:51<00:01,  6.23it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  6.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.30it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.36it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.52it/s][A
Iteration:  98%|█████████▊| 262/268 [00:52<00:00,  6.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:52<00:00,  6.35it/s][A
Iteration:  99%|█████████▊| 264/268 [00:52<00:00,  6.33it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.44it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.46it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.74it/s][A04/29/2024 00:52:45 - INFO - trainer.trainer_mod_2 - Epoch 4 finished. Took 52.94 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.06it/s]
Epoch:   5%|▌         | 5/100 [04:19<1:23:24, 52.68s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.18it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.59it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.53it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.61it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 00:52:46,969 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:52:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:52:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:52:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:52:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.48it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.37it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.36it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.53it/s]04/29/2024 00:52:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:52:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3827584804264468, 'eval_loss': 1.142309, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2832, 2825, 2812, 2793, 2790, 2790, 2773, 2801, 2914, 2940, 2969, 3003], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4321032, 'remaining_params': 80696568, 'pruned_model_sparsity': 0.0508251467931346, 'expected_sparsity': 0.07832, 'target_sparsity': 0.13992537313432835, 'step': 1350}


Iteration:   4%|▎         | 10/268 [00:03<03:34,  1.20it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:40,  1.60it/s][A
Iteration:   4%|▍         | 12/268 [00:04<02:03,  2.07it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:37,  2.61it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:20,  3.15it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:07,  3.73it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:58,  4.33it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:52,  4.80it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:47,  5.26it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:45,  5.50it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:43,  5.75it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:40,  6.05it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:40,  6.09it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:40,  6.10it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:40,  6.08it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:39,  6.18it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:39,  6.16it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.24it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.29it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.34it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.43it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.44it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:34,  6.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.61it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.62it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.69it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.28it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.43it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 00:52:56,925 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:52:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:52:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:52:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:52:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.64it/s]04/29/2024 00:52:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:52:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42977390602382576, 'eval_loss': 1.1190746, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2817, 2810, 2799, 2779, 2776, 2778, 2757, 2784, 2897, 2921, 2954, 2980], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 13612612, 'remaining_params': 71404988, 'pruned_model_sparsity': 0.16011522320084312, 'expected_sparsity': 0.13647, 'target_sparsity': 0.1455223880597015, 'step': 1400}


Iteration:  22%|██▏       | 60/268 [00:13<02:47,  1.24it/s][A04/29/2024 00:52:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 1400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:13<02:06,  1.64it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:37,  2.11it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<01:17,  2.65it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:03,  3.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:53,  3.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:46,  4.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:41,  4.80it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:38,  5.21it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:35,  5.56it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:34,  5.79it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:32,  6.00it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:32,  6.11it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.19it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:31,  6.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.30it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.34it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.37it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.40it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.42it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.44it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.47it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:28,  6.42it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.36it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.41it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.48it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.56it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.58it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.57it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.56it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.36it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 00:53:06,822 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:53:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:53:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:53:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:53:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.65it/s]04/29/2024 00:53:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:53:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4306932716491276, 'eval_loss': 1.0646837, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2800, 2794, 2785, 2766, 2763, 2765, 2741, 2763, 2876, 2913, 2948, 2934], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 13903692, 'remaining_params': 71113908, 'pruned_model_sparsity': 0.16353898486901536, 'expected_sparsity': 0.15831, 'target_sparsity': 0.15111940298507462, 'step': 1450}


Iteration:  41%|████      | 110/268 [00:23<02:06,  1.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<01:35,  1.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<01:13,  2.11it/s][A
Iteration:  42%|████▏     | 113/268 [00:24<00:58,  2.65it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:48,  3.21it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:40,  3.78it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:35,  4.24it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:31,  4.74it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:29,  5.16it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:27,  5.42it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:26,  5.59it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:25,  5.81it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:24,  5.98it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.10it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:23,  6.15it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.28it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:23,  6.17it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.30it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.33it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.39it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.33it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.29it/s][A
Iteration:  49%|████▉     | 132/268 [00:27<00:21,  6.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.32it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.35it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.52it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.54it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.43it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.36it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.39it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.28it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.24it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.31it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.22it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:18,  6.32it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.40it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.34it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.36it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 00:53:16,852 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:53:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:53:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:53:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:53:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.44it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.65it/s]04/29/2024 00:53:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:53:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4394747228458321, 'eval_loss': 1.1657923, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2783, 2776, 2771, 2752, 2749, 2752, 2726, 2744, 2850, 2909, 2944, 2827], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 11, 12], 'pruned_params': 14689608, 'remaining_params': 70327992, 'pruned_model_sparsity': 0.1727831413730804, 'expected_sparsity': 0.1803, 'target_sparsity': 0.15671641791044774, 'step': 1500}


Iteration:  60%|█████▉    | 160/268 [00:33<01:27,  1.24it/s][A04/29/2024 00:53:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 1500, Alignment: tensor([ 0,  6,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:33<01:05,  1.63it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:50,  2.10it/s][A
Iteration:  61%|██████    | 163/268 [00:34<00:40,  2.61it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:32,  3.16it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:27,  3.74it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:23,  4.31it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:21,  4.78it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:19,  5.17it/s][A
Iteration:  63%|██████▎   | 169/268 [00:35<00:18,  5.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:17,  5.75it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:16,  5.98it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.13it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.28it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:36<00:14,  6.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.50it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 182/268 [00:37<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:12,  6.60it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.44it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.44it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.27it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.27it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:12,  6.32it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.41it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.41it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:11,  6.58it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.48it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.48it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.41it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.43it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.33it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.47it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.48it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 00:53:26,808 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:53:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:53:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:53:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:53:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:53:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:53:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.43502056233029146, 'eval_loss': 1.193163, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2764, 2759, 2757, 2738, 2735, 2738, 2708, 2718, 2818, 2907, 2942, 2689], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12], 'pruned_params': 19474044, 'remaining_params': 65543556, 'pruned_model_sparsity': 0.22905897131887987, 'expected_sparsity': 0.21335, 'target_sparsity': 0.16231343283582086, 'step': 1550}


Iteration:  78%|███████▊  | 210/268 [00:43<00:46,  1.24it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:34,  1.64it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:26,  2.12it/s][A
Iteration:  79%|███████▉  | 213/268 [00:44<00:21,  2.58it/s][A
Iteration:  80%|███████▉  | 214/268 [00:44<00:17,  3.16it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:14,  3.74it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:12,  4.28it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:10,  4.72it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:09,  5.16it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  5.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:45<00:08,  5.76it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  5.90it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.04it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.07it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  6.21it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:46<00:06,  6.37it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.38it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.18it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.25it/s][A
Iteration:  87%|████████▋ | 232/268 [00:47<00:05,  6.27it/s][A
Iteration:  87%|████████▋ | 233/268 [00:47<00:05,  6.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.40it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.53it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:48<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.40it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.38it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.46it/s][A
Iteration:  91%|█████████▏| 245/268 [00:49<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.57it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:02,  6.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.34it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.39it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.32it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.40it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 00:53:36,781 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:53:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:53:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:53:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:53:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.69it/s]04/29/2024 00:53:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:53:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.44436498029196, 'eval_loss': 1.136806, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2749, 2744, 2746, 2728, 2724, 2728, 2695, 2702, 2784, 2905, 2941, 2628], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 12], 'pruned_params': 19680864, 'remaining_params': 65336736, 'pruned_model_sparsity': 0.2314916440831075, 'expected_sparsity': 0.22562, 'target_sparsity': 0.16791044776119401, 'step': 1600}


Iteration:  97%|█████████▋| 260/268 [00:53<00:06,  1.25it/s][A04/29/2024 00:53:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 1600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:53<00:04,  1.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:02,  2.12it/s][A
Iteration:  98%|█████████▊| 263/268 [00:54<00:01,  2.60it/s][A
Iteration:  99%|█████████▊| 264/268 [00:54<00:01,  3.16it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  3.72it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  4.23it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  4.72it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  5.34it/s][A04/29/2024 00:53:40 - INFO - trainer.trainer_mod_2 - Epoch 5 finished. Took 54.77 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.89it/s]
Epoch:   6%|▌         | 6/100 [05:14<1:23:38, 53.39s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.26it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.67it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.43it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.55it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.56it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.37it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.48it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.48it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.36it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.45it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.45it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.50it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.55it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.54it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.54it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:37,  6.31it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:37,  6.30it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.45it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.40it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.48it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.53it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 00:53:46,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:53:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:53:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:53:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:53:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.71it/s]04/29/2024 00:53:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:53:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.43655986862605256, 'eval_loss': 1.2046405, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2736, 2731, 2736, 2719, 2714, 2717, 2681, 2683, 2749, 2904, 2939, 2600], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 20474440, 'remaining_params': 64543160, 'pruned_model_sparsity': 0.24082589957844022, 'expected_sparsity': 0.23332, 'target_sparsity': 0.17350746268656714, 'step': 1650}


Iteration:  16%|█▌        | 42/268 [00:08<03:01,  1.25it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:16,  1.64it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:45,  2.12it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<01:23,  2.67it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:08,  3.22it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:57,  3.83it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:50,  4.37it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:44,  4.88it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:41,  5.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:39,  5.54it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:37,  5.71it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:36,  5.90it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:35,  6.00it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:34,  6.16it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.19it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.36it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.41it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.42it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.43it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.32it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.46it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.59it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.39it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:31,  6.23it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.48it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.39it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.37it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.41it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.37it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.34it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 00:53:56,608 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:53:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:53:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:53:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:53:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:53:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:53:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3953611854992157, 'eval_loss': 1.2470438, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2727, 2722, 2729, 2713, 2708, 2711, 2672, 2671, 2721, 2903, 2939, 2584], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 20811480, 'remaining_params': 64206120, 'pruned_model_sparsity': 0.2447902551942186, 'expected_sparsity': 0.23791, 'target_sparsity': 0.1791044776119403, 'step': 1700}


Iteration:  34%|███▍      | 92/268 [00:18<02:21,  1.25it/s][A04/29/2024 00:53:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 1700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:18<01:46,  1.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<01:22,  2.11it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<01:05,  2.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:53,  3.23it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:45,  3.78it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:39,  4.32it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:35,  4.82it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:32,  5.25it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:29,  5.64it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:28,  5.85it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:27,  5.98it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:27,  6.03it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.16it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.49it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.52it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.52it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.57it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.44it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.41it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.55it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.55it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.57it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.55it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.59it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.36it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.33it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.51it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.50it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.64it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.57it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.58it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.43it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.47it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.42it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 00:54:06,477 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:54:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:54:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:54:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:54:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:54:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:54:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.43399515532371097, 'eval_loss': 1.0531442, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2722, 2717, 2725, 2709, 2704, 2707, 2667, 2662, 2702, 2903, 2938, 2575], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 20901868, 'remaining_params': 64115732, 'pruned_model_sparsity': 0.24585342329117735, 'expected_sparsity': 0.24053, 'target_sparsity': 0.1847014925373134, 'step': 1750}


Iteration:  53%|█████▎    | 142/268 [00:28<01:40,  1.25it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<01:15,  1.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:58,  2.12it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:46,  2.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:37,  3.23it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:32,  3.71it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:28,  4.27it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:24,  4.82it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:22,  5.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:21,  5.40it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:20,  5.77it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:19,  5.88it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.09it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.08it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:18,  6.16it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.25it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.24it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.32it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.46it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.58it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.43it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.47it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.60it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.59it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.61it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.49it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.34it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.36it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.11it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.34it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.40it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:14,  6.28it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.41it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.45it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.35it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 00:54:16,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:54:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:54:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:54:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:54:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:54:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:54:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.41296488927625324, 'eval_loss': 1.217078, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2720, 2715, 2724, 2708, 2703, 2705, 2663, 2658, 2693, 2902, 2938, 2571], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 20941700, 'remaining_params': 64075900, 'pruned_model_sparsity': 0.24632193804576935, 'expected_sparsity': 0.24151, 'target_sparsity': 0.1902985074626866, 'step': 1800}


Iteration:  72%|███████▏  | 192/268 [00:38<01:00,  1.25it/s][A04/29/2024 00:54:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 1800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:38<00:45,  1.64it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:34,  2.12it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:27,  2.64it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:22,  3.21it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:18,  3.75it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:16,  4.21it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:14,  4.71it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:13,  5.08it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:12,  5.43it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:11,  5.78it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  5.93it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.15it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.25it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.41it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.47it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.55it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.52it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.50it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.36it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.54it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.55it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.54it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.55it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.39it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 00:54:26,321 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:54:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:54:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:54:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:54:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.69it/s]04/29/2024 00:54:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:54:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.408812756433793, 'eval_loss': 1.208063, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2721, 2716, 2725, 2710, 2704, 2707, 2663, 2659, 2694, 2902, 2937, 2571], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 20926380, 'remaining_params': 64091220, 'pruned_model_sparsity': 0.24614174006323397, 'expected_sparsity': 0.24122, 'target_sparsity': 0.1958955223880597, 'step': 1850}


Iteration:  90%|█████████ | 242/268 [00:48<00:20,  1.24it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:15,  1.64it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:11,  2.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:08,  2.65it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:06,  3.23it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:05,  3.77it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:04,  4.28it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  4.79it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.20it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  5.53it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  5.78it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.00it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.00it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.16it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.29it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.06it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.28it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.29it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.36it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.30it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.70it/s][A04/29/2024 00:54:32 - INFO - trainer.trainer_mod_2 - Epoch 6 finished. Took 52.32 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:   7%|▋         | 7/100 [06:06<1:22:12, 53.04s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.34it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.29it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.17it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:42,  6.12it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.24it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.32it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.31it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.38it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.43it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.37it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.29it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.39it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.36it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.54it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 00:54:36,282 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:54:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:54:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:54:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:54:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.71it/s]04/29/2024 00:54:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:54:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4414709131742262, 'eval_loss': 1.1685759, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2725, 2720, 2728, 2714, 2706, 2711, 2667, 2666, 2704, 2902, 2938, 2573], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 20862036, 'remaining_params': 64155564, 'pruned_model_sparsity': 0.24538490853658537, 'expected_sparsity': 0.23984, 'target_sparsity': 0.20149253731343283, 'step': 1900}


Iteration:   9%|▉         | 24/268 [00:05<03:15,  1.24it/s][A04/29/2024 00:54:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 1900, Alignment: tensor([ 0,  7,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:06<02:27,  1.65it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:54,  2.12it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:30,  2.65it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:14,  3.22it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:02,  3.84it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:55,  4.32it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:49,  4.81it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:45,  5.20it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:42,  5.53it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:40,  5.80it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:39,  5.93it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:38,  6.09it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.21it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.32it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.16it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.27it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.35it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.44it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.52it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.61it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.58it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.51it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.50it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.58it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.58it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.51it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.50it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.54it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.54it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.56it/s][A[INFO|trainer.py:570] 2024-04-29 00:54:46,145 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:54:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:54:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:54:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:54:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.68it/s]04/29/2024 00:54:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:54:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.47358036122369446, 'eval_loss': 1.0562556, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2731, 2724, 2733, 2717, 2709, 2714, 2671, 2671, 2718, 2903, 2938, 2578], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 20790032, 'remaining_params': 64227568, 'pruned_model_sparsity': 0.24453797801866908, 'expected_sparsity': 0.23773, 'target_sparsity': 0.20708955223880599, 'step': 1950}


Iteration:  28%|██▊       | 74/268 [00:15<02:35,  1.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:57,  1.65it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<01:31,  2.09it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<01:13,  2.61it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:59,  3.21it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:50,  3.76it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:43,  4.27it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:39,  4.76it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:36,  5.16it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:33,  5.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:31,  5.77it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:30,  5.96it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.19it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.21it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.34it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.28it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.50it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.55it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:25,  6.62it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.43it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.45it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.46it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.48it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.49it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.33it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.31it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.24it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.37it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.39it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.50it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.70it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.66it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.61it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.72it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.66it/s][A[INFO|trainer.py:570] 2024-04-29 00:54:56,033 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:54:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:54:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:54:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:54:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:54:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:54:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4513528019476203, 'eval_loss': 1.0652713, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2738, 2730, 2738, 2722, 2715, 2719, 2677, 2679, 2736, 2903, 2939, 2585], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 20688920, 'remaining_params': 64328680, 'pruned_model_sparsity': 0.24334867133393556, 'expected_sparsity': 0.23475, 'target_sparsity': 0.2126865671641791, 'step': 2000}


Iteration:  46%|████▋     | 124/268 [00:25<01:55,  1.25it/s][A04/29/2024 00:54:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 2000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:25<01:26,  1.65it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<01:06,  2.13it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:53,  2.65it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:43,  3.23it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:36,  3.81it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:32,  4.30it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:28,  4.87it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:26,  5.21it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:24,  5.57it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:22,  5.86it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:22,  5.91it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.11it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:21,  6.24it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.34it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.33it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.39it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.36it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.22it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.30it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.24it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.34it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.42it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.49it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.42it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.56it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.43it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.19it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:17,  5.90it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.10it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.16it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.26it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.56it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 00:55:05,980 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:55:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:55:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:55:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:55:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 00:55:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:55:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4141907540983119, 'eval_loss': 1.2886407, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2744, 2736, 2744, 2725, 2719, 2722, 2678, 2679, 2750, 2904, 2939, 2594], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 20426948, 'remaining_params': 64590652, 'pruned_model_sparsity': 0.24026728583258056, 'expected_sparsity': 0.23188, 'target_sparsity': 0.21828358208955226, 'step': 2050}


Iteration:  65%|██████▍   | 174/268 [00:35<01:15,  1.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:56,  1.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:43,  2.12it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:34,  2.66it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:27,  3.23it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:23,  3.78it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:20,  4.27it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:18,  4.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:16,  5.22it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:15,  5.58it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:14,  5.86it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.06it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.18it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.29it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.27it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.19it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.23it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.17it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.31it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.37it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.40it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.45it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.38it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.58it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.56it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.59it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.51it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.52it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.52it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.55it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.54it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.44it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.39it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.47it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 00:55:15,875 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:55:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:55:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:55:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:55:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 00:55:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:55:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.43839114299220056, 'eval_loss': 1.0898572, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2750, 2742, 2750, 2729, 2724, 2727, 2682, 2685, 2766, 2905, 2940, 2603], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 20338092, 'remaining_params': 64679508, 'pruned_model_sparsity': 0.23922213753387533, 'expected_sparsity': 0.22868, 'target_sparsity': 0.22388059701492538, 'step': 2100}


Iteration:  84%|████████▎ | 224/268 [00:45<00:35,  1.24it/s][A04/29/2024 00:55:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 2100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:45<00:26,  1.64it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:19,  2.10it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:15,  2.64it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:12,  3.22it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:10,  3.75it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:08,  4.27it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:07,  4.78it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.19it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:06,  5.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  5.74it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  5.95it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.20it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.37it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.42it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.48it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.64it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.64it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.56it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.47it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.49it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.54it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.57it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.50it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.43it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.49it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.54it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.87it/s][A04/29/2024 00:55:24 - INFO - trainer.trainer_mod_2 - Epoch 7 finished. Took 52.25 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:   8%|▊         | 8/100 [06:59<1:20:56, 52.79s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 00:55:25,701 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:55:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:55:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:55:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:55:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 00:55:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:55:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.46479494456565146, 'eval_loss': 1.0890667, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2755, 2747, 2754, 2734, 2729, 2731, 2685, 2691, 2778, 2905, 2941, 2611], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 20263024, 'remaining_params': 64754576, 'pruned_model_sparsity': 0.23833916741945196, 'expected_sparsity': 0.22572, 'target_sparsity': 0.2294776119402985, 'step': 2150}


Iteration:   2%|▏         | 6/268 [00:03<03:51,  1.13it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:48,  1.55it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:06,  2.05it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:38,  2.62it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:21,  3.17it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:07,  3.80it/s][A
Iteration:   4%|▍         | 12/268 [00:04<00:59,  4.27it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:52,  4.83it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:48,  5.24it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:44,  5.65it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.90it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:41,  6.02it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.15it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:39,  6.36it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.39it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.57it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.58it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.56it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.57it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.57it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:36,  6.56it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.35it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.39it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.32it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.21it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.31it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.49it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.35it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.37it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.44it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.39it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.43it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.50it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.47it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.25it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.37it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 00:55:35,591 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:55:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:55:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:55:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:55:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 00:55:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:55:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48003807823864186, 'eval_loss': 1.1255314, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2760, 2751, 2758, 2737, 2732, 2735, 2688, 2696, 2786, 2906, 2941, 2618], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 20203276, 'remaining_params': 64814324, 'pruned_model_sparsity': 0.23763639528756397, 'expected_sparsity': 0.22322, 'target_sparsity': 0.23507462686567165, 'step': 2200}


Iteration:  21%|██        | 56/268 [00:12<02:50,  1.24it/s][A04/29/2024 00:55:37 - INFO - trainer.trainer_mod_2 - v4 Global step: 2200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:13<02:08,  1.64it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:39,  2.12it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<01:18,  2.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:04,  3.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:53,  3.85it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:47,  4.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:43,  4.73it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:39,  5.12it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:37,  5.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:35,  5.74it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:33,  5.96it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:32,  6.16it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.23it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.45it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.55it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.37it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.20it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:30,  6.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.30it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.40it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.40it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.46it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.32it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.30it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.36it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.34it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.50it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.40it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.30it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.29it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.36it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 00:55:45,535 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:55:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:55:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:55:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:55:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.69it/s]04/29/2024 00:55:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:55:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.477445313867009, 'eval_loss': 1.0947117, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2762, 2753, 2760, 2739, 2735, 2737, 2690, 2698, 2791, 2906, 2941, 2621], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 11], 'pruned_params': 19973476, 'remaining_params': 65044124, 'pruned_model_sparsity': 0.23493342554953328, 'expected_sparsity': 0.22208, 'target_sparsity': 0.24067164179104478, 'step': 2250}


Iteration:  40%|███▉      | 106/268 [00:22<02:09,  1.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<01:37,  1.64it/s][A
Iteration:  40%|████      | 108/268 [00:23<01:15,  2.12it/s][A
Iteration:  41%|████      | 109/268 [00:23<01:00,  2.65it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:49,  3.19it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:42,  3.66it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:36,  4.22it/s][A
Iteration:  42%|████▏     | 113/268 [00:24<00:32,  4.71it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:30,  5.09it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:28,  5.46it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:26,  5.75it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:25,  5.96it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:24,  6.13it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.23it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:23,  6.31it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.36it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.44it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.54it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.39it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.45it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.34it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.42it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.47it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.11it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.16it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.23it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.20it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.22it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.30it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.36it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.53it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.58it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.54it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 00:55:55,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:55:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:55:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:55:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:55:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 00:55:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:55:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.46238089236787555, 'eval_loss': 1.1309626, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2762, 2753, 2761, 2739, 2734, 2737, 2690, 2697, 2789, 2906, 2941, 2618], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 11, 10, 11], 'pruned_params': 19978072, 'remaining_params': 65039528, 'pruned_model_sparsity': 0.2349874849442939, 'expected_sparsity': 0.22273, 'target_sparsity': 0.2462686567164179, 'step': 2300}


Iteration:  58%|█████▊    | 156/268 [00:32<01:30,  1.24it/s][A04/29/2024 00:55:57 - INFO - trainer.trainer_mod_2 - v4 Global step: 2300, Alignment: tensor([ 3,  6,  7, 10], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:33<01:07,  1.64it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:51,  2.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:41,  2.63it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:33,  3.21it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:28,  3.80it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:24,  4.35it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:21,  4.78it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:20,  5.19it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:18,  5.48it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:17,  5.69it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:17,  5.86it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:16,  5.96it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:16,  6.14it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:15,  6.27it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.19it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.21it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.21it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.23it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:15,  6.20it/s][A
Iteration:  66%|██████▌   | 176/268 [00:36<00:14,  6.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.50it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.52it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.47it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.45it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:12,  6.50it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.53it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.49it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.54it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.60it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.57it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.28it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 00:56:05,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:56:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:56:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:56:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:56:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:56:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:56:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.47390502751474173, 'eval_loss': 1.0420917, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2760, 2751, 2761, 2738, 2733, 2736, 2686, 2690, 2778, 2905, 2940, 2608], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 20218596, 'remaining_params': 64799004, 'pruned_model_sparsity': 0.23781659327009938, 'expected_sparsity': 0.22522, 'target_sparsity': 0.251865671641791, 'step': 2350}


Iteration:  77%|███████▋  | 206/268 [00:42<00:50,  1.23it/s][A
Iteration:  77%|███████▋  | 207/268 [00:43<00:37,  1.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:43<00:28,  2.10it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:22,  2.64it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:18,  3.18it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:15,  3.77it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:12,  4.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:11,  4.86it/s][A
Iteration:  80%|███████▉  | 214/268 [00:44<00:10,  5.21it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:09,  5.48it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:09,  5.76it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  5.90it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  6.07it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:45<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.42it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.34it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.32it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.40it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.46it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.48it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:47<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.51it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.62it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.73it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.59it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.56it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.36it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.43it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 00:56:15,341 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:56:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:56:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:56:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:56:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.69it/s]04/29/2024 00:56:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:56:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49244666873959125, 'eval_loss': 0.99417573, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2755, 2746, 2758, 2735, 2730, 2733, 2681, 2683, 2764, 2904, 2939, 2593], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 20292132, 'remaining_params': 64725468, 'pruned_model_sparsity': 0.2386815435862692, 'expected_sparsity': 0.22887, 'target_sparsity': 0.2574626865671642, 'step': 2400}


Iteration:  96%|█████████▌| 256/268 [00:52<00:09,  1.25it/s][A04/29/2024 00:56:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 2400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:52<00:06,  1.63it/s][A
Iteration:  96%|█████████▋| 258/268 [00:53<00:04,  2.11it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:03,  2.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:02,  3.22it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  3.79it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  4.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  4.84it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  5.56it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  5.76it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.89it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.38it/s][A04/29/2024 00:56:19 - INFO - trainer.trainer_mod_2 - Epoch 8 finished. Took 54.57 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.91it/s]
Epoch:   9%|▉         | 9/100 [07:53<1:20:54, 53.35s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.77it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.23it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.46it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.50it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.32it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.36it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.37it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.39it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.44it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.25it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.20it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.43it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.56it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.55it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.41it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.46it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.34it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.48it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.52it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.51it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.51it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.61it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.51it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 00:56:25,234 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:56:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:56:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:56:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:56:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.71it/s]04/29/2024 00:56:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:56:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.46238089236787555, 'eval_loss': 1.1474717, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2747, 2739, 2753, 2729, 2724, 2727, 2672, 2672, 2741, 2903, 2938, 2575], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 20416224, 'remaining_params': 64601376, 'pruned_model_sparsity': 0.24014114724480579, 'expected_sparsity': 0.23326, 'target_sparsity': 0.2630597014925373, 'step': 2450}


Iteration:  14%|█▍        | 38/268 [00:08<03:05,  1.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<02:19,  1.64it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:48,  2.10it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:26,  2.63it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:10,  3.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:59,  3.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:51,  4.34it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:46,  4.82it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:42,  5.17it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:40,  5.50it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:38,  5.77it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:36,  5.98it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:36,  6.05it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:35,  6.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.29it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.35it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.32it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.58it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.67it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.32it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.25it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.20it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:30,  6.31it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.29it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.38it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.53it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.45it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.39it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.30it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 00:56:35,165 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:56:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:56:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:56:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:56:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.71it/s]04/29/2024 00:56:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:56:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.45582884738805496, 'eval_loss': 1.1164359, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2736, 2728, 2744, 2722, 2716, 2718, 2661, 2655, 2707, 2901, 2936, 2556], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 20791564, 'remaining_params': 64226036, 'pruned_model_sparsity': 0.2445559978169226, 'expected_sparsity': 0.2377, 'target_sparsity': 0.26865671641791045, 'step': 2500}


Iteration:  33%|███▎      | 88/268 [00:17<02:24,  1.25it/s][A04/29/2024 00:56:37 - INFO - trainer.trainer_mod_2 - v4 Global step: 2500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:18<01:50,  1.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<01:24,  2.09it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:07,  2.63it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:54,  3.21it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:46,  3.74it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:40,  4.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:36,  4.80it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:32,  5.23it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:31,  5.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:29,  5.71it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:28,  5.92it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:28,  5.96it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:27,  6.01it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:27,  6.08it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.22it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.21it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.24it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.27it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.23it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.33it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.29it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.25it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.42it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.43it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.55it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.67it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.64it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.63it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.64it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.68it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.64it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.63it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.48it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.42it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.46it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.46it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.31it/s][A[INFO|trainer.py:570] 2024-04-29 00:56:45,098 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:56:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:56:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:56:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:56:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 00:56:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:56:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.45011897171884124, 'eval_loss': 1.1653811, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2720, 2715, 2733, 2712, 2706, 2707, 2644, 2630, 2660, 2899, 2934, 2534], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 9, 11], 'pruned_params': 21036684, 'remaining_params': 63980916, 'pruned_model_sparsity': 0.2474391655374887, 'expected_sparsity': 0.24251, 'target_sparsity': 0.27425373134328357, 'step': 2550}


Iteration:  51%|█████▏    | 138/268 [00:27<01:44,  1.24it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<01:18,  1.64it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<01:00,  2.11it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:47,  2.65it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:39,  3.20it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:32,  3.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:28,  4.33it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:25,  4.83it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:23,  5.10it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:22,  5.39it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:21,  5.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:20,  5.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:19,  5.95it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:19,  6.15it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.32it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.30it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.34it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.30it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.37it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.34it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.28it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.23it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.33it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.41it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.51it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.44it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.46it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.36it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.42it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 00:56:55,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:56:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:56:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:56:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:56:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:56:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:56:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4586677503781831, 'eval_loss': 1.0022966, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2700, 2696, 2719, 2698, 2692, 2693, 2626, 2602, 2601, 2896, 2932, 2507], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 8, 11], 'pruned_params': 21539180, 'remaining_params': 63478420, 'pruned_model_sparsity': 0.2533496593646492, 'expected_sparsity': 0.24779, 'target_sparsity': 0.2798507462686567, 'step': 2600}


Iteration:  70%|███████   | 188/268 [00:37<01:04,  1.24it/s][A04/29/2024 00:56:57 - INFO - trainer.trainer_mod_2 - v4 Global step: 2600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:38<00:48,  1.64it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:36,  2.12it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:29,  2.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:23,  3.22it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:19,  3.78it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:17,  4.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:15,  4.79it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:13,  5.23it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:12,  5.54it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  5.87it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.06it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.33it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.33it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.32it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.37it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.20it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  5.97it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:09,  6.06it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.27it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.25it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.41it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.53it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.54it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.49it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.52it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.41it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.41it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.37it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.34it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.58it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.48it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 00:57:04,956 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:57:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:57:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:57:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:57:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 00:57:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:57:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48972049332711237, 'eval_loss': 1.0728912, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2673, 2672, 2701, 2682, 2676, 2676, 2605, 2569, 2525, 2893, 2928, 2473], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 9, 8, 11], 'pruned_params': 22115212, 'remaining_params': 62902388, 'pruned_model_sparsity': 0.2601251035079795, 'expected_sparsity': 0.25372, 'target_sparsity': 0.28544776119402987, 'step': 2650}


Iteration:  89%|████████▉ | 238/268 [00:47<00:24,  1.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:17,  1.65it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:13,  2.12it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:10,  2.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:08,  3.20it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:06,  3.72it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:05,  4.28it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  4.79it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:04,  5.21it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  5.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.78it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.86it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  5.95it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.11it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.23it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.41it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.42it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.47it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.25it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.32it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.37it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.43it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.45it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.83it/s][A04/29/2024 00:57:11 - INFO - trainer.trainer_mod_2 - Epoch 9 finished. Took 52.45 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.11it/s]
Epoch:  10%|█         | 10/100 [08:46<1:19:36, 53.07s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.41it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.53it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.38it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.25it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.32it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.44it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.37it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.45it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.41it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.38it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.27it/s][A[INFO|trainer.py:570] 2024-04-29 00:57:14,912 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:57:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:57:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:57:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:57:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:57:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:57:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4707952903807499, 'eval_loss': 1.1526926, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2639, 2641, 2678, 2660, 2655, 2653, 2577, 2526, 2431, 2889, 2924, 2432], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 9, 8, 11], 'pruned_params': 22603920, 'remaining_params': 62413680, 'pruned_model_sparsity': 0.26587341915085816, 'expected_sparsity': 0.26023, 'target_sparsity': 0.291044776119403, 'step': 2700}


Iteration:   7%|▋         | 20/268 [00:05<03:19,  1.24it/s][A04/29/2024 00:57:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 2700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:31,  1.64it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:57,  2.10it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:32,  2.64it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:16,  3.18it/s][A
Iteration:   9%|▉         | 25/268 [00:06<01:04,  3.75it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:56,  4.30it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:50,  4.75it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:46,  5.19it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:43,  5.49it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:41,  5.78it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:39,  5.97it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:38,  6.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.22it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.35it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.49it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.61it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.49it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.48it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.31it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.49it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.57it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.40it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.63it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.45it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.35it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.46it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.50it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.38it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.47it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 00:57:24,819 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:57:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:57:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:57:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:57:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.71it/s]04/29/2024 00:57:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:57:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.45772210547720277, 'eval_loss': 1.2248725, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2597, 2603, 2650, 2633, 2628, 2625, 2539, 2469, 2317, 2884, 2918, 2384], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 9, 8, 11], 'pruned_params': 23215188, 'remaining_params': 61802412, 'pruned_model_sparsity': 0.2730633186540199, 'expected_sparsity': 0.26865, 'target_sparsity': 0.2966417910447761, 'step': 2750}


Iteration:  26%|██▌       | 70/268 [00:15<02:38,  1.25it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<02:00,  1.64it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:32,  2.11it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<01:13,  2.67it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:00,  3.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:50,  3.84it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:43,  4.42it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:39,  4.89it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:35,  5.28it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:34,  5.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:32,  5.76it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:31,  5.99it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:30,  6.08it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:30,  6.14it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.18it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.27it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.37it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.37it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.36it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.48it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.52it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.57it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.64it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.45it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:22,  6.63it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.46it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 00:57:34,694 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:57:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:57:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:57:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:57:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 00:57:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:57:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4651957372734309, 'eval_loss': 1.1089885, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2546, 2557, 2616, 2602, 2597, 2593, 2495, 2405, 2187, 2878, 2912, 2330], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 8, 11], 'pruned_params': 24120600, 'remaining_params': 60897000, 'pruned_model_sparsity': 0.2837130194218609, 'expected_sparsity': 0.27954, 'target_sparsity': 0.30223880597014924, 'step': 2800}


Iteration:  45%|████▍     | 120/268 [00:25<01:58,  1.25it/s][A04/29/2024 00:57:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 2800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:25<01:29,  1.65it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<01:08,  2.12it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:54,  2.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:44,  3.24it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:37,  3.82it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:32,  4.35it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:29,  4.83it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:27,  5.17it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:25,  5.35it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:24,  5.59it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:23,  5.83it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:22,  5.95it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:22,  6.13it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.25it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.25it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.24it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.24it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.17it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.25it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.44it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.45it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.51it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.52it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.26it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.34it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.42it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.46it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.55it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.62it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.59it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.60it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.48it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.39it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.45it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.58it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 00:57:44,627 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:57:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:57:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:57:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:57:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 00:57:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:57:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4606649271937996, 'eval_loss': 1.1166335, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2487, 2507, 2576, 2567, 2562, 2559, 2449, 2339, 2050, 2872, 2903, 2271], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 7, 8, 11], 'pruned_params': 25085760, 'remaining_params': 59931840, 'pruned_model_sparsity': 0.2950654923215899, 'expected_sparsity': 0.29017, 'target_sparsity': 0.30783582089552236, 'step': 2850}


Iteration:  63%|██████▎   | 170/268 [00:34<01:18,  1.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:59,  1.64it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:45,  2.11it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:35,  2.64it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:29,  3.19it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:24,  3.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:21,  4.35it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:18,  4.82it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:17,  5.09it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:16,  5.38it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:15,  5.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:15,  5.79it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:14,  6.01it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.24it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.30it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.50it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.50it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:11,  6.61it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.68it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.28it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.26it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.36it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.32it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.27it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.35it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.43it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.33it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.35it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.46it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.49it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.50it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.51it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.08it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.14it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.23it/s][A[INFO|trainer.py:570] 2024-04-29 00:57:54,600 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:57:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:57:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:57:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:57:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 00:57:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:57:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.47390502751474173, 'eval_loss': 1.0297067, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2422, 2451, 2534, 2529, 2524, 2521, 2401, 2271, 1913, 2864, 2894, 2207], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 8, 11], 'pruned_params': 26093816, 'remaining_params': 58923784, 'pruned_model_sparsity': 0.30692251957241795, 'expected_sparsity': 0.30253, 'target_sparsity': 0.3134328358208955, 'step': 2900}


Iteration:  82%|████████▏ | 220/268 [00:44<00:38,  1.24it/s][A04/29/2024 00:57:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 2900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:45<00:28,  1.63it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:21,  2.11it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:17,  2.62it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:13,  3.19it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:11,  3.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:09,  4.28it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:08,  4.72it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:07,  5.08it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:07,  5.42it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  5.65it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.88it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.94it/s][A
Iteration:  87%|████████▋ | 233/268 [00:47<00:05,  6.13it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.27it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.57it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.40it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.45it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.47it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.48it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.22it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.25it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.48it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.48it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.60it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.45it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.50it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.80it/s][A04/29/2024 00:58:04 - INFO - trainer.trainer_mod_2 - Epoch 10 finished. Took 52.39 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  11%|█         | 11/100 [09:38<1:18:24, 52.86s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.11it/s][A[INFO|trainer.py:570] 2024-04-29 00:58:04,497 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:58:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:58:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:58:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:58:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 00:58:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:58:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4951647129040171, 'eval_loss': 1.0519253, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2355, 2392, 2488, 2489, 2483, 2482, 2350, 2201, 1784, 2855, 2883, 2141], 'head_nums': [12, 12, 12, 11, 12, 12, 12, 11, 11, 6, 8, 11], 'pruned_params': 27316352, 'remaining_params': 57701248, 'pruned_model_sparsity': 0.32130231857874136, 'expected_sparsity': 0.31554, 'target_sparsity': 0.31902985074626866, 'step': 2950}


Iteration:   1%|          | 2/268 [00:02<06:19,  1.43s/it][A
Iteration:   1%|          | 3/268 [00:02<03:43,  1.19it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:30,  1.75it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:50,  2.38it/s][A
Iteration:   2%|▏         | 6/268 [00:03<01:26,  3.02it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:11,  3.66it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:00,  4.29it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:54,  4.77it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:49,  5.18it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:46,  5.56it/s][A
Iteration:   4%|▍         | 12/268 [00:04<00:43,  5.83it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:42,  6.01it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:41,  6.15it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:40,  6.27it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:40,  6.29it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.35it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.43it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:38,  6.39it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:37,  6.54it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.37it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.42it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.46it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.51it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:37,  6.48it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.42it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.35it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.55it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.50it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.61it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:35,  6.60it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.20it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.26it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.42it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.28it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.37it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.53it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 00:58:14,389 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:58:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:58:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:58:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:58:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 00:58:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:58:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5047031319242462, 'eval_loss': 0.9495711, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2287, 2330, 2441, 2447, 2441, 2441, 2298, 2132, 1666, 2845, 2870, 2076], 'head_nums': [12, 11, 12, 11, 12, 12, 12, 11, 11, 6, 8, 11], 'pruned_params': 28341260, 'remaining_params': 56676340, 'pruned_model_sparsity': 0.33335756361035834, 'expected_sparsity': 0.32914, 'target_sparsity': 0.32462686567164173, 'step': 3000}


Iteration:  19%|█▉        | 52/268 [00:12<02:52,  1.25it/s][A04/29/2024 00:58:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 3000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:12<02:10,  1.65it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:40,  2.13it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:20,  2.64it/s][A
Iteration:  21%|██        | 56/268 [00:13<01:06,  3.18it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:55,  3.79it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:47,  4.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:44,  4.74it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:39,  5.23it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:37,  5.49it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:36,  5.69it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:34,  5.94it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:33,  6.09it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:32,  6.22it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:31,  6.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:31,  6.47it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.46it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.37it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.39it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.31it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.44it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.45it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.35it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.38it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.27it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.34it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.29it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.34it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.33it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.36it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.38it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.32it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.40it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:28,  6.01it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.17it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.26it/s][A[INFO|trainer.py:570] 2024-04-29 00:58:24,392 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:58:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:58:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:58:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:58:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 00:58:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:58:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4863214033883767, 'eval_loss': 1.0384396, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2221, 2271, 2395, 2408, 2402, 2404, 2248, 2069, 1560, 2835, 2856, 2012], 'head_nums': [12, 11, 11, 11, 12, 12, 12, 11, 11, 5, 7, 11], 'pruned_params': 29703208, 'remaining_params': 55314392, 'pruned_model_sparsity': 0.34937716425775367, 'expected_sparsity': 0.34213, 'target_sparsity': 0.3302238805970149, 'step': 3050}


Iteration:  38%|███▊      | 102/268 [00:22<02:14,  1.24it/s][A
Iteration:  38%|███▊      | 103/268 [00:22<01:40,  1.64it/s][A
Iteration:  39%|███▉      | 104/268 [00:22<01:18,  2.10it/s][A
Iteration:  39%|███▉      | 105/268 [00:22<01:01,  2.64it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<00:50,  3.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<00:42,  3.80it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:36,  4.36it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:33,  4.79it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:30,  5.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:28,  5.46it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:26,  5.82it/s][A
Iteration:  42%|████▏     | 113/268 [00:24<00:25,  6.08it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:24,  6.18it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:24,  6.23it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:24,  6.31it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:23,  6.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:23,  6.50it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:22,  6.54it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:22,  6.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:22,  6.59it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:21,  6.68it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.35it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.23it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.21it/s][A
Iteration:  49%|████▉     | 132/268 [00:27<00:21,  6.34it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.40it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.57it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.58it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.55it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.57it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.56it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.44it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.61it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.59it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.68it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.60it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.60it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 00:58:34,222 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:58:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:58:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:58:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:58:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 00:58:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:58:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4884373089272632, 'eval_loss': 1.043676, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2161, 2217, 2352, 2371, 2365, 2368, 2199, 2007, 1467, 2824, 2841, 1952], 'head_nums': [12, 11, 11, 11, 12, 12, 12, 11, 11, 5, 7, 11], 'pruned_params': 30424780, 'remaining_params': 54592820, 'pruned_model_sparsity': 0.3578644892351701, 'expected_sparsity': 0.35323, 'target_sparsity': 0.33582089552238803, 'step': 3100}


Iteration:  57%|█████▋    | 152/268 [00:32<01:32,  1.25it/s][A04/29/2024 00:58:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 3100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:32<01:09,  1.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:32<00:53,  2.12it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<00:42,  2.65it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:34,  3.22it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:29,  3.80it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:25,  4.31it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:22,  4.76it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:21,  5.07it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:19,  5.42it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:18,  5.65it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:17,  5.91it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:17,  6.02it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:16,  6.10it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:16,  6.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:15,  6.28it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.39it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:15,  6.32it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.37it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.33it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.50it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.42it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.36it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.42it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.48it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.53it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.44it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.46it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.32it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.39it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.48it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.51it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.65it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.65it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.55it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.55it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 00:58:44,174 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:58:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:58:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:58:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:58:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 00:58:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:58:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48569858867371524, 'eval_loss': 1.0392168, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2108, 2168, 2313, 2338, 2332, 2336, 2157, 1954, 1390, 2812, 2825, 1897], 'head_nums': [11, 11, 11, 11, 12, 12, 12, 11, 11, 5, 7, 11], 'pruned_params': 31250528, 'remaining_params': 53767072, 'pruned_model_sparsity': 0.36757716049382716, 'expected_sparsity': 0.36332, 'target_sparsity': 0.3414179104477612, 'step': 3150}


Iteration:  75%|███████▌  | 202/268 [00:42<00:53,  1.24it/s][A
Iteration:  76%|███████▌  | 203/268 [00:42<00:39,  1.63it/s][A
Iteration:  76%|███████▌  | 204/268 [00:42<00:30,  2.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:42<00:23,  2.63it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:19,  3.23it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:16,  3.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:43<00:13,  4.30it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:12,  4.78it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:11,  5.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:10,  5.56it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:09,  5.90it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:09,  6.02it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:08,  6.20it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:08,  6.32it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  6.37it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:07,  6.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:07,  6.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.38it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.54it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:06,  6.47it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.40it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.58it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.55it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.52it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.58it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.59it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.62it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.49it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.59it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.68it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.64it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.57it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.49it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 00:58:53,985 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:58:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:58:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:58:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:58:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 00:58:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:58:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5143125854026518, 'eval_loss': 0.92957187, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2062, 2126, 2279, 2306, 2302, 2306, 2118, 1911, 1329, 2801, 2810, 1849], 'head_nums': [11, 10, 11, 11, 12, 12, 12, 11, 11, 5, 6, 11], 'pruned_params': 32189644, 'remaining_params': 52827956, 'pruned_model_sparsity': 0.378623296823246, 'expected_sparsity': 0.37315, 'target_sparsity': 0.3470149253731343, 'step': 3200}


Iteration:  94%|█████████▍| 252/268 [00:51<00:12,  1.25it/s][A04/29/2024 00:58:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 3200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:52<00:09,  1.65it/s][A
Iteration:  95%|█████████▍| 254/268 [00:52<00:06,  2.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:04,  2.67it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:03,  3.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:02,  3.87it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:02,  4.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:01,  4.85it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:01,  5.21it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  5.50it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  5.95it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  6.04it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  6.20it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  6.24it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.24it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.63it/s][A04/29/2024 00:58:58 - INFO - trainer.trainer_mod_2 - Epoch 11 finished. Took 54.41 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  12%|█▏        | 12/100 [10:33<1:18:13, 53.33s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.47it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.55it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.49it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.61it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.61it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.49it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.51it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.61it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.58it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:37,  6.67it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.66it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.65it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:36,  6.72it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.52it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.44it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.40it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.28it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.29it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:38,  6.36it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.41it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.48it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.43it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 00:59:03,821 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:59:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:59:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:59:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:59:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 00:59:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:59:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5032714117876455, 'eval_loss': 1.0052117, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2025, 2092, 2254, 2283, 2276, 2283, 2088, 1877, 1281, 2791, 2795, 1808], 'head_nums': [11, 9, 11, 11, 12, 12, 12, 11, 11, 5, 6, 11], 'pruned_params': 32814700, 'remaining_params': 52202900, 'pruned_model_sparsity': 0.38597537451068953, 'expected_sparsity': 0.38077, 'target_sparsity': 0.35261194029850745, 'step': 3250}


Iteration:  13%|█▎        | 34/268 [00:07<03:07,  1.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:21,  1.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:49,  2.12it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:27,  2.65it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:11,  3.21it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:59,  3.82it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:52,  4.32it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:47,  4.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:43,  5.21it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:40,  5.49it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:39,  5.66it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:37,  5.89it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:36,  6.05it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:36,  6.13it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.27it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.64it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.59it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.40it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.47it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.20it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.31it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.56it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.35it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.38it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.45it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.49it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.53it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.47it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.48it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.36it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.43it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.47it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 00:59:13,725 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:59:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:59:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:59:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:59:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 00:59:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:59:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49873860411200693, 'eval_loss': 1.0072861, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1996, 2066, 2233, 2265, 2258, 2266, 2066, 1851, 1244, 2782, 2782, 1776], 'head_nums': [11, 9, 11, 11, 12, 12, 12, 11, 11, 5, 6, 11], 'pruned_params': 33142548, 'remaining_params': 51875052, 'pruned_model_sparsity': 0.3898316113369467, 'expected_sparsity': 0.3862, 'target_sparsity': 0.3582089552238806, 'step': 3300}


Iteration:  31%|███▏      | 84/268 [00:17<02:27,  1.24it/s][A04/29/2024 00:59:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 3300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:17<01:51,  1.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<01:26,  2.11it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:08,  2.63it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:56,  3.18it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:47,  3.77it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:41,  4.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:36,  4.81it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:34,  5.17it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:32,  5.44it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:30,  5.79it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:29,  5.93it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:28,  6.10it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.15it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.32it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.50it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.25it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.34it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.31it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.22it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.44it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.40it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.42it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.36it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.43it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:24,  6.18it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.29it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.26it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.26it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.44it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.49it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.48it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.33it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.27it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.26it/s][A[INFO|trainer.py:570] 2024-04-29 00:59:23,717 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:59:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:59:23 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:59:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:59:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 00:59:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:59:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4966051069451032, 'eval_loss': 1.0241379, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1975, 2047, 2219, 2250, 2244, 2253, 2049, 1830, 1219, 2775, 2771, 1751], 'head_nums': [11, 9, 11, 11, 12, 12, 12, 11, 11, 4, 6, 11], 'pruned_params': 33582232, 'remaining_params': 51435368, 'pruned_model_sparsity': 0.3950032934357121, 'expected_sparsity': 0.39, 'target_sparsity': 0.3638059701492537, 'step': 3350}


Iteration:  50%|█████     | 134/268 [00:27<01:48,  1.24it/s][A
Iteration:  50%|█████     | 135/268 [00:27<01:21,  1.63it/s][A
Iteration:  51%|█████     | 136/268 [00:27<01:02,  2.11it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:50,  2.62it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:40,  3.20it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:34,  3.75it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:30,  4.25it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:27,  4.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:24,  5.10it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:23,  5.38it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:21,  5.70it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:20,  5.86it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:20,  6.03it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.18it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.38it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.54it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.49it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.49it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:16,  6.49it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.49it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.37it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.43it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.40it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.48it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.55it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.68it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.66it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.61it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:13,  6.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.60it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 00:59:33,619 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:59:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:59:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:59:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:59:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 00:59:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:59:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.488643700354395, 'eval_loss': 0.8742926, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1960, 2034, 2208, 2240, 2234, 2243, 2035, 1814, 1202, 2769, 2763, 1732], 'head_nums': [11, 9, 11, 11, 12, 12, 12, 11, 11, 4, 6, 11], 'pruned_params': 33759944, 'remaining_params': 51257656, 'pruned_model_sparsity': 0.39709359003312256, 'expected_sparsity': 0.393, 'target_sparsity': 0.3694029850746268, 'step': 3400}


Iteration:  69%|██████▊   | 184/268 [00:37<01:07,  1.24it/s][A04/29/2024 00:59:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 3400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:37<00:50,  1.64it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:38,  2.13it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:30,  2.67it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:24,  3.25it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:20,  3.85it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:17,  4.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:15,  4.87it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:14,  5.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:13,  5.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:12,  5.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.10it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.32it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.39it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.49it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.46it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.57it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.39it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.62it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.58it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.56it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.64it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.48it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.51it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.43it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.41it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.36it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.43it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.44it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.57it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.65it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.72it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.63it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.58it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 00:59:43,429 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:59:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:59:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:59:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:59:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 00:59:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:59:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5014398969289968, 'eval_loss': 0.9550095, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1952, 2026, 2201, 2234, 2229, 2237, 2027, 1804, 1192, 2765, 2757, 1719], 'head_nums': [11, 9, 11, 11, 12, 12, 12, 11, 11, 4, 6, 11], 'pruned_params': 33864120, 'remaining_params': 51153480, 'pruned_model_sparsity': 0.39831893631436316, 'expected_sparsity': 0.39476, 'target_sparsity': 0.375, 'step': 3450}


Iteration:  87%|████████▋ | 234/268 [00:46<00:27,  1.25it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:20,  1.65it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:15,  2.13it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:11,  2.66it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:09,  3.24it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:07,  3.82it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:06,  4.36it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:05,  4.90it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.27it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  5.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.77it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.07it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.13it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.24it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.34it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.39it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.35it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.41it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.32it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.50it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.47it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.66it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.76it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.69it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.20it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.59it/s][A04/29/2024 00:59:50 - INFO - trainer.trainer_mod_2 - Epoch 12 finished. Took 52.23 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  13%|█▎        | 13/100 [11:25<1:16:50, 53.00s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.54it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.35it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.31it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.39it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.33it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 00:59:53,305 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 00:59:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 00:59:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 00:59:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 00:59:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 00:59:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 00:59:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.516893769913646, 'eval_loss': 0.92806756, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1947, 2022, 2199, 2231, 2226, 2233, 2022, 1799, 1186, 2762, 2752, 1709], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 34312996, 'remaining_params': 50704604, 'pruned_model_sparsity': 0.4035987372026498, 'expected_sparsity': 0.39564, 'target_sparsity': 0.3805970149253732, 'step': 3500}


Iteration:   6%|▌         | 16/268 [00:04<03:23,  1.24it/s][A04/29/2024 00:59:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 3500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:32,  1.64it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:58,  2.12it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:34,  2.63it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:18,  3.15it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:07,  3.68it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:58,  4.18it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:52,  4.71it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:47,  5.14it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:44,  5.50it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:41,  5.80it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:40,  5.88it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:40,  5.99it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:39,  6.09it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.20it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:37,  6.30it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.35it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:34,  6.59it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.60it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.60it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.50it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.35it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.41it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.40it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.37it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.27it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.34it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.32it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.41it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.53it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.48it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 01:00:03,247 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:00:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:00:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:00:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:00:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 01:00:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:00:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4966051069451032, 'eval_loss': 1.0494224, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1943, 2017, 2196, 2228, 2223, 2230, 2017, 1794, 1182, 2760, 2749, 1703], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 34366616, 'remaining_params': 50650984, 'pruned_model_sparsity': 0.4042294301415236, 'expected_sparsity': 0.39647, 'target_sparsity': 0.38619402985074625, 'step': 3550}


Iteration:  25%|██▍       | 66/268 [00:14<02:41,  1.25it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<02:01,  1.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:33,  2.13it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<01:14,  2.68it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:00,  3.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:51,  3.83it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:45,  4.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:40,  4.83it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:37,  5.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:34,  5.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:33,  5.80it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:32,  5.86it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:31,  6.01it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.18it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.31it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.37it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.39it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.45it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.27it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:30,  5.93it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:29,  6.13it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.24it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.45it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.40it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.36it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.42it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.44it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.44it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.41it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.46it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.32it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.36it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:00:13,206 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:00:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:00:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:00:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:00:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 01:00:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:00:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.507992911858168, 'eval_loss': 1.0316304, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1942, 2015, 2195, 2228, 2221, 2230, 2016, 1792, 1179, 2758, 2747, 1698], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 34385000, 'remaining_params': 50632600, 'pruned_model_sparsity': 0.4044456677205661, 'expected_sparsity': 0.39677, 'target_sparsity': 0.3917910447761194, 'step': 3600}


Iteration:  43%|████▎     | 116/268 [00:24<02:02,  1.24it/s][A04/29/2024 01:00:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 3600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:24<01:31,  1.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<01:10,  2.12it/s][A
Iteration:  44%|████▍     | 119/268 [00:25<00:56,  2.66it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:45,  3.23it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:38,  3.81it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:33,  4.31it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:30,  4.70it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:28,  5.13it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:26,  5.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:25,  5.66it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:24,  5.83it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:23,  6.03it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.27it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:27<00:20,  6.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.48it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.51it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.49it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.43it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.48it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.40it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.54it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.24it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.36it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.32it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.49it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.39it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.30it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.35it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.34it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.43it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.38it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.52it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:15,  6.56it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 01:00:23,136 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:00:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:00:23 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:00:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:00:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 01:00:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:00:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5288408642382201, 'eval_loss': 0.91061914, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1938, 2011, 2193, 2226, 2220, 2228, 2012, 1788, 1175, 2756, 2743, 1691], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 34426364, 'remaining_params': 50591236, 'pruned_model_sparsity': 0.40493220227341165, 'expected_sparsity': 0.39735, 'target_sparsity': 0.39738805970149255, 'step': 3650}


Iteration:  62%|██████▏   | 166/268 [00:34<01:21,  1.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<01:01,  1.65it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:47,  2.12it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:37,  2.67it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:30,  3.23it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:25,  3.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:22,  4.29it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:19,  4.78it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:17,  5.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:16,  5.56it/s][A
Iteration:  66%|██████▌   | 176/268 [00:36<00:15,  5.82it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:15,  6.03it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.18it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.29it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.43it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.58it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.59it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.55it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.68it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.62it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.55it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.42it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.29it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.28it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:08,  6.56it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.48it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.48it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.52it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:00:32,985 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:00:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:00:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:00:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:00:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.72it/s]04/29/2024 01:00:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:00:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.529206928614411, 'eval_loss': 0.8591017, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1933, 2007, 2189, 2222, 2216, 2224, 2006, 1782, 1170, 2753, 2739, 1682], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 34490708, 'remaining_params': 50526892, 'pruned_model_sparsity': 0.4056890338000602, 'expected_sparsity': 0.39824, 'target_sparsity': 0.40298507462686567, 'step': 3700}


Iteration:  81%|████████  | 216/268 [00:44<00:41,  1.25it/s][A04/29/2024 01:00:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 3700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:44<00:31,  1.64it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:23,  2.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:18,  2.65it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:14,  3.23it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:12,  3.85it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:10,  4.39it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:09,  4.78it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:08,  5.14it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  5.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:07,  5.72it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.15it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.27it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.54it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.50it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.22it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.32it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.34it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.06it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.16it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.42it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.37it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.33it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.34it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.45it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.35it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:00:42,933 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:00:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:00:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:00:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:00:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 01:00:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:00:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5356604105681386, 'eval_loss': 0.90426, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1924, 2001, 2184, 2219, 2211, 2219, 2000, 1776, 1161, 2748, 2732, 1669], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 34573436, 'remaining_params': 50444164, 'pruned_model_sparsity': 0.4066621029057513, 'expected_sparsity': 0.39949, 'target_sparsity': 0.4085820895522388, 'step': 3750}


Iteration:  99%|█████████▉| 266/268 [00:54<00:01,  1.25it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  1.65it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  2.16it/s][A04/29/2024 01:00:45 - INFO - trainer.trainer_mod_2 - Epoch 13 finished. Took 54.55 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.91it/s]
Epoch:  14%|█▍        | 14/100 [12:19<1:16:38, 53.47s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.50it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.55it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.51it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.56it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.64it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.66it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.65it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.73it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.69it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.58it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.46it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.51it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:37,  6.43it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.45it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.40it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.44it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.35it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:37,  6.25it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:37,  6.22it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:37,  6.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.52it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.37it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.33it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.56it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:33,  6.67it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:33,  6.64it/s][A[INFO|trainer.py:570] 2024-04-29 01:00:52,770 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:00:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:00:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:00:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:00:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 01:00:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:00:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4814917681613742, 'eval_loss': 1.0948184, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1911, 1989, 2175, 2211, 2202, 2209, 1988, 1762, 1147, 2742, 2721, 1651], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 34728168, 'remaining_params': 50289432, 'pruned_model_sparsity': 0.4084821025293586, 'expected_sparsity': 0.40154, 'target_sparsity': 0.41417910447761197, 'step': 3800}


Iteration:  18%|█▊        | 48/268 [00:09<02:55,  1.25it/s][A04/29/2024 01:00:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 3800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:13,  1.64it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:42,  2.12it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<01:21,  2.65it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:06,  3.24it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:56,  3.81it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:49,  4.36it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:43,  4.92it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:40,  5.25it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:38,  5.53it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:36,  5.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:35,  5.94it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:34,  6.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:33,  6.23it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.37it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.43it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.29it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.30it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.39it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.54it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.55it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.64it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.68it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.68it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.49it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.34it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.39it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:29,  6.33it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.33it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.51it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.55it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.49it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.51it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.67it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.61it/s][A[INFO|trainer.py:570] 2024-04-29 01:01:02,625 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:01:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:01:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:01:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:01:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 01:01:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:01:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5004077836235508, 'eval_loss': 1.0174116, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1893, 1972, 2162, 2199, 2190, 2197, 1974, 1744, 1129, 2732, 2707, 1624], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 34933456, 'remaining_params': 50084144, 'pruned_model_sparsity': 0.4108967554953327, 'expected_sparsity': 0.40435, 'target_sparsity': 0.41977611940298504, 'step': 3850}


Iteration:  37%|███▋      | 98/268 [00:19<02:16,  1.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:42,  1.65it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<01:19,  2.12it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<01:02,  2.66it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:51,  3.23it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:43,  3.78it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:37,  4.34it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:33,  4.83it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:31,  5.15it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:29,  5.52it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:27,  5.86it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:26,  6.04it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.18it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.28it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.29it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.48it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.43it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.54it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:23,  6.37it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.44it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.26it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.35it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.21it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.56it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.52it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.51it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.53it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.36it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.43it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:20,  6.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.39it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:19,  6.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:19,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:01:12,565 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:01:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:01:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:01:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:01:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.74it/s]04/29/2024 01:01:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:01:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5047031319242462, 'eval_loss': 1.0847737, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1868, 1951, 2144, 2182, 2174, 2181, 1955, 1720, 1105, 2719, 2686, 1590], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 35209216, 'remaining_params': 49808384, 'pruned_model_sparsity': 0.4141403191809696, 'expected_sparsity': 0.40817, 'target_sparsity': 0.4253731343283582, 'step': 3900}


Iteration:  55%|█████▌    | 148/268 [00:29<01:37,  1.24it/s][A04/29/2024 01:01:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 3900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:29<01:12,  1.64it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:55,  2.11it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:44,  2.62it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:35,  3.22it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:29,  3.84it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:26,  4.34it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:23,  4.82it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:22,  5.01it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:21,  5.10it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:20,  5.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:19,  5.63it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:18,  5.90it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.04it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.16it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.24it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.31it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.29it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.28it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.35it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.55it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.39it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.33it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.52it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.51it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.52it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.53it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.57it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.33it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.33it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:11,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:01:22,562 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:01:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:01:22 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:01:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:01:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 01:01:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:01:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5084779139221436, 'eval_loss': 0.96515876, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1837, 1922, 2121, 2160, 2154, 2161, 1930, 1691, 1076, 2701, 2659, 1547], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 11, 4, 6, 11], 'pruned_params': 35558512, 'remaining_params': 49459088, 'pruned_model_sparsity': 0.4182488331827763, 'expected_sparsity': 0.41308, 'target_sparsity': 0.43097014925373134, 'step': 3950}


Iteration:  74%|███████▍  | 198/268 [00:39<00:56,  1.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:42,  1.63it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:32,  2.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:25,  2.66it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:20,  3.24it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:17,  3.82it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:14,  4.38it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:12,  4.85it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:11,  5.27it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  5.66it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:10,  5.81it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.03it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.01it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.15it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  6.18it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.20it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.30it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.38it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.25it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.12it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.25it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.58it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.65it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.56it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.58it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.47it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.50it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.34it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.41it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.51it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.50it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:01:32,444 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:01:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:01:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:01:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:01:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.74it/s]04/29/2024 01:01:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:01:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49331319939044976, 'eval_loss': 1.0448276, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1802, 1891, 2095, 2136, 2129, 2135, 1899, 1655, 1043, 2678, 2623, 1497], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 10, 4, 6, 11], 'pruned_params': 36163652, 'remaining_params': 48853948, 'pruned_model_sparsity': 0.4253666534929238, 'expected_sparsity': 0.41891, 'target_sparsity': 0.4365671641791045, 'step': 4000}


Iteration:  93%|█████████▎| 248/268 [00:49<00:15,  1.25it/s][A04/29/2024 01:01:34 - INFO - trainer.trainer_mod_2 - v4 Global step: 4000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:49<00:11,  1.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:08,  2.12it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:06,  2.66it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:04,  3.22it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:03,  3.79it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:03,  4.29it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  4.70it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.07it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:02,  5.46it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.75it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  5.88it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.25it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.24it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.36it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.30it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.29it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.37it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.40it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.80it/s][A04/29/2024 01:01:37 - INFO - trainer.trainer_mod_2 - Epoch 14 finished. Took 52.32 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  15%|█▌        | 15/100 [13:12<1:15:15, 53.12s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.40it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.15it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.42it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.60it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.40it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.41it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.33it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.31it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.23it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.40it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.28it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.24it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:39,  6.17it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:39,  6.26it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.36it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.28it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.39it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.43it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.44it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:01:42,402 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:01:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:01:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:01:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:01:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.74it/s]04/29/2024 01:01:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:01:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5108235781406687, 'eval_loss': 0.9595918, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1762, 1854, 2065, 2107, 2101, 2106, 1866, 1617, 1008, 2649, 2578, 1440], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 10, 4, 6, 11], 'pruned_params': 36621720, 'remaining_params': 48395880, 'pruned_model_sparsity': 0.4307545731707317, 'expected_sparsity': 0.42507, 'target_sparsity': 0.4421641791044776, 'step': 4050}


Iteration:  11%|█         | 30/268 [00:06<03:11,  1.24it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<02:24,  1.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:51,  2.12it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:27,  2.68it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:12,  3.23it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:01,  3.82it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:53,  4.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:48,  4.78it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:44,  5.22it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:41,  5.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:39,  5.84it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:38,  5.95it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:37,  6.04it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:37,  6.07it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:36,  6.06it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.28it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.33it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.39it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.58it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.53it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.52it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.29it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:34,  6.08it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.23it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.32it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.36it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:33,  6.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.26it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.31it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.40it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.54it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.48it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:30,  6.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.41it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:01:52,353 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:01:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:01:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:01:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:01:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 01:01:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:01:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.521280331227275, 'eval_loss': 1.0014223, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1719, 1814, 2031, 2075, 2069, 2074, 1830, 1577, 971, 2613, 2524, 1379], 'head_nums': [11, 8, 11, 11, 12, 12, 12, 10, 10, 4, 6, 11], 'pruned_params': 37121152, 'remaining_params': 47896448, 'pruned_model_sparsity': 0.43662902740138515, 'expected_sparsity': 0.43221, 'target_sparsity': 0.44776119402985076, 'step': 4100}


Iteration:  30%|██▉       | 80/268 [00:16<02:30,  1.25it/s][A04/29/2024 01:01:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 4100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:16<01:53,  1.65it/s][A
Iteration:  31%|███       | 82/268 [00:17<01:27,  2.12it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:10,  2.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:57,  3.20it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:48,  3.78it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:41,  4.33it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:37,  4.84it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:34,  5.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:32,  5.51it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:30,  5.82it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:29,  5.99it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.14it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.26it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.28it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.24it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.25it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.53it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.48it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.53it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.51it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.64it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.63it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.33it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.40it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.55it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:02:02,223 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:02:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:02:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:02:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:02:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 01:02:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:02:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4999447014632779, 'eval_loss': 1.0480868, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1673, 1772, 1996, 2040, 2035, 2040, 1790, 1533, 934, 2571, 2459, 1315], 'head_nums': [11, 8, 10, 10, 12, 12, 12, 10, 10, 4, 6, 11], 'pruned_params': 38044948, 'remaining_params': 46972652, 'pruned_model_sparsity': 0.4474949657482686, 'expected_sparsity': 0.44138, 'target_sparsity': 0.45335820895522383, 'step': 4150}


Iteration:  49%|████▊     | 130/268 [00:26<01:50,  1.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<01:23,  1.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<01:04,  2.12it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:50,  2.68it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:41,  3.25it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:34,  3.82it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:30,  4.38it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:27,  4.78it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:25,  5.07it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:23,  5.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:22,  5.68it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:21,  5.93it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.10it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.21it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:20,  6.14it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.49it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.58it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.41it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.50it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.41it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.48it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.44it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.41it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.55it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.57it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:02:12,103 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:02:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:02:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:02:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:02:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 01:02:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:02:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5237621121274929, 'eval_loss': 0.9612203, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1629, 1730, 1960, 2005, 2001, 2004, 1749, 1489, 899, 2524, 2384, 1251], 'head_nums': [11, 8, 9, 9, 12, 12, 12, 10, 10, 4, 6, 11], 'pruned_params': 38968744, 'remaining_params': 46048856, 'pruned_model_sparsity': 0.45836090409515207, 'expected_sparsity': 0.45141, 'target_sparsity': 0.458955223880597, 'step': 4200}


Iteration:  67%|██████▋   | 180/268 [00:36<01:10,  1.25it/s][A04/29/2024 01:02:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 4200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:36<00:52,  1.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:40,  2.12it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:31,  2.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:25,  3.27it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:21,  3.83it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:18,  4.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:16,  4.91it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:15,  5.26it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:14,  5.52it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:13,  5.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.03it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.09it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.20it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.37it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.45it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.31it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.37it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.40it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.42it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.31it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.31it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.55it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.48it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.53it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:08,  6.12it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.23it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.33it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.53it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.62it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.58it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.59it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.57it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.57it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:02:21,980 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:02:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:02:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:02:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:02:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:02:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:02:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5322407163754954, 'eval_loss': 0.94072485, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1585, 1688, 1924, 1969, 1967, 1970, 1710, 1447, 865, 2471, 2302, 1190], 'head_nums': [11, 8, 9, 9, 12, 12, 12, 10, 10, 4, 6, 11], 'pruned_params': 39491156, 'remaining_params': 45526444, 'pruned_model_sparsity': 0.4645056552996086, 'expected_sparsity': 0.46064, 'target_sparsity': 0.46455223880597013, 'step': 4250}


Iteration:  86%|████████▌ | 230/268 [00:46<00:30,  1.25it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:22,  1.64it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:16,  2.12it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:13,  2.66it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:10,  3.22it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:08,  3.79it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:07,  4.35it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:06,  4.80it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:05,  5.23it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:05,  5.58it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  5.69it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.01it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.05it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  6.21it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.24it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.34it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.43it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.51it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.52it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.53it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.49it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.61it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.61it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.51it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.84it/s][A04/29/2024 01:02:29 - INFO - trainer.trainer_mod_2 - Epoch 15 finished. Took 52.27 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  16%|█▌        | 16/100 [14:04<1:14:00, 52.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.21it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.54it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.65it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.60it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:41,  6.22it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 01:02:31,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:02:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:02:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:02:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:02:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:02:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:02:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5418955192466713, 'eval_loss': 0.90007585, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1544, 1648, 1890, 1937, 1934, 1936, 1671, 1407, 833, 2415, 2215, 1133], 'head_nums': [11, 8, 8, 9, 11, 12, 12, 10, 10, 4, 6, 11], 'pruned_params': 40381248, 'remaining_params': 44636352, 'pruned_model_sparsity': 0.4749751580849142, 'expected_sparsity': 0.46949, 'target_sparsity': 0.4701492537313433, 'step': 4300}


Iteration:   4%|▍         | 12/268 [00:04<03:28,  1.23it/s][A04/29/2024 01:02:34 - INFO - trainer.trainer_mod_2 - v4 Global step: 4300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:04<02:36,  1.62it/s][A
Iteration:   5%|▌         | 14/268 [00:04<02:00,  2.11it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:35,  2.65it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:17,  3.26it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:05,  3.81it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:58,  4.31it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:51,  4.85it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:47,  5.26it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:44,  5.54it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.89it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:41,  5.97it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:40,  6.05it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:39,  6.22it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.23it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:39,  6.18it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.30it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.27it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.30it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.49it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.40it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.37it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.39it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.48it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.52it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.54it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.60it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.71it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.58it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.68it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.74it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.72it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.68it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:31,  6.73it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:31,  6.66it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.62it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.62it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.62it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.56it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:02:41,667 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:02:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:02:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:02:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:02:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:02:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:02:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5127766293248668, 'eval_loss': 0.9567684, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1505, 1610, 1857, 1903, 1901, 1904, 1635, 1369, 804, 2357, 2124, 1079], 'head_nums': [11, 7, 8, 9, 11, 11, 12, 10, 10, 4, 6, 11], 'pruned_params': 41251424, 'remaining_params': 43766176, 'pruned_model_sparsity': 0.4852104034929238, 'expected_sparsity': 0.4778, 'target_sparsity': 0.4757462686567164, 'step': 4350}


Iteration:  23%|██▎       | 62/268 [00:13<02:44,  1.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<02:04,  1.65it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:35,  2.14it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<01:15,  2.68it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:01,  3.26it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:52,  3.84it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:45,  4.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:40,  4.91it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:37,  5.31it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:35,  5.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:33,  5.85it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.13it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.28it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.28it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:30,  6.35it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.53it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.54it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:27,  6.68it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.62it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:27,  6.70it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.56it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.56it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.48it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.40it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.40it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.38it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.39it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.50it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.49it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.32it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.53it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.45it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:02:51,473 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:02:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:02:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:02:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:02:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:02:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:02:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4940437906083124, 'eval_loss': 0.9624669, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1469, 1576, 1826, 1872, 1870, 1874, 1603, 1333, 778, 2297, 2034, 1029], 'head_nums': [11, 7, 8, 9, 11, 11, 12, 10, 10, 4, 6, 11], 'pruned_params': 41691108, 'remaining_params': 43326492, 'pruned_model_sparsity': 0.4903820855916893, 'expected_sparsity': 0.48481, 'target_sparsity': 0.48134328358208955, 'step': 4400}


Iteration:  42%|████▏     | 112/268 [00:23<02:04,  1.25it/s][A04/29/2024 01:02:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 4400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:23<01:34,  1.65it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<01:12,  2.12it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:57,  2.66it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:46,  3.25it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:40,  3.75it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:34,  4.31it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:31,  4.78it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:28,  5.19it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:26,  5.60it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:25,  5.74it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:24,  6.04it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.29it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.35it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:25<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.55it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:20,  6.57it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.56it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.45it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.47it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.48it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.45it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.48it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.50it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.56it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.38it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.23it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:19,  6.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.33it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.37it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.34it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.27it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.35it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.45it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.38it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.52it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.67it/s][A[INFO|trainer.py:570] 2024-04-29 01:03:01,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:03:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:03:01 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:03:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:03:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 01:03:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:03:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5315332344895993, 'eval_loss': 0.98014045, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1434, 1544, 1797, 1843, 1842, 1847, 1573, 1302, 755, 2236, 1945, 983], 'head_nums': [11, 7, 8, 9, 11, 11, 12, 10, 10, 4, 6, 11], 'pruned_params': 42095556, 'remaining_params': 42922044, 'pruned_model_sparsity': 0.4951393123306233, 'expected_sparsity': 0.49141, 'target_sparsity': 0.4869402985074627, 'step': 4450}


Iteration:  60%|██████    | 162/268 [00:33<01:24,  1.25it/s][A
Iteration:  61%|██████    | 163/268 [00:33<01:03,  1.65it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:48,  2.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:38,  2.66it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:31,  3.23it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:26,  3.80it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:23,  4.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:21,  4.69it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:19,  5.14it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:17,  5.50it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:16,  5.80it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:16,  5.90it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.15it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:15,  6.20it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.38it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.47it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.30it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.29it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:13,  6.33it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.61it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.59it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:11,  6.66it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.65it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.16it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.19it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:11,  6.37it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.45it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.49it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.51it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.59it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:09,  6.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:03:11,266 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:03:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:03:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:03:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:03:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:03:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:03:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5281052367914586, 'eval_loss': 0.97106886, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1403, 1514, 1770, 1816, 1816, 1820, 1544, 1273, 735, 2176, 1859, 940], 'head_nums': [11, 6, 8, 9, 11, 11, 11, 10, 10, 4, 6, 11], 'pruned_params': 42864620, 'remaining_params': 42152980, 'pruned_model_sparsity': 0.5041852510538994, 'expected_sparsity': 0.49756, 'target_sparsity': 0.4925373134328358, 'step': 4500}


Iteration:  79%|███████▉  | 212/268 [00:43<00:44,  1.25it/s][A04/29/2024 01:03:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 4500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:43<00:33,  1.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:25,  2.13it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:20,  2.64it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:16,  3.22it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:13,  3.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:11,  4.27it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:10,  4.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:09,  5.17it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:08,  5.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:08,  5.68it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:08,  5.54it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  5.91it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.15it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.19it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.27it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.35it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.31it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.38it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.24it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.22it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.33it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.24it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.42it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.44it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.37it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.52it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.45it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.19it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.27it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.34it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:03:21,270 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:03:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:03:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:03:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:03:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:03:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:03:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49784061977662064, 'eval_loss': 0.9966401, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1375, 1487, 1745, 1791, 1792, 1796, 1517, 1247, 717, 2116, 1776, 900], 'head_nums': [11, 6, 8, 9, 11, 11, 11, 10, 10, 4, 6, 11], 'pruned_params': 43207788, 'remaining_params': 41809812, 'pruned_model_sparsity': 0.508221685862692, 'expected_sparsity': 0.50345, 'target_sparsity': 0.4981343283582089, 'step': 4550}


Iteration:  98%|█████████▊| 262/268 [00:53<00:04,  1.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:03,  1.65it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:01,  2.14it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:01,  2.66it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  3.25it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  3.80it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.48it/s][A04/29/2024 01:03:24 - INFO - trainer.trainer_mod_2 - Epoch 16 finished. Took 54.35 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  17%|█▋        | 17/100 [14:58<1:13:44, 53.31s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.19it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.40it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.29it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.29it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.35it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.47it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.53it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.30it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.25it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.30it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.39it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.43it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.48it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.57it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.36it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.44it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.49it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.41it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.46it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.61it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.50it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.56it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:34,  6.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.56it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:33,  6.65it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:34,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 01:03:31,140 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:03:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:03:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:03:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:03:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:03:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:03:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5320268278817644, 'eval_loss': 0.9660526, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1349, 1462, 1722, 1768, 1769, 1772, 1491, 1223, 701, 2057, 1696, 864], 'head_nums': [11, 6, 8, 9, 11, 11, 11, 10, 10, 4, 6, 11], 'pruned_params': 43529508, 'remaining_params': 41488092, 'pruned_model_sparsity': 0.5120058434959349, 'expected_sparsity': 0.50922, 'target_sparsity': 0.503731343283582, 'step': 4600}


Iteration:  16%|█▋        | 44/268 [00:08<02:58,  1.25it/s][A04/29/2024 01:03:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 4600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:09<02:14,  1.65it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:44,  2.13it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<01:23,  2.65it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:08,  3.19it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:57,  3.80it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:50,  4.35it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:45,  4.80it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:40,  5.27it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:38,  5.59it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:36,  5.81it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:35,  6.02it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.19it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:34,  6.19it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.28it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.33it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.27it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.36it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.41it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.38it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.44it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.37it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.54it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.46it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.46it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.48it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.47it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.52it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.55it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.58it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.34it/s][A[INFO|trainer.py:570] 2024-04-29 01:03:41,042 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:03:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:03:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:03:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:03:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:03:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:03:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5481377727255567, 'eval_loss': 0.9358696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1324, 1439, 1701, 1747, 1749, 1752, 1468, 1200, 686, 2000, 1621, 831], 'head_nums': [11, 6, 7, 9, 11, 11, 10, 9, 10, 4, 6, 11], 'pruned_params': 44410408, 'remaining_params': 40607192, 'pruned_model_sparsity': 0.5223672274917194, 'expected_sparsity': 0.51451, 'target_sparsity': 0.5093283582089552, 'step': 4650}


Iteration:  35%|███▌      | 94/268 [00:18<02:19,  1.25it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<01:44,  1.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<01:20,  2.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<01:04,  2.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:52,  3.24it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:44,  3.81it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:39,  4.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:34,  4.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:33,  4.92it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:31,  5.30it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:29,  5.55it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:27,  5.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:27,  5.94it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.20it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.30it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.28it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.33it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.33it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.28it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.44it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.48it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.54it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.56it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.54it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.44it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.46it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.56it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.56it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.39it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:20,  6.25it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.31it/s][A[INFO|trainer.py:570] 2024-04-29 01:03:50,994 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:03:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:03:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:03:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:03:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 01:03:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:03:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5234063013213631, 'eval_loss': 0.9386734, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1302, 1418, 1681, 1727, 1729, 1733, 1446, 1179, 673, 1944, 1549, 801], 'head_nums': [11, 6, 7, 9, 11, 11, 10, 9, 10, 4, 6, 11], 'pruned_params': 44683104, 'remaining_params': 40334496, 'pruned_model_sparsity': 0.5255747515808491, 'expected_sparsity': 0.51936, 'target_sparsity': 0.5149253731343284, 'step': 4700}


Iteration:  54%|█████▎    | 144/268 [00:28<01:39,  1.24it/s][A04/29/2024 01:03:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 4700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:28<01:14,  1.64it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:58,  2.10it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:46,  2.61it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:38,  3.12it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:32,  3.69it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:27,  4.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:24,  4.72it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:22,  5.05it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:21,  5.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:20,  5.63it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:19,  5.89it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:18,  6.05it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.21it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.28it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.29it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.33it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.38it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.26it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.34it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.39it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.27it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.34it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.37it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.51it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.57it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.38it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.41it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.31it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.43it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.44it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.50it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.44it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.43it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:12,  6.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.39it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:04:00,968 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:04:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:04:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:04:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:04:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:04:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:04:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5316372091056994, 'eval_loss': 0.91672367, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1281, 1398, 1662, 1707, 1711, 1714, 1426, 1159, 661, 1890, 1479, 774], 'head_nums': [11, 6, 7, 9, 11, 11, 10, 9, 10, 4, 6, 11], 'pruned_params': 44942012, 'remaining_params': 40075588, 'pruned_model_sparsity': 0.528620097485697, 'expected_sparsity': 0.52405, 'target_sparsity': 0.5205223880597014, 'step': 4750}


Iteration:  72%|███████▏  | 194/268 [00:38<00:59,  1.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:44,  1.64it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:34,  2.11it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:26,  2.63it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:22,  3.18it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:18,  3.75it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:15,  4.31it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:13,  4.85it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:12,  5.18it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:11,  5.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  5.83it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  5.93it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  6.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.21it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.27it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.23it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.25it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.38it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.35it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.28it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.60it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.46it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.47it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.45it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.36it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.18it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.26it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.38it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.44it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.48it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.48it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.48it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.53it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:04:10,913 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:04:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:04:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:04:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:04:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:04:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:04:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5128724791536567, 'eval_loss': 1.0121233, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1260, 1379, 1644, 1689, 1693, 1697, 1406, 1141, 651, 1837, 1412, 751], 'head_nums': [11, 6, 7, 9, 11, 11, 10, 9, 10, 4, 6, 11], 'pruned_params': 45185600, 'remaining_params': 39832000, 'pruned_model_sparsity': 0.5314852454080097, 'expected_sparsity': 0.52871, 'target_sparsity': 0.5261194029850746, 'step': 4800}


Iteration:  91%|█████████ | 244/268 [00:48<00:19,  1.24it/s][A04/29/2024 01:04:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 4800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:48<00:13,  1.65it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:10,  2.12it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:07,  2.67it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:06,  3.25it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:05,  3.79it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:04,  4.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  4.87it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:03,  5.26it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  5.69it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.88it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.15it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.19it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.29it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.49it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.58it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.42it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.81it/s][A04/29/2024 01:04:16 - INFO - trainer.trainer_mod_2 - Epoch 17 finished. Took 52.38 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  18%|█▊        | 18/100 [15:51<1:12:28, 53.03s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.64it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.58it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.56it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:41,  6.10it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.25it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.43it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.38it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.34it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.40it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.53it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:04:20,719 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:04:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:04:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:04:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:04:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:04:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:04:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5206360818297229, 'eval_loss': 0.9587027, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1241, 1361, 1627, 1671, 1675, 1679, 1388, 1125, 641, 1785, 1348, 727], 'head_nums': [11, 6, 7, 9, 11, 11, 9, 9, 10, 4, 6, 11], 'pruned_params': 45614560, 'remaining_params': 39403040, 'pruned_model_sparsity': 0.5365307889190003, 'expected_sparsity': 0.5328, 'target_sparsity': 0.5317164179104478, 'step': 4850}


Iteration:  10%|▉         | 26/268 [00:06<03:13,  1.25it/s][A
Iteration:  10%|█         | 27/268 [00:06<02:26,  1.64it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:53,  2.12it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:29,  2.67it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:13,  3.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:02,  3.81it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:54,  4.35it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:48,  4.83it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:44,  5.22it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:41,  5.58it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:39,  5.86it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:38,  5.96it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:38,  6.04it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:37,  6.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.27it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.52it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.22it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.24it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.24it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.31it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.31it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.35it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.35it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.27it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.35it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.37it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:31,  6.16it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.27it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.27it/s][A[INFO|trainer.py:570] 2024-04-29 01:04:30,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:04:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:04:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:04:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:04:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:04:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:04:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5442538936990396, 'eval_loss': 0.8841248, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1223, 1344, 1610, 1654, 1659, 1663, 1372, 1109, 632, 1733, 1284, 705], 'head_nums': [11, 6, 7, 9, 11, 11, 9, 9, 10, 3, 6, 11], 'pruned_params': 46028200, 'remaining_params': 38989400, 'pruned_model_sparsity': 0.5413961344474556, 'expected_sparsity': 0.53653, 'target_sparsity': 0.5373134328358209, 'step': 4900}


Iteration:  28%|██▊       | 76/268 [00:16<02:33,  1.25it/s][A04/29/2024 01:04:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 4900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:16<01:56,  1.64it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<01:29,  2.12it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:11,  2.66it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:58,  3.24it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:49,  3.81it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:43,  4.27it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:38,  4.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:34,  5.26it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:32,  5.58it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:31,  5.81it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:31,  5.84it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:30,  5.91it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:30,  5.96it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.20it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.31it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.25it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.27it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.39it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.41it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.64it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.61it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.62it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:24,  6.64it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:24,  6.75it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.70it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.55it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.55it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.55it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.46it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.48it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.42it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.55it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.38it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.34it/s][A[INFO|trainer.py:570] 2024-04-29 01:04:40,595 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:04:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:04:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:04:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:04:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:04:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:04:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5416589932124241, 'eval_loss': 0.9083467, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1205, 1327, 1593, 1637, 1642, 1646, 1354, 1092, 623, 1678, 1220, 683], 'head_nums': [11, 6, 7, 9, 11, 11, 9, 9, 9, 3, 6, 11], 'pruned_params': 46449500, 'remaining_params': 38568100, 'pruned_model_sparsity': 0.5463515789671786, 'expected_sparsity': 0.54069, 'target_sparsity': 0.542910447761194, 'step': 4950}


Iteration:  47%|████▋     | 126/268 [00:26<01:54,  1.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<01:26,  1.63it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<01:06,  2.11it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:52,  2.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:42,  3.23it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:36,  3.77it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:31,  4.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:28,  4.71it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:26,  5.13it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:24,  5.47it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:22,  5.85it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:21,  6.02it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.05it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.19it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.31it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.39it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.53it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.45it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.49it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.49it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.62it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.54it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.52it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.36it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.43it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.29it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.48it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.33it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.21it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.23it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.33it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.47it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 01:04:50,520 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:04:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:04:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:04:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:04:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:04:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:04:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5416589932124241, 'eval_loss': 0.8796966, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1186, 1310, 1575, 1620, 1625, 1629, 1335, 1074, 613, 1621, 1156, 662], 'head_nums': [11, 6, 7, 9, 11, 11, 9, 9, 9, 3, 6, 11], 'pruned_params': 46682364, 'remaining_params': 38335236, 'pruned_model_sparsity': 0.5490905883017163, 'expected_sparsity': 0.545, 'target_sparsity': 0.5485074626865671, 'step': 5000}


Iteration:  66%|██████▌   | 176/268 [00:35<01:13,  1.24it/s][A04/29/2024 01:04:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 5000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:36<00:55,  1.64it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:42,  2.11it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:33,  2.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:27,  3.21it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:22,  3.79it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:19,  4.33it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:17,  4.77it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:16,  5.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:14,  5.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:14,  5.79it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:13,  5.83it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:13,  6.11it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.24it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.16it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.21it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.36it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.39it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.37it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.22it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.37it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.41it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.50it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.37it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.43it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.56it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.55it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.56it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.57it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.50it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.43it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 01:05:00,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:05:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:05:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:05:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:05:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 01:05:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:05:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5588305747648582, 'eval_loss': 0.8655635, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1168, 1293, 1557, 1602, 1608, 1612, 1317, 1056, 603, 1561, 1092, 640], 'head_nums': [11, 6, 7, 9, 11, 11, 9, 9, 9, 3, 6, 11], 'pruned_params': 46913696, 'remaining_params': 38103904, 'pruned_model_sparsity': 0.5518115778380006, 'expected_sparsity': 0.54962, 'target_sparsity': 0.5541044776119403, 'step': 5050}


Iteration:  84%|████████▍ | 226/268 [00:45<00:33,  1.25it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:24,  1.64it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:18,  2.12it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:14,  2.65it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:11,  3.19it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:09,  3.75it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:08,  4.30it/s][A
Iteration:  87%|████████▋ | 233/268 [00:47<00:07,  4.80it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:06,  5.21it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  5.61it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  5.79it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  5.99it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.02it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.16it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.36it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.40it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.29it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.35it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.36it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.44it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.40it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.44it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.50it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.50it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.40it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.43it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.59it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.69it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.65it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.51it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.89it/s][A04/29/2024 01:05:09 - INFO - trainer.trainer_mod_2 - Epoch 18 finished. Took 52.37 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  19%|█▉        | 19/100 [16:43<1:11:19, 52.83s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.78it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.65it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.57it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.50it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.39it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:42,  6.21it/s][A[INFO|trainer.py:570] 2024-04-29 01:05:10,321 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:05:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:05:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:05:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:05:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 01:05:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:05:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5334876461854267, 'eval_loss': 0.8674251, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1148, 1274, 1539, 1582, 1589, 1593, 1297, 1038, 594, 1496, 1026, 619], 'head_nums': [11, 6, 6, 9, 11, 11, 8, 9, 8, 3, 6, 11], 'pruned_params': 47750168, 'remaining_params': 37267432, 'pruned_model_sparsity': 0.5616503876844324, 'expected_sparsity': 0.55457, 'target_sparsity': 0.5597014925373134, 'step': 5100}


Iteration:   3%|▎         | 8/268 [00:03<03:39,  1.18it/s][A04/29/2024 01:05:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 5100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:43,  1.58it/s][A
Iteration:   4%|▎         | 10/268 [00:03<02:04,  2.07it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:38,  2.61it/s][A
Iteration:   4%|▍         | 12/268 [00:04<01:20,  3.18it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:07,  3.79it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:57,  4.39it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:51,  4.88it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:47,  5.26it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:45,  5.58it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:44,  5.61it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:42,  5.87it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:40,  6.09it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.28it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:37,  6.48it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.48it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.48it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.38it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.34it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.39it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.50it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.55it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.61it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:35,  6.61it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.68it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.54it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.35it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.28it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.55it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.56it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.67it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.65it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.63it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.58it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.36it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.47it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.58it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.66it/s][A[INFO|trainer.py:570] 2024-04-29 01:05:20,154 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:05:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:05:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:05:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:05:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:05:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:05:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5181030951855673, 'eval_loss': 0.9343585, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1127, 1255, 1518, 1562, 1569, 1573, 1276, 1019, 583, 1429, 959, 599], 'head_nums': [11, 6, 6, 9, 11, 11, 8, 9, 8, 3, 6, 11], 'pruned_params': 48013672, 'remaining_params': 37003928, 'pruned_model_sparsity': 0.5647497929840409, 'expected_sparsity': 0.55888, 'target_sparsity': 0.5652985074626865, 'step': 5150}


Iteration:  22%|██▏       | 58/268 [00:13<02:47,  1.25it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<02:06,  1.65it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:37,  2.14it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<01:17,  2.67it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:03,  3.24it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:53,  3.83it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:46,  4.36it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:42,  4.80it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:39,  5.13it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:36,  5.54it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:34,  5.83it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:33,  6.02it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.20it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:31,  6.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.34it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.51it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.40it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.44it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.36it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.42it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.33it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.29it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.34it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.29it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.58it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.59it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.59it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.57it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.40it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.32it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.41it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.42it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.34it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.30it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:05:30,084 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:05:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:05:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:05:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:05:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:05:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:05:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5265067723079826, 'eval_loss': 0.88061166, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1106, 1234, 1496, 1541, 1548, 1552, 1254, 1000, 572, 1357, 890, 578], 'head_nums': [11, 6, 6, 9, 11, 11, 8, 9, 8, 3, 6, 11], 'pruned_params': 48287900, 'remaining_params': 36729700, 'pruned_model_sparsity': 0.5679753368714243, 'expected_sparsity': 0.56327, 'target_sparsity': 0.5708955223880597, 'step': 5200}


Iteration:  40%|████      | 108/268 [00:23<02:09,  1.24it/s][A04/29/2024 01:05:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 5200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:23<01:37,  1.63it/s][A
Iteration:  41%|████      | 110/268 [00:23<01:15,  2.09it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:59,  2.62it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:48,  3.20it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:41,  3.78it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:35,  4.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:32,  4.74it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:29,  5.09it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:27,  5.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:26,  5.72it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:25,  5.88it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:24,  6.02it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:24,  6.09it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.23it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.17it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:23,  6.20it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.30it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.35it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.41it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.50it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.45it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.33it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.39it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.44it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.42it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.28it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.35it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.39it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.48it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.61it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.58it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.60it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.49it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:19,  6.05it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.25it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 01:05:40,049 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:05:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:05:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:05:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:05:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 01:05:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:05:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5521589562965672, 'eval_loss': 0.8699825, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1083, 1213, 1473, 1517, 1524, 1529, 1230, 979, 561, 1280, 821, 558], 'head_nums': [11, 6, 6, 9, 11, 11, 8, 9, 8, 3, 5, 11], 'pruned_params': 48781204, 'remaining_params': 36236396, 'pruned_model_sparsity': 0.5737777119090636, 'expected_sparsity': 0.56845, 'target_sparsity': 0.5764925373134328, 'step': 5250}


Iteration:  59%|█████▉    | 158/268 [00:33<01:28,  1.24it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<01:06,  1.64it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:50,  2.12it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:40,  2.66it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:32,  3.27it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:27,  3.81it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:23,  4.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:21,  4.84it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:19,  5.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:18,  5.49it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:17,  5.78it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:16,  5.93it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:16,  6.11it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.21it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.55it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.55it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.44it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.53it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.39it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.44it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.28it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.24it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.36it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.46it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.62it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.47it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.48it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:05:49,927 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:05:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:05:49 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:05:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:05:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:05:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:05:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5416589932124241, 'eval_loss': 0.8712325, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1060, 1190, 1448, 1492, 1500, 1505, 1206, 956, 549, 1199, 752, 537], 'head_nums': [11, 6, 6, 9, 11, 11, 8, 9, 8, 3, 5, 11], 'pruned_params': 49092200, 'remaining_params': 35925400, 'pruned_model_sparsity': 0.5774357309545318, 'expected_sparsity': 0.57311, 'target_sparsity': 0.582089552238806, 'step': 5300}


Iteration:  78%|███████▊  | 208/268 [00:43<00:47,  1.25it/s][A04/29/2024 01:05:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 5300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:43<00:35,  1.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:27,  2.13it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:21,  2.69it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:17,  3.27it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:14,  3.85it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:12,  4.38it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:11,  4.76it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:10,  5.17it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:09,  5.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  5.77it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  5.99it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.13it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.19it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.31it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.35it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.29it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.28it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.39it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.35it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.38it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.41it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.59it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.42it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.37it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.24it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.42it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.44it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.45it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.33it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.27it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.33it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.53it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.52it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.46it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:05:59,831 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:05:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:05:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:05:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:05:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:06:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:06:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5446151814563016, 'eval_loss': 0.93367296, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1035, 1166, 1421, 1465, 1474, 1481, 1181, 934, 538, 1117, 684, 515], 'head_nums': [11, 6, 6, 9, 11, 11, 8, 9, 8, 3, 5, 11], 'pruned_params': 49415452, 'remaining_params': 35602148, 'pruned_model_sparsity': 0.5812379083860283, 'expected_sparsity': 0.57803, 'target_sparsity': 0.5876865671641791, 'step': 5350}


Iteration:  96%|█████████▋| 258/268 [00:52<00:07,  1.26it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:05,  1.66it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:03,  2.14it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:02,  2.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  3.23it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  3.82it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  4.36it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  4.85it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  5.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.55it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.07it/s][A04/29/2024 01:06:03 - INFO - trainer.trainer_mod_2 - Epoch 19 finished. Took 54.42 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  20%|██        | 20/100 [17:37<1:11:04, 53.31s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.54it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.55it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.33it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.38it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.52it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.56it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.49it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.64it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.60it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.49it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.51it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.50it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.50it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.56it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.48it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.39it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.43it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.33it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:35,  6.63it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.59it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.66it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.63it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.64it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.60it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.69it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:33,  6.74it/s][A[INFO|trainer.py:570] 2024-04-29 01:06:09,619 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:06:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:06:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:06:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:06:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.27it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:06:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:06:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5314083843246411, 'eval_loss': 0.91631705, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1010, 1142, 1394, 1437, 1447, 1454, 1154, 911, 527, 1035, 618, 494], 'head_nums': [11, 6, 6, 9, 10, 11, 8, 9, 7, 3, 5, 11], 'pruned_params': 50143152, 'remaining_params': 34874448, 'pruned_model_sparsity': 0.589797312556459, 'expected_sparsity': 0.58483, 'target_sparsity': 0.5932835820895522, 'step': 5400}


Iteration:  15%|█▍        | 40/268 [00:08<03:02,  1.25it/s][A04/29/2024 01:06:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 5400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:17,  1.65it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:45,  2.13it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:24,  2.67it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:08,  3.27it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:57,  3.85it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:50,  4.41it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:45,  4.90it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:41,  5.24it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:39,  5.59it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:37,  5.87it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:35,  6.06it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.19it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.32it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.32it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.27it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.29it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.37it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.41it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.47it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.55it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.59it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.57it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:31,  6.37it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.48it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.63it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.58it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.56it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.58it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.56it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.55it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:29,  6.26it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.28it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.34it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:28,  6.24it/s][A[INFO|trainer.py:570] 2024-04-29 01:06:19,499 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:06:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:06:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:06:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:06:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:06:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:06:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5207572018426233, 'eval_loss': 1.0020213, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1116, 1367, 1409, 1420, 1427, 1127, 888, 515, 954, 558, 474], 'head_nums': [11, 6, 6, 9, 10, 11, 8, 9, 7, 3, 5, 11], 'pruned_params': 50483256, 'remaining_params': 34534344, 'pruned_model_sparsity': 0.5937977077687444, 'expected_sparsity': 0.59396, 'target_sparsity': 0.5988805970149254, 'step': 5450}


Iteration:  34%|███▎      | 90/268 [00:18<02:22,  1.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:48,  1.63it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<01:23,  2.11it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<01:05,  2.66it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:53,  3.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:45,  3.82it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:39,  4.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:35,  4.85it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:32,  5.17it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:30,  5.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:29,  5.79it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:27,  6.02it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.19it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.32it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.39it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.37it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:25,  6.38it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.38it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.39it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.24it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.41it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.41it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.42it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.40it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.48it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.53it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.32it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.27it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:21,  6.33it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.36it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.40it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.59it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.65it/s][A[INFO|trainer.py:570] 2024-04-29 01:06:29,404 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:06:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:06:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:06:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:06:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:06:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:06:31 - INFO - trainer.trainer_mod_2 - Starting saving the best from epoch 20 and step 5500
04/29/2024 01:06:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49938409054607086, 'eval_loss': 0.947759, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [962, 1092, 1340, 1381, 1394, 1400, 1101, 866, 504, 878, 504, 457], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 5, 10], 'pruned_params': 51595488, 'remaining_params': 33422112, 'pruned_model_sparsity': 0.6068800813008131, 'expected_sparsity': 0.60255, 'target_sparsity': 0.6, 'step': 5500}
04/29/2024 01:06:31 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 20 | Step: 5500 | Model size: 33422112 | Score: 0.49938]

[INFO|configuration_utils.py:439] 2024-04-29 01:06:31,560 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 01:06:32,198 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  52%|█████▏    | 140/268 [00:28<02:06,  1.01it/s][A04/29/2024 01:06:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 5500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:28<01:34,  1.35it/s][A
Iteration:  53%|█████▎    | 142/268 [00:29<01:10,  1.78it/s][A
Iteration:  53%|█████▎    | 143/268 [00:29<00:55,  2.26it/s][A
Iteration:  54%|█████▎    | 144/268 [00:29<00:43,  2.82it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:36,  3.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:30,  3.97it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:26,  4.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:24,  4.91it/s][A
Iteration:  56%|█████▌    | 149/268 [00:30<00:22,  5.25it/s][A
Iteration:  56%|█████▌    | 150/268 [00:30<00:21,  5.47it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<00:20,  5.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:19,  5.89it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:19,  5.95it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.11it/s][A
Iteration:  58%|█████▊    | 155/268 [00:31<00:18,  6.15it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:18,  6.21it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:17,  6.32it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.33it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.38it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.42it/s][A
Iteration:  60%|██████    | 162/268 [00:32<00:16,  6.45it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:16,  6.50it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:33<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:16,  6.05it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.18it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.20it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.28it/s][A
Iteration:  65%|██████▍   | 174/268 [00:34<00:14,  6.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.38it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.50it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 181/268 [00:35<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:13,  6.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:36<00:12,  6.46it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.31it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 01:06:40,006 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:06:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:06:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:06:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:06:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:06:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:06:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.544509467622167, 'eval_loss': 0.8592358, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [941, 1071, 1316, 1356, 1369, 1377, 1078, 845, 494, 811, 460, 441], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 52087260, 'remaining_params': 32930340, 'pruned_model_sparsity': 0.6126644365401988, 'expected_sparsity': 0.60822, 'target_sparsity': 0.6, 'step': 5550}
04/29/2024 01:06:42 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 20 | Step: 5550 | Model size: 32930340 | Score: 0.54451]

[INFO|configuration_utils.py:439] 2024-04-29 01:06:42,184 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 01:06:43,062 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  71%|███████   | 190/268 [00:39<01:23,  1.07s/it][A
Iteration:  71%|███████▏  | 191/268 [00:39<01:01,  1.25it/s][A
Iteration:  72%|███████▏  | 192/268 [00:39<00:45,  1.65it/s][A
Iteration:  72%|███████▏  | 193/268 [00:40<00:35,  2.13it/s][A
Iteration:  72%|███████▏  | 194/268 [00:40<00:27,  2.67it/s][A
Iteration:  73%|███████▎  | 195/268 [00:40<00:22,  3.27it/s][A
Iteration:  73%|███████▎  | 196/268 [00:40<00:18,  3.79it/s][A
Iteration:  74%|███████▎  | 197/268 [00:40<00:16,  4.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:40<00:14,  4.82it/s][A
Iteration:  74%|███████▍  | 199/268 [00:40<00:13,  5.15it/s][A
Iteration:  75%|███████▍  | 200/268 [00:41<00:12,  5.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:41<00:11,  5.71it/s][A
Iteration:  75%|███████▌  | 202/268 [00:41<00:11,  5.83it/s][A
Iteration:  76%|███████▌  | 203/268 [00:41<00:10,  5.94it/s][A
Iteration:  76%|███████▌  | 204/268 [00:41<00:10,  6.19it/s][A
Iteration:  76%|███████▋  | 205/268 [00:41<00:10,  6.26it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:09,  6.35it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:09,  6.54it/s][A
Iteration:  78%|███████▊  | 209/268 [00:42<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 210/268 [00:42<00:08,  6.55it/s][A
Iteration:  79%|███████▊  | 211/268 [00:42<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:42<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:08,  6.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:08,  6.50it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:08,  6.61it/s][A
Iteration:  81%|████████  | 216/268 [00:43<00:07,  6.68it/s][A
Iteration:  81%|████████  | 217/268 [00:43<00:07,  6.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:43<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.42it/s][A
Iteration:  83%|████████▎ | 222/268 [00:44<00:07,  6.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:44<00:07,  6.20it/s][A
Iteration:  84%|████████▎ | 224/268 [00:44<00:07,  6.23it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.36it/s][A
Iteration:  85%|████████▌ | 229/268 [00:45<00:06,  6.39it/s][A
Iteration:  86%|████████▌ | 230/268 [00:45<00:05,  6.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:45<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 235/268 [00:46<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:46<00:04,  6.50it/s][A
Iteration:  88%|████████▊ | 237/268 [00:46<00:04,  6.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:06:50,841 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:06:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:06:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:06:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:06:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:06:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:06:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5258978858175564, 'eval_loss': 0.93969804, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [923, 1053, 1294, 1334, 1348, 1356, 1057, 827, 487, 754, 424, 428], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 8, 6, 3, 4, 10], 'pruned_params': 52540732, 'remaining_params': 32476868, 'pruned_model_sparsity': 0.617998296823246, 'expected_sparsity': 0.61279, 'target_sparsity': 0.6, 'step': 5600}


Iteration:  90%|████████▉ | 240/268 [00:49<00:22,  1.25it/s][A04/29/2024 01:06:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 5600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:49<00:16,  1.63it/s][A
Iteration:  90%|█████████ | 242/268 [00:49<00:12,  2.11it/s][A
Iteration:  91%|█████████ | 243/268 [00:49<00:09,  2.65it/s][A
Iteration:  91%|█████████ | 244/268 [00:50<00:07,  3.23it/s][A
Iteration:  91%|█████████▏| 245/268 [00:50<00:06,  3.77it/s][A
Iteration:  92%|█████████▏| 246/268 [00:50<00:05,  4.31it/s][A
Iteration:  92%|█████████▏| 247/268 [00:50<00:04,  4.81it/s][A
Iteration:  93%|█████████▎| 248/268 [00:50<00:03,  5.23it/s][A
Iteration:  93%|█████████▎| 249/268 [00:50<00:03,  5.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:51<00:03,  5.89it/s][A
Iteration:  94%|█████████▎| 251/268 [00:51<00:02,  6.05it/s][A
Iteration:  94%|█████████▍| 252/268 [00:51<00:02,  6.13it/s][A
Iteration:  94%|█████████▍| 253/268 [00:51<00:02,  6.28it/s][A
Iteration:  95%|█████████▍| 254/268 [00:51<00:02,  6.36it/s][A
Iteration:  95%|█████████▌| 255/268 [00:51<00:02,  6.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:51<00:01,  6.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:01,  6.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:01,  6.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:52<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 261/268 [00:52<00:01,  6.16it/s][A
Iteration:  98%|█████████▊| 262/268 [00:52<00:00,  6.27it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  6.35it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  6.42it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  6.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:53<00:00,  6.39it/s][A
Iteration: 100%|██████████| 268/268 [00:53<00:00,  6.72it/s][A04/29/2024 01:06:57 - INFO - trainer.trainer_mod_2 - Epoch 20 finished. Took 53.82 seconds.
Iteration: 100%|██████████| 268/268 [00:53<00:00,  4.98it/s]
Epoch:  21%|██        | 21/100 [18:31<1:10:23, 53.47s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.47it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.50it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.41it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.45it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.35it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.52it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.61it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.47it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.29it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.16it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:41,  6.10it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:40,  6.21it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.27it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 01:07:00,771 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:07:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:07:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:07:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:07:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:07:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:07:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5339494412838712, 'eval_loss': 0.8988147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [909, 1038, 1277, 1315, 1331, 1340, 1040, 813, 481, 708, 397, 419], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 8, 6, 3, 4, 10], 'pruned_params': 52747552, 'remaining_params': 32270048, 'pruned_model_sparsity': 0.6204309695874737, 'expected_sparsity': 0.61725, 'target_sparsity': 0.6, 'step': 5650}


Iteration:   8%|▊         | 22/268 [00:05<03:17,  1.24it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:29,  1.64it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:55,  2.11it/s][A
Iteration:   9%|▉         | 25/268 [00:06<01:31,  2.65it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:15,  3.20it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:04,  3.75it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:56,  4.27it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:50,  4.71it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:46,  5.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:42,  5.56it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:40,  5.89it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:38,  6.07it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.39it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.46it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.55it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.54it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.32it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.37it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.38it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.32it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.48it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.61it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.57it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.60it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.58it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.59it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.55it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.56it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:07:10,626 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:07:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:07:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:07:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:07:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:07:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:07:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5418980827011334, 'eval_loss': 0.86585855, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [897, 1026, 1264, 1301, 1317, 1327, 1027, 802, 477, 674, 378, 412], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 7, 6, 3, 4, 9], 'pruned_params': 53302136, 'remaining_params': 31715464, 'pruned_model_sparsity': 0.6269541365552544, 'expected_sparsity': 0.62216, 'target_sparsity': 0.6, 'step': 5700}


Iteration:  27%|██▋       | 72/268 [00:15<02:36,  1.25it/s][A04/29/2024 01:07:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 5700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:15<01:58,  1.64it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:31,  2.12it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:12,  2.66it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:59,  3.23it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:50,  3.81it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:43,  4.34it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:39,  4.81it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:36,  5.22it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:33,  5.62it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:32,  5.76it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:30,  5.99it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.15it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.24it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.31it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.48it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:26,  6.59it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.58it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.59it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.65it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.64it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.61it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.15it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.17it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.32it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.52it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.23it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.20it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.32it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.40it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.43it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.46it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:07:20,527 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:07:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:07:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:07:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:07:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:07:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:07:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5443521169935567, 'eval_loss': 0.88206697, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [891, 1019, 1256, 1293, 1309, 1319, 1020, 796, 474, 652, 365, 409], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 7, 6, 3, 4, 9], 'pruned_params': 53395588, 'remaining_params': 31622012, 'pruned_model_sparsity': 0.6280533442487203, 'expected_sparsity': 0.62552, 'target_sparsity': 0.6, 'step': 5750}


Iteration:  46%|████▌     | 122/268 [00:25<01:57,  1.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<01:28,  1.64it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<01:07,  2.12it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:54,  2.64it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:44,  3.23it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:36,  3.83it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:32,  4.31it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:29,  4.79it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:26,  5.26it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:24,  5.54it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:23,  5.87it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:22,  5.97it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.13it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.27it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.20it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.24it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.44it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.55it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.36it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.18it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.22it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.28it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.52it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:16,  6.62it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.36it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.30it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.19it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.28it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.44it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.33it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:16,  5.95it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:16,  6.12it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.14it/s][A[INFO|trainer.py:570] 2024-04-29 01:07:30,513 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:07:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:07:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:07:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:07:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:07:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:07:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5363967157085073, 'eval_loss': 0.8497017, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [889, 1017, 1255, 1290, 1306, 1317, 1017, 794, 473, 643, 360, 407], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 7, 6, 3, 4, 9], 'pruned_params': 53424696, 'remaining_params': 31592904, 'pruned_model_sparsity': 0.6283957204155375, 'expected_sparsity': 0.62659, 'target_sparsity': 0.6, 'step': 5800}


Iteration:  64%|██████▍   | 172/268 [00:35<01:16,  1.25it/s][A04/29/2024 01:07:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 5800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:35<00:57,  1.65it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:43,  2.14it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:34,  2.67it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:28,  3.25it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:23,  3.82it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:20,  4.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:18,  4.80it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:16,  5.22it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:15,  5.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:15,  5.73it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:14,  5.98it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.12it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.23it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.29it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.36it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.39it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.44it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.40it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.53it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.45it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.54it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.49it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.53it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.54it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.53it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.47it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.41it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.43it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.42it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.45it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.37it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.44it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.20it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:07:40,405 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:07:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:07:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:07:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:07:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:07:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:07:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5232849512779736, 'eval_loss': 0.9143796, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [891, 1020, 1258, 1293, 1309, 1319, 1018, 796, 476, 644, 361, 408], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 7, 6, 3, 4, 9], 'pruned_params': 53390992, 'remaining_params': 31626608, 'pruned_model_sparsity': 0.6279992848539596, 'expected_sparsity': 0.62549, 'target_sparsity': 0.6, 'step': 5850}


Iteration:  83%|████████▎ | 222/268 [00:45<00:36,  1.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:27,  1.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:20,  2.10it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:16,  2.62it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:13,  3.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:10,  3.74it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:09,  4.23it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:08,  4.70it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:07,  5.15it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.76it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  5.92it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  5.98it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.14it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.25it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.49it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.60it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.59it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.56it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.56it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.42it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.33it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.41it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.44it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.43it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.32it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.32it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.72it/s][A04/29/2024 01:07:49 - INFO - trainer.trainer_mod_2 - Epoch 21 finished. Took 52.37 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  22%|██▏       | 22/100 [19:24<1:09:04, 53.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:45,  5.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.21it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:07:50,322 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:07:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:07:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:07:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:07:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:07:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:07:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5364243566130295, 'eval_loss': 0.91710687, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [899, 1027, 1266, 1302, 1317, 1326, 1025, 803, 486, 656, 371, 415], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 7, 6, 3, 4, 9], 'pruned_params': 53282220, 'remaining_params': 31735380, 'pruned_model_sparsity': 0.6267198791779585, 'expected_sparsity': 0.62195, 'target_sparsity': 0.6, 'step': 5900}


Iteration:   1%|▏         | 4/268 [00:02<04:25,  1.00s/it][A04/29/2024 01:07:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 5900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<03:03,  1.43it/s][A
Iteration:   2%|▏         | 6/268 [00:03<02:14,  1.95it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:43,  2.53it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:23,  3.13it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:09,  3.70it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:00,  4.29it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:52,  4.85it/s][A
Iteration:   4%|▍         | 12/268 [00:04<00:48,  5.29it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:46,  5.51it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:44,  5.77it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:42,  5.97it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.10it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:40,  6.13it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.24it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:39,  6.32it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:39,  6.31it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.25it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.33it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.23it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.20it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.29it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.35it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.28it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.32it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.38it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.42it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.48it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.29it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.27it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.21it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:36,  6.21it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.30it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.41it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.42it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.35it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.61it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.61it/s][A[INFO|trainer.py:570] 2024-04-29 01:08:00,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:08:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:08:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:08:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:08:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:08:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:08:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5241612737013471, 'eval_loss': 0.89242756, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [911, 1038, 1277, 1314, 1328, 1336, 1035, 814, 505, 681, 391, 430], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 8, 6, 4, 4, 9], 'pruned_params': 52726104, 'remaining_params': 32291496, 'pruned_model_sparsity': 0.6201786924119241, 'expected_sparsity': 0.61613, 'target_sparsity': 0.6, 'step': 5950}


Iteration:  20%|██        | 54/268 [00:12<02:50,  1.26it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:08,  1.66it/s][A
Iteration:  21%|██        | 56/268 [00:13<01:39,  2.13it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<01:19,  2.66it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:04,  3.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:54,  3.85it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:47,  4.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:42,  4.83it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:39,  5.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:36,  5.58it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:34,  5.91it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:33,  6.09it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:32,  6.15it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.40it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:31,  6.33it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:30,  6.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.50it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.56it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.47it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.47it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.40it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.36it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.52it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.56it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.47it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.43it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.40it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.48it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.48it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 01:08:10,130 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:08:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:08:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:08:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:08:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:08:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:08:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5399503104637741, 'eval_loss': 0.83757603, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [925, 1052, 1292, 1327, 1340, 1349, 1048, 828, 538, 718, 421, 456], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 8, 6, 4, 5, 10], 'pruned_params': 51921804, 'remaining_params': 33095796, 'pruned_model_sparsity': 0.6107182983288166, 'expected_sparsity': 0.60788, 'target_sparsity': 0.6, 'step': 6000}


Iteration:  39%|███▉      | 104/268 [00:22<02:11,  1.25it/s][A04/29/2024 01:08:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 6000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:22<01:39,  1.64it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<01:16,  2.11it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<01:01,  2.63it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:50,  3.18it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:42,  3.76it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:36,  4.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:32,  4.84it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:29,  5.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:27,  5.62it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:27,  5.69it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:26,  5.84it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:25,  6.03it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:24,  6.11it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.39it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:22,  6.44it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:22,  6.44it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.60it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.56it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.34it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.32it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.40it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.45it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.40it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.58it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.56it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.42it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.47it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.40it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.31it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.39it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.24it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.42it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.42it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:08:20,061 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:08:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:08:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:08:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:08:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:08:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:08:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5599999927061219, 'eval_loss': 0.86485124, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [940, 1066, 1306, 1342, 1354, 1362, 1062, 845, 590, 767, 461, 497], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 5, 5, 10], 'pruned_params': 50880044, 'remaining_params': 34137556, 'pruned_model_sparsity': 0.5984648355164107, 'expected_sparsity': 0.59622, 'target_sparsity': 0.6, 'step': 6050}
04/29/2024 01:08:22 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 22 | Step: 6050 | Model size: 34137556 | Score: 0.56]

[INFO|configuration_utils.py:439] 2024-04-29 01:08:22,218 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 01:08:23,023 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  57%|█████▋    | 154/268 [00:33<01:59,  1.05s/it][A
Iteration:  58%|█████▊    | 155/268 [00:33<01:28,  1.28it/s][A
Iteration:  58%|█████▊    | 156/268 [00:33<01:06,  1.69it/s][A
Iteration:  59%|█████▊    | 157/268 [00:33<00:51,  2.16it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:40,  2.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:34<00:33,  3.27it/s][A
Iteration:  60%|█████▉    | 160/268 [00:34<00:28,  3.85it/s][A
Iteration:  60%|██████    | 161/268 [00:34<00:24,  4.38it/s][A
Iteration:  60%|██████    | 162/268 [00:34<00:22,  4.71it/s][A
Iteration:  61%|██████    | 163/268 [00:34<00:20,  5.10it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:19,  5.46it/s][A
Iteration:  62%|██████▏   | 165/268 [00:35<00:17,  5.73it/s][A
Iteration:  62%|██████▏   | 166/268 [00:35<00:17,  5.96it/s][A
Iteration:  62%|██████▏   | 167/268 [00:35<00:16,  6.11it/s][A
Iteration:  63%|██████▎   | 168/268 [00:35<00:16,  6.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:35<00:15,  6.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:15,  6.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.40it/s][A
Iteration:  64%|██████▍   | 172/268 [00:36<00:14,  6.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:36<00:14,  6.45it/s][A
Iteration:  65%|██████▍   | 174/268 [00:36<00:14,  6.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:36<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 176/268 [00:36<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.48it/s][A
Iteration:  66%|██████▋   | 178/268 [00:37<00:13,  6.47it/s][A
Iteration:  67%|██████▋   | 179/268 [00:37<00:13,  6.59it/s][A
Iteration:  67%|██████▋   | 180/268 [00:37<00:13,  6.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:37<00:13,  6.57it/s][A
Iteration:  68%|██████▊   | 182/268 [00:37<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.55it/s][A
Iteration:  69%|██████▉   | 185/268 [00:38<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:38<00:12,  6.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:38<00:12,  6.46it/s][A
Iteration:  70%|███████   | 188/268 [00:38<00:12,  6.48it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:12,  6.51it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.53it/s][A
Iteration:  71%|███████▏  | 191/268 [00:39<00:11,  6.57it/s][A
Iteration:  72%|███████▏  | 192/268 [00:39<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 193/268 [00:39<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 194/268 [00:39<00:11,  6.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:39<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.45it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.58it/s][A
Iteration:  74%|███████▍  | 198/268 [00:40<00:10,  6.56it/s][A
Iteration:  74%|███████▍  | 199/268 [00:40<00:10,  6.52it/s][A
Iteration:  75%|███████▍  | 200/268 [00:40<00:10,  6.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:40<00:10,  6.39it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:08:30,786 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:08:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:08:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:08:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:08:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:08:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:08:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5771272716642352, 'eval_loss': 0.8057867, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [953, 1078, 1318, 1353, 1365, 1374, 1074, 859, 652, 817, 503, 555], 'head_nums': [11, 8, 7, 9, 9, 11, 8, 9, 7, 6, 6, 10], 'pruned_params': 49852072, 'remaining_params': 35165528, 'pruned_model_sparsity': 0.5863735508882867, 'expected_sparsity': 0.58193, 'target_sparsity': 0.6, 'step': 6100}
04/29/2024 01:08:32 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 22 | Step: 6100 | Model size: 35165528 | Score: 0.57713]

[INFO|configuration_utils.py:439] 2024-04-29 01:08:32,944 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 01:08:33,832 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  76%|███████▌  | 204/268 [00:44<01:08,  1.08s/it][A04/29/2024 01:08:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 6100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:44<00:50,  1.25it/s][A
Iteration:  77%|███████▋  | 206/268 [00:44<00:37,  1.65it/s][A
Iteration:  77%|███████▋  | 207/268 [00:44<00:28,  2.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:44<00:22,  2.65it/s][A
Iteration:  78%|███████▊  | 209/268 [00:44<00:18,  3.23it/s][A
Iteration:  78%|███████▊  | 210/268 [00:45<00:15,  3.81it/s][A
Iteration:  79%|███████▊  | 211/268 [00:45<00:12,  4.40it/s][A
Iteration:  79%|███████▉  | 212/268 [00:45<00:11,  4.88it/s][A
Iteration:  79%|███████▉  | 213/268 [00:45<00:10,  5.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:45<00:09,  5.59it/s][A
Iteration:  80%|████████  | 215/268 [00:45<00:09,  5.85it/s][A
Iteration:  81%|████████  | 216/268 [00:45<00:08,  5.89it/s][A
Iteration:  81%|████████  | 217/268 [00:46<00:08,  6.06it/s][A
Iteration:  81%|████████▏ | 218/268 [00:46<00:08,  6.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:46<00:07,  6.30it/s][A
Iteration:  82%|████████▏ | 220/268 [00:46<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 221/268 [00:46<00:07,  6.33it/s][A
Iteration:  83%|████████▎ | 222/268 [00:46<00:07,  6.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:47<00:07,  6.36it/s][A
Iteration:  84%|████████▎ | 224/268 [00:47<00:06,  6.50it/s][A
Iteration:  84%|████████▍ | 225/268 [00:47<00:06,  6.59it/s][A
Iteration:  84%|████████▍ | 226/268 [00:47<00:06,  6.60it/s][A
Iteration:  85%|████████▍ | 227/268 [00:47<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 228/268 [00:47<00:06,  6.53it/s][A
Iteration:  85%|████████▌ | 229/268 [00:47<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:48<00:05,  6.44it/s][A
Iteration:  86%|████████▌ | 231/268 [00:48<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 232/268 [00:48<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:48<00:05,  6.07it/s][A
Iteration:  87%|████████▋ | 234/268 [00:48<00:05,  6.21it/s][A
Iteration:  88%|████████▊ | 235/268 [00:48<00:05,  6.21it/s][A
Iteration:  88%|████████▊ | 236/268 [00:49<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:49<00:04,  6.47it/s][A
Iteration:  89%|████████▉ | 238/268 [00:49<00:04,  6.52it/s][A
Iteration:  89%|████████▉ | 239/268 [00:49<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 240/268 [00:49<00:04,  6.36it/s][A
Iteration:  90%|████████▉ | 241/268 [00:49<00:04,  6.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:50<00:04,  6.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:50<00:03,  6.47it/s][A
Iteration:  91%|█████████ | 244/268 [00:50<00:03,  6.31it/s][A
Iteration:  91%|█████████▏| 245/268 [00:50<00:03,  6.19it/s][A
Iteration:  92%|█████████▏| 246/268 [00:50<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:50<00:03,  6.49it/s][A
Iteration:  93%|█████████▎| 248/268 [00:50<00:03,  6.58it/s][A
Iteration:  93%|█████████▎| 249/268 [00:51<00:02,  6.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:51<00:02,  6.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:51<00:02,  6.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:51<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 253/268 [00:51<00:02,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 01:08:41,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:08:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:08:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:08:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:08:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:08:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:08:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5471054662620461, 'eval_loss': 0.91112703, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [958, 1083, 1323, 1358, 1369, 1378, 1077, 863, 679, 836, 521, 583], 'head_nums': [11, 8, 7, 9, 9, 11, 8, 9, 7, 6, 7, 10], 'pruned_params': 49560992, 'remaining_params': 35456608, 'pruned_model_sparsity': 0.5829497892201144, 'expected_sparsity': 0.57542, 'target_sparsity': 0.6, 'step': 6150}


Iteration:  95%|█████████▍| 254/268 [00:54<00:11,  1.24it/s][A
Iteration:  95%|█████████▌| 255/268 [00:54<00:07,  1.64it/s][A
Iteration:  96%|█████████▌| 256/268 [00:54<00:05,  2.09it/s][A
Iteration:  96%|█████████▌| 257/268 [00:54<00:04,  2.63it/s][A
Iteration:  96%|█████████▋| 258/268 [00:54<00:03,  3.17it/s][A
Iteration:  97%|█████████▋| 259/268 [00:54<00:02,  3.73it/s][A
Iteration:  97%|█████████▋| 260/268 [00:55<00:01,  4.28it/s][A
Iteration:  97%|█████████▋| 261/268 [00:55<00:01,  4.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:55<00:01,  5.19it/s][A
Iteration:  98%|█████████▊| 263/268 [00:55<00:00,  5.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:55<00:00,  5.78it/s][A
Iteration:  99%|█████████▉| 265/268 [00:55<00:00,  6.07it/s][A
Iteration:  99%|█████████▉| 266/268 [00:55<00:00,  6.11it/s][A
Iteration: 100%|█████████▉| 267/268 [00:56<00:00,  6.21it/s][A
Iteration: 100%|██████████| 268/268 [00:56<00:00,  6.63it/s][A04/29/2024 01:08:45 - INFO - trainer.trainer_mod_2 - Epoch 22 finished. Took 56.23 seconds.
Iteration: 100%|██████████| 268/268 [00:56<00:00,  4.77it/s]
Epoch:  23%|██▎       | 23/100 [20:20<1:09:23, 54.07s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:44,  5.94it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.18it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:42,  6.16it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:42,  6.18it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:42,  6.21it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.27it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.26it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:42,  5.93it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:42,  6.04it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:41,  6.09it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.16it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.16it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.37it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:39,  6.27it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.24it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.42it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.42it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.38it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.53it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.49it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.41it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.33it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.41it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.46it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.47it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:08:51,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:08:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:08:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:08:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:08:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:08:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:08:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5337999966053822, 'eval_loss': 0.90191704, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [956, 1081, 1322, 1356, 1368, 1377, 1075, 860, 652, 814, 503, 548], 'head_nums': [11, 8, 7, 9, 9, 11, 8, 9, 7, 6, 6, 10], 'pruned_params': 49819900, 'remaining_params': 35197700, 'pruned_model_sparsity': 0.5859951351249624, 'expected_sparsity': 0.58134, 'target_sparsity': 0.6, 'step': 6200}


Iteration:  13%|█▎        | 36/268 [00:07<03:04,  1.25it/s][A04/29/2024 01:08:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 6200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:19,  1.65it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:47,  2.15it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<01:24,  2.70it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:10,  3.25it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:58,  3.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:51,  4.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:46,  4.88it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:43,  5.18it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:39,  5.62it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:37,  5.86it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:37,  5.93it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:36,  6.08it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.28it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.24it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.25it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:35,  6.11it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.15it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.32it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.41it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.39it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.56it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:30,  6.64it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.71it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.52it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.50it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.54it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.47it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:30,  6.31it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.35it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.43it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.45it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.30it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.36it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.56it/s][A[INFO|trainer.py:570] 2024-04-29 01:09:01,491 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:09:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:09:01 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:09:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:09:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:09:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:09:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5425982560876161, 'eval_loss': 0.8985042, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [950, 1076, 1317, 1352, 1364, 1372, 1070, 853, 610, 778, 473, 503], 'head_nums': [11, 7, 7, 9, 9, 11, 8, 9, 7, 5, 6, 10], 'pruned_params': 50339248, 'remaining_params': 34678352, 'pruned_model_sparsity': 0.5921038467329117, 'expected_sparsity': 0.59071, 'target_sparsity': 0.6, 'step': 6250}


Iteration:  32%|███▏      | 86/268 [00:17<02:25,  1.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:49,  1.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<01:24,  2.13it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<01:06,  2.67it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:54,  3.24it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:46,  3.82it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:40,  4.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:35,  4.89it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:32,  5.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:30,  5.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:29,  5.81it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:28,  5.93it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:28,  6.01it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.16it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.32it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.40it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.44it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.43it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.39it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.54it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.42it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.48it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.39it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.35it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.31it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.42it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.57it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.46it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.36it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.43it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.49it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:09:11,374 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:09:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:09:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:09:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:09:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:09:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:09:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5312518765149835, 'eval_loss': 0.91931504, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [945, 1070, 1312, 1346, 1359, 1368, 1064, 845, 577, 747, 448, 471], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 51047032, 'remaining_params': 33970568, 'pruned_model_sparsity': 0.6004289935260464, 'expected_sparsity': 0.59759, 'target_sparsity': 0.6, 'step': 6300}


Iteration:  51%|█████     | 136/268 [00:27<01:45,  1.25it/s][A04/29/2024 01:09:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 6300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:27<01:19,  1.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<01:00,  2.13it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:48,  2.64it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:39,  3.23it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:33,  3.80it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:29,  4.29it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:26,  4.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:23,  5.18it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:22,  5.51it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:21,  5.77it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.09it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.06it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:19,  6.12it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.30it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.46it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.54it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.58it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.57it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.57it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.39it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.61it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.68it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:14,  6.67it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.70it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.49it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.49it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.53it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.55it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.37it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.49it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.50it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.58it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.55it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:09:21,222 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:09:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:09:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:09:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:09:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:09:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:09:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5484358677014353, 'eval_loss': 0.8858669, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [940, 1066, 1309, 1342, 1355, 1364, 1060, 840, 555, 723, 429, 452], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51523484, 'remaining_params': 33494116, 'pruned_model_sparsity': 0.6060331507828968, 'expected_sparsity': 0.60194, 'target_sparsity': 0.6, 'step': 6350}


Iteration:  69%|██████▉   | 186/268 [00:37<01:05,  1.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:49,  1.65it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:37,  2.14it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:29,  2.68it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:23,  3.25it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:20,  3.83it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:17,  4.37it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:15,  4.87it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:14,  5.15it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:13,  5.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:12,  5.74it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  5.96it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.06it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  5.94it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:11,  6.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.23it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.25it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.29it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.28it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.32it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.34it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.27it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.33it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.52it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.50it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.53it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.34it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.35it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.32it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.28it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.45it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:09:31,148 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:09:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:09:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:09:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:09:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:09:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:09:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5575034099514093, 'eval_loss': 0.88572264, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [936, 1063, 1306, 1338, 1353, 1361, 1057, 835, 541, 707, 416, 439], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51586296, 'remaining_params': 33431304, 'pruned_model_sparsity': 0.6067719625112917, 'expected_sparsity': 0.6045, 'target_sparsity': 0.6, 'step': 6400}


Iteration:  88%|████████▊ | 236/268 [00:47<00:25,  1.26it/s][A04/29/2024 01:09:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 6400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:47<00:18,  1.65it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:14,  2.13it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:10,  2.68it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:08,  3.25it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:07,  3.81it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:06,  4.32it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:05,  4.80it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.23it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  5.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  5.83it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.06it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.13it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.50it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.49it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.52it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.58it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.54it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.72it/s][A04/29/2024 01:09:38 - INFO - trainer.trainer_mod_2 - Epoch 23 finished. Took 52.26 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  24%|██▍       | 24/100 [21:12<1:07:47, 53.53s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.64it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.35it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.46it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.50it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.37it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.45it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.31it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.29it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.37it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.42it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.33it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.27it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.32it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:09:40,993 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:09:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:09:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:09:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:09:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 01:09:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:09:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5266648955454677, 'eval_loss': 0.91819566, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [934, 1062, 1305, 1337, 1352, 1360, 1055, 833, 534, 698, 408, 432], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51613872, 'remaining_params': 33403728, 'pruned_model_sparsity': 0.6070963188798555, 'expected_sparsity': 0.60581, 'target_sparsity': 0.6, 'step': 6450}


Iteration:   7%|▋         | 18/268 [00:04<03:19,  1.25it/s][A
Iteration:   7%|▋         | 19/268 [00:05<02:30,  1.66it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:56,  2.13it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:32,  2.66it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:15,  3.24it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:03,  3.83it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:55,  4.37it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:49,  4.91it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:45,  5.34it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:42,  5.63it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:40,  5.95it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:40,  5.96it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:40,  5.94it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.10it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.24it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.31it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.60it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.67it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.67it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.78it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.63it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.42it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.37it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:33,  6.26it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:33,  6.20it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.29it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.35it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.32it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:09:50,856 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:09:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:09:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:09:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:09:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 01:09:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:09:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5408374954915984, 'eval_loss': 0.8707586, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [934, 1062, 1305, 1339, 1352, 1361, 1056, 832, 532, 695, 406, 430], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51612340, 'remaining_params': 33405260, 'pruned_model_sparsity': 0.6070782990816019, 'expected_sparsity': 0.60596, 'target_sparsity': 0.6, 'step': 6500}


Iteration:  25%|██▌       | 68/268 [00:14<02:39,  1.25it/s][A04/29/2024 01:09:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 6500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<02:00,  1.65it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:33,  2.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<01:13,  2.67it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:00,  3.23it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:51,  3.79it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:45,  4.31it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:40,  4.80it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:37,  5.17it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:34,  5.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:32,  5.78it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:32,  5.85it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:31,  6.05it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:30,  6.17it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.37it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.41it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.45it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.42it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.49it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.45it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.57it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:25,  6.66it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.65it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.47it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.33it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.50it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.50it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.50it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.53it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.68it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.61it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.72it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.69it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.63it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:10:00,704 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:10:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:10:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:10:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:10:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 01:10:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:10:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5261360919387726, 'eval_loss': 0.93276, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [936, 1065, 1308, 1343, 1354, 1362, 1057, 833, 534, 696, 408, 431], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51583232, 'remaining_params': 33434368, 'pruned_model_sparsity': 0.6067359229147847, 'expected_sparsity': 0.60523, 'target_sparsity': 0.6, 'step': 6550}


Iteration:  44%|████▍     | 118/268 [00:24<01:59,  1.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<01:30,  1.66it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<01:09,  2.13it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:55,  2.67it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:46,  3.13it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:38,  3.72it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:34,  4.21it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:30,  4.70it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:27,  5.13it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:25,  5.56it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:24,  5.68it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:23,  5.81it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.00it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.14it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.26it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.26it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.40it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.48it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.62it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.53it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.48it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.48it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.39it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.60it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:16,  6.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:16,  6.65it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.46it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.41it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.45it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.21it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.33it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.30it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.35it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.41it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.32it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:10:10,616 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:10:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:10:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:10:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:10:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:02, 14.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 01:10:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:10:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5630684232854489, 'eval_loss': 0.83005315, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [939, 1068, 1312, 1346, 1357, 1365, 1060, 836, 540, 702, 413, 436], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51535740, 'remaining_params': 33481860, 'pruned_model_sparsity': 0.606177309168925, 'expected_sparsity': 0.60373, 'target_sparsity': 0.6, 'step': 6600}


Iteration:  63%|██████▎   | 168/268 [00:34<01:20,  1.25it/s][A04/29/2024 01:10:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 6600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:34<01:00,  1.65it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:46,  2.11it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:36,  2.66it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:29,  3.26it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:24,  3.84it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:21,  4.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:19,  4.82it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:17,  5.16it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:16,  5.50it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:15,  5.72it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:15,  5.92it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:14,  6.12it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:14,  6.15it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.25it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.35it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.39it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.22it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.41it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.54it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:10,  6.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.65it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.53it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.54it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.46it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.47it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.39it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.39it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.46it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.43it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:10:20,493 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:10:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:10:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:10:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:10:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:10:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:10:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5371884165342511, 'eval_loss': 0.90408653, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [943, 1072, 1316, 1350, 1360, 1369, 1064, 840, 549, 711, 420, 443], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.60183, 'target_sparsity': 0.6, 'step': 6650}


Iteration:  81%|████████▏ | 218/268 [00:44<00:39,  1.25it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:29,  1.65it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:22,  2.13it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:17,  2.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:14,  3.22it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:11,  3.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:10,  4.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:08,  4.85it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:08,  5.06it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:07,  5.36it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:07,  5.61it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  5.85it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  5.96it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  6.02it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.17it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.41it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.26it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.27it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.26it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.39it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.31it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.35it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.29it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.33it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.38it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.30it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.29it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.23it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.37it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.38it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.43it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.44it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.48it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.54it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:10:30,444 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:10:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:10:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:10:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:10:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:10:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:10:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5504217860036938, 'eval_loss': 0.8943764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [948, 1077, 1320, 1354, 1364, 1373, 1068, 844, 558, 721, 428, 452], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 51016392, 'remaining_params': 34001208, 'pruned_model_sparsity': 0.6000685975609756, 'expected_sparsity': 0.5996, 'target_sparsity': 0.6, 'step': 6700}


Iteration: 100%|██████████| 268/268 [00:54<00:00,  1.27it/s][A04/29/2024 01:10:32 - INFO - trainer.trainer_mod_2 - Epoch 24 finished. Took 54.41 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  25%|██▌       | 25/100 [22:07<1:07:14, 53.79s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/29/2024 01:10:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 6700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:42,  6.22it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.40it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.36it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.49it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.53it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.50it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.49it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.42it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.38it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.21it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:40,  6.17it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:39,  6.19it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:39,  6.20it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.27it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.36it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.38it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.41it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.47it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.47it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.48it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.42it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.38it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.51it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.53it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.35it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.32it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.40it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:34,  6.48it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:07<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:07<00:33,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:10:40,371 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:10:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:10:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:10:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:10:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:10:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:10:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.549719450045872, 'eval_loss': 0.9239148, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [951, 1080, 1324, 1358, 1368, 1376, 1071, 848, 567, 729, 435, 460], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50959708, 'remaining_params': 34057892, 'pruned_model_sparsity': 0.5994018650255947, 'expected_sparsity': 0.59769, 'target_sparsity': 0.6, 'step': 6750}


Iteration:  19%|█▊        | 50/268 [00:09<02:53,  1.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<02:10,  1.66it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:41,  2.14it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<01:20,  2.68it/s][A
Iteration:  20%|██        | 54/268 [00:10<01:05,  3.25it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:55,  3.86it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:48,  4.35it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:43,  4.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:40,  5.19it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:37,  5.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:36,  5.68it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:35,  5.84it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:34,  6.02it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.23it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.18it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.25it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.35it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.42it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.46it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:30,  6.27it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.35it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.42it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.44it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.54it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.53it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.49it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.55it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.49it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.51it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.55it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:26,  6.53it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:25,  6.55it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:26,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:10:50,284 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:10:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:10:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:10:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:10:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:10:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:10:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.8842804, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [953, 1082, 1326, 1360, 1370, 1378, 1073, 850, 573, 733, 438, 464], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50926004, 'remaining_params': 34091596, 'pruned_model_sparsity': 0.5990054294640169, 'expected_sparsity': 0.59655, 'target_sparsity': 0.6, 'step': 6800}


Iteration:  37%|███▋      | 100/268 [00:19<02:14,  1.25it/s][A04/29/2024 01:10:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 6800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:19<01:41,  1.65it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<01:17,  2.14it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:01,  2.68it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:50,  3.26it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:42,  3.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:36,  4.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:32,  4.92it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:29,  5.36it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:28,  5.61it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:26,  5.87it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.04it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.17it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.24it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.62it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.60it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.54it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.66it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.52it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.41it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.33it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.41it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.48it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.52it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.53it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.38it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.36it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.47it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.60it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:18,  6.66it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.52it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.61it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.59it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:19,  6.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.43it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:18,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:11:00,107 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:11:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:11:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:11:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:11:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:11:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:11:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5468655257933821, 'eval_loss': 0.86176276, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [955, 1083, 1327, 1361, 1372, 1378, 1074, 851, 573, 731, 437, 462], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50912216, 'remaining_params': 34105384, 'pruned_model_sparsity': 0.598843251279735, 'expected_sparsity': 0.59647, 'target_sparsity': 0.6, 'step': 6850}


Iteration:  56%|█████▌    | 150/268 [00:29<01:34,  1.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<01:10,  1.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:54,  2.13it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:43,  2.66it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:35,  3.21it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:29,  3.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:25,  4.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:23,  4.78it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:21,  5.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:19,  5.58it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:18,  5.81it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:18,  5.94it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  5.99it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:17,  6.07it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.21it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.30it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.38it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.42it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.30it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.38it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:14,  6.30it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:14,  6.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.26it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.37it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.24it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.33it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.35it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.54it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.38it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.16it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.26it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:11,  6.33it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:11,  6.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:11,  6.23it/s][A[INFO|trainer.py:570] 2024-04-29 01:11:10,100 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:11:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:11:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:11:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:11:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:11:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:11:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.550090073200501, 'eval_loss': 0.92891014, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [955, 1083, 1327, 1361, 1372, 1378, 1073, 850, 567, 723, 431, 454], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50924472, 'remaining_params': 34093128, 'pruned_model_sparsity': 0.5989874096657634, 'expected_sparsity': 0.59725, 'target_sparsity': 0.6, 'step': 6900}


Iteration:  75%|███████▍  | 200/268 [00:39<00:54,  1.24it/s][A04/29/2024 01:11:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 6900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:39<00:40,  1.64it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:31,  2.12it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:24,  2.65it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:19,  3.23it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:17,  3.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:14,  4.25it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:12,  4.75it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:11,  5.20it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:10,  5.52it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:10,  5.80it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  5.89it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  6.09it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.24it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.25it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.42it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.41it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.42it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.34it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.39it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.34it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.44it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.58it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.59it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.57it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.57it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.69it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.53it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.52it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.53it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.41it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.44it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.35it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.46it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.57it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.53it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:03,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:11:19,994 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:11:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:11:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:11:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:11:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:11:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:11:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5350407726436055, 'eval_loss': 0.88866705, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [954, 1083, 1327, 1361, 1372, 1378, 1072, 848, 559, 714, 423, 445], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50942856, 'remaining_params': 34074744, 'pruned_model_sparsity': 0.5992036472448058, 'expected_sparsity': 0.5986, 'target_sparsity': 0.6, 'step': 6950}


Iteration:  93%|█████████▎| 250/268 [00:49<00:14,  1.25it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:10,  1.65it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:07,  2.14it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:05,  2.68it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:04,  3.24it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:03,  3.83it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  4.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:02,  4.85it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  5.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  5.77it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.00it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.02it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.19it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.11it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.24it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.31it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.38it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.76it/s][A04/29/2024 01:11:24 - INFO - trainer.trainer_mod_2 - Epoch 25 finished. Took 52.31 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  26%|██▌       | 26/100 [22:59<1:05:47, 53.35s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.31it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.51it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.60it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.63it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.62it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.43it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.45it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.47it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.32it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.51it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.44it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.41it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.29it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.33it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.37it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.42it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.41it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.45it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:11:29,863 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:11:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:11:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:11:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:11:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:11:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:11:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.539019545585709, 'eval_loss': 0.9377431, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [953, 1082, 1326, 1361, 1373, 1377, 1071, 846, 551, 704, 414, 436], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50964304, 'remaining_params': 34053296, 'pruned_model_sparsity': 0.5994559244203553, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 7000}


Iteration:  12%|█▏        | 32/268 [00:07<03:08,  1.25it/s][A04/29/2024 01:11:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 7000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:07<02:23,  1.64it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:51,  2.11it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:28,  2.64it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:12,  3.22it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:00,  3.84it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:53,  4.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:47,  4.81it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:43,  5.20it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:41,  5.52it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:39,  5.79it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:37,  5.93it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:37,  5.97it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:36,  6.14it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.21it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.17it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.30it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.44it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.47it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.51it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.66it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.61it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.59it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:31,  6.09it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:31,  6.09it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:31,  6.10it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:31,  6.15it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.47it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:11:39,805 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:11:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:11:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:11:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:11:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.16it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.70it/s]04/29/2024 01:11:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:11:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5424244271777358, 'eval_loss': 0.9285499, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [951, 1080, 1326, 1359, 1371, 1376, 1069, 843, 544, 696, 407, 429], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50996476, 'remaining_params': 34021124, 'pruned_model_sparsity': 0.5998343401836796, 'expected_sparsity': 0.60111, 'target_sparsity': 0.6, 'step': 7050}


Iteration:  31%|███       | 82/268 [00:17<02:29,  1.25it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:52,  1.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<01:27,  2.11it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<01:09,  2.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:56,  3.21it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:47,  3.82it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:42,  4.27it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:37,  4.77it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:33,  5.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:32,  5.38it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:30,  5.71it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:29,  5.94it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:28,  6.04it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:28,  6.12it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:28,  6.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.58it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.56it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.47it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.33it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.26it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.64it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.50it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.48it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.34it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.30it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.44it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.52it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.46it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:11:49,748 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:11:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:11:49 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:11:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:11:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:11:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:11:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5393878269002617, 'eval_loss': 0.9427928, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [951, 1080, 1326, 1359, 1371, 1375, 1068, 842, 540, 691, 402, 424], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51399392, 'remaining_params': 33618208, 'pruned_model_sparsity': 0.6045735471243602, 'expected_sparsity': 0.60184, 'target_sparsity': 0.6, 'step': 7100}


Iteration:  49%|████▉     | 132/268 [00:26<01:48,  1.25it/s][A04/29/2024 01:11:51 - INFO - trainer.trainer_mod_2 - v4 Global step: 7100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:27<01:21,  1.65it/s][A
Iteration:  50%|█████     | 134/268 [00:27<01:03,  2.12it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:50,  2.65it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:40,  3.23it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:34,  3.82it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:29,  4.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:26,  4.86it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:24,  5.32it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:22,  5.62it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:21,  5.88it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.04it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:20,  6.18it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.33it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.51it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.51it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.69it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.63it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.58it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.58it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.52it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.60it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.57it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.66it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.37it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.55it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.55it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.52it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.49it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.43it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:11:59,544 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:11:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:11:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:11:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:11:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:12:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:12:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5319354120310512, 'eval_loss': 0.89636177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [951, 1080, 1327, 1360, 1371, 1375, 1067, 841, 539, 688, 400, 422], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51400924, 'remaining_params': 33616676, 'pruned_model_sparsity': 0.6045915669226136, 'expected_sparsity': 0.60208, 'target_sparsity': 0.6, 'step': 7150}


Iteration:  68%|██████▊   | 182/268 [00:36<01:08,  1.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:51,  1.64it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:39,  2.10it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:31,  2.64it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:25,  3.20it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:21,  3.77it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:18,  4.33it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:16,  4.77it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:14,  5.21it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:13,  5.61it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  5.92it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.08it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.20it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.31it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.44it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.45it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.58it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.53it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.49it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.53it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.45it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.27it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.38it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.39it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.44it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.54it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.36it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.38it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.55it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.30it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.28it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.29it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:06,  6.24it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.23it/s][A[INFO|trainer.py:570] 2024-04-29 01:12:09,467 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:12:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:12:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:12:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:12:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:12:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:12:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5391948418977317, 'eval_loss': 0.9386044, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [952, 1082, 1328, 1361, 1372, 1376, 1068, 842, 540, 688, 401, 423], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51189508, 'remaining_params': 33828092, 'pruned_model_sparsity': 0.6021048347636254, 'expected_sparsity': 0.60177, 'target_sparsity': 0.6, 'step': 7200}


Iteration:  87%|████████▋ | 232/268 [00:46<00:28,  1.25it/s][A04/29/2024 01:12:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 7200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:46<00:21,  1.64it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:16,  2.11it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:12,  2.64it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:09,  3.21it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:08,  3.68it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:07,  4.23it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:06,  4.73it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:05,  5.14it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  5.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.76it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  5.99it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.07it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.17it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.11it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.21it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.12it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.24it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.25it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.16it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.25it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.23it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.24it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.40it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.29it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.32it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.32it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.45it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.41it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.53it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.42it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.80it/s][A04/29/2024 01:12:17 - INFO - trainer.trainer_mod_2 - Epoch 26 finished. Took 52.36 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  27%|██▋       | 27/100 [23:51<1:04:32, 53.05s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.40it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.44it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.29it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.39it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.31it/s][A[INFO|trainer.py:570] 2024-04-29 01:12:19,452 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:12:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:12:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:12:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:12:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:12:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:12:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5285368344613508, 'eval_loss': 0.927531, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [954, 1084, 1331, 1363, 1374, 1378, 1069, 844, 543, 691, 403, 425], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51160400, 'remaining_params': 33857200, 'pruned_model_sparsity': 0.6017624585968082, 'expected_sparsity': 0.60105, 'target_sparsity': 0.6, 'step': 7250}


Iteration:   5%|▌         | 14/268 [00:04<03:24,  1.24it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:34,  1.64it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:59,  2.11it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:34,  2.67it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:17,  3.24it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:05,  3.83it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:56,  4.40it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:49,  4.95it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:46,  5.28it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:43,  5.62it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.87it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:41,  5.89it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:39,  6.09it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:39,  6.15it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.17it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.28it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.18it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.28it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.49it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.33it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.56it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.33it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.56it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.43it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.51it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.44it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.48it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.48it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.51it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:33,  6.19it/s][A[INFO|trainer.py:570] 2024-04-29 01:12:29,362 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:12:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:12:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:12:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:12:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:12:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:12:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5339501336198276, 'eval_loss': 0.93213445, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [957, 1087, 1333, 1365, 1376, 1381, 1071, 847, 547, 694, 406, 428], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50927536, 'remaining_params': 34090064, 'pruned_model_sparsity': 0.5990234492622704, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 7300}


Iteration:  24%|██▍       | 64/268 [00:14<02:44,  1.24it/s][A04/29/2024 01:12:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 7300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:14<02:03,  1.65it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:35,  2.12it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:15,  2.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:01,  3.24it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:52,  3.81it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:45,  4.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:40,  4.82it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:37,  5.29it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:34,  5.59it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:33,  5.73it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:32,  5.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:31,  6.01it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:31,  6.15it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:30,  6.24it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.49it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.50it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:27,  6.65it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:27,  6.62it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.41it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.29it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.49it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.48it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.42it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.58it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.57it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.48it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.22it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.30it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.45it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.31it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.26it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.43it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.55it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.62it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.57it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.48it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 01:12:39,259 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:12:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:12:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:12:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:12:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 01:12:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:12:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5496311083440725, 'eval_loss': 0.9061847, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [959, 1089, 1335, 1368, 1378, 1382, 1073, 849, 551, 697, 409, 431], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50896896, 'remaining_params': 34120704, 'pruned_model_sparsity': 0.5986630532971996, 'expected_sparsity': 0.59919, 'target_sparsity': 0.6, 'step': 7350}


Iteration:  43%|████▎     | 114/268 [00:24<02:03,  1.25it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<01:33,  1.64it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<01:11,  2.12it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:57,  2.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:46,  3.20it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:39,  3.78it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:33,  4.37it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:30,  4.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:27,  5.23it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:26,  5.56it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:24,  5.83it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:23,  6.05it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:23,  6.11it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.33it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.22it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.38it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.41it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.32it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.35it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.45it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.52it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.40it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.33it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.38it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.42it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.46it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.31it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:18,  6.09it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.21it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.36it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.40it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.57it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:15,  6.64it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.59it/s][A[INFO|trainer.py:570] 2024-04-29 01:12:49,180 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:12:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:12:49 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:12:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:12:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:12:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:12:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5520922661403441, 'eval_loss': 0.92192054, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [961, 1091, 1337, 1369, 1379, 1384, 1075, 850, 553, 698, 410, 432], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50873916, 'remaining_params': 34143684, 'pruned_model_sparsity': 0.5983927563233966, 'expected_sparsity': 0.59869, 'target_sparsity': 0.6, 'step': 7400}


Iteration:  61%|██████    | 164/268 [00:34<01:22,  1.25it/s][A04/29/2024 01:12:51 - INFO - trainer.trainer_mod_2 - v4 Global step: 7400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:34<01:02,  1.66it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:47,  2.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:37,  2.70it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:30,  3.25it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:25,  3.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:23,  4.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:20,  4.75it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:18,  5.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:17,  5.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:16,  5.80it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:15,  5.94it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.14it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.12it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.31it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.42it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.45it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.47it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.51it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.53it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.50it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.50it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.52it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.60it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.51it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.55it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.50it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.43it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.38it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.42it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:12:59,057 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:12:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:12:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:12:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:12:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:13:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:13:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5599279872250126, 'eval_loss': 0.8887545, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [962, 1092, 1338, 1371, 1380, 1384, 1075, 850, 553, 697, 409, 430], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50864724, 'remaining_params': 34152876, 'pruned_model_sparsity': 0.5982846375338753, 'expected_sparsity': 0.59863, 'target_sparsity': 0.6, 'step': 7450}


Iteration:  80%|███████▉  | 214/268 [00:43<00:43,  1.25it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:32,  1.65it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:24,  2.12it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:19,  2.66it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:15,  3.26it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:12,  3.83it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:10,  4.38it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:10,  4.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:09,  5.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:08,  5.42it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  5.65it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  5.81it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:07,  6.00it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.08it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.22it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.37it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.32it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.52it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.40it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.45it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.33it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.43it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.45it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.20it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.32it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.49it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.46it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:13:09,006 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:13:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:13:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:13:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:13:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:13:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:13:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.543216061185355, 'eval_loss': 0.9128843, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [962, 1092, 1339, 1371, 1380, 1384, 1075, 850, 550, 693, 405, 426], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50867788, 'remaining_params': 34149812, 'pruned_model_sparsity': 0.5983206771303824, 'expected_sparsity': 0.59902, 'target_sparsity': 0.6, 'step': 7500}


Iteration:  99%|█████████▊| 264/268 [00:53<00:03,  1.25it/s][A04/29/2024 01:13:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 7500, Alignment: tensor([ 1,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:54<00:01,  1.64it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  2.11it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  2.64it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  3.31it/s][A04/29/2024 01:13:11 - INFO - trainer.trainer_mod_2 - Epoch 27 finished. Took 54.49 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  28%|██▊       | 28/100 [24:46<1:04:10, 53.48s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.35it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.51it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.51it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.31it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.57it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:38,  6.57it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.58it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:41,  6.14it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.24it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.37it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:40,  6.14it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.30it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.30it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:39,  6.29it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:39,  6.20it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.28it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.29it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:38,  6.35it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.50it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.50it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.37it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:38,  6.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:37,  6.37it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.32it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.51it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.44it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.38it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.42it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.47it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:33,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 01:13:18,918 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:13:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:13:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:13:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:13:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:13:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:13:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5340375668019066, 'eval_loss': 0.9335118, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [961, 1091, 1339, 1371, 1380, 1383, 1074, 848, 546, 688, 400, 421], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 50883108, 'remaining_params': 34134492, 'pruned_model_sparsity': 0.5985008751129178, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 7550}


Iteration:  17%|█▋        | 46/268 [00:09<02:56,  1.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<02:14,  1.65it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:43,  2.12it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:22,  2.64it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:07,  3.22it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:56,  3.81it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:49,  4.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:44,  4.85it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:40,  5.25it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:37,  5.65it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:35,  5.89it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:34,  6.10it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.26it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.27it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.41it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.54it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.64it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.64it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.59it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.58it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.40it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.38it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:31,  6.25it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.50it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.55it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.68it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.66it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.51it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.52it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.39it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:29,  6.28it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.42it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.55it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.46it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:28,  6.36it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.40it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:27,  6.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:27,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:13:28,775 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:13:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:13:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:13:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:13:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:13:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:13:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5393878269002617, 'eval_loss': 0.9537045, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [960, 1090, 1338, 1370, 1379, 1383, 1074, 847, 542, 683, 395, 418], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51290620, 'remaining_params': 33726980, 'pruned_model_sparsity': 0.6032941414483589, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 7600}


Iteration:  36%|███▌      | 96/268 [00:19<02:17,  1.25it/s][A04/29/2024 01:13:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 7600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:19<01:43,  1.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<01:19,  2.14it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:03,  2.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:51,  3.25it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:43,  3.83it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:38,  4.36it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:33,  4.89it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:30,  5.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:29,  5.55it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:27,  5.89it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:26,  6.19it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:25,  6.29it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.28it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.50it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.42it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.50it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.53it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.46it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.52it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.51it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.51it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.54it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.53it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.42it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.42it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.52it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.51it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.53it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.53it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.56it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.53it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.39it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.53it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.49it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.50it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:13:38,581 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:13:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:13:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:13:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:13:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 01:13:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:13:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5395109128667314, 'eval_loss': 0.9371874, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [960, 1091, 1338, 1371, 1379, 1383, 1074, 847, 540, 678, 391, 417], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51290620, 'remaining_params': 33726980, 'pruned_model_sparsity': 0.6032941414483589, 'expected_sparsity': 0.60082, 'target_sparsity': 0.6, 'step': 7650}


Iteration:  54%|█████▍    | 146/268 [00:29<01:42,  1.19it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<01:16,  1.58it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:58,  2.04it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:46,  2.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:37,  3.15it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:31,  3.73it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:27,  4.24it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:24,  4.73it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:22,  5.11it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:20,  5.41it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:19,  5.60it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:18,  5.87it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:18,  6.09it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.14it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.28it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.24it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.42it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.41it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.44it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.54it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.59it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.50it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.47it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.55it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.56it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.64it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.40it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.34it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.42it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.48it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:13:48,585 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:13:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:13:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:13:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:13:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:13:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:13:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5391256846157523, 'eval_loss': 0.91735995, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [961, 1091, 1339, 1371, 1379, 1384, 1074, 847, 539, 676, 390, 416], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51287556, 'remaining_params': 33730044, 'pruned_model_sparsity': 0.6032581018518518, 'expected_sparsity': 0.60088, 'target_sparsity': 0.6, 'step': 7700}


Iteration:  73%|███████▎  | 196/268 [00:38<00:57,  1.25it/s][A04/29/2024 01:13:50 - INFO - trainer.trainer_mod_2 - v4 Global step: 7700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:39<00:43,  1.64it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:33,  2.12it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:25,  2.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:21,  3.21it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:17,  3.77it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:15,  4.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:13,  4.80it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:12,  5.12it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:11,  5.46it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  5.66it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  5.90it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.07it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.12it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.36it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.42it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.43it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.40it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.30it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.47it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.50it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.63it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.57it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.47it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.48it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.40it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.39it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.34it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.24it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.51it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.51it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.35it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.27it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.27it/s][A[INFO|trainer.py:570] 2024-04-29 01:13:58,534 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:13:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:13:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:13:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:13:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:14:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:14:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5274611768595587, 'eval_loss': 0.89122474, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [962, 1093, 1341, 1372, 1381, 1385, 1076, 848, 540, 677, 389, 416], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.60052, 'target_sparsity': 0.6, 'step': 7750}


Iteration:  92%|█████████▏| 246/268 [00:48<00:17,  1.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:12,  1.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:09,  2.11it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:07,  2.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:05,  3.20it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:04,  3.78it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:03,  4.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:03,  4.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  5.34it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  5.68it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.85it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.03it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.26it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.36it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.47it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.49it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.86it/s][A04/29/2024 01:14:04 - INFO - trainer.trainer_mod_2 - Epoch 28 finished. Took 52.36 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  29%|██▉       | 29/100 [25:38<1:02:53, 53.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.36it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.57it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.42it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.34it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.32it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.41it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.46it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.51it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.60it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.55it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.42it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.54it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.56it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.56it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.58it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.57it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.48it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.41it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:14:08,430 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:14:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:14:08 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:14:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:14:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:14:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:14:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.547116568580723, 'eval_loss': 0.8904467, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [964, 1094, 1343, 1374, 1383, 1387, 1076, 848, 541, 677, 389, 417], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.6002, 'target_sparsity': 0.6, 'step': 7800}


Iteration:  10%|█         | 28/268 [00:06<03:11,  1.25it/s][A04/29/2024 01:14:10 - INFO - trainer.trainer_mod_2 - v4 Global step: 7800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:25,  1.64it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:53,  2.10it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:30,  2.63it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:13,  3.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:02,  3.76it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:54,  4.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:48,  4.79it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:45,  5.07it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:42,  5.39it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:40,  5.68it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:38,  6.01it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.18it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.16it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.21it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.29it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.34it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.43it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.26it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.26it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.35it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.29it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.37it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.42it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.45it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.36it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.38it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.25it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.36it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.45it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.50it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:14:18,415 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:14:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:14:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:14:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:14:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:14:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:14:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5468625515611443, 'eval_loss': 0.95071554, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [966, 1096, 1345, 1376, 1384, 1387, 1077, 851, 542, 679, 390, 417], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51031712, 'remaining_params': 33985888, 'pruned_model_sparsity': 0.600248795543511, 'expected_sparsity': 0.59974, 'target_sparsity': 0.6, 'step': 7850}


Iteration:  29%|██▉       | 78/268 [00:16<02:32,  1.25it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:54,  1.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<01:28,  2.12it/s][A
Iteration:  30%|███       | 81/268 [00:16<01:10,  2.66it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:57,  3.23it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:48,  3.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:42,  4.31it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:37,  4.88it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:34,  5.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:32,  5.60it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:30,  5.85it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:29,  6.07it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.15it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.17it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.19it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.30it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.38it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.34it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.20it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.40it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.38it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.48it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.58it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.57it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.40it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.43it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.57it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.45it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.54it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.53it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.54it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.61it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.57it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.52it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:14:28,277 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:14:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:14:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:14:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:14:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:14:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:14:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5391256846157523, 'eval_loss': 0.8957025, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [967, 1096, 1346, 1377, 1386, 1388, 1078, 851, 543, 678, 389, 417], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51019456, 'remaining_params': 33998144, 'pruned_model_sparsity': 0.6001046371574826, 'expected_sparsity': 0.59958, 'target_sparsity': 0.6, 'step': 7900}


Iteration:  48%|████▊     | 128/268 [00:26<01:51,  1.26it/s][A04/29/2024 01:14:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 7900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:26<01:24,  1.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<01:04,  2.13it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:51,  2.68it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:41,  3.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:35,  3.80it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:30,  4.35it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:27,  4.78it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:25,  5.21it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:23,  5.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:22,  5.78it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:22,  5.73it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:22,  5.79it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:21,  6.02it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.10it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.19it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.28it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.38it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.61it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.44it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.18it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.21it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.35it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.42it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.48it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.54it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.44it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.29it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.32it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.39it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.45it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.36it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.39it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.27it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:14:38,235 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:14:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:14:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:14:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:14:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:14:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:14:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5287745826239029, 'eval_loss': 0.9018661, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [967, 1097, 1347, 1378, 1387, 1389, 1078, 851, 542, 676, 388, 416], 'head_nums': [11, 7, 7, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51209424, 'remaining_params': 33808176, 'pruned_model_sparsity': 0.6023390921409214, 'expected_sparsity': 0.5995, 'target_sparsity': 0.6, 'step': 7950}


Iteration:  66%|██████▋   | 178/268 [00:36<01:12,  1.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:54,  1.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:41,  2.13it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:32,  2.68it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:26,  3.28it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:22,  3.85it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:19,  4.40it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:16,  4.90it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:15,  5.34it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:14,  5.65it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:13,  5.81it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.08it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.20it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.37it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.28it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.34it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.42it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.49it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.62it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.43it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.49it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.62it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.45it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.43it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.31it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.24it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.41it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.38it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.29it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.33it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.37it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.02it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.10it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.23it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.20it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.10it/s][A[INFO|trainer.py:570] 2024-04-29 01:14:48,173 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:14:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:14:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:14:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:14:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:14:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:14:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5598239422810317, 'eval_loss': 0.87571496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [968, 1098, 1348, 1379, 1387, 1390, 1078, 850, 541, 674, 386, 415], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51400924, 'remaining_params': 33616676, 'pruned_model_sparsity': 0.6045915669226136, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 8000}


Iteration:  85%|████████▌ | 228/268 [00:46<00:32,  1.24it/s][A04/29/2024 01:14:50 - INFO - trainer.trainer_mod_2 - v4 Global step: 8000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:46<00:23,  1.64it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:18,  2.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:13,  2.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:11,  3.21it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:09,  3.80it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:07,  4.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:06,  4.81it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:06,  5.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  5.62it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:05,  5.98it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.01it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.18it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.29it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.27it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.37it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.43it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.41it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.42it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.47it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.44it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.48it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.41it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.34it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.37it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.77it/s][A04/29/2024 01:14:56 - INFO - trainer.trainer_mod_2 - Epoch 29 finished. Took 52.36 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  30%|███       | 30/100 [26:30<1:01:43, 52.91s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.20it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.27it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.60it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:14:58,020 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:14:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:14:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:14:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:14:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:15:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:15:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5521069582827846, 'eval_loss': 0.88840497, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [968, 1098, 1349, 1379, 1387, 1390, 1078, 850, 539, 672, 383, 414], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51598552, 'remaining_params': 33419048, 'pruned_model_sparsity': 0.60691612089732, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 8050}


Iteration:   4%|▎         | 10/268 [00:03<03:30,  1.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:37,  1.63it/s][A
Iteration:   4%|▍         | 12/268 [00:03<02:00,  2.12it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:35,  2.67it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:18,  3.26it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:06,  3.81it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:57,  4.42it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:51,  4.88it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:47,  5.27it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:44,  5.62it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:41,  5.94it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:40,  6.14it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.26it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.35it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.31it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:38,  6.36it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.43it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.47it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.49it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.47it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.40it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.48it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.47it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.51it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.38it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.14it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.16it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.26it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.33it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.49it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.61it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.66it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.65it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.68it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.63it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.59it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.59it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.67it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.48it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:15:07,828 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:15:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:15:07 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:15:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:15:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:15:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:15:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5469587051515413, 'eval_loss': 0.9318661, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [968, 1099, 1350, 1379, 1388, 1390, 1078, 850, 538, 668, 381, 412], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51595488, 'remaining_params': 33422112, 'pruned_model_sparsity': 0.6068800813008131, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 8100}


Iteration:  22%|██▏       | 60/268 [00:13<02:46,  1.25it/s][A04/29/2024 01:15:10 - INFO - trainer.trainer_mod_2 - v4 Global step: 8100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:13<02:05,  1.65it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:36,  2.14it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<01:17,  2.64it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:03,  3.20it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:54,  3.75it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:46,  4.31it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:41,  4.81it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:38,  5.23it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:35,  5.55it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:33,  5.83it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:32,  6.03it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:31,  6.24it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.29it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.42it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.47it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.24it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.18it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:30,  6.11it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.21it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.29it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.29it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.23it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.16it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.41it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.49it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.31it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.28it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.35it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.40it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.40it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.33it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.44it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.47it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:15:17,779 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:15:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:15:17 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:15:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:15:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:15:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:15:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5416549448511832, 'eval_loss': 0.9210358, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [968, 1100, 1351, 1379, 1388, 1391, 1078, 850, 536, 666, 378, 411], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51593956, 'remaining_params': 33423644, 'pruned_model_sparsity': 0.6068620615025595, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 8150}


Iteration:  41%|████      | 110/268 [00:23<02:06,  1.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<01:35,  1.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<01:13,  2.13it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:57,  2.68it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:46,  3.28it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:39,  3.85it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:34,  4.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:31,  4.84it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:28,  5.18it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:27,  5.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:25,  5.76it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:24,  6.07it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.22it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.28it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.34it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.53it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.55it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.55it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.40it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:21,  6.38it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.42it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.35it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.32it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.35it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.32it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.56it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.62it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.55it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.54it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.45it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.54it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.56it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:16,  6.68it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:16,  6.63it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.56it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:15:27,601 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:15:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:15:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:15:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:15:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:15:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:15:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5486729244194056, 'eval_loss': 0.9007401, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [969, 1101, 1352, 1380, 1389, 1392, 1079, 850, 536, 664, 376, 410], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51583232, 'remaining_params': 33434368, 'pruned_model_sparsity': 0.6067359229147847, 'expected_sparsity': 0.60019, 'target_sparsity': 0.6, 'step': 8200}


Iteration:  60%|█████▉    | 160/268 [00:33<01:26,  1.25it/s][A04/29/2024 01:15:29 - INFO - trainer.trainer_mod_2 - v4 Global step: 8200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:33<01:05,  1.64it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:50,  2.12it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:39,  2.66it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:32,  3.22it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:27,  3.74it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:24,  4.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:21,  4.74it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:19,  5.18it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:17,  5.54it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:16,  5.77it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:16,  5.92it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.07it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.07it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.20it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.37it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.54it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.36it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.40it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.30it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.41it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.49it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.48it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.30it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.37it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.37it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.43it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:10,  5.99it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.01it/s][A[INFO|trainer.py:570] 2024-04-29 01:15:37,612 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:15:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:15:37 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:15:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:15:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:15:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:15:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5543972545286807, 'eval_loss': 0.9187734, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [970, 1101, 1354, 1381, 1389, 1392, 1079, 851, 535, 662, 375, 409], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51577104, 'remaining_params': 33440496, 'pruned_model_sparsity': 0.6066638437217705, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 8250}


Iteration:  78%|███████▊  | 210/268 [00:43<00:46,  1.24it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:34,  1.64it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:26,  2.11it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:20,  2.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:16,  3.19it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:14,  3.76it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:12,  4.25it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:10,  4.66it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:09,  5.16it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  5.50it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:08,  5.77it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  5.97it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  5.95it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.20it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  6.27it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.36it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.33it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.29it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.28it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.32it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.41it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.18it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.37it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.34it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.32it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.44it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.39it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.47it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.40it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.58it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.49it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.39it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.44it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.26it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:15:47,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:15:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:15:47 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:15:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:15:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:15:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:15:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5472224847569017, 'eval_loss': 0.92279136, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [971, 1103, 1355, 1382, 1391, 1393, 1079, 850, 535, 660, 374, 408], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51566380, 'remaining_params': 33451220, 'pruned_model_sparsity': 0.6065377051339957, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 8300}


Iteration:  97%|█████████▋| 260/268 [00:53<00:06,  1.25it/s][A04/29/2024 01:15:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 8300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:53<00:04,  1.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:02,  2.12it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  2.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:01,  3.21it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  3.79it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  4.30it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  4.78it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  5.42it/s][A04/29/2024 01:15:50 - INFO - trainer.trainer_mod_2 - Epoch 30 finished. Took 54.48 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  31%|███       | 31/100 [27:25<1:01:23, 53.38s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.46it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:43,  6.02it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:42,  6.14it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:42,  6.18it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.30it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.32it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.47it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.36it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.32it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.51it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.58it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.57it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.40it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.35it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.30it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.39it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.40it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.46it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.40it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.41it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.65it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.62it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.62it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.59it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.69it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.67it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:34,  6.70it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.64it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 01:15:57,441 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:15:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:15:57 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:15:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:15:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:15:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:15:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.529144545456451, 'eval_loss': 0.9294153, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [972, 1104, 1356, 1383, 1391, 1393, 1080, 850, 535, 659, 374, 407], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51754816, 'remaining_params': 33262784, 'pruned_model_sparsity': 0.608754140319181, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 8350}


Iteration:  16%|█▌        | 42/268 [00:08<03:00,  1.26it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:15,  1.66it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:45,  2.13it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<01:23,  2.67it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:08,  3.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:57,  3.83it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:50,  4.38it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:45,  4.84it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:41,  5.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:39,  5.52it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:36,  5.89it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:35,  6.04it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:35,  6.09it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.58it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.55it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.65it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.59it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.30it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.50it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:28,  6.67it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.34it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.35it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.41it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.37it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.51it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:16:07,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:16:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:16:07 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:16:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:16:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:16:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:16:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.537031102939668, 'eval_loss': 0.905151, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [973, 1105, 1357, 1383, 1392, 1394, 1080, 850, 535, 658, 373, 406], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51747156, 'remaining_params': 33270444, 'pruned_model_sparsity': 0.6086640413279133, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 8400}


Iteration:  34%|███▍      | 92/268 [00:18<02:20,  1.26it/s][A04/29/2024 01:16:09 - INFO - trainer.trainer_mod_2 - v4 Global step: 8400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:18<01:45,  1.66it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<01:21,  2.13it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:05,  2.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:53,  3.21it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:45,  3.78it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:39,  4.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:34,  4.83it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:31,  5.25it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:30,  5.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:29,  5.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:28,  5.82it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:27,  5.94it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.12it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:26,  6.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.31it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:25,  6.39it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.45it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.46it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.48it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.40it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.25it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.40it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.42it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.41it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.43it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.43it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.40it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.32it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.41it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.37it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.52it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.55it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.53it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.51it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.49it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.51it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:20,  6.38it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:16:17,222 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:16:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:16:17 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:16:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:16:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:16:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:16:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5458278835785596, 'eval_loss': 0.89381987, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [973, 1105, 1358, 1384, 1393, 1395, 1080, 850, 535, 656, 372, 405], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51741028, 'remaining_params': 33276572, 'pruned_model_sparsity': 0.6085919621348991, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 8450}


Iteration:  53%|█████▎    | 142/268 [00:28<01:41,  1.25it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<01:15,  1.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:58,  2.11it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:46,  2.65it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:38,  3.19it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:32,  3.76it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:27,  4.32it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:24,  4.81it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:22,  5.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:21,  5.56it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:19,  5.85it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:19,  6.02it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.09it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.32it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.31it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.35it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.38it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.22it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.33it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.36it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.48it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.36it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.25it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.42it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.44it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.44it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.19it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.29it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.34it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.49it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.36it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.41it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.50it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.60it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.50it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.50it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:16:27,151 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:16:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:16:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:16:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:16:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:16:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:16:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5339501336198276, 'eval_loss': 0.9364542, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [974, 1106, 1359, 1384, 1393, 1396, 1080, 850, 534, 654, 371, 405], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51736432, 'remaining_params': 33281168, 'pruned_model_sparsity': 0.6085379027401385, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 8500}


Iteration:  72%|███████▏  | 192/268 [00:38<01:00,  1.25it/s][A04/29/2024 01:16:29 - INFO - trainer.trainer_mod_2 - v4 Global step: 8500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:38<00:45,  1.65it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:35,  2.10it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:27,  2.64it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:22,  3.21it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:18,  3.80it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:16,  4.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:14,  4.83it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:12,  5.23it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:12,  5.58it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:11,  5.71it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:11,  5.87it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  5.92it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.07it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  6.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.20it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.23it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.22it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.18it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.27it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.37it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.47it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.47it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.42it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.24it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.23it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.34it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.42it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.43it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.39it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.45it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.50it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.32it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.44it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.39it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 01:16:37,117 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:16:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:16:37 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:16:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:16:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:16:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:16:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5482488790250747, 'eval_loss': 0.8836991, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [975, 1107, 1360, 1384, 1394, 1397, 1081, 851, 535, 653, 369, 404], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51724176, 'remaining_params': 33293424, 'pruned_model_sparsity': 0.6083937443541102, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 8550}


Iteration:  90%|█████████ | 242/268 [00:48<00:20,  1.25it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:15,  1.64it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:11,  2.13it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:08,  2.64it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:06,  3.21it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:05,  3.79it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:04,  4.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  4.78it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  5.60it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  5.75it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  5.82it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.04it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.26it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.45it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.44it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.41it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.46it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.81it/s][A04/29/2024 01:16:43 - INFO - trainer.trainer_mod_2 - Epoch 31 finished. Took 52.3 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  32%|███▏      | 32/100 [28:17<1:00:07, 53.06s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.24it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.38it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.43it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.47it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.45it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.48it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.42it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.42it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.37it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.40it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.57it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.59it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.38it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.35it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 01:16:46,981 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:16:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:16:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:16:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:16:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 01:16:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:16:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5452100835559165, 'eval_loss': 0.86034304, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [975, 1108, 1361, 1385, 1395, 1398, 1082, 851, 535, 651, 368, 404], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51714984, 'remaining_params': 33302616, 'pruned_model_sparsity': 0.608285625564589, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 8600}


Iteration:   9%|▉         | 24/268 [00:05<03:14,  1.25it/s][A04/29/2024 01:16:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 8600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:06<02:26,  1.65it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:53,  2.13it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:30,  2.66it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:14,  3.23it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:02,  3.82it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:53,  4.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:48,  4.85it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:45,  5.19it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:42,  5.54it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:40,  5.83it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:38,  6.05it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.24it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.31it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.38it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.26it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.27it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.37it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.31it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.31it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.31it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.28it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.36it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.29it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.25it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.48it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.52it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.35it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.41it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.46it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.45it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.46it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.58it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.58it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.72it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.68it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.59it/s][A[INFO|trainer.py:570] 2024-04-29 01:16:56,868 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:16:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:16:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:16:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:16:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:16:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:16:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5393878269002617, 'eval_loss': 0.89513516, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1108, 1361, 1386, 1395, 1398, 1082, 851, 533, 649, 366, 403], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51714984, 'remaining_params': 33302616, 'pruned_model_sparsity': 0.608285625564589, 'expected_sparsity': 0.5998, 'target_sparsity': 0.6, 'step': 8650}


Iteration:  28%|██▊       | 74/268 [00:15<02:34,  1.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:56,  1.66it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<01:30,  2.13it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<01:11,  2.68it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:59,  3.19it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:50,  3.78it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:43,  4.34it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:38,  4.81it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:35,  5.24it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:33,  5.60it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:31,  5.87it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:30,  6.03it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:30,  6.02it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.11it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.21it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.40it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.46it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.40it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.37it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.45it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.61it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.57it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.38it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.46it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.39it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.29it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.20it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.30it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.33it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.46it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.44it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:17:06,755 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:17:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:17:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:17:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:17:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:17:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:17:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5250596922747974, 'eval_loss': 0.9006249, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1109, 1362, 1386, 1395, 1397, 1082, 850, 532, 646, 365, 402], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51716516, 'remaining_params': 33301084, 'pruned_model_sparsity': 0.6083036453628425, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 8700}


Iteration:  46%|████▋     | 124/268 [00:25<01:54,  1.26it/s][A04/29/2024 01:17:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 8700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:25<01:26,  1.66it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<01:06,  2.14it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:52,  2.68it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:43,  3.25it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:36,  3.81it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:32,  4.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:28,  4.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:26,  5.12it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:24,  5.50it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:23,  5.77it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:22,  6.00it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.08it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:21,  6.04it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.14it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.27it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.23it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.25it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.42it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.58it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.69it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.54it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.54it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.55it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.64it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.49it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.60it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.45it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.46it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.50it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.47it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.42it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.28it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.39it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 01:17:16,627 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:17:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:17:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:17:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:17:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:17:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:17:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5418980827011334, 'eval_loss': 0.902558, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1109, 1362, 1386, 1395, 1397, 1081, 850, 531, 643, 362, 401], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51719580, 'remaining_params': 33298020, 'pruned_model_sparsity': 0.6083396849593496, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 8750}


Iteration:  65%|██████▍   | 174/268 [00:35<01:14,  1.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:56,  1.66it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:43,  2.13it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:34,  2.62it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:28,  3.19it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:23,  3.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:20,  4.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:18,  4.80it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:16,  5.12it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:15,  5.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:14,  5.77it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  5.97it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.10it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.23it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.32it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.48it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.60it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.51it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.34it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.31it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.49it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.41it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.43it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.55it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.57it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.53it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.45it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.49it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.60it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.56it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:08,  6.05it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.21it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.24it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:17:26,563 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:17:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:17:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:17:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:17:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:17:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:17:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5286156744059349, 'eval_loss': 0.9416848, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [977, 1109, 1362, 1387, 1395, 1397, 1080, 849, 531, 640, 360, 400], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51719580, 'remaining_params': 33298020, 'pruned_model_sparsity': 0.6083396849593496, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 8800}


Iteration:  84%|████████▎ | 224/268 [00:45<00:35,  1.24it/s][A04/29/2024 01:17:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 8800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:45<00:26,  1.64it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:19,  2.11it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:15,  2.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:12,  3.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:10,  3.74it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:08,  4.25it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:07,  4.71it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.19it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:06,  5.59it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  5.86it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.01it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.20it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.29it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.33it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.53it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.58it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.58it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.66it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.63it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.61it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.59it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.68it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.64it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.51it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.58it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.54it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.44it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.39it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.75it/s][A04/29/2024 01:17:35 - INFO - trainer.trainer_mod_2 - Epoch 32 finished. Took 52.2 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  33%|███▎      | 33/100 [29:09<58:57, 52.80s/it]  
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.50it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.68it/s][A[INFO|trainer.py:570] 2024-04-29 01:17:36,361 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:17:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:17:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:17:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:17:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:17:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:17:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5287745826239029, 'eval_loss': 0.9127244, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [977, 1109, 1362, 1387, 1396, 1397, 1079, 848, 530, 637, 359, 398], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51722644, 'remaining_params': 33294956, 'pruned_model_sparsity': 0.6083757245558566, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 8850}


Iteration:   2%|▏         | 6/268 [00:03<03:51,  1.13it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:48,  1.55it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:06,  2.05it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:39,  2.61it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:20,  3.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:07,  3.79it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:59,  4.33it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:53,  4.81it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:48,  5.23it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:45,  5.56it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:43,  5.81it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:41,  6.02it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.18it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:39,  6.25it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:40,  6.18it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.20it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.23it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.31it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.46it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.41it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.43it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.45it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.47it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.42it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.47it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.55it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.55it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.52it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.39it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.47it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.43it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:17:46,243 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:17:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:17:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:17:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:17:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:17:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:17:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5259770638545269, 'eval_loss': 0.9766751, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [978, 1109, 1363, 1388, 1396, 1398, 1079, 849, 530, 635, 358, 398], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51714984, 'remaining_params': 33302616, 'pruned_model_sparsity': 0.608285625564589, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 8900}


Iteration:  21%|██        | 56/268 [00:12<02:49,  1.25it/s][A04/29/2024 01:17:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 8900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:13<02:08,  1.64it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:39,  2.11it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<01:18,  2.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:04,  3.23it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:55,  3.75it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:48,  4.28it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:44,  4.61it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:40,  5.07it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:37,  5.41it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:35,  5.71it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:33,  5.91it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:32,  6.06it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.28it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.36it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.59it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.46it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.29it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.28it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.37it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.27it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.36it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.27it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.35it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.49it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.30it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.41it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.30it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.45it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.46it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.57it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 01:17:56,162 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:17:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:17:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:17:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:17:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:17:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:17:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5523181756655187, 'eval_loss': 0.9036212, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [978, 1110, 1364, 1390, 1397, 1399, 1080, 849, 531, 633, 359, 397], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51702728, 'remaining_params': 33314872, 'pruned_model_sparsity': 0.6081414671785607, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 8950}


Iteration:  40%|███▉      | 106/268 [00:22<02:08,  1.26it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<01:36,  1.66it/s][A
Iteration:  40%|████      | 108/268 [00:23<01:14,  2.15it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:59,  2.69it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:48,  3.27it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:40,  3.84it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:35,  4.39it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:31,  4.86it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:29,  5.28it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:26,  5.71it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:25,  5.94it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:25,  6.03it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:24,  6.17it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:24,  6.14it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:25,  5.83it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:24,  6.04it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.18it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.29it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.30it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.25it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.22it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.17it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.20it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.22it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.34it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.32it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.40it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.42it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.43it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.45it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.47it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.40it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.39it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.27it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.33it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.30it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.40it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.51it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:18:06,105 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:18:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:18:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:18:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:18:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:18:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:18:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.543216061185355, 'eval_loss': 0.92624456, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [979, 1110, 1365, 1391, 1397, 1399, 1080, 849, 531, 631, 358, 397], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51698132, 'remaining_params': 33319468, 'pruned_model_sparsity': 0.6080874077838001, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 9000}


Iteration:  58%|█████▊    | 156/268 [00:32<01:29,  1.26it/s][A04/29/2024 01:18:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 9000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:32<01:07,  1.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:51,  2.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:40,  2.68it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:33,  3.25it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:27,  3.82it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:24,  4.36it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:21,  4.86it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:19,  5.31it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:18,  5.64it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:17,  5.86it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:17,  5.92it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:16,  6.18it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.27it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.35it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.23it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.43it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.40it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.55it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.60it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.70it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.43it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.53it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.42it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.57it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.40it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.32it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.28it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.24it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.34it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.50it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:18:15,990 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:18:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:18:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:18:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:18:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:18:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:18:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.537552563011597, 'eval_loss': 0.90848994, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1111, 1366, 1391, 1398, 1399, 1080, 848, 531, 630, 357, 397], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51693536, 'remaining_params': 33324064, 'pruned_model_sparsity': 0.6080333483890394, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 9050}


Iteration:  77%|███████▋  | 206/268 [00:42<00:49,  1.25it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:37,  1.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:43<00:28,  2.09it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:22,  2.63it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:18,  3.20it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:15,  3.80it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:12,  4.34it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:11,  4.87it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:10,  5.28it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:09,  5.53it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  5.81it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.01it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  6.18it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  6.02it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.18it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.27it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.26it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.34it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.36it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.21it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.13it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.17it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.31it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.32it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.37it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.48it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.42it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.35it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.44it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.64it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.58it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.41it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:18:25,932 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:18:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:18:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:18:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:18:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:18:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:18:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5392823485107089, 'eval_loss': 0.93774253, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1113, 1367, 1392, 1398, 1399, 1080, 848, 531, 628, 357, 396], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51687408, 'remaining_params': 33330192, 'pruned_model_sparsity': 0.6079612691960253, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 9100}


Iteration:  96%|█████████▌| 256/268 [00:52<00:09,  1.26it/s][A04/29/2024 01:18:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 9100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:52<00:06,  1.66it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:04,  2.13it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:03,  2.67it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:02,  3.22it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  3.79it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  4.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  4.80it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.10it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  5.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  5.70it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.95it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.42it/s][A04/29/2024 01:18:29 - INFO - trainer.trainer_mod_2 - Epoch 33 finished. Took 54.48 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  34%|███▍      | 34/100 [30:04<58:37, 53.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:45,  5.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.30it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.50it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.50it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.61it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.61it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.55it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.44it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.33it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.37it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.33it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.41it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.40it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.42it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:39,  6.31it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.29it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.38it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.45it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.39it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.45it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.61it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.37it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.44it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:18:35,830 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:18:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:18:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:18:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:18:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:18:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:18:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5272381739553602, 'eval_loss': 0.92766064, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 1113, 1368, 1393, 1399, 1399, 1080, 848, 531, 626, 356, 396], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51681280, 'remaining_params': 33336320, 'pruned_model_sparsity': 0.6078891900030111, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 9150}


Iteration:  14%|█▍        | 38/268 [00:08<03:04,  1.25it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<02:19,  1.65it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:47,  2.11it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:24,  2.67it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:10,  3.22it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:59,  3.80it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:51,  4.34it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:46,  4.83it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:41,  5.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:39,  5.62it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:37,  5.88it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:36,  5.96it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:35,  6.15it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.24it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.23it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.35it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.28it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.48it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.52it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.46it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.48it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.42it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.55it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.47it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.27it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.33it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.39it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.35it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.48it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.46it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.49it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.48it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.52it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.49it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.61it/s][A[INFO|trainer.py:570] 2024-04-29 01:18:45,713 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:18:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:18:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:18:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:18:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:18:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:18:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5308757570358055, 'eval_loss': 0.9334701, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [982, 1114, 1369, 1394, 1399, 1400, 1081, 849, 532, 623, 354, 394], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51669024, 'remaining_params': 33348576, 'pruned_model_sparsity': 0.6077450316169828, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 9200}


Iteration:  33%|███▎      | 88/268 [00:17<02:23,  1.26it/s][A04/29/2024 01:18:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 9200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:18<01:47,  1.66it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<01:23,  2.14it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:06,  2.67it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:53,  3.27it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:45,  3.83it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:40,  4.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:35,  4.86it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:33,  5.21it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:31,  5.45it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:29,  5.71it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:28,  5.92it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.07it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.19it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.21it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.31it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.45it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.43it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.43it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.46it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.45it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.45it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.29it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.28it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.41it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.34it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.34it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.32it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.30it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.36it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:23,  6.00it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:23,  6.08it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.21it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.35it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.27it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.30it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.10it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:21,  6.30it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.35it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:18:55,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:18:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:18:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:18:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:18:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:18:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:18:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5377587696044389, 'eval_loss': 0.9099116, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 1113, 1370, 1394, 1400, 1401, 1080, 848, 530, 620, 352, 393], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51673620, 'remaining_params': 33343980, 'pruned_model_sparsity': 0.6077990910117435, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 9250}


Iteration:  51%|█████▏    | 138/268 [00:27<01:44,  1.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<01:18,  1.65it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<01:00,  2.13it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:47,  2.65it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:39,  3.21it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:32,  3.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:28,  4.30it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:25,  4.79it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:23,  5.20it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:21,  5.50it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:20,  5.85it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:19,  6.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:19,  6.18it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.19it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.29it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.31it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.51it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:16,  6.52it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.35it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.49it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.48it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.50it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.48it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.41it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.16it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:16,  6.23it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:16,  6.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.24it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.17it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.29it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.42it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.52it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.41it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.42it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.54it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.40it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.32it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:19:05,621 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:19:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:19:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:19:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:19:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:19:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:19:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5327292010480984, 'eval_loss': 0.94090676, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 1113, 1370, 1394, 1399, 1401, 1079, 847, 529, 616, 349, 392], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51679748, 'remaining_params': 33337852, 'pruned_model_sparsity': 0.6078711702047576, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 9300}


Iteration:  70%|███████   | 188/268 [00:37<01:03,  1.26it/s][A04/29/2024 01:19:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 9300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:37<00:47,  1.66it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:36,  2.12it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:28,  2.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:23,  3.21it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:19,  3.80it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:16,  4.37it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:15,  4.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:13,  5.25it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:12,  5.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  5.91it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.16it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.28it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.33it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.43it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.42it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.33it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.27it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.42it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.38it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.39it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.44it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.46it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.51it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.50it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.35it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.43it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.20it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:06,  6.23it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.24it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.30it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.41it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:19:15,537 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:19:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:19:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:19:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:19:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:19:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:19:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5232519323928566, 'eval_loss': 0.9639367, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 1113, 1370, 1393, 1399, 1401, 1078, 847, 529, 613, 347, 391], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51682812, 'remaining_params': 33334788, 'pruned_model_sparsity': 0.6079072098012647, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 9350}


Iteration:  89%|████████▉ | 238/268 [00:47<00:23,  1.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:17,  1.64it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:13,  2.11it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:10,  2.64it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:08,  3.21it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:06,  3.83it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:05,  4.37it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  4.85it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:04,  5.28it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  5.58it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.82it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.95it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.02it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.19it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.37it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.49it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.49it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.36it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.55it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.51it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.53it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.56it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.90it/s][A04/29/2024 01:19:22 - INFO - trainer.trainer_mod_2 - Epoch 34 finished. Took 52.36 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  35%|███▌      | 35/100 [30:56<57:26, 53.02s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.40it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.33it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.38it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.40it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.25it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.33it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.49it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:38,  6.60it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.58it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.61it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.56it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.71it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.66it/s][A[INFO|trainer.py:570] 2024-04-29 01:19:25,352 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:19:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:19:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:19:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:19:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:19:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:19:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.519563286537562, 'eval_loss': 0.9523387, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 1113, 1370, 1394, 1400, 1402, 1079, 848, 529, 610, 345, 390], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51675152, 'remaining_params': 33342448, 'pruned_model_sparsity': 0.607817110809997, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 9400}


Iteration:   7%|▋         | 20/268 [00:05<03:16,  1.26it/s][A04/29/2024 01:19:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 9400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:28,  1.66it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:55,  2.14it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:31,  2.68it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:14,  3.26it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:03,  3.84it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:55,  4.37it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:50,  4.81it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:45,  5.24it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:42,  5.57it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:42,  5.59it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:40,  5.83it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:39,  6.00it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:38,  6.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.43it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:37,  6.04it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.10it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.19it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.35it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.37it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.30it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.33it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.41it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.43it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.37it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.23it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.34it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.39it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.54it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.45it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.27it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:19:35,320 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:19:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:19:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:19:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:19:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:19:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:19:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5382179635494023, 'eval_loss': 0.92739934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [982, 1114, 1370, 1395, 1401, 1401, 1079, 847, 529, 609, 344, 390], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51672088, 'remaining_params': 33345512, 'pruned_model_sparsity': 0.6077810712134899, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 9450}


Iteration:  26%|██▌       | 70/268 [00:15<02:38,  1.25it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<01:59,  1.65it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:32,  2.12it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<01:13,  2.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:59,  3.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:50,  3.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:43,  4.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:40,  4.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:36,  5.20it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:34,  5.47it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:32,  5.77it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:31,  5.91it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:30,  6.08it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:30,  6.15it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.29it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.29it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.36it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.52it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.46it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.37it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.41it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.40it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.34it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.32it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.44it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.49it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.25it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.33it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.32it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.34it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.30it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.40it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.32it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.30it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:19:45,272 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:19:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:19:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:19:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:19:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:19:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:19:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5241612737013471, 'eval_loss': 0.92771167, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [982, 1115, 1371, 1396, 1401, 1402, 1079, 847, 529, 607, 343, 389], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51665960, 'remaining_params': 33351640, 'pruned_model_sparsity': 0.6077089920204758, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 9500}


Iteration:  45%|████▍     | 120/268 [00:25<01:58,  1.25it/s][A04/29/2024 01:19:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 9500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:25<01:29,  1.65it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<01:08,  2.13it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:54,  2.67it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:44,  3.20it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:37,  3.80it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:32,  4.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:29,  4.85it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:26,  5.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:24,  5.58it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:23,  5.82it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  5.99it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:22,  6.07it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:22,  6.13it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.32it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.40it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.56it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.56it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.57it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.56it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.61it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.45it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.49it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.34it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.51it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.52it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.52it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.58it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.59it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.62it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.62it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:19:55,105 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:19:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:19:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:19:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:19:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:19:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:19:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5363967157085073, 'eval_loss': 0.9153704, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1115, 1372, 1396, 1402, 1402, 1079, 847, 530, 605, 342, 389], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51659832, 'remaining_params': 33357768, 'pruned_model_sparsity': 0.6076369128274616, 'expected_sparsity': 0.59993, 'target_sparsity': 0.6, 'step': 9550}


Iteration:  63%|██████▎   | 170/268 [00:34<01:18,  1.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:58,  1.66it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:45,  2.13it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:36,  2.63it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:29,  3.21it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:24,  3.83it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:21,  4.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:19,  4.73it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:17,  5.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:16,  5.40it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:15,  5.69it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:14,  5.99it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:14,  6.08it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.23it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.28it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.27it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.34it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.23it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.24it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.41it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.53it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.64it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.59it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.58it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.56it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.54it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.22it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.28it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.33it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.47it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.61it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:08,  6.67it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.76it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.72it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.59it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.41it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.58it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.54it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:20:04,998 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:20:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:20:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:20:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:20:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:20:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:20:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5450362181686306, 'eval_loss': 0.923992, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1116, 1372, 1397, 1402, 1402, 1079, 847, 530, 603, 341, 389], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51656768, 'remaining_params': 33360832, 'pruned_model_sparsity': 0.6076008732309546, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 9600}


Iteration:  82%|████████▏ | 220/268 [00:44<00:38,  1.25it/s][A04/29/2024 01:20:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 9600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:45<00:28,  1.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:21,  2.13it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:16,  2.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:13,  3.24it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:11,  3.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:09,  4.31it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:08,  4.81it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:07,  5.27it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  5.59it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  5.74it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.97it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.15it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.14it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.17it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.18it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.22it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.21it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.48it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.45it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.29it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.50it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.43it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.37it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.28it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.33it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.51it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.56it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.41it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.43it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.40it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.76it/s][A04/29/2024 01:20:14 - INFO - trainer.trainer_mod_2 - Epoch 35 finished. Took 52.3 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  36%|███▌      | 36/100 [31:48<56:19, 52.80s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 01:20:14,888 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:20:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:20:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:20:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:20:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:20:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:20:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5325167447166456, 'eval_loss': 0.88590443, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1116, 1373, 1397, 1402, 1403, 1079, 847, 529, 600, 340, 388], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51655236, 'remaining_params': 33362364, 'pruned_model_sparsity': 0.607582853432701, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 9650}


Iteration:   1%|          | 2/268 [00:02<06:16,  1.41s/it][A
Iteration:   1%|          | 3/268 [00:02<03:43,  1.19it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:30,  1.75it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:50,  2.38it/s][A
Iteration:   2%|▏         | 6/268 [00:03<01:26,  3.04it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:10,  3.69it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:00,  4.27it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:54,  4.79it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:49,  5.21it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:46,  5.57it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:43,  5.84it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:42,  5.94it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:41,  6.08it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:40,  6.19it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:39,  6.31it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.30it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.24it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:39,  6.32it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.39it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.37it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.41it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.55it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.42it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.49it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.42it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.38it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.26it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.58it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.55it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.49it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.49it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.31it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.52it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.38it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.60it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.55it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.55it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 01:20:24,777 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:20:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:20:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:20:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:20:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:20:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:20:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5298746530730193, 'eval_loss': 0.9423719, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1116, 1373, 1397, 1403, 1403, 1079, 847, 529, 597, 338, 387], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51653704, 'remaining_params': 33363896, 'pruned_model_sparsity': 0.6075648336344475, 'expected_sparsity': 0.59995, 'target_sparsity': 0.6, 'step': 9700}


Iteration:  19%|█▉        | 52/268 [00:12<02:52,  1.25it/s][A04/29/2024 01:20:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 9700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:12<02:09,  1.66it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:40,  2.14it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:19,  2.68it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:05,  3.22it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:55,  3.77it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:48,  4.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:43,  4.78it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:40,  5.19it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:37,  5.49it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:35,  5.77it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:35,  5.82it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:34,  5.94it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:33,  6.12it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:31,  6.33it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.39it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:30,  6.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:32,  6.14it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:31,  6.15it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.28it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.42it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.50it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.47it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.40it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.48it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.43it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.47it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:27,  6.62it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.51it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.55it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.64it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.60it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:26,  6.62it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:26,  6.61it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.58it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.70it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.67it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.58it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:20:34,632 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:20:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:20:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:20:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:20:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:20:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:20:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5160691863640823, 'eval_loss': 0.9920686, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1116, 1374, 1397, 1402, 1402, 1078, 846, 528, 594, 336, 387], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51659832, 'remaining_params': 33357768, 'pruned_model_sparsity': 0.6076369128274616, 'expected_sparsity': 0.59991, 'target_sparsity': 0.6, 'step': 9750}


Iteration:  38%|███▊      | 102/268 [00:22<02:11,  1.26it/s][A
Iteration:  38%|███▊      | 103/268 [00:22<01:39,  1.66it/s][A
Iteration:  39%|███▉      | 104/268 [00:22<01:16,  2.13it/s][A
Iteration:  39%|███▉      | 105/268 [00:22<01:00,  2.69it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<00:50,  3.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<00:42,  3.79it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:36,  4.34it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:33,  4.73it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:30,  5.14it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:28,  5.44it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:27,  5.75it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:25,  5.97it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:25,  6.13it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:24,  6.26it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:24,  6.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:24,  6.21it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:24,  6.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:22,  6.49it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:22,  6.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:21,  6.57it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.60it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.54it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.26it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.32it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.27it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.19it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.33it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.38it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.35it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.47it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.59it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.36it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.45it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:20:44,518 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:20:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:20:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:20:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:20:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:20:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:20:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5286869837598177, 'eval_loss': 0.94342464, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1115, 1374, 1397, 1402, 1402, 1077, 845, 528, 590, 334, 386], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51664428, 'remaining_params': 33353172, 'pruned_model_sparsity': 0.6076909722222222, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 9800}


Iteration:  57%|█████▋    | 152/268 [00:32<01:32,  1.26it/s][A04/29/2024 01:20:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 9800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:32<01:09,  1.66it/s][A
Iteration:  57%|█████▋    | 154/268 [00:32<00:53,  2.13it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<00:42,  2.67it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:34,  3.27it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:29,  3.83it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:25,  4.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:22,  4.85it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:20,  5.32it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:18,  5.65it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:17,  5.93it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:17,  6.08it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:16,  6.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:16,  6.31it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:16,  6.09it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:16,  6.22it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:14,  6.55it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:14,  6.47it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.52it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.35it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.47it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.42it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.44it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.41it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.43it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.48it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.38it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.31it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.46it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.40it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.37it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:20:54,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:20:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:20:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:20:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:20:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 01:20:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:20:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5472224847569017, 'eval_loss': 0.9359244, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1115, 1374, 1397, 1402, 1402, 1077, 845, 527, 586, 332, 385], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51665960, 'remaining_params': 33351640, 'pruned_model_sparsity': 0.6077089920204758, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 9850}


Iteration:  75%|███████▌  | 202/268 [00:41<00:52,  1.25it/s][A
Iteration:  76%|███████▌  | 203/268 [00:42<00:39,  1.65it/s][A
Iteration:  76%|███████▌  | 204/268 [00:42<00:30,  2.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:42<00:23,  2.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:19,  3.23it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:16,  3.81it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:13,  4.36it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:12,  4.84it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:11,  5.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:10,  5.56it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:09,  5.81it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:09,  6.07it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:08,  6.15it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:08,  6.24it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  6.17it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.18it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  6.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.18it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.22it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.39it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:06,  6.44it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.56it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.58it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.64it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.71it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.60it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.69it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.38it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.24it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.42it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.46it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.51it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:21:04,266 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:21:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:21:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:21:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:21:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:21:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:21:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5469587051515413, 'eval_loss': 0.9282579, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1115, 1374, 1397, 1402, 1401, 1077, 845, 526, 584, 331, 384], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51667492, 'remaining_params': 33350108, 'pruned_model_sparsity': 0.6077270118187293, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 9900}


Iteration:  94%|█████████▍| 252/268 [00:51<00:12,  1.26it/s][A04/29/2024 01:21:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 9900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:51<00:09,  1.65it/s][A
Iteration:  95%|█████████▍| 254/268 [00:52<00:06,  2.13it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:04,  2.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:03,  3.24it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:02,  3.79it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:02,  4.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:01,  4.84it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:01,  5.20it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  5.54it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.80it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  6.02it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  6.24it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  6.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  6.37it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.39it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.76it/s][A04/29/2024 01:21:08 - INFO - trainer.trainer_mod_2 - Epoch 36 finished. Took 54.27 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.94it/s]
Epoch:  37%|███▋      | 37/100 [32:43<55:54, 53.24s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.72it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:38,  6.77it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.56it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.25it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:41,  6.28it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.57it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.52it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.46it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.41it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.45it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.49it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.55it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.55it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.64it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.54it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.61it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:21:14,096 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:21:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:21:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:21:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:21:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:21:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:21:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.54781790671712, 'eval_loss': 0.9164489, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1115, 1374, 1397, 1402, 1403, 1076, 845, 526, 581, 330, 384], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51665960, 'remaining_params': 33351640, 'pruned_model_sparsity': 0.6077089920204758, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 9950}


Iteration:  13%|█▎        | 34/268 [00:07<03:06,  1.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:20,  1.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:49,  2.12it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:26,  2.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:11,  3.20it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<01:00,  3.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:52,  4.33it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:47,  4.83it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:44,  5.10it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:40,  5.53it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:38,  5.80it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:37,  6.02it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:36,  6.09it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.14it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.13it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.15it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.41it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.40it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.46it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.28it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.33it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.48it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.52it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.55it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.51it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.55it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.44it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.50it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.34it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.42it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.34it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.50it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:30,  6.23it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.30it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.40it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 01:21:24,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:21:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:21:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:21:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:21:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:21:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:21:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5446151814563016, 'eval_loss': 0.9113918, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1116, 1374, 1398, 1402, 1403, 1076, 844, 526, 579, 329, 383], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51664428, 'remaining_params': 33353172, 'pruned_model_sparsity': 0.6076909722222222, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 10000}


Iteration:  31%|███▏      | 84/268 [00:17<02:26,  1.25it/s][A04/29/2024 01:21:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 10000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:17<01:50,  1.65it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<01:25,  2.12it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:07,  2.67it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:55,  3.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:46,  3.83it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:40,  4.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:36,  4.85it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:33,  5.26it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:31,  5.53it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:30,  5.74it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:29,  5.92it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:28,  6.11it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.23it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.31it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.25it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.39it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.48it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:26,  6.14it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.24it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.33it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.33it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.20it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.24it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.30it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.40it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.42it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.43it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.46it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.48it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.45it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.54it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 01:21:33,936 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:21:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:21:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:21:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:21:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:21:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:21:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5340667882909217, 'eval_loss': 0.9205853, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1116, 1375, 1398, 1403, 1404, 1076, 844, 527, 577, 328, 383], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51658300, 'remaining_params': 33359300, 'pruned_model_sparsity': 0.607618893029208, 'expected_sparsity': 0.59984, 'target_sparsity': 0.6, 'step': 10050}


Iteration:  50%|█████     | 134/268 [00:27<01:46,  1.25it/s][A
Iteration:  50%|█████     | 135/268 [00:27<01:19,  1.66it/s][A
Iteration:  51%|█████     | 136/268 [00:27<01:02,  2.13it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:49,  2.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:40,  3.20it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:34,  3.75it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:29,  4.34it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:26,  4.82it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:23,  5.29it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:22,  5.60it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:21,  5.79it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:20,  5.87it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:20,  6.04it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.20it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.37it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.54it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.37it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.34it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.30it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.34it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.31it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.40it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.42it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.40it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.41it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.29it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.37it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.41it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.37it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.38it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.32it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:21:43,844 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:21:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:21:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:21:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:21:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:21:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:21:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5402881620449809, 'eval_loss': 0.8833997, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1117, 1375, 1398, 1404, 1405, 1076, 845, 527, 574, 328, 383], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51652172, 'remaining_params': 33365428, 'pruned_model_sparsity': 0.6075468138361939, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 10100}


Iteration:  69%|██████▊   | 184/268 [00:37<01:06,  1.26it/s][A04/29/2024 01:21:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 10100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:37<00:49,  1.66it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:38,  2.15it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:29,  2.70it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:24,  3.26it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:20,  3.84it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:18,  4.30it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:16,  4.75it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:14,  5.09it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:14,  5.29it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:13,  5.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:12,  5.74it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:12,  5.89it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  5.95it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.11it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.32it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.49it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.51it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.62it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:08,  6.70it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:08,  6.69it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.65it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.59it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.56it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.38it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.47it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.59it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.67it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:06,  6.77it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.69it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.75it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.60it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.47it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.59it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:06,  6.08it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.23it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.23it/s][A[INFO|trainer.py:570] 2024-04-29 01:21:53,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:21:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:21:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:21:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:21:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:21:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:21:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5502476813761963, 'eval_loss': 0.90265745, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1116, 1375, 1398, 1404, 1405, 1075, 844, 526, 571, 327, 381], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51658300, 'remaining_params': 33359300, 'pruned_model_sparsity': 0.607618893029208, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 10150}


Iteration:  87%|████████▋ | 234/268 [00:47<00:27,  1.25it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:20,  1.65it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:15,  2.11it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:11,  2.64it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:09,  3.21it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:07,  3.77it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:06,  4.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:05,  4.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.32it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  5.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.81it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.03it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.15it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.36it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.54it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.45it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.50it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.49it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.51it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.41it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.54it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.54it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.86it/s][A04/29/2024 01:22:01 - INFO - trainer.trainer_mod_2 - Epoch 37 finished. Took 52.24 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  38%|███▊      | 38/100 [33:35<54:42, 52.94s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  7.01it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.79it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.73it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.76it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.68it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.64it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.73it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.70it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.53it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.55it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.67it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:22:03,508 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:22:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:22:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:22:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:22:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:22:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:22:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5458278835785596, 'eval_loss': 0.8730278, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1115, 1375, 1396, 1403, 1404, 1074, 842, 525, 566, 324, 380], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51673620, 'remaining_params': 33343980, 'pruned_model_sparsity': 0.6077990910117435, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 10200}


Iteration:   6%|▌         | 16/268 [00:04<03:21,  1.25it/s][A04/29/2024 01:22:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 10200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:32,  1.64it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:58,  2.12it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:34,  2.63it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:17,  3.20it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:05,  3.79it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:56,  4.35it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:50,  4.88it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:45,  5.35it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:42,  5.66it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:41,  5.83it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:41,  5.83it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:40,  5.92it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:39,  6.08it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.13it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.22it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.34it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.19it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.27it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.33it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.37it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.45it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.37it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.24it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.53it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.63it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.60it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.30it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.33it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.19it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.39it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.37it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.39it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:33,  6.04it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:33,  6.05it/s][A[INFO|trainer.py:570] 2024-04-29 01:22:13,507 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:22:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:22:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:22:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:22:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:22:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:22:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5495609631481372, 'eval_loss': 0.9064177, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [982, 1114, 1374, 1395, 1402, 1404, 1072, 841, 524, 561, 322, 379], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51687408, 'remaining_params': 33330192, 'pruned_model_sparsity': 0.6079612691960253, 'expected_sparsity': 0.60046, 'target_sparsity': 0.6, 'step': 10250}


Iteration:  25%|██▍       | 66/268 [00:14<02:42,  1.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<02:02,  1.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:34,  2.12it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<01:15,  2.62it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:02,  3.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:52,  3.79it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:46,  4.26it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:40,  4.77it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:37,  5.20it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:34,  5.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:32,  5.84it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:32,  5.95it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:30,  6.20it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.33it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.40it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.40it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.44it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.32it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.37it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.32it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.43it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.48it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.60it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.48it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.49it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.52it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.60it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.69it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.55it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:22:23,377 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:22:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:22:23 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:22:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:22:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:22:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:22:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5313208986648889, 'eval_loss': 0.9482929, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1114, 1375, 1395, 1401, 1403, 1072, 840, 524, 558, 320, 379], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51688940, 'remaining_params': 33328660, 'pruned_model_sparsity': 0.6079792889942788, 'expected_sparsity': 0.6005, 'target_sparsity': 0.6, 'step': 10300}


Iteration:  43%|████▎     | 116/268 [00:24<02:00,  1.26it/s][A04/29/2024 01:22:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 10300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:24<01:30,  1.66it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<01:09,  2.15it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:55,  2.69it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:45,  3.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:38,  3.85it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:33,  4.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:29,  4.89it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:27,  5.24it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:25,  5.58it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:24,  5.78it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:23,  5.97it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:23,  6.01it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:23,  6.02it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.06it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.20it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.19it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.30it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.35it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.34it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.33it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.22it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.35it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.54it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.44it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.33it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.36it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.53it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.62it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.58it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.56it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.48it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.48it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.51it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.33it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.36it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.28it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.34it/s][A[INFO|trainer.py:570] 2024-04-29 01:22:33,291 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:22:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:22:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:22:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:22:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:22:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:22:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.550090073200501, 'eval_loss': 0.91806537, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1116, 1376, 1397, 1403, 1405, 1074, 842, 526, 558, 322, 381], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51662896, 'remaining_params': 33354704, 'pruned_model_sparsity': 0.6076729524239687, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 10350}


Iteration:  62%|██████▏   | 166/268 [00:34<01:21,  1.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<01:01,  1.64it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:47,  2.12it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:37,  2.66it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:30,  3.22it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:25,  3.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:21,  4.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:19,  4.87it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:17,  5.28it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:16,  5.69it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:15,  5.85it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:15,  5.87it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.05it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.18it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.42it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.60it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.48it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.50it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.48it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.53it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.54it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.33it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.39it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.31it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.26it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.41it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.30it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.36it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.40it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:22:43,178 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:22:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:22:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:22:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:22:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:22:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:22:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5460649174667868, 'eval_loss': 0.9174657, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [987, 1118, 1378, 1400, 1405, 1407, 1074, 844, 529, 559, 323, 384], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51635320, 'remaining_params': 33382280, 'pruned_model_sparsity': 0.607348596055405, 'expected_sparsity': 0.59933, 'target_sparsity': 0.6, 'step': 10400}


Iteration:  81%|████████  | 216/268 [00:44<00:41,  1.25it/s][A04/29/2024 01:22:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 10400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:44<00:30,  1.65it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:23,  2.14it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:18,  2.68it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:14,  3.25it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:12,  3.84it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:10,  4.39it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:09,  4.92it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:08,  5.33it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  5.63it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:07,  5.85it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.16it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.19it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.53it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.52it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.41it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.42it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.44it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.45it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.42it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.46it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.44it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.42it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.29it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.33it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.32it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.43it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.37it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:22:53,060 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:22:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:22:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:22:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:22:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:22:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:22:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5562373687564978, 'eval_loss': 0.9221953, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [986, 1118, 1378, 1400, 1404, 1407, 1073, 844, 528, 557, 322, 379], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51641448, 'remaining_params': 33376152, 'pruned_model_sparsity': 0.6074206752484191, 'expected_sparsity': 0.59948, 'target_sparsity': 0.6, 'step': 10450}


Iteration:  99%|█████████▉| 266/268 [00:54<00:01,  1.25it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  1.65it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  2.16it/s][A04/29/2024 01:22:55 - INFO - trainer.trainer_mod_2 - Epoch 38 finished. Took 54.4 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  39%|███▉      | 39/100 [34:29<54:16, 53.38s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.86it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.80it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.58it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.67it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.53it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.40it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.46it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.45it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.36it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.27it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.35it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.42it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.32it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.30it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.38it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.40it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.55it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.54it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.51it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.46it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.53it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:35,  6.62it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:37,  6.30it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.36it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.31it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.39it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.42it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.44it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.48it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.51it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.53it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.51it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:34,  6.54it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:33,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:23:02,917 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:23:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:23:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:23:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:23:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:23:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:23:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5452100835559165, 'eval_loss': 0.92559254, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1116, 1377, 1399, 1402, 1405, 1071, 842, 525, 550, 319, 377], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51665960, 'remaining_params': 33351640, 'pruned_model_sparsity': 0.6077089920204758, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 10500}


Iteration:  18%|█▊        | 48/268 [00:09<02:55,  1.26it/s][A04/29/2024 01:23:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 10500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:12,  1.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:42,  2.13it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<01:20,  2.69it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:05,  3.28it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:55,  3.89it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:49,  4.36it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:43,  4.85it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:41,  5.16it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:38,  5.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:36,  5.77it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:34,  6.06it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:34,  6.07it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:33,  6.18it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:33,  6.21it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.28it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.30it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.36it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:33,  5.99it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.27it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.36it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.33it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.39it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.45it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.57it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.35it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.39it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.46it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.50it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.63it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:29,  6.25it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:29,  6.20it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.32it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.41it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.46it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.47it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.49it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.38it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:26,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:23:12,849 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:23:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:23:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:23:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:23:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:23:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:23:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.54370529570588, 'eval_loss': 0.87889147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1114, 1375, 1396, 1400, 1403, 1069, 840, 523, 543, 316, 375], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51695068, 'remaining_params': 33322532, 'pruned_model_sparsity': 0.608051368187293, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 10550}


Iteration:  37%|███▋      | 98/268 [00:19<02:16,  1.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:42,  1.65it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<01:19,  2.11it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<01:02,  2.66it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:51,  3.23it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:43,  3.81it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:37,  4.36it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:33,  4.80it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:31,  5.15it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:29,  5.45it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:27,  5.73it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:26,  5.95it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.12it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.16it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.01it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:25,  6.16it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.29it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.35it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.29it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.35it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.31it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.63it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.59it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.48it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.38it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:21,  6.27it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.34it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.31it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.39it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.46it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.64it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.56it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:18,  6.58it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.38it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:19,  6.41it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:23:22,772 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:23:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:23:22 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:23:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:23:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:23:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:23:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5366931756163555, 'eval_loss': 0.91225964, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [982, 1114, 1375, 1396, 1399, 1402, 1068, 839, 522, 538, 314, 375], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51704260, 'remaining_params': 33313340, 'pruned_model_sparsity': 0.6081594869768142, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 10600}


Iteration:  55%|█████▌    | 148/268 [00:29<01:36,  1.25it/s][A04/29/2024 01:23:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 10600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:29<01:12,  1.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:55,  2.12it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:44,  2.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:36,  3.21it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:30,  3.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:26,  4.27it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:23,  4.74it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:22,  5.04it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:20,  5.39it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:19,  5.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:18,  5.87it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:18,  5.91it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.07it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.16it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.26it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.36it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.25it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.31it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.39it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.44it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.49it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.46it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.58it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.52it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.36it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.37it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.33it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.39it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.50it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.42it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.55it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.26it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.48it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:23:32,711 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:23:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:23:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:23:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:23:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:23:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:23:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.539019545585709, 'eval_loss': 0.9352049, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1115, 1378, 1397, 1401, 1404, 1070, 841, 525, 539, 315, 379], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51676684, 'remaining_params': 33340916, 'pruned_model_sparsity': 0.6078351306082506, 'expected_sparsity': 0.59989, 'target_sparsity': 0.6, 'step': 10650}


Iteration:  74%|███████▍  | 198/268 [00:39<00:55,  1.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:41,  1.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:31,  2.13it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:25,  2.67it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:20,  3.24it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:17,  3.82it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:14,  4.31it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:12,  4.86it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:11,  5.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  5.59it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:10,  5.74it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:10,  5.86it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  5.98it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.15it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.25it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.36it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.33it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.43it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.55it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.60it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.61it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.44it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.48it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.49it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.41it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.41it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.54it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.39it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.38it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.28it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 01:23:42,569 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:23:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:23:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:23:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:23:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:23:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:23:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5396261051709696, 'eval_loss': 0.9357531, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [987, 1118, 1380, 1399, 1403, 1405, 1071, 843, 528, 541, 317, 384], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51647576, 'remaining_params': 33370024, 'pruned_model_sparsity': 0.6074927544414334, 'expected_sparsity': 0.59912, 'target_sparsity': 0.6, 'step': 10700}


Iteration:  93%|█████████▎| 248/268 [00:49<00:15,  1.26it/s][A04/29/2024 01:23:44 - INFO - trainer.trainer_mod_2 - v4 Global step: 10700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:49<00:11,  1.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:08,  2.12it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:06,  2.66it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:04,  3.26it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:03,  3.83it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:03,  4.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  4.87it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  5.64it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.89it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.04it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.18it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.34it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.43it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.31it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.48it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.41it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.71it/s][A04/29/2024 01:23:47 - INFO - trainer.trainer_mod_2 - Epoch 39 finished. Took 52.28 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  40%|████      | 40/100 [35:22<53:02, 53.05s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.75it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.20it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.39it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.42it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.43it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.47it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.29it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.30it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.34it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.41it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.46it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.57it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.65it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.64it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.61it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.60it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.59it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.57it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.57it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.59it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.59it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:23:52,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:23:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:23:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:23:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:23:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:23:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:23:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5465839960451542, 'eval_loss': 0.9045341, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [986, 1117, 1380, 1399, 1403, 1405, 1071, 842, 527, 536, 313, 376], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51653704, 'remaining_params': 33363896, 'pruned_model_sparsity': 0.6075648336344475, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 10750}


Iteration:  11%|█         | 30/268 [00:06<03:10,  1.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:22,  1.66it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:50,  2.13it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:29,  2.64it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:12,  3.22it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:00,  3.83it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:52,  4.38it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:48,  4.81it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:43,  5.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:41,  5.47it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:40,  5.59it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:39,  5.70it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:38,  5.93it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.13it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.23it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.32it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.48it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:36,  6.06it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:35,  6.07it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.21it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.29it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.23it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.40it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.42it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.52it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.53it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.42it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.44it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.46it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.44it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.48it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.37it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 01:24:02,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:24:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:24:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:24:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:24:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 01:24:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:24:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5387376669923544, 'eval_loss': 0.91446954, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1115, 1378, 1396, 1400, 1403, 1068, 839, 524, 529, 311, 373], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51690472, 'remaining_params': 33327128, 'pruned_model_sparsity': 0.6079973087925323, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 10800}


Iteration:  30%|██▉       | 80/268 [00:16<02:29,  1.26it/s][A04/29/2024 01:24:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 10800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:16<01:52,  1.66it/s][A
Iteration:  31%|███       | 82/268 [00:17<01:26,  2.14it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:08,  2.70it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:56,  3.28it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:47,  3.83it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:41,  4.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:37,  4.79it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:34,  5.17it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:32,  5.54it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:30,  5.91it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:29,  6.08it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.15it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:28,  6.24it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.45it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.57it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.27it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:27,  6.18it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.30it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.40it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.47it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.46it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.41it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.43it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.44it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.50it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.46it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.48it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.60it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.42it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 01:24:12,193 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:24:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:24:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:24:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:24:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 01:24:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:24:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5294395294021531, 'eval_loss': 0.9240548, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 1113, 1377, 1395, 1399, 1402, 1066, 838, 523, 523, 309, 372], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51708856, 'remaining_params': 33308744, 'pruned_model_sparsity': 0.6082135463715749, 'expected_sparsity': 0.60074, 'target_sparsity': 0.6, 'step': 10850}


Iteration:  49%|████▊     | 130/268 [00:26<01:49,  1.26it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<01:22,  1.66it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<01:03,  2.13it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:50,  2.67it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:41,  3.25it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:34,  3.84it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:29,  4.42it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:26,  4.92it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:24,  5.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:22,  5.67it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:21,  5.90it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:21,  5.93it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.09it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.16it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.28it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.36it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.54it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:17,  6.71it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:17,  6.68it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.63it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.56it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.55it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:16,  6.65it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:16,  6.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.60it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.60it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.59it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.56it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.60it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.51it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.44it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.55it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.60it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.64it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 01:24:21,960 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:24:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:24:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:24:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:24:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 01:24:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:24:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5396512550123742, 'eval_loss': 0.9338045, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1115, 1379, 1396, 1400, 1404, 1068, 839, 525, 523, 310, 375], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51685876, 'remaining_params': 33331724, 'pruned_model_sparsity': 0.6079432493977718, 'expected_sparsity': 0.6002, 'target_sparsity': 0.6, 'step': 10900}


Iteration:  67%|██████▋   | 180/268 [00:36<01:09,  1.26it/s][A04/29/2024 01:24:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 10900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:36<00:52,  1.66it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:40,  2.14it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:31,  2.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:25,  3.27it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:21,  3.82it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:18,  4.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:16,  4.87it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:15,  5.28it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:13,  5.67it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:13,  5.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.00it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.24it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.39it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.48it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.22it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.23it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.35it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:09,  6.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.42it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.48it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.55it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.53it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.54it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.53it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.50it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.57it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.57it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.54it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:24:31,809 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:24:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:24:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:24:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:24:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:24:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:24:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5351348879153569, 'eval_loss': 0.933628, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [988, 1118, 1381, 1400, 1403, 1407, 1070, 842, 530, 525, 315, 386], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51639916, 'remaining_params': 33377684, 'pruned_model_sparsity': 0.6074026554501656, 'expected_sparsity': 0.59889, 'target_sparsity': 0.6, 'step': 10950}


Iteration:  86%|████████▌ | 230/268 [00:46<00:30,  1.25it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:22,  1.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:17,  2.11it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:13,  2.64it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:10,  3.21it/s][A
Iteration:  88%|████████▊ | 235/268 [00:46<00:08,  3.80it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:07,  4.26it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:06,  4.74it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:05,  5.17it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:05,  5.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  5.72it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  5.88it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.05it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  6.17it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.35it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.37it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:03,  6.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.40it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.35it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.33it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.37it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.58it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.46it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.25it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.36it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.54it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.63it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.46it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.82it/s][A04/29/2024 01:24:39 - INFO - trainer.trainer_mod_2 - Epoch 40 finished. Took 52.06 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.15it/s]
Epoch:  41%|████      | 41/100 [36:14<51:52, 52.75s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.47it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.37it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:42,  6.20it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.29it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.39it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.55it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:24:41,713 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:24:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:24:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:24:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:24:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:24:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:24:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5403785768297347, 'eval_loss': 0.90053856, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [989, 1117, 1382, 1398, 1402, 1406, 1069, 841, 528, 519, 310, 374], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51650640, 'remaining_params': 33366960, 'pruned_model_sparsity': 0.6075287940379404, 'expected_sparsity': 0.59947, 'target_sparsity': 0.6, 'step': 11000}


Iteration:   4%|▍         | 12/268 [00:04<03:27,  1.24it/s][A04/29/2024 01:24:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 11000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:04<02:35,  1.64it/s][A
Iteration:   5%|▌         | 14/268 [00:04<02:00,  2.12it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:36,  2.64it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:17,  3.24it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:05,  3.82it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:57,  4.37it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:51,  4.85it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:47,  5.24it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:45,  5.42it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:42,  5.73it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:41,  5.85it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:40,  6.01it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:39,  6.15it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.25it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.35it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.31it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.35it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.58it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.57it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:34,  6.67it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.71it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.65it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.47it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.52it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.36it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.27it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.35it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.37it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.29it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.49it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.62it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.61it/s][A[INFO|trainer.py:570] 2024-04-29 01:24:51,573 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:24:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:24:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:24:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:24:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:24:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:24:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5279532549901665, 'eval_loss': 0.9370547, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1114, 1378, 1395, 1398, 1403, 1065, 837, 523, 510, 307, 371], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51702728, 'remaining_params': 33314872, 'pruned_model_sparsity': 0.6081414671785607, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 11050}


Iteration:  23%|██▎       | 62/268 [00:13<02:44,  1.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<02:03,  1.66it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:35,  2.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<01:16,  2.67it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:02,  3.26it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:53,  3.79it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:46,  4.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:40,  4.88it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:37,  5.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:35,  5.52it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:33,  5.78it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:33,  5.83it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:32,  6.05it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:31,  6.11it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.25it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.45it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.46it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.48it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.59it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.55it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.56it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:27,  6.66it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:27,  6.60it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.52it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.33it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:29,  5.97it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:28,  6.06it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:28,  6.04it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:28,  5.91it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:28,  5.97it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.10it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.23it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.22it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.48it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.42it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.49it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.50it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.51it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.53it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.45it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:25:01,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:25:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:25:01 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:25:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:25:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:25:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:25:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5262420102371838, 'eval_loss': 0.960193, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [982, 1111, 1376, 1392, 1396, 1400, 1062, 835, 521, 504, 304, 370], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51737964, 'remaining_params': 33279636, 'pruned_model_sparsity': 0.6085559225383921, 'expected_sparsity': 0.60108, 'target_sparsity': 0.6, 'step': 11100}


Iteration:  42%|████▏     | 112/268 [00:23<02:04,  1.25it/s][A04/29/2024 01:25:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 11100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:23<01:33,  1.65it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<01:12,  2.12it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:57,  2.66it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:47,  3.23it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:39,  3.82it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:34,  4.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:30,  4.84it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:28,  5.23it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:26,  5.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:25,  5.80it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:24,  5.93it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:23,  6.04it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:23,  6.08it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.22it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.18it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.16it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.26it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.27it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.33it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.38it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.39it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.47it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.46it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.27it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.33it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.36it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.43it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.41it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.40it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.35it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:25:11,444 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:25:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:25:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:25:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:25:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:25:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:25:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5237230166102567, 'eval_loss': 0.9424288, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1113, 1378, 1394, 1399, 1401, 1064, 838, 524, 505, 306, 374], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51707324, 'remaining_params': 33310276, 'pruned_model_sparsity': 0.6081955265733213, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 11150}


Iteration:  60%|██████    | 162/268 [00:33<01:24,  1.26it/s][A
Iteration:  61%|██████    | 163/268 [00:33<01:03,  1.65it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:48,  2.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:38,  2.65it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:31,  3.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:26,  3.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:23,  4.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:20,  4.79it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:19,  5.15it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:17,  5.57it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:16,  5.75it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  5.95it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.18it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.29it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.37it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.24it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.25it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.52it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.53it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.56it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.44it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.49it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.51it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.43it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.20it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.21it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.33it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.27it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.46it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.46it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.46it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.39it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.43it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:25:21,359 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:25:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:25:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:25:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:25:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:25:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:25:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5353569722427551, 'eval_loss': 0.9230135, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [988, 1118, 1383, 1398, 1403, 1406, 1069, 843, 532, 513, 315, 396], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51442288, 'remaining_params': 33575312, 'pruned_model_sparsity': 0.6050781014754592, 'expected_sparsity': 0.5982, 'target_sparsity': 0.6, 'step': 11200}


Iteration:  79%|███████▉  | 212/268 [00:43<00:44,  1.25it/s][A04/29/2024 01:25:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 11200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:43<00:33,  1.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:25,  2.12it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:19,  2.67it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:16,  3.24it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:13,  3.85it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:11,  4.39it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:10,  4.86it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:09,  5.14it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:08,  5.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  5.86it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  5.98it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  6.06it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  6.13it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.47it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.38it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.49it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.47it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.38it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.42it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.39it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.59it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.57it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.42it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.58it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.34it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.31it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.44it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 01:25:31,236 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:25:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:25:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:25:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:25:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:25:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:25:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5345640705889373, 'eval_loss': 0.93266845, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [987, 1116, 1381, 1397, 1402, 1404, 1067, 839, 526, 503, 305, 371], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51670556, 'remaining_params': 33347044, 'pruned_model_sparsity': 0.6077630514152363, 'expected_sparsity': 0.59966, 'target_sparsity': 0.6, 'step': 11250}


Iteration:  98%|█████████▊| 262/268 [00:53<00:04,  1.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:03,  1.65it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:01,  2.13it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:01,  2.67it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  3.23it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  3.79it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.46it/s][A04/29/2024 01:25:34 - INFO - trainer.trainer_mod_2 - Epoch 41 finished. Took 54.46 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  42%|████▏     | 42/100 [37:08<51:29, 53.26s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.29it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.20it/s][A
Iteration:   1%|          | 3/268 [00:00<00:43,  6.09it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.28it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.37it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.33it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.22it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.31it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.35it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.55it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.46it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.49it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.62it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.51it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.56it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.54it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.54it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.63it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.51it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.51it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.48it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.49it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.54it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.43it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.59it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.48it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.39it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:36,  6.28it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:36,  6.26it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 01:25:41,139 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:25:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:25:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:25:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:25:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:25:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:25:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5364243566130295, 'eval_loss': 0.9590475, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 1111, 1376, 1391, 1397, 1400, 1060, 833, 519, 493, 300, 368], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51748688, 'remaining_params': 33268912, 'pruned_model_sparsity': 0.6086820611261669, 'expected_sparsity': 0.6012, 'target_sparsity': 0.6, 'step': 11300}


Iteration:  16%|█▋        | 44/268 [00:08<02:59,  1.25it/s][A04/29/2024 01:25:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 11300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:09<02:15,  1.65it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:44,  2.12it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<01:23,  2.66it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:08,  3.19it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:58,  3.76it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:50,  4.31it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:45,  4.76it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:42,  5.14it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:39,  5.39it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:39,  5.37it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:37,  5.66it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:36,  5.88it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:34,  6.14it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.19it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.54it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.52it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.63it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.60it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.55it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.56it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.57it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.63it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:29,  6.68it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.53it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.56it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.44it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.46it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.61it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.60it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.45it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.52it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.51it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.60it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.55it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:28,  6.25it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:28,  6.32it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:28,  6.25it/s][A[INFO|trainer.py:570] 2024-04-29 01:25:51,028 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:25:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:25:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:25:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:25:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:25:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:25:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5422671648885407, 'eval_loss': 0.9376149, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1109, 1375, 1390, 1396, 1399, 1059, 832, 519, 489, 298, 367], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51762476, 'remaining_params': 33255124, 'pruned_model_sparsity': 0.6088442393104486, 'expected_sparsity': 0.60135, 'target_sparsity': 0.6, 'step': 11350}


Iteration:  35%|███▌      | 94/268 [00:18<02:19,  1.25it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<01:44,  1.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<01:20,  2.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<01:04,  2.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:52,  3.22it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:44,  3.76it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:39,  4.30it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:34,  4.80it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:32,  5.18it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:29,  5.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:28,  5.69it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:27,  6.01it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:26,  6.23it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.46it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.57it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.60it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.57it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.45it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.54it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.66it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.53it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.62it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.42it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.48it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.37it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.37it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.43it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.39it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.33it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:21,  6.26it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.43it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.43it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:21,  6.17it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.29it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:20,  6.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.38it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.34it/s][A[INFO|trainer.py:570] 2024-04-29 01:26:00,913 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:26:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:26:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:26:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:26:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:26:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:26:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5408374954915984, 'eval_loss': 0.90982115, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1114, 1380, 1394, 1400, 1404, 1063, 838, 529, 499, 313, 393], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51492844, 'remaining_params': 33524756, 'pruned_model_sparsity': 0.605672754817826, 'expected_sparsity': 0.59858, 'target_sparsity': 0.6, 'step': 11400}


Iteration:  54%|█████▎    | 144/268 [00:28<01:39,  1.25it/s][A04/29/2024 01:26:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 11400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:28<01:14,  1.64it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:57,  2.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:45,  2.65it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:37,  3.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:31,  3.78it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:27,  4.36it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:23,  4.90it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:22,  5.22it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:20,  5.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:19,  5.81it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:19,  5.95it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:18,  6.08it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.23it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.30it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.45it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.51it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.54it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.57it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.30it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.19it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.41it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.42it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.50it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.52it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.44it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.63it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.62it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.60it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.56it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 01:26:10,793 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:26:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:26:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:26:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:26:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:26:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:26:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5340667882909217, 'eval_loss': 0.9347641, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [987, 1115, 1382, 1396, 1402, 1405, 1065, 839, 531, 499, 312, 390], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.59821, 'target_sparsity': 0.6, 'step': 11450}


Iteration:  72%|███████▏  | 194/268 [00:38<00:59,  1.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:44,  1.65it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:33,  2.13it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:26,  2.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:21,  3.22it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:18,  3.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:16,  4.23it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:14,  4.70it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:12,  5.15it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:12,  5.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:11,  5.65it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  5.89it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  5.91it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  6.10it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.22it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.23it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.29it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.43it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.44it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.36it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.37it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.43it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.28it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.38it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.56it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.66it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.56it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.50it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.59it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.49it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.50it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.53it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.55it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.56it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.68it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.63it/s][A[INFO|trainer.py:570] 2024-04-29 01:26:20,692 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:26:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:26:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:26:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:26:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:26:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:26:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5349285081048897, 'eval_loss': 0.9345057, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [979, 1109, 1375, 1389, 1395, 1399, 1056, 830, 519, 480, 296, 366], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51774732, 'remaining_params': 33242868, 'pruned_model_sparsity': 0.608988397696477, 'expected_sparsity': 0.60144, 'target_sparsity': 0.6, 'step': 11500}


Iteration:  91%|█████████ | 244/268 [00:48<00:19,  1.25it/s][A04/29/2024 01:26:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 11500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:48<00:13,  1.65it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:10,  2.13it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:07,  2.68it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:06,  3.25it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:04,  3.80it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:04,  4.31it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  4.75it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:03,  5.17it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  5.54it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.78it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  5.89it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.07it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.22it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.23it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.43it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.49it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.53it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.88it/s][A04/29/2024 01:26:26 - INFO - trainer.trainer_mod_2 - Epoch 42 finished. Took 52.23 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  43%|████▎     | 43/100 [38:00<50:18, 52.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.50it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.32it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.36it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.46it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.48it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.29it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.36it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.33it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.52it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.55it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.46it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.47it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.62it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.26it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.36it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.35it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.41it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.44it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:26:30,568 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:26:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:26:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:26:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:26:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:26:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:26:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5248207980411488, 'eval_loss': 0.9418939, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1106, 1373, 1386, 1391, 1395, 1052, 826, 517, 474, 293, 366], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51819160, 'remaining_params': 33198440, 'pruned_model_sparsity': 0.6095109718458296, 'expected_sparsity': 0.60217, 'target_sparsity': 0.6, 'step': 11550}


Iteration:  10%|▉         | 26/268 [00:06<03:13,  1.25it/s][A
Iteration:  10%|█         | 27/268 [00:06<02:25,  1.65it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:52,  2.13it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:29,  2.67it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:14,  3.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:02,  3.80it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:56,  4.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:50,  4.63it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:47,  4.98it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:43,  5.32it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:41,  5.65it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:39,  5.81it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:38,  6.03it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:37,  6.15it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.14it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.26it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.27it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.39it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.32it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.40it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.42it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.51it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.58it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.59it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.54it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.55it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.52it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.55it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.55it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.66it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.60it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.63it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.59it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.65it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:26:40,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:26:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:26:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:26:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:26:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:26:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:26:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5365747584120986, 'eval_loss': 0.95560175, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1113, 1379, 1392, 1398, 1401, 1058, 833, 530, 489, 311, 397], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51521952, 'remaining_params': 33495648, 'pruned_model_sparsity': 0.6060151309846432, 'expected_sparsity': 0.5987, 'target_sparsity': 0.6, 'step': 11600}


Iteration:  28%|██▊       | 76/268 [00:16<02:33,  1.25it/s][A04/29/2024 01:26:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 11600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:16<01:56,  1.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<01:29,  2.13it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:10,  2.69it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:57,  3.27it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:48,  3.84it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:42,  4.39it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:38,  4.85it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:34,  5.27it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:32,  5.60it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:31,  5.80it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:30,  5.99it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:30,  5.88it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:29,  5.99it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:29,  6.06it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.33it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.22it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.21it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.14it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.26it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.41it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.47it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.51it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.63it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.61it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.43it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.39it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.41it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.49it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.53it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.65it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.61it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.63it/s][A[INFO|trainer.py:570] 2024-04-29 01:26:50,357 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:26:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:26:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:26:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:26:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:26:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:26:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5205768624725053, 'eval_loss': 0.92712295, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [988, 1117, 1384, 1396, 1402, 1405, 1061, 838, 539, 498, 322, 419], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51261512, 'remaining_params': 33756088, 'pruned_model_sparsity': 0.6029517652815417, 'expected_sparsity': 0.59627, 'target_sparsity': 0.6, 'step': 11650}


Iteration:  47%|████▋     | 126/268 [00:25<01:52,  1.26it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<01:24,  1.66it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<01:05,  2.13it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:52,  2.67it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:42,  3.24it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:36,  3.77it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:31,  4.32it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:28,  4.80it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:25,  5.20it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:23,  5.56it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:22,  5.80it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:22,  5.86it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.08it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.30it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.54it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.52it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.34it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.49it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.39it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.44it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.39it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.42it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.56it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.59it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.59it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.58it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.45it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.47it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.46it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.55it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.58it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.56it/s][A[INFO|trainer.py:570] 2024-04-29 01:27:00,226 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:27:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:27:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:27:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:27:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:27:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:27:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5142153328951897, 'eval_loss': 0.93103355, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [977, 1107, 1373, 1385, 1393, 1397, 1051, 826, 518, 467, 291, 365], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51811500, 'remaining_params': 33206100, 'pruned_model_sparsity': 0.6094208728545619, 'expected_sparsity': 0.60191, 'target_sparsity': 0.6, 'step': 11700}


Iteration:  66%|██████▌   | 176/268 [00:35<01:13,  1.25it/s][A04/29/2024 01:27:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 11700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:36<00:55,  1.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:42,  2.13it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:33,  2.65it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:27,  3.23it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:22,  3.80it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:20,  4.28it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:17,  4.77it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:16,  5.18it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:14,  5.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:14,  5.81it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:13,  5.92it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:13,  6.11it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.31it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.24it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.17it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.17it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.29it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.23it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.30it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.35it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.43it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.35it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.34it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.41it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.42it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.47it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.35it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.55it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.71it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:27:10,155 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:27:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:27:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:27:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:27:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:27:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:27:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5129121393126265, 'eval_loss': 0.94977397, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [972, 1101, 1367, 1379, 1387, 1391, 1044, 821, 515, 457, 288, 363], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51888100, 'remaining_params': 33129500, 'pruned_model_sparsity': 0.6103218627672388, 'expected_sparsity': 0.60324, 'target_sparsity': 0.6, 'step': 11750}


Iteration:  84%|████████▍ | 226/268 [00:45<00:33,  1.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:24,  1.66it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:18,  2.12it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:14,  2.66it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:11,  3.26it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:09,  3.85it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:08,  4.34it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:07,  4.77it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:06,  5.13it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:06,  5.47it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  5.70it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  5.93it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.11it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.10it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.24it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.34it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.34it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.50it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.59it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.58it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.42it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.48it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.58it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.56it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.69it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.51it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.60it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.42it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.43it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.40it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.75it/s][A04/29/2024 01:27:18 - INFO - trainer.trainer_mod_2 - Epoch 43 finished. Took 52.25 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  44%|████▍     | 44/100 [38:53<49:13, 52.74s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  7.00it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.76it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.56it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.60it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 01:27:20,024 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:27:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:27:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:27:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:27:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:27:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:27:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5232236706415442, 'eval_loss': 0.938359, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [979, 1107, 1374, 1385, 1392, 1397, 1051, 829, 527, 472, 306, 385], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51593956, 'remaining_params': 33423644, 'pruned_model_sparsity': 0.6068620615025595, 'expected_sparsity': 0.60011, 'target_sparsity': 0.6, 'step': 11800}


Iteration:   3%|▎         | 8/268 [00:03<03:40,  1.18it/s][A04/29/2024 01:27:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 11800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:43,  1.58it/s][A
Iteration:   4%|▎         | 10/268 [00:03<02:05,  2.06it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:38,  2.61it/s][A
Iteration:   4%|▍         | 12/268 [00:04<01:19,  3.21it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:07,  3.80it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:58,  4.32it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:52,  4.80it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:50,  5.02it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:46,  5.39it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:43,  5.69it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:41,  5.94it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:41,  6.04it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:40,  6.11it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.30it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.32it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.36it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.48it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.47it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.58it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:35,  6.73it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.57it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:35,  6.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.60it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.57it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.45it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.48it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.53it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.61it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:33,  6.68it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.62it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.57it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.52it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.43it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.47it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.48it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.48it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.43it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:27:29,867 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:27:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:27:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:27:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:27:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:27:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:27:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5395539646127814, 'eval_loss': 0.90055317, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [989, 1117, 1383, 1393, 1400, 1406, 1060, 840, 550, 505, 351, 445], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 7, 4, 5, 10], 'pruned_params': 51053160, 'remaining_params': 33964440, 'pruned_model_sparsity': 0.6005010727190605, 'expected_sparsity': 0.59366, 'target_sparsity': 0.6, 'step': 11850}


Iteration:  22%|██▏       | 58/268 [00:13<02:47,  1.25it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<02:06,  1.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:36,  2.15it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<01:16,  2.71it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:02,  3.28it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:53,  3.86it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:47,  4.30it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:42,  4.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:39,  5.16it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:36,  5.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:34,  5.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:33,  5.90it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:32,  6.05it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:32,  6.13it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:31,  6.13it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.36it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.46it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.36it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.33it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:30,  6.21it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.40it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.29it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.39it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.56it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.44it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.39it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.24it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.26it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.27it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.31it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.46it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.47it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.23it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.32it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.56it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.29it/s][A[INFO|trainer.py:570] 2024-04-29 01:27:39,813 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:27:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:27:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:27:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:27:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:27:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:27:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5334876461854267, 'eval_loss': 0.94859564, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1108, 1375, 1385, 1392, 1398, 1051, 828, 523, 458, 288, 364], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51791584, 'remaining_params': 33226016, 'pruned_model_sparsity': 0.6091866154772659, 'expected_sparsity': 0.60139, 'target_sparsity': 0.6, 'step': 11900}


Iteration:  40%|████      | 108/268 [00:23<02:07,  1.25it/s][A04/29/2024 01:27:41 - INFO - trainer.trainer_mod_2 - v4 Global step: 11900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:23<01:36,  1.65it/s][A
Iteration:  41%|████      | 110/268 [00:23<01:14,  2.12it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:58,  2.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:48,  3.24it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:40,  3.83it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:35,  4.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:31,  4.87it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:28,  5.30it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:26,  5.61it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:25,  5.89it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:24,  6.08it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:23,  6.21it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.23it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.35it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.40it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:21,  6.57it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.67it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.65it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.61it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.62it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.40it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.47it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.50it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.45it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.50it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.43it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.48it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.47it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.51it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.62it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.62it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.61it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.63it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.61it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.62it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.70it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.58it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.58it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 01:27:49,593 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:27:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:27:49 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:27:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:27:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 01:27:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:27:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5358471074046374, 'eval_loss': 0.94300115, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [971, 1099, 1366, 1376, 1385, 1391, 1042, 820, 515, 444, 283, 362], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51906484, 'remaining_params': 33111116, 'pruned_model_sparsity': 0.6105381003462812, 'expected_sparsity': 0.60375, 'target_sparsity': 0.6, 'step': 11950}


Iteration:  59%|█████▉    | 158/268 [00:32<01:27,  1.26it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<01:05,  1.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:50,  2.13it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:39,  2.68it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:32,  3.28it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:27,  3.86it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:23,  4.41it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:21,  4.82it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:19,  5.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:18,  5.44it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:17,  5.71it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:16,  5.96it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:16,  6.11it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:15,  6.22it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.20it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.29it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.23it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.19it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.18it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.19it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.32it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:12,  6.54it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.59it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.56it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.58it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:11,  6.58it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.51it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.54it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:10,  6.55it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.48it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.46it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.62it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.59it/s][A[INFO|trainer.py:570] 2024-04-29 01:27:59,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:27:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:27:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:27:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:27:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 01:28:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:28:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5420036503219092, 'eval_loss': 0.9037401, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [972, 1101, 1368, 1378, 1387, 1392, 1043, 822, 519, 446, 288, 367], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51880440, 'remaining_params': 33137160, 'pruned_model_sparsity': 0.6102317637759711, 'expected_sparsity': 0.6029, 'target_sparsity': 0.6, 'step': 12000}


Iteration:  78%|███████▊  | 208/268 [00:42<00:47,  1.26it/s][A04/29/2024 01:28:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 12000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:42<00:35,  1.66it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:27,  2.14it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:21,  2.69it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:17,  3.27it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:14,  3.80it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:12,  4.36it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:11,  4.78it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:09,  5.22it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:09,  5.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  5.66it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  5.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.00it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.05it/s][A
Iteration:  83%|████████▎ | 222/268 [00:44<00:07,  6.24it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.26it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.50it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.50it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.62it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.64it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.61it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.48it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:46<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.61it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.59it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.43it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.30it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.38it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.32it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:03,  6.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.44it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.58it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.42it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.46it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:28:09,306 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:28:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:28:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:28:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:28:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:28:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:28:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5396512550123742, 'eval_loss': 0.90174884, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1113, 1379, 1388, 1396, 1402, 1054, 834, 546, 485, 337, 415], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51312068, 'remaining_params': 33705532, 'pruned_model_sparsity': 0.6035464186239085, 'expected_sparsity': 0.59609, 'target_sparsity': 0.6, 'step': 12050}


Iteration:  96%|█████████▋| 258/268 [00:52<00:07,  1.26it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:05,  1.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:52<00:03,  2.13it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:02,  2.66it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  3.20it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  3.79it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  4.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  4.79it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  5.20it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.52it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.04it/s][A04/29/2024 01:28:12 - INFO - trainer.trainer_mod_2 - Epoch 44 finished. Took 54.21 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.94it/s]
Epoch:  45%|████▌     | 45/100 [39:47<48:45, 53.18s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.08it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.36it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.56it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.58it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.53it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.64it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.60it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.44it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.34it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:41,  6.08it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:41,  6.15it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.23it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.25it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.25it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.35it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.40it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.51it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.50it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.53it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.53it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.39it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.36it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.34it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.42it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:38,  6.15it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:38,  6.21it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:37,  6.24it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:38,  6.17it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:37,  6.17it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:37,  6.14it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:37,  6.09it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:38,  6.02it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:37,  6.09it/s][A[INFO|trainer.py:570] 2024-04-29 01:28:19,307 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:28:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:28:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:28:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:28:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:28:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:28:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5427883381607795, 'eval_loss': 0.9267798, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [987, 1115, 1381, 1390, 1399, 1404, 1056, 836, 549, 485, 336, 413], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51281428, 'remaining_params': 33736172, 'pruned_model_sparsity': 0.6031860226588377, 'expected_sparsity': 0.59533, 'target_sparsity': 0.6, 'step': 12100}


Iteration:  15%|█▍        | 40/268 [00:08<03:03,  1.24it/s][A04/29/2024 01:28:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 12100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:18,  1.64it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:46,  2.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:24,  2.65it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<01:09,  3.22it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:58,  3.81it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:51,  4.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:46,  4.77it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:42,  5.20it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:39,  5.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:10<00:38,  5.68it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:37,  5.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:35,  6.00it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:35,  6.08it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.22it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.32it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.29it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.21it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.31it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.25it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.44it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.31it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.26it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.37it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.31it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.47it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.43it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.62it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.42it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.33it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.36it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:29,  6.34it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.26it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.33it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.39it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:28:29,269 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:28:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:28:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:28:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:28:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:28:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:28:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.550612081256011, 'eval_loss': 0.88496184, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [974, 1103, 1370, 1379, 1388, 1394, 1043, 821, 518, 439, 282, 362], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51868184, 'remaining_params': 33149416, 'pruned_model_sparsity': 0.6100876053899428, 'expected_sparsity': 0.60303, 'target_sparsity': 0.6, 'step': 12150}


Iteration:  34%|███▎      | 90/268 [00:18<02:21,  1.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:46,  1.66it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<01:22,  2.13it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<01:05,  2.68it/s][A
Iteration:  35%|███▌      | 94/268 [00:19<00:53,  3.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:45,  3.83it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:39,  4.38it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:35,  4.88it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:32,  5.27it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:30,  5.59it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:29,  5.78it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:28,  5.83it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:27,  6.04it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:27,  6.02it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.27it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:25,  6.29it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.37it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.41it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.43it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.55it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.50it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.54it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.45it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:22,  6.51it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.51it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:21,  6.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.59it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.48it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.45it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.38it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.40it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.46it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.55it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.58it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.54it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.63it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.73it/s][A[INFO|trainer.py:570] 2024-04-29 01:28:39,090 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:28:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:28:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:28:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:28:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.49it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:28:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:28:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5510914449192472, 'eval_loss': 0.8658505, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [969, 1098, 1365, 1374, 1383, 1389, 1037, 817, 515, 432, 279, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51934060, 'remaining_params': 33083540, 'pruned_model_sparsity': 0.610862456714845, 'expected_sparsity': 0.60409, 'target_sparsity': 0.6, 'step': 12200}


Iteration:  52%|█████▏    | 140/268 [00:28<01:41,  1.26it/s][A04/29/2024 01:28:41 - INFO - trainer.trainer_mod_2 - v4 Global step: 12200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:28<01:16,  1.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:59,  2.13it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:46,  2.67it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:37,  3.27it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:32,  3.82it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:28,  4.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:25,  4.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:23,  5.12it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:22,  5.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:20,  5.71it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:19,  5.93it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.12it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.30it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.29it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.29it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.34it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:16,  6.48it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.62it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.59it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:15,  6.70it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.63it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.55it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.44it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.56it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.35it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.45it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.37it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.58it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.72it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.63it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.62it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.62it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.69it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:11,  6.78it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:11,  6.71it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:11,  6.66it/s][A[INFO|trainer.py:570] 2024-04-29 01:28:48,904 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:28:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:28:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:28:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:28:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:28:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:28:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5399503104637741, 'eval_loss': 0.889462, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [975, 1103, 1371, 1379, 1388, 1394, 1042, 823, 526, 445, 296, 376], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51655236, 'remaining_params': 33362364, 'pruned_model_sparsity': 0.607582853432701, 'expected_sparsity': 0.60165, 'target_sparsity': 0.6, 'step': 12250}


Iteration:  71%|███████   | 190/268 [00:38<01:01,  1.26it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:46,  1.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:35,  2.16it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:27,  2.70it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:22,  3.28it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:18,  3.85it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:16,  4.39it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:14,  4.88it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:13,  5.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:12,  5.61it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:11,  5.87it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:11,  6.08it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.24it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.41it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.26it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.33it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.21it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.28it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.37it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.40it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.37it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.41it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.43it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.44it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.38it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.53it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.63it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.45it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.52it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.36it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.34it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.40it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.37it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.41it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.62it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.50it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:28:58,768 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:28:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:28:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:28:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:28:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:29:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:29:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5416385858307549, 'eval_loss': 0.8747673, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [988, 1115, 1382, 1390, 1398, 1404, 1053, 836, 554, 487, 354, 431], 'head_nums': [11, 7, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51080736, 'remaining_params': 33936864, 'pruned_model_sparsity': 0.6008254290876243, 'expected_sparsity': 0.59468, 'target_sparsity': 0.6, 'step': 12300}


Iteration:  90%|████████▉ | 240/268 [00:47<00:22,  1.26it/s][A04/29/2024 01:29:00 - INFO - trainer.trainer_mod_2 - v4 Global step: 12300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:48<00:16,  1.66it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:12,  2.15it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:09,  2.69it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:07,  3.27it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:06,  3.81it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:05,  4.36it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:04,  4.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.15it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.52it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.89it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.09it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.27it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.28it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.30it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.98it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.15it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.24it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.51it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.48it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.48it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.84it/s][A04/29/2024 01:29:05 - INFO - trainer.trainer_mod_2 - Epoch 45 finished. Took 52.24 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  46%|████▌     | 46/100 [40:39<47:36, 52.90s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:47,  5.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.12it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.32it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.54it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.47it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.52it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.54it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.52it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.53it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.44it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.38it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.31it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.37it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:29:08,636 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:29:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:29:08 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:29:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:29:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:29:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:29:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5508182716655207, 'eval_loss': 0.89629114, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [986, 1113, 1380, 1388, 1396, 1402, 1051, 832, 545, 465, 323, 399], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51318196, 'remaining_params': 33699404, 'pruned_model_sparsity': 0.6036184978169226, 'expected_sparsity': 0.59712, 'target_sparsity': 0.6, 'step': 12350}


Iteration:   8%|▊         | 22/268 [00:05<03:16,  1.25it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:27,  1.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:54,  2.13it/s][A
Iteration:   9%|▉         | 25/268 [00:06<01:31,  2.67it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:14,  3.24it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:03,  3.78it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:55,  4.34it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:49,  4.82it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:44,  5.30it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:42,  5.60it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:41,  5.72it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:39,  5.94it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:38,  6.03it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.20it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.16it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:37,  6.09it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.53it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.56it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.55it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.54it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:33,  6.22it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.36it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.31it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.18it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.22it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.25it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:32,  6.17it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.21it/s][A[INFO|trainer.py:570] 2024-04-29 01:29:18,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:29:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:29:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:29:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:29:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:29:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:29:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5551439282323715, 'eval_loss': 0.8787527, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [974, 1103, 1370, 1378, 1388, 1393, 1040, 820, 519, 428, 280, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51875844, 'remaining_params': 33141756, 'pruned_model_sparsity': 0.6101777043812104, 'expected_sparsity': 0.60308, 'target_sparsity': 0.6, 'step': 12400}


Iteration:  27%|██▋       | 72/268 [00:15<02:37,  1.25it/s][A04/29/2024 01:29:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 12400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:15<01:58,  1.65it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:31,  2.12it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:12,  2.65it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:59,  3.24it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:49,  3.82it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:43,  4.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:39,  4.81it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:36,  5.20it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:34,  5.48it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:31,  5.83it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:30,  6.04it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.19it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.39it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.39it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.31it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.42it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.45it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.58it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.54it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.43it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.47it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.51it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.45it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.36it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.44it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.34it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.47it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.41it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:29:28,454 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:29:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:29:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:29:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:29:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:29:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:29:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5465839960451542, 'eval_loss': 0.887746, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [971, 1100, 1367, 1374, 1384, 1391, 1037, 817, 517, 423, 278, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51917208, 'remaining_params': 33100392, 'pruned_model_sparsity': 0.610664238934056, 'expected_sparsity': 0.60379, 'target_sparsity': 0.6, 'step': 12450}


Iteration:  46%|████▌     | 122/268 [00:25<01:56,  1.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<01:27,  1.65it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<01:07,  2.12it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:54,  2.64it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:44,  3.21it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:37,  3.78it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:32,  4.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:28,  4.87it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:26,  5.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:24,  5.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:23,  5.85it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:22,  6.02it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.24it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.17it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.34it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.55it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.58it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.38it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.38it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.51it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.54it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.45it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.41it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.49it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.49it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.43it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.46it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.46it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.56it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.38it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:29:38,323 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:29:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:29:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:29:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:29:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:29:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:29:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5504031254980248, 'eval_loss': 0.8871373, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [978, 1106, 1374, 1380, 1390, 1397, 1043, 825, 530, 439, 296, 379], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51621532, 'remaining_params': 33396068, 'pruned_model_sparsity': 0.6071864178711232, 'expected_sparsity': 0.60091, 'target_sparsity': 0.6, 'step': 12500}


Iteration:  64%|██████▍   | 172/268 [00:35<01:16,  1.25it/s][A04/29/2024 01:29:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 12500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:35<00:57,  1.64it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:44,  2.09it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:35,  2.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:28,  3.22it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:24,  3.77it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:20,  4.31it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:18,  4.76it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:16,  5.26it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:15,  5.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:14,  5.76it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:14,  5.98it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.16it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.39it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.53it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.53it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.41it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.09it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.13it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.26it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.35it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.43it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.31it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.58it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.56it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.59it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.56it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.56it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.34it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 01:29:48,256 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:29:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:29:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:29:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:29:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:29:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:29:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5332198659134496, 'eval_loss': 0.92934185, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [989, 1116, 1383, 1389, 1399, 1405, 1052, 836, 554, 474, 343, 426], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51272236, 'remaining_params': 33745364, 'pruned_model_sparsity': 0.6030779038693165, 'expected_sparsity': 0.595, 'target_sparsity': 0.6, 'step': 12550}


Iteration:  83%|████████▎ | 222/268 [00:45<00:36,  1.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:27,  1.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:20,  2.12it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:16,  2.63it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:13,  3.20it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:10,  3.79it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:09,  4.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:08,  4.76it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:07,  5.24it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.83it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.14it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.26it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.46it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.46it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.49it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.58it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.48it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.56it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.55it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.58it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.33it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.60it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.67it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.72it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.63it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.41it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.45it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.46it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.85it/s][A04/29/2024 01:29:57 - INFO - trainer.trainer_mod_2 - Epoch 46 finished. Took 52.23 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  47%|████▋     | 47/100 [41:31<46:33, 52.70s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:29:58,083 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:29:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:29:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:29:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:29:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:30:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:30:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5406003416615092, 'eval_loss': 0.91017103, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1113, 1381, 1387, 1397, 1404, 1050, 831, 543, 450, 305, 391], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51321260, 'remaining_params': 33696340, 'pruned_model_sparsity': 0.6036545374134297, 'expected_sparsity': 0.59773, 'target_sparsity': 0.6, 'step': 12600}


Iteration:   1%|▏         | 4/268 [00:02<04:25,  1.01s/it][A04/29/2024 01:30:00 - INFO - trainer.trainer_mod_2 - v4 Global step: 12600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<03:03,  1.43it/s][A
Iteration:   2%|▏         | 6/268 [00:03<02:14,  1.95it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:43,  2.53it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:23,  3.12it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:08,  3.76it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:59,  4.37it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:52,  4.87it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:48,  5.27it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:45,  5.59it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:43,  5.83it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:41,  6.05it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.10it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:40,  6.16it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.20it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:40,  6.19it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.38it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.24it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.25it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.35it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.40it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:36,  6.57it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:36,  6.55it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:36,  6.64it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.58it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.56it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.09it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:38,  6.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.27it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.36it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.31it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.43it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.36it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.50it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.55it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.47it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.67it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.60it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:30:07,968 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:30:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:30:07 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:30:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:30:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:30:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:30:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5425688103069501, 'eval_loss': 0.8874482, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [975, 1104, 1373, 1378, 1389, 1396, 1040, 821, 522, 421, 277, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51855928, 'remaining_params': 33161672, 'pruned_model_sparsity': 0.6099434470039145, 'expected_sparsity': 0.60256, 'target_sparsity': 0.6, 'step': 12650}


Iteration:  20%|██        | 54/268 [00:12<02:51,  1.25it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:09,  1.65it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:39,  2.13it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<01:19,  2.66it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:04,  3.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:56,  3.70it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:49,  4.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:44,  4.70it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:40,  5.10it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:37,  5.46it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:35,  5.73it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:34,  5.91it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:33,  5.99it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:32,  6.17it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.28it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:31,  6.34it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:30,  6.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.38it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.30it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.36it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.35it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.48it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.53it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.46it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.46it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.52it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.32it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.46it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.39it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.53it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.67it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.48it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.39it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.57it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.65it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:30:17,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:30:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:30:17 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:30:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:30:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:30:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:30:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5395109128667314, 'eval_loss': 0.91418964, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [972, 1101, 1371, 1375, 1387, 1393, 1037, 817, 520, 416, 276, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51894228, 'remaining_params': 33123372, 'pruned_model_sparsity': 0.610393941960253, 'expected_sparsity': 0.60317, 'target_sparsity': 0.6, 'step': 12700}


Iteration:  39%|███▉      | 104/268 [00:22<02:10,  1.25it/s][A04/29/2024 01:30:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 12700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:22<01:38,  1.66it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<01:15,  2.14it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<01:00,  2.68it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:49,  3.23it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:41,  3.79it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:36,  4.28it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:32,  4.79it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:29,  5.21it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:27,  5.54it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:26,  5.77it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:25,  6.00it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:25,  6.08it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:24,  6.22it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:24,  6.10it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.25it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:23,  6.26it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.35it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.36it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.33it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.23it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:22,  6.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.38it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.41it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.24it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.24it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.21it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.44it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.48it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.48it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.40it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.37it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.55it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.56it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 01:30:27,802 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:30:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:30:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:30:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:30:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:30:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:30:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5603228770167558, 'eval_loss': 0.89934796, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [978, 1107, 1377, 1381, 1392, 1398, 1042, 823, 530, 428, 294, 376], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51809968, 'remaining_params': 33207632, 'pruned_model_sparsity': 0.6094028530563084, 'expected_sparsity': 0.60084, 'target_sparsity': 0.6, 'step': 12750}


Iteration:  57%|█████▋    | 154/268 [00:32<01:30,  1.26it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<01:08,  1.66it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:52,  2.13it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:41,  2.67it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:34,  3.21it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:28,  3.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:24,  4.34it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:22,  4.82it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:20,  5.22it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:18,  5.55it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:18,  5.72it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:17,  5.89it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:16,  6.08it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:16,  6.22it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:16,  6.23it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.42it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:14,  6.51it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.38it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.32it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.32it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.49it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.47it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.33it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.39it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.15it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.34it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.32it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.36it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.50it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.55it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.40it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.49it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:30:37,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:30:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:30:37 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:30:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:30:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:30:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:30:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5358471074046374, 'eval_loss': 0.9097056, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [988, 1116, 1386, 1389, 1399, 1406, 1049, 832, 549, 454, 341, 416], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51286024, 'remaining_params': 33731576, 'pruned_model_sparsity': 0.6032400820535984, 'expected_sparsity': 0.59605, 'target_sparsity': 0.6, 'step': 12800}


Iteration:  76%|███████▌  | 204/268 [00:42<00:51,  1.25it/s][A04/29/2024 01:30:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 12800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:42<00:38,  1.65it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:29,  2.13it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:23,  2.65it/s][A
Iteration:  78%|███████▊  | 208/268 [00:43<00:18,  3.23it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:15,  3.81it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:13,  4.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:11,  4.76it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:10,  5.13it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:10,  5.49it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:09,  5.78it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:08,  5.99it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  6.13it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:07,  6.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:06,  6.52it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.52it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.41it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.55it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.52it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.53it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.55it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.64it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.60it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.57it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.59it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.59it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.36it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.39it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.45it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:30:47,601 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:30:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:30:47 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:30:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:30:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:30:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:30:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.54781790671712, 'eval_loss': 0.88298374, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1114, 1384, 1387, 1397, 1404, 1047, 829, 541, 436, 303, 385], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51521952, 'remaining_params': 33495648, 'pruned_model_sparsity': 0.6060151309846432, 'expected_sparsity': 0.59804, 'target_sparsity': 0.6, 'step': 12850}


Iteration:  95%|█████████▍| 254/268 [00:52<00:11,  1.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:07,  1.64it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:05,  2.12it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:04,  2.67it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:03,  3.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:02,  3.78it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:01,  4.32it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  4.81it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.24it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  5.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.92it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  6.10it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  6.08it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.21it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.60it/s][A04/29/2024 01:30:51 - INFO - trainer.trainer_mod_2 - Epoch 47 finished. Took 54.44 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  48%|████▊     | 48/100 [42:26<46:07, 53.22s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.54it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.42it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.44it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.36it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.34it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.30it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.35it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.53it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.45it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.53it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.51it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.53it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.50it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.53it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.63it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.48it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.53it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:38,  6.36it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.39it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.43it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.39it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.42it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:37,  6.37it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:30:57,451 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:30:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:30:57 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:30:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:30:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:30:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:30:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5577353353156735, 'eval_loss': 0.88701075, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1106, 1377, 1380, 1390, 1398, 1040, 820, 524, 414, 275, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51836012, 'remaining_params': 33181588, 'pruned_model_sparsity': 0.6097091896266185, 'expected_sparsity': 0.6021, 'target_sparsity': 0.6, 'step': 12900}


Iteration:  13%|█▎        | 36/268 [00:07<03:04,  1.26it/s][A04/29/2024 01:30:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 12900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:19,  1.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:47,  2.14it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<01:25,  2.69it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:10,  3.24it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:59,  3.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:52,  4.30it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:47,  4.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:42,  5.27it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:40,  5.57it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:38,  5.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:38,  5.76it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:36,  5.96it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.12it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:35,  6.16it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.29it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.25it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.22it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.33it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.48it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.58it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:30,  6.69it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:30,  6.76it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.60it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.50it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.54it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.54it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.54it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.45it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.38it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.48it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:30,  6.08it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.23it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 01:31:07,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:31:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:31:07 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:31:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:31:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:31:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:31:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5492247863049868, 'eval_loss': 0.8690972, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [974, 1104, 1375, 1378, 1388, 1396, 1039, 819, 522, 410, 274, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51860524, 'remaining_params': 33157076, 'pruned_model_sparsity': 0.6099975063986751, 'expected_sparsity': 0.60248, 'target_sparsity': 0.6, 'step': 12950}


Iteration:  32%|███▏      | 86/268 [00:17<02:25,  1.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:49,  1.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<01:24,  2.13it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<01:07,  2.66it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:54,  3.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:46,  3.81it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:40,  4.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:36,  4.84it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:33,  5.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:31,  5.55it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:30,  5.70it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:29,  5.82it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.12it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.15it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.15it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.22it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.32it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.45it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.66it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.62it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.52it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.54it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.57it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.26it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.34it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.40it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.52it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.56it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.64it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.64it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.70it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:20,  6.69it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:20,  6.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.45it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.41it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.16it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:21,  6.29it/s][A[INFO|trainer.py:570] 2024-04-29 01:31:17,223 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:31:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:31:17 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:31:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:31:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 01:31:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:31:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5523181756655187, 'eval_loss': 0.91133356, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1109, 1380, 1383, 1392, 1401, 1042, 823, 530, 419, 291, 374], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51791584, 'remaining_params': 33226016, 'pruned_model_sparsity': 0.6091866154772659, 'expected_sparsity': 0.60045, 'target_sparsity': 0.6, 'step': 13000}


Iteration:  51%|█████     | 136/268 [00:27<01:45,  1.25it/s][A04/29/2024 01:31:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 13000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:27<01:19,  1.64it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<01:01,  2.12it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:48,  2.67it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:39,  3.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:32,  3.85it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:28,  4.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:25,  4.90it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:23,  5.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:21,  5.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:20,  5.85it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.16it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.30it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.41it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.52it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.55it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.57it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.55it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.57it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.46it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.64it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.60it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.27it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:15,  6.39it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.42it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.49it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.32it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.63it/s][A[INFO|trainer.py:570] 2024-04-29 01:31:27,039 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:31:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:31:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:31:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:31:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 01:31:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:31:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5598743897878832, 'eval_loss': 0.8871704, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [986, 1115, 1386, 1389, 1397, 1407, 1047, 830, 543, 435, 333, 402], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51307472, 'remaining_params': 33710128, 'pruned_model_sparsity': 0.6034923592291479, 'expected_sparsity': 0.59691, 'target_sparsity': 0.6, 'step': 13050}


Iteration:  69%|██████▉   | 186/268 [00:37<01:04,  1.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:48,  1.67it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:37,  2.13it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:29,  2.67it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:23,  3.26it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:20,  3.83it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:17,  4.37it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:15,  4.91it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:13,  5.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:12,  5.72it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:12,  5.93it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:11,  6.10it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.26it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.25it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.32it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.39it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.43it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.50it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.55it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.26it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.36it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:08,  6.61it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.70it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.66it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.56it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.54it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:07,  6.56it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.58it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.66it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.41it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.45it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.56it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.50it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.53it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.45it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:31:36,832 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:31:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:31:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:31:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:31:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.90it/s]04/29/2024 01:31:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:31:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5454001814167142, 'eval_loss': 0.8602318, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1113, 1385, 1387, 1396, 1405, 1044, 826, 536, 421, 288, 374], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51737964, 'remaining_params': 33279636, 'pruned_model_sparsity': 0.6085559225383921, 'expected_sparsity': 0.599, 'target_sparsity': 0.6, 'step': 13100}


Iteration:  88%|████████▊ | 236/268 [00:47<00:25,  1.26it/s][A04/29/2024 01:31:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 13100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:47<00:18,  1.66it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:14,  2.14it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:10,  2.68it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:08,  3.23it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:07,  3.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:05,  4.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:05,  4.85it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  5.63it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  5.83it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.04it/s][A
Iteration:  93%|█████████▎| 248/268 [00:48<00:03,  6.04it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.27it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.35it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.39it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.25it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.26it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:50<00:01,  6.36it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.58it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.50it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.88it/s][A04/29/2024 01:31:43 - INFO - trainer.trainer_mod_2 - Epoch 48 finished. Took 52.0 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.15it/s]
Epoch:  49%|████▉     | 49/100 [43:18<44:55, 52.85s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:38,  6.78it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.72it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.67it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.65it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.64it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.64it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.53it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:39,  6.47it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.52it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.36it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 01:31:46,657 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:31:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:31:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:31:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:31:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:31:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:31:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5550196600183235, 'eval_loss': 0.8950445, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [977, 1107, 1380, 1381, 1390, 1400, 1038, 820, 524, 407, 274, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51826820, 'remaining_params': 33190780, 'pruned_model_sparsity': 0.6096010708370972, 'expected_sparsity': 0.60151, 'target_sparsity': 0.6, 'step': 13150}


Iteration:   7%|▋         | 18/268 [00:04<03:20,  1.25it/s][A
Iteration:   7%|▋         | 19/268 [00:05<02:30,  1.65it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:56,  2.13it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:33,  2.64it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:16,  3.20it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:04,  3.78it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:57,  4.25it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:51,  4.75it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:47,  5.11it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:44,  5.43it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:42,  5.69it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:40,  5.86it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:39,  5.98it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.14it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:38,  6.19it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.29it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.23it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.52it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.69it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.63it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.62it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.61it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.57it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.59it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.51it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.54it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.57it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.65it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.43it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.55it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:31:56,533 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:31:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:31:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:31:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:31:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:31:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:31:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5434531271960991, 'eval_loss': 0.9006938, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1106, 1378, 1380, 1389, 1399, 1037, 819, 523, 405, 273, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51842140, 'remaining_params': 33175460, 'pruned_model_sparsity': 0.6097812688196327, 'expected_sparsity': 0.60174, 'target_sparsity': 0.6, 'step': 13200}


Iteration:  25%|██▌       | 68/268 [00:14<02:39,  1.25it/s][A04/29/2024 01:31:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 13200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<02:01,  1.64it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:33,  2.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<01:13,  2.67it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:00,  3.23it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:51,  3.81it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:44,  4.36it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:39,  4.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:36,  5.28it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:34,  5.60it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:33,  5.76it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:31,  5.95it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:31,  5.97it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:30,  6.12it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.33it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.37it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.32it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.47it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.27it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.31it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.34it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.28it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.37it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.43it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.39it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.40it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.32it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.51it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.42it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:32:06,442 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:32:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:32:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:32:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:32:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:32:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:32:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5512772054945002, 'eval_loss': 0.8918049, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1110, 1383, 1383, 1394, 1403, 1040, 823, 531, 412, 292, 371], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51780860, 'remaining_params': 33236740, 'pruned_model_sparsity': 0.6090604768894912, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 13250}


Iteration:  44%|████▍     | 118/268 [00:24<01:59,  1.26it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<01:31,  1.64it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<01:10,  2.11it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:55,  2.65it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:45,  3.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:38,  3.78it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:33,  4.26it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:30,  4.75it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:27,  5.16it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:25,  5.53it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:24,  5.73it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:23,  5.96it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.13it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.18it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:22,  6.17it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.25it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.22it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.23it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.33it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.43it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.47it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.48it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.49it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.49it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.58it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.54it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.45it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.39it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:18,  6.02it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.18it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.28it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.34it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.40it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.42it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.57it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.66it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.62it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:32:16,381 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:32:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:32:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:32:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:32:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:32:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:32:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5460649174667868, 'eval_loss': 0.88699967, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [984, 1114, 1387, 1387, 1397, 1407, 1044, 827, 538, 420, 318, 385], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51526548, 'remaining_params': 33491052, 'pruned_model_sparsity': 0.6060691903794038, 'expected_sparsity': 0.59772, 'target_sparsity': 0.6, 'step': 13300}


Iteration:  63%|██████▎   | 168/268 [00:34<01:19,  1.25it/s][A04/29/2024 01:32:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 13300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:34<01:00,  1.64it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:46,  2.13it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:36,  2.67it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:29,  3.24it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:24,  3.85it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:21,  4.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:19,  4.89it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:17,  5.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:16,  5.58it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:15,  5.81it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.03it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:14,  6.19it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:14,  6.13it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.17it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.53it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.55it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.54it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.54it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.48it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.22it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.29it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.42it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.38it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.50it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.45it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.47it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.49it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.52it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.51it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.62it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.60it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.58it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.39it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.33it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:32:26,256 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:32:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:32:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:32:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:32:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:32:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:32:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.550612081256011, 'eval_loss': 0.90775174, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [981, 1111, 1385, 1385, 1394, 1404, 1040, 823, 530, 406, 276, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51771668, 'remaining_params': 33245932, 'pruned_model_sparsity': 0.6089523580999698, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 13350}


Iteration:  81%|████████▏ | 218/268 [00:44<00:40,  1.25it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:29,  1.64it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:22,  2.11it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:17,  2.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:14,  3.20it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:11,  3.77it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:10,  4.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:09,  4.75it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:08,  5.19it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:07,  5.51it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  5.77it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  5.90it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.09it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.20it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.57it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.48it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.61it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.40it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.50it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.62it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:02,  6.68it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.66it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.63it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.57it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.28it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.46it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.47it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.49it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.43it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.20it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.21it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.30it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.29it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:32:36,143 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:32:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:32:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:32:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:32:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:32:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:32:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5552849676135797, 'eval_loss': 0.86031365, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1107, 1381, 1381, 1390, 1400, 1036, 819, 525, 399, 271, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51829884, 'remaining_params': 33187716, 'pruned_model_sparsity': 0.6096371104336044, 'expected_sparsity': 0.6011, 'target_sparsity': 0.6, 'step': 13400}


Iteration: 100%|██████████| 268/268 [00:54<00:00,  1.26it/s][A04/29/2024 01:32:38 - INFO - trainer.trainer_mod_2 - Epoch 49 finished. Took 54.4 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  50%|█████     | 50/100 [44:12<44:25, 53.32s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/29/2024 01:32:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 13400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:41,  6.47it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.54it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.46it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.50it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.38it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.45it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.45it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:38,  6.57it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.47it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.30it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.37it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.43it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.39it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.37it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.35it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:40,  6.02it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:39,  6.11it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.22it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.40it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.33it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.48it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.64it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:33,  6.65it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:34,  6.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:35,  6.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:34,  6.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:07<00:34,  6.39it/s][A
Iteration:  18%|█▊        | 49/268 [00:07<00:34,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:32:46,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:32:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:32:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:32:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:32:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:32:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:32:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5599279872250126, 'eval_loss': 0.88741744, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1107, 1381, 1381, 1390, 1400, 1034, 818, 525, 397, 270, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51834480, 'remaining_params': 33183120, 'pruned_model_sparsity': 0.6096911698283649, 'expected_sparsity': 0.60124, 'target_sparsity': 0.6, 'step': 13450}


Iteration:  19%|█▊        | 50/268 [00:09<02:54,  1.25it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<02:11,  1.65it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:41,  2.13it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<01:20,  2.66it/s][A
Iteration:  20%|██        | 54/268 [00:10<01:06,  3.23it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:55,  3.82it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:48,  4.37it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:43,  4.86it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:40,  5.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:37,  5.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:36,  5.77it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:34,  5.97it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:33,  6.23it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.31it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.29it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.30it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.29it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.36it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.34it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.37it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.34it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:30,  6.31it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.42it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.52it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.54it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.42it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.44it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.51it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.57it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.58it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.60it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.48it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.53it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:26,  6.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:26,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:32:55,978 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:32:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:32:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:32:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:32:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:32:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:32:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5546789239242798, 'eval_loss': 0.8639429, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1110, 1385, 1384, 1393, 1403, 1037, 822, 532, 402, 284, 369], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51782392, 'remaining_params': 33235208, 'pruned_model_sparsity': 0.6090784966877446, 'expected_sparsity': 0.59959, 'target_sparsity': 0.6, 'step': 13500}


Iteration:  37%|███▋      | 100/268 [00:19<02:14,  1.25it/s][A04/29/2024 01:32:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 13500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:19<01:41,  1.65it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<01:18,  2.13it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:01,  2.67it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:50,  3.24it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:42,  3.82it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:37,  4.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:33,  4.83it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:30,  5.22it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:28,  5.57it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:27,  5.83it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.11it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.21it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.28it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.50it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.42it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.48it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.61it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.52it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.52it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.31it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.27it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.38it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:21,  6.31it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.47it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.30it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:20,  6.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:20,  6.33it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.39it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:19,  6.41it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.45it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:18,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:33:05,872 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:33:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:33:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:33:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:33:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:33:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:33:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5606238208505129, 'eval_loss': 0.8924558, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1113, 1388, 1386, 1395, 1405, 1039, 824, 535, 405, 292, 374], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51748688, 'remaining_params': 33268912, 'pruned_model_sparsity': 0.6086820611261669, 'expected_sparsity': 0.59852, 'target_sparsity': 0.6, 'step': 13550}


Iteration:  56%|█████▌    | 150/268 [00:29<01:34,  1.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<01:10,  1.66it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:54,  2.14it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:43,  2.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:35,  3.24it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:29,  3.77it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:26,  4.28it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:23,  4.77it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:21,  5.19it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:19,  5.52it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:18,  5.78it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.02it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.15it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:17,  6.16it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.18it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.38it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.58it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.57it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.55it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.55it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.53it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.38it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.49it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.54it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.53it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.43it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.36it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.31it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.28it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.44it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.62it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.44it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:33:15,763 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:33:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:33:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:33:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:33:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:33:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:33:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5499492780843731, 'eval_loss': 0.899672, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1110, 1385, 1383, 1393, 1404, 1037, 821, 530, 396, 270, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51786988, 'remaining_params': 33230612, 'pruned_model_sparsity': 0.6091325560825053, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 13600}


Iteration:  75%|███████▍  | 200/268 [00:39<00:54,  1.25it/s][A04/29/2024 01:33:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 13600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:39<00:40,  1.66it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:30,  2.15it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:24,  2.70it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:19,  3.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:16,  3.85it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:14,  4.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:13,  4.69it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:11,  5.14it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:10,  5.51it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:10,  5.71it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  5.93it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  6.07it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.12it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.09it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.23it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.29it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.35it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.47it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.47it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.50it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.54it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.29it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.35it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.38it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.52it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.29it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.37it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.50it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.51it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.55it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.48it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.46it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.43it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.44it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.59it/s][A[INFO|trainer.py:570] 2024-04-29 01:33:25,641 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:33:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:33:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:33:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:33:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:33:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:33:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5588305747648582, 'eval_loss': 0.8720835, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [977, 1107, 1383, 1380, 1391, 1402, 1033, 818, 527, 391, 268, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51825288, 'remaining_params': 33192312, 'pruned_model_sparsity': 0.6095830510388437, 'expected_sparsity': 0.60091, 'target_sparsity': 0.6, 'step': 13650}


Iteration:  93%|█████████▎| 250/268 [00:49<00:14,  1.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:10,  1.66it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:07,  2.13it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:05,  2.69it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:04,  3.26it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:03,  3.81it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  4.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:02,  4.82it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.16it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  5.54it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  5.81it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.00it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.22it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.30it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.17it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.12it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.15it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.08it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.51it/s][A04/29/2024 01:33:30 - INFO - trainer.trainer_mod_2 - Epoch 50 finished. Took 52.29 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  51%|█████     | 51/100 [45:05<43:17, 53.01s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.81it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.06it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.36it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.41it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:42,  6.25it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.35it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.27it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.39it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.24it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.31it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.31it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.53it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.55it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.42it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.51it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.56it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.56it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.53it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.63it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.51it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:33:35,557 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:33:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:33:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:33:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:33:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:33:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:33:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5640063794282216, 'eval_loss': 0.88155156, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [977, 1107, 1384, 1381, 1392, 1403, 1033, 819, 527, 390, 268, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51817628, 'remaining_params': 33199972, 'pruned_model_sparsity': 0.609492952047576, 'expected_sparsity': 0.60085, 'target_sparsity': 0.6, 'step': 13700}


Iteration:  12%|█▏        | 32/268 [00:07<03:08,  1.25it/s][A04/29/2024 01:33:37 - INFO - trainer.trainer_mod_2 - v4 Global step: 13700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:07<02:22,  1.65it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:49,  2.13it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:26,  2.68it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:11,  3.26it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:02,  3.68it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:54,  4.21it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:49,  4.66it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:44,  5.11it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:41,  5.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:39,  5.74it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:37,  6.05it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:36,  6.11it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.27it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.31it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.37it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.53it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.39it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.44it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.46it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.48it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.47it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.49it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.41it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.41it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:31,  6.24it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.42it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.44it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:33:45,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:33:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:33:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:33:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:33:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:33:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:33:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.570213836374093, 'eval_loss': 0.86815697, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1110, 1387, 1384, 1394, 1406, 1036, 822, 533, 395, 278, 368], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51773200, 'remaining_params': 33244400, 'pruned_model_sparsity': 0.6089703778982234, 'expected_sparsity': 0.59931, 'target_sparsity': 0.6, 'step': 13750}


Iteration:  31%|███       | 82/268 [00:17<02:27,  1.26it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:51,  1.66it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<01:26,  2.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<01:08,  2.67it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:56,  3.24it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:47,  3.78it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:41,  4.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:37,  4.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:34,  5.21it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:32,  5.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:31,  5.60it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:30,  5.75it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:28,  6.02it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.20it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.33it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.67it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:24,  6.71it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:24,  6.68it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:24,  6.63it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.60it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.59it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.55it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.57it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.55it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.43it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.46it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.59it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.55it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.54it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.41it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.37it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.40it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.48it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.52it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:33:55,309 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:33:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:33:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:33:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:33:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:33:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:33:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5569945850020542, 'eval_loss': 0.8581762, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [981, 1111, 1389, 1385, 1396, 1407, 1036, 822, 534, 394, 276, 366], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51198700, 'remaining_params': 33818900, 'pruned_model_sparsity': 0.6022129535531466, 'expected_sparsity': 0.59895, 'target_sparsity': 0.6, 'step': 13800}


Iteration:  49%|████▉     | 132/268 [00:26<01:48,  1.25it/s][A04/29/2024 01:33:57 - INFO - trainer.trainer_mod_2 - v4 Global step: 13800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:27<01:21,  1.65it/s][A
Iteration:  50%|█████     | 134/268 [00:27<01:03,  2.12it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:49,  2.68it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:40,  3.23it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:34,  3.78it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:29,  4.37it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:26,  4.86it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:24,  5.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:22,  5.59it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:21,  5.83it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  5.97it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:20,  6.19it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:20,  6.14it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.41it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.45it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.46it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.41it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.33it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.30it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.41it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.43it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.43it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.46it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.47it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.62it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.48it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.37it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:16,  6.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.31it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.37it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.41it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.46it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.40it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.47it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:34:05,232 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:34:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:34:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:34:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:34:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:34:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:34:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5661576952804931, 'eval_loss': 0.860185, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [978, 1108, 1387, 1383, 1394, 1404, 1032, 818, 530, 387, 267, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51800776, 'remaining_params': 33216824, 'pruned_model_sparsity': 0.6092947342667872, 'expected_sparsity': 0.60013, 'target_sparsity': 0.6, 'step': 13850}


Iteration:  68%|██████▊   | 182/268 [00:36<01:08,  1.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:51,  1.65it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:39,  2.11it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:31,  2.65it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:25,  3.20it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:21,  3.78it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:18,  4.28it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:16,  4.79it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:15,  5.12it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:13,  5.51it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:13,  5.77it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.06it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.51it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.41it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.42it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.34it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.18it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.09it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.22it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.29it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.43it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.37it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.42it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.48it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.42it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.47it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.47it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.52it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.57it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.55it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:34:15,160 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:34:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:34:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:34:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:34:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:34:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:34:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5651604238862242, 'eval_loss': 0.8986209, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [975, 1105, 1384, 1380, 1391, 1402, 1029, 816, 527, 383, 266, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51839076, 'remaining_params': 33178524, 'pruned_model_sparsity': 0.6097452292231256, 'expected_sparsity': 0.60083, 'target_sparsity': 0.6, 'step': 13900}


Iteration:  87%|████████▋ | 232/268 [00:46<00:28,  1.25it/s][A04/29/2024 01:34:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 13900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:46<00:21,  1.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:16,  2.09it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:12,  2.63it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:10,  3.18it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:08,  3.81it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:06,  4.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:05,  4.85it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:05,  5.24it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  5.62it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.86it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  6.03it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.29it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.10it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.20it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.32it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.43it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.43it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.29it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.45it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.56it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.89it/s][A04/29/2024 01:34:22 - INFO - trainer.trainer_mod_2 - Epoch 51 finished. Took 52.27 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  52%|█████▏    | 52/100 [45:57<42:13, 52.79s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.85it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.32it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:43,  6.02it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:42,  6.09it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.25it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.35it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 01:34:25,053 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:34:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:34:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:34:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:34:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:34:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:34:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5627577880793446, 'eval_loss': 0.8620495, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1106, 1385, 1380, 1392, 1403, 1029, 816, 528, 382, 266, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51829884, 'remaining_params': 33187716, 'pruned_model_sparsity': 0.6096371104336044, 'expected_sparsity': 0.60062, 'target_sparsity': 0.6, 'step': 13950}


Iteration:   5%|▌         | 14/268 [00:04<03:24,  1.24it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:34,  1.64it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:59,  2.12it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:35,  2.63it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:17,  3.21it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:05,  3.83it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:56,  4.41it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:50,  4.88it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:46,  5.30it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:43,  5.59it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.86it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:40,  6.05it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:39,  6.17it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.21it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.16it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.14it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:39,  5.99it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.26it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.25it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.24it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.42it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.47it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.39it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.40it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.35it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.14it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.35it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.36it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.40it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.35it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.33it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.52it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:31,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:34:35,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:34:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:34:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:34:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:34:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:34:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:34:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5447384394358111, 'eval_loss': 0.89896387, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [980, 1110, 1388, 1383, 1394, 1405, 1029, 819, 533, 386, 275, 369], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51224744, 'remaining_params': 33792856, 'pruned_model_sparsity': 0.6025192901234568, 'expected_sparsity': 0.59915, 'target_sparsity': 0.6, 'step': 14000}


Iteration:  24%|██▍       | 64/268 [00:14<02:43,  1.25it/s][A04/29/2024 01:34:37 - INFO - trainer.trainer_mod_2 - v4 Global step: 14000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:14<02:03,  1.65it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:35,  2.12it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:15,  2.66it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:01,  3.23it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:52,  3.81it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:45,  4.40it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:39,  4.93it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:37,  5.18it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:35,  5.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:33,  5.72it/s][A
Iteration:  28%|██▊       | 75/268 [00:16<00:32,  5.88it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:31,  6.05it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.22it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:30,  6.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.25it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.26it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.31it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.50it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.52it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.55it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.55it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.28it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.23it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.30it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.28it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.36it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.41it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.41it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.58it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.60it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.58it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.65it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.61it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.67it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:23,  6.67it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:23,  6.63it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.58it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.57it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.52it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:34:44,881 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:34:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:34:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:34:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:34:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:34:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:34:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5403785768297347, 'eval_loss': 0.8918086, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [980, 1111, 1389, 1384, 1395, 1406, 1029, 820, 533, 383, 266, 362], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51226276, 'remaining_params': 33791324, 'pruned_model_sparsity': 0.6025373099217103, 'expected_sparsity': 0.5994, 'target_sparsity': 0.6, 'step': 14050}


Iteration:  43%|████▎     | 114/268 [00:24<02:02,  1.25it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<01:32,  1.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<01:11,  2.13it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:56,  2.68it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:46,  3.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:39,  3.80it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:33,  4.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:30,  4.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:27,  5.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:25,  5.73it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:24,  5.93it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:23,  6.20it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.29it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.42it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.38it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.34it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.40it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.53it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.53it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.43it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.53it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.52it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.23it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.39it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.49it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.42it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.44it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.35it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.39it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.37it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.35it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.30it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.40it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.48it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:34:54,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:34:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:34:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:34:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:34:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 01:34:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:34:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5486729244194056, 'eval_loss': 0.8716685, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [976, 1108, 1387, 1381, 1393, 1403, 1027, 818, 530, 379, 264, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51817628, 'remaining_params': 33199972, 'pruned_model_sparsity': 0.609492952047576, 'expected_sparsity': 0.60042, 'target_sparsity': 0.6, 'step': 14100}


Iteration:  61%|██████    | 164/268 [00:34<01:22,  1.26it/s][A04/29/2024 01:34:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 14100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:34<01:01,  1.66it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:47,  2.15it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:37,  2.70it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:30,  3.26it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:25,  3.85it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:22,  4.36it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:19,  4.90it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:18,  5.29it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:16,  5.62it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:16,  5.73it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:15,  5.88it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:15,  6.09it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.25it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.59it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.50it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.45it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.39it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.36it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.35it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.35it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.23it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.34it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.38it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.37it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.46it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.40it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.37it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.51it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.56it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.65it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:35:04,594 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:35:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:35:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:35:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:35:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.90it/s]04/29/2024 01:35:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:35:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5722385869866928, 'eval_loss': 0.8639572, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [975, 1107, 1386, 1379, 1391, 1403, 1025, 816, 529, 377, 264, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51836012, 'remaining_params': 33181588, 'pruned_model_sparsity': 0.6097091896266185, 'expected_sparsity': 0.60068, 'target_sparsity': 0.6, 'step': 14150}


Iteration:  80%|███████▉  | 214/268 [00:43<00:42,  1.26it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:31,  1.66it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:24,  2.13it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:19,  2.68it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:15,  3.25it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:12,  3.83it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:11,  4.34it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:09,  4.76it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:08,  5.21it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:08,  5.55it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  5.80it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  5.94it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.11it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.24it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.32it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.39it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.34it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.41it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.48it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.60it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.57it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.58it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.39it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.43it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.35it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.30it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.22it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.21it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.30it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.53it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.43it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.52it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.63it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.50it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.54it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 01:35:14,443 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:35:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:35:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:35:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:35:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:35:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:35:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5709406887467645, 'eval_loss': 0.8631039, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [977, 1110, 1388, 1381, 1393, 1405, 1027, 817, 532, 377, 267, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51253852, 'remaining_params': 33763748, 'pruned_model_sparsity': 0.602861666290274, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 14200}


Iteration:  99%|█████████▊| 264/268 [00:53<00:03,  1.26it/s][A04/29/2024 01:35:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 14200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:53<00:01,  1.66it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  2.14it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  2.68it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  3.34it/s][A04/29/2024 01:35:17 - INFO - trainer.trainer_mod_2 - Epoch 52 finished. Took 54.33 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  53%|█████▎    | 53/100 [46:51<41:42, 53.25s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.54it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.55it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.58it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.54it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.52it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.52it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.52it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.62it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.62it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.58it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.47it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.51it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.65it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.64it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.54it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.65it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.66it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.64it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:35,  6.71it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.66it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.50it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.58it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.60it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.48it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:35,  6.47it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.39it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:35,  6.35it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:35,  6.29it/s][A[INFO|trainer.py:570] 2024-04-29 01:35:24,227 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:35:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:35:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:35:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:35:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:35:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:35:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5576106804001113, 'eval_loss': 0.87633985, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [979, 1111, 1389, 1382, 1394, 1406, 1028, 819, 533, 376, 265, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51238532, 'remaining_params': 33779068, 'pruned_model_sparsity': 0.6026814683077386, 'expected_sparsity': 0.59931, 'target_sparsity': 0.6, 'step': 14250}


Iteration:  17%|█▋        | 46/268 [00:09<02:58,  1.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<02:14,  1.64it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:44,  2.11it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:22,  2.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:08,  3.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:57,  3.79it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:50,  4.30it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:44,  4.79it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:41,  5.20it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:38,  5.55it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:36,  5.81it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:35,  5.89it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:34,  6.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.25it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.29it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:32,  6.36it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.60it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.58it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.60it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.58it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.34it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.46it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.48it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.64it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.59it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.61it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.49it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:28,  6.36it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.43it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:27,  6.45it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:28,  6.17it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:28,  6.24it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:27,  6.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:27,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:35:34,123 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:35:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:35:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:35:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:35:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:35:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:35:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5443521169935567, 'eval_loss': 0.9149979, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [977, 1109, 1388, 1380, 1393, 1404, 1025, 816, 530, 373, 263, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51270704, 'remaining_params': 33746896, 'pruned_model_sparsity': 0.6030598840710629, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 14300}


Iteration:  36%|███▌      | 96/268 [00:19<02:18,  1.24it/s][A04/29/2024 01:35:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 14300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:19<01:44,  1.64it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<01:20,  2.12it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:03,  2.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:51,  3.27it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:43,  3.80it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:38,  4.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:34,  4.82it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:31,  5.23it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:29,  5.57it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:27,  5.82it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:26,  6.02it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:26,  6.10it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.15it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.41it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.29it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.26it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:25,  6.10it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.24it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.26it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.27it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.27it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.29it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.30it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.35it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.52it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.52it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.46it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.48it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.43it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.45it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.51it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.54it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.56it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.58it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.57it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.52it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:35:44,029 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:35:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:35:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:35:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:35:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:35:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:35:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.560464995177653, 'eval_loss': 0.9016322, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [974, 1106, 1386, 1377, 1391, 1401, 1022, 813, 528, 369, 262, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51309004, 'remaining_params': 33708596, 'pruned_model_sparsity': 0.6035103790274013, 'expected_sparsity': 0.60062, 'target_sparsity': 0.6, 'step': 14350}


Iteration:  54%|█████▍    | 146/268 [00:29<01:37,  1.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<01:13,  1.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:56,  2.11it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:44,  2.67it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:36,  3.24it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:30,  3.82it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:26,  4.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:23,  4.85it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:21,  5.21it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:20,  5.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:19,  5.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:18,  5.97it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.16it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.26it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.32it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.30it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.23it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.30it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.42it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.48it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.44it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:15,  6.05it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.20it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.27it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.42it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.28it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.41it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.46it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.47it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.35it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.29it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.18it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:12,  6.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.27it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.36it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:35:53,998 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:35:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:35:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:35:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:35:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:35:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:35:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5448788961504227, 'eval_loss': 0.9030638, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [974, 1106, 1386, 1377, 1390, 1401, 1021, 813, 529, 369, 261, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51310536, 'remaining_params': 33707064, 'pruned_model_sparsity': 0.6035283988256549, 'expected_sparsity': 0.60061, 'target_sparsity': 0.6, 'step': 14400}


Iteration:  73%|███████▎  | 196/268 [00:38<00:57,  1.25it/s][A04/29/2024 01:35:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 14400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:39<00:43,  1.65it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:32,  2.12it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:25,  2.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:20,  3.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:17,  3.81it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:15,  4.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:13,  4.84it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:12,  5.23it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:11,  5.51it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  5.77it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  6.06it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.17it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.31it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.30it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.34it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.38it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.35it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.41it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.36it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.42it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.45it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.35it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.42it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.37it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.43it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.56it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.46it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.51it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.50it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.49it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.47it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.30it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.42it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.45it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:36:03,874 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:36:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:36:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:36:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:36:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:36:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:36:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5584013487121077, 'eval_loss': 0.88145065, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [978, 1109, 1389, 1380, 1393, 1404, 1024, 816, 534, 373, 271, 367], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51249256, 'remaining_params': 33768344, 'pruned_model_sparsity': 0.6028076068955134, 'expected_sparsity': 0.59909, 'target_sparsity': 0.6, 'step': 14450}


Iteration:  92%|█████████▏| 246/268 [00:48<00:17,  1.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:12,  1.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:09,  2.13it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:07,  2.69it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:05,  3.29it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:04,  3.83it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:03,  4.29it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:03,  4.79it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.22it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  5.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.68it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  5.91it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.95it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  5.97it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.04it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.20it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.52it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.54it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.44it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.80it/s][A04/29/2024 01:36:09 - INFO - trainer.trainer_mod_2 - Epoch 53 finished. Took 52.24 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  54%|█████▍    | 54/100 [47:43<40:35, 52.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.54it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.41it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.48it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.40it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.24it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.29it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.43it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.33it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.37it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.39it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.40it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.46it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.50it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.62it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.71it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.65it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.61it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.62it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.58it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:36:13,754 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:36:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:36:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:36:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:36:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:36:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:36:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5652516382961122, 'eval_loss': 0.88372004, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [978, 1110, 1389, 1380, 1393, 1405, 1024, 816, 533, 369, 262, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51261512, 'remaining_params': 33756088, 'pruned_model_sparsity': 0.6029517652815417, 'expected_sparsity': 0.59954, 'target_sparsity': 0.6, 'step': 14500}


Iteration:  10%|█         | 28/268 [00:06<03:12,  1.25it/s][A04/29/2024 01:36:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 14500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:06<02:25,  1.64it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:52,  2.12it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:29,  2.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:13,  3.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:02,  3.77it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:53,  4.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:48,  4.85it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:44,  5.25it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:41,  5.57it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:39,  5.84it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:38,  6.01it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.15it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.24it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.31it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.19it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.30it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.47it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.41it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.33it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.46it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.46it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.44it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.44it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.45it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.50it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.61it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.31it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.31it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.36it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.38it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:36:23,658 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:36:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:36:23 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:36:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:36:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:36:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:36:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5713110471171509, 'eval_loss': 0.87011266, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [974, 1106, 1386, 1377, 1391, 1402, 1021, 813, 529, 364, 260, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51309004, 'remaining_params': 33708596, 'pruned_model_sparsity': 0.6035103790274013, 'expected_sparsity': 0.60052, 'target_sparsity': 0.6, 'step': 14550}


Iteration:  29%|██▉       | 78/268 [00:16<02:31,  1.25it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:55,  1.64it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<01:28,  2.12it/s][A
Iteration:  30%|███       | 81/268 [00:16<01:10,  2.65it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:58,  3.20it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:49,  3.76it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:42,  4.31it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:38,  4.80it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:35,  5.16it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:32,  5.52it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:31,  5.68it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:30,  5.84it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:29,  5.96it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:29,  6.06it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.20it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.40it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.37it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.59it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.61it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:23,  6.68it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:23,  6.71it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.65it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.60it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.55it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.75it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.61it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.51it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.43it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.39it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.51it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:36:33,513 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:36:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:36:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:36:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:36:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:36:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:36:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.8857941, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1106, 1385, 1376, 1390, 1401, 1019, 812, 529, 361, 259, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51319728, 'remaining_params': 33697872, 'pruned_model_sparsity': 0.6036365176151761, 'expected_sparsity': 0.60061, 'target_sparsity': 0.6, 'step': 14600}


Iteration:  48%|████▊     | 128/268 [00:26<01:51,  1.25it/s][A04/29/2024 01:36:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 14600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:26<01:24,  1.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<01:04,  2.13it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:51,  2.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:41,  3.25it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:35,  3.83it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:30,  4.38it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:27,  4.80it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:25,  5.20it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:23,  5.53it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:22,  5.86it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:21,  6.13it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.23it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:21,  6.03it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.18it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.20it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.40it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.39it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.46it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.41it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.33it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.35it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.42it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.42it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.55it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.51it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.31it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.39it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.42it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.44it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.44it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.44it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.35it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.37it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.34it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:36:43,428 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:36:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:36:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:36:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:36:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:36:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:36:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5619111841232217, 'eval_loss': 0.8747488, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [976, 1108, 1387, 1379, 1393, 1402, 1021, 815, 533, 362, 262, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51278364, 'remaining_params': 33739236, 'pruned_model_sparsity': 0.6031499830623306, 'expected_sparsity': 0.59961, 'target_sparsity': 0.6, 'step': 14650}


Iteration:  66%|██████▋   | 178/268 [00:36<01:11,  1.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:54,  1.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:41,  2.13it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:32,  2.68it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:26,  3.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:22,  3.83it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:19,  4.41it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:16,  4.90it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:15,  5.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:14,  5.68it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:13,  5.83it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:13,  5.95it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.08it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.15it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.25it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.25it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.32it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.38it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.49it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.60it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.28it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.38it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.43it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.45it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.45it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.57it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.43it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.50it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.50it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.50it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:36:53,303 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:36:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:36:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:36:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:36:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:36:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:36:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.55727640631709, 'eval_loss': 0.87695247, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [977, 1110, 1389, 1381, 1394, 1403, 1022, 816, 533, 362, 260, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51266108, 'remaining_params': 33751492, 'pruned_model_sparsity': 0.6030058246763024, 'expected_sparsity': 0.59926, 'target_sparsity': 0.6, 'step': 14700}


Iteration:  85%|████████▌ | 228/268 [00:46<00:32,  1.25it/s][A04/29/2024 01:36:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 14700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:46<00:23,  1.64it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:17,  2.12it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:14,  2.63it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:11,  3.19it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:09,  3.79it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:07,  4.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:06,  4.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:06,  5.16it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  5.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:05,  5.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  5.82it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  5.99it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.12it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.25it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.50it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.51it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.08it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.23it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.23it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.30it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.35it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.44it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.47it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.42it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.79it/s][A04/29/2024 01:37:01 - INFO - trainer.trainer_mod_2 - Epoch 54 finished. Took 52.27 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  55%|█████▌    | 55/100 [48:36<39:33, 52.75s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.28it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.46it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.34it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.52it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 01:37:03,252 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:37:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:37:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:37:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:37:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:37:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:37:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5575725329540656, 'eval_loss': 0.8978331, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [974, 1107, 1386, 1378, 1391, 1401, 1019, 813, 530, 358, 258, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51309004, 'remaining_params': 33708596, 'pruned_model_sparsity': 0.6035103790274013, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 14750}


Iteration:   4%|▎         | 10/268 [00:03<03:31,  1.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:38,  1.62it/s][A
Iteration:   4%|▍         | 12/268 [00:04<02:01,  2.11it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:37,  2.61it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:19,  3.19it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:07,  3.76it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:00,  4.18it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:54,  4.62it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:49,  5.09it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:45,  5.44it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:43,  5.71it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:41,  5.96it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:40,  6.09it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.32it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.47it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:37,  6.41it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.53it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.46it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.52it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.53it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.59it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.38it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.38it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.39it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.42it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.42it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.32it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:37:13,171 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:37:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:37:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:37:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:37:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:37:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:37:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5520779858808869, 'eval_loss': 0.89324105, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1105, 1384, 1375, 1389, 1398, 1017, 810, 528, 354, 257, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51339644, 'remaining_params': 33677956, 'pruned_model_sparsity': 0.6038707749924721, 'expected_sparsity': 0.60089, 'target_sparsity': 0.6, 'step': 14800}


Iteration:  22%|██▏       | 60/268 [00:13<02:45,  1.26it/s][A04/29/2024 01:37:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 14800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:13<02:05,  1.65it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:36,  2.13it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<01:16,  2.69it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:02,  3.25it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:53,  3.82it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:46,  4.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:42,  4.72it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:38,  5.14it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:36,  5.51it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:33,  5.85it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:32,  6.05it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:31,  6.26it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.28it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.47it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.37it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.48it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.50it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.61it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.40it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.37it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.34it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.41it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:29,  6.04it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.19it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.28it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.18it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.31it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.38it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.54it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.57it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.68it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.44it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.36it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:37:23,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:37:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:37:23 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:37:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:37:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:37:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:37:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5296677503485717, 'eval_loss': 0.9209695, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [975, 1107, 1385, 1377, 1391, 1400, 1018, 812, 532, 356, 261, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51304408, 'remaining_params': 33713192, 'pruned_model_sparsity': 0.6034563196326408, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 14850}


Iteration:  41%|████      | 110/268 [00:23<02:06,  1.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<01:34,  1.65it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<01:13,  2.13it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:58,  2.67it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:47,  3.25it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:39,  3.86it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:34,  4.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:30,  4.88it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:28,  5.31it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:26,  5.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:25,  5.72it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:24,  5.96it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.09it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.12it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:23,  6.18it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:23,  6.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:22,  6.19it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.29it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.20it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.37it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.45it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.45it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.38it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.41it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.38it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.34it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.42it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.56it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.36it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.46it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.51it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.49it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.33it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.57it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.50it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.63it/s][A[INFO|trainer.py:570] 2024-04-29 01:37:32,978 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:37:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:37:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:37:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:37:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:37:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:37:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.54370529570588, 'eval_loss': 0.90664023, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [978, 1110, 1389, 1379, 1393, 1403, 1020, 815, 537, 362, 272, 371], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51247724, 'remaining_params': 33769876, 'pruned_model_sparsity': 0.6027895870972598, 'expected_sparsity': 0.59845, 'target_sparsity': 0.6, 'step': 14900}


Iteration:  60%|█████▉    | 160/268 [00:33<01:26,  1.25it/s][A04/29/2024 01:37:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 14900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:33<01:04,  1.65it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:49,  2.12it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:39,  2.66it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:32,  3.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:27,  3.81it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:23,  4.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:20,  4.86it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:19,  5.25it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:17,  5.57it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:16,  5.77it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:16,  5.92it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.06it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.13it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.27it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.33it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.28it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.23it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.28it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.43it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.47it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.39it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.46it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.49it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.61it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.55it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:10,  6.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.39it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:09,  6.62it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.58it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.67it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.71it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 01:37:42,859 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:37:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:37:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:37:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:37:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:37:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:37:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5520779858808869, 'eval_loss': 0.90604764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1106, 1385, 1376, 1390, 1400, 1017, 811, 529, 352, 257, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51328920, 'remaining_params': 33688680, 'pruned_model_sparsity': 0.6037446364046973, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 14950}


Iteration:  78%|███████▊  | 210/268 [00:43<00:46,  1.24it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:34,  1.65it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:26,  2.13it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:20,  2.66it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:16,  3.22it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:14,  3.75it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:12,  4.31it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:10,  4.78it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:09,  5.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  5.54it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:08,  5.80it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.01it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.12it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.26it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.26it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.19it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.21it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.28it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.27it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.27it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.21it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.41it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.34it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.41it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.57it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.52it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.32it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.43it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.47it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.48it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.41it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:37:52,803 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:37:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:37:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:37:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:37:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:37:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:37:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5353569722427551, 'eval_loss': 0.90400714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1103, 1381, 1372, 1386, 1397, 1013, 807, 527, 348, 256, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51377944, 'remaining_params': 33639656, 'pruned_model_sparsity': 0.6043212699488106, 'expected_sparsity': 0.60115, 'target_sparsity': 0.6, 'step': 15000}


Iteration:  97%|█████████▋| 260/268 [00:53<00:06,  1.25it/s][A04/29/2024 01:37:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 15000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:53<00:04,  1.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:02,  2.13it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  2.67it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:01,  3.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  3.84it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  4.41it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  4.83it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  5.45it/s][A04/29/2024 01:37:56 - INFO - trainer.trainer_mod_2 - Epoch 55 finished. Took 54.46 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  56%|█████▌    | 56/100 [49:30<39:03, 53.26s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:44,  6.06it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.19it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.46it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.41it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.48it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.37it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.37it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.43it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.50it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.51it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.50it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.54it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.55it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.52it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.62it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.58it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.55it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.57it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:34,  6.65it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:34,  6.62it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.39it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.39it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:38:02,624 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:38:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:38:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:38:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:38:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:38:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:38:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5406003416615092, 'eval_loss': 0.9136021, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [971, 1105, 1383, 1374, 1387, 1398, 1014, 809, 531, 351, 262, 363], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51339644, 'remaining_params': 33677956, 'pruned_model_sparsity': 0.6038707749924721, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 15050}


Iteration:  16%|█▌        | 42/268 [00:08<03:00,  1.25it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:16,  1.65it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:45,  2.12it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<01:23,  2.68it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:08,  3.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:58,  3.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:50,  4.33it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:44,  4.88it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:41,  5.28it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:38,  5.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:36,  5.87it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:35,  6.05it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:35,  6.09it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:34,  6.15it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.24it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.29it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.34it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.40it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.64it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.51it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.61it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.60it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.67it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.65it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.70it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.69it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.31it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.47it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.50it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.37it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.38it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.52it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.44it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.45it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.44it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:29,  6.20it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:28,  6.26it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:28,  6.33it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:28,  6.31it/s][A[INFO|trainer.py:570] 2024-04-29 01:38:12,514 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:38:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:38:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:38:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:38:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:38:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:38:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5465839960451542, 'eval_loss': 0.8991537, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [976, 1109, 1387, 1377, 1390, 1401, 1017, 812, 538, 358, 276, 379], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51065416, 'remaining_params': 33952184, 'pruned_model_sparsity': 0.6006452311050888, 'expected_sparsity': 0.59798, 'target_sparsity': 0.6, 'step': 15100}


Iteration:  34%|███▍      | 92/268 [00:18<02:21,  1.24it/s][A04/29/2024 01:38:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 15100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:18<01:46,  1.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<01:22,  2.11it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:05,  2.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:53,  3.22it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:45,  3.80it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:39,  4.27it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:35,  4.78it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:31,  5.26it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:30,  5.54it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:28,  5.73it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:27,  5.96it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.10it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.14it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:26,  6.17it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.20it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:26,  6.13it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.21it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.32it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.40it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.44it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.30it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.36it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.31it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.41it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.52it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.35it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.31it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.34it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.60it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.47it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.53it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.50it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.49it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.42it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.31it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:20,  6.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:38:22,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:38:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:38:22 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:38:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:38:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:38:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:38:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5434531271960991, 'eval_loss': 0.9055955, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1103, 1382, 1372, 1386, 1397, 1011, 806, 528, 344, 255, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51379476, 'remaining_params': 33638124, 'pruned_model_sparsity': 0.6043392897470642, 'expected_sparsity': 0.60079, 'target_sparsity': 0.6, 'step': 15150}


Iteration:  53%|█████▎    | 142/268 [00:28<01:40,  1.25it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<01:15,  1.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:58,  2.12it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:46,  2.65it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:37,  3.26it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:31,  3.83it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:27,  4.34it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:24,  4.91it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:22,  5.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:20,  5.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:19,  5.98it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.08it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.31it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.25it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.26it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.37it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.39it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.03it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.15it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.25it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.15it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:17,  6.01it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.08it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.07it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.43it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.45it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.27it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.37it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.29it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.26it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.33it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.42it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.52it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.55it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.45it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.46it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:38:32,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:38:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:38:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:38:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:38:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:38:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:38:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5417717645202469, 'eval_loss': 0.8821288, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1100, 1379, 1369, 1382, 1395, 1008, 804, 526, 340, 254, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51417776, 'remaining_params': 33599824, 'pruned_model_sparsity': 0.6047897847034026, 'expected_sparsity': 0.60153, 'target_sparsity': 0.6, 'step': 15200}


Iteration:  72%|███████▏  | 192/268 [00:38<01:00,  1.25it/s][A04/29/2024 01:38:34 - INFO - trainer.trainer_mod_2 - v4 Global step: 15200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:38<00:45,  1.65it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:34,  2.13it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:27,  2.68it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:22,  3.23it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:18,  3.80it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:15,  4.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:14,  4.88it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:12,  5.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:11,  5.59it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:11,  5.85it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.03it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.10it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.15it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  6.19it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.33it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.27it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.50it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:07,  6.65it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.72it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.60it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.60it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.56it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.47it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.43it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.46it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.36it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.27it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.35it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.50it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.55it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.59it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.67it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:38:42,245 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:38:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:38:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:38:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:38:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:38:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:38:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.54552128338247, 'eval_loss': 0.9111113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1105, 1384, 1373, 1387, 1399, 1012, 810, 536, 352, 272, 381], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51105248, 'remaining_params': 33912352, 'pruned_model_sparsity': 0.6011137458596808, 'expected_sparsity': 0.59866, 'target_sparsity': 0.6, 'step': 15250}


Iteration:  90%|█████████ | 242/268 [00:48<00:20,  1.26it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:15,  1.65it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:11,  2.13it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:08,  2.69it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:06,  3.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:05,  3.84it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:04,  4.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  4.86it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.27it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  5.62it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  5.87it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.00it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.14it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.25it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.45it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.60it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.53it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.46it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.82it/s][A04/29/2024 01:38:48 - INFO - trainer.trainer_mod_2 - Epoch 56 finished. Took 52.2 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  57%|█████▋    | 57/100 [50:22<37:56, 52.94s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.30it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.50it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.33it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.41it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.35it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.38it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.48it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.42it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.26it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.33it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.53it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:36,  6.71it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.69it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:38:52,058 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:38:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:38:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:38:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:38:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:38:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:38:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5458722532834043, 'eval_loss': 0.8954159, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1106, 1385, 1374, 1388, 1400, 1012, 810, 536, 348, 264, 369], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51312068, 'remaining_params': 33705532, 'pruned_model_sparsity': 0.6035464186239085, 'expected_sparsity': 0.59885, 'target_sparsity': 0.6, 'step': 15300}


Iteration:   9%|▉         | 24/268 [00:05<03:13,  1.26it/s][A04/29/2024 01:38:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 15300, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:06<02:26,  1.66it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:53,  2.13it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:30,  2.66it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:14,  3.23it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:02,  3.81it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:54,  4.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:48,  4.87it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:44,  5.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:42,  5.58it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:40,  5.77it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:39,  5.92it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:39,  5.85it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:38,  6.07it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:37,  6.19it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:37,  6.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.31it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.47it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.60it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.57it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.60it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.58it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.55it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.55it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.55it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.57it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.49it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.59it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.56it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.56it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.46it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.55it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.52it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.47it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.53it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 01:39:01,878 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:39:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:39:01 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:39:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:39:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:39:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:39:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.54370529570588, 'eval_loss': 0.89840543, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1099, 1378, 1367, 1381, 1392, 1004, 802, 526, 336, 253, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51440756, 'remaining_params': 33576844, 'pruned_model_sparsity': 0.6050600816772057, 'expected_sparsity': 0.60193, 'target_sparsity': 0.6, 'step': 15350}


Iteration:  28%|██▊       | 74/268 [00:15<02:33,  1.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:55,  1.67it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<01:29,  2.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<01:11,  2.69it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:58,  3.26it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:48,  3.88it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:42,  4.42it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:38,  4.88it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:35,  5.28it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:33,  5.45it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:32,  5.71it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:31,  5.87it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.07it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.23it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.30it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:28,  6.27it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.36it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.34it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.31it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:28,  6.19it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.30it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.39it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.32it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.37it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.41it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.35it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.41it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.61it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.72it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.66it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.62it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.57it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.37it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.48it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.41it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.54it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:23,  6.26it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.31it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 01:39:11,782 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:39:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:39:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:39:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:39:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:39:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:39:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5492247863049868, 'eval_loss': 0.9132475, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1100, 1379, 1368, 1382, 1393, 1004, 803, 529, 339, 257, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51414712, 'remaining_params': 33602888, 'pruned_model_sparsity': 0.6047537451068955, 'expected_sparsity': 0.6011, 'target_sparsity': 0.6, 'step': 15400}


Iteration:  46%|████▋     | 124/268 [00:25<01:55,  1.25it/s][A04/29/2024 01:39:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 15400, Alignment: tensor([ 0,  6,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:25<01:27,  1.64it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<01:06,  2.13it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:52,  2.67it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:43,  3.20it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:36,  3.81it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:32,  4.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:28,  4.85it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:25,  5.34it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:24,  5.49it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:23,  5.75it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:22,  5.88it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:23,  5.69it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:22,  5.90it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.07it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:21,  6.12it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.25it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.31it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.44it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.54it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.52it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.40it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.48it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.45it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.51it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.52it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.50it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.50it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.30it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.37it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.62it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:39:21,723 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:39:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:39:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:39:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:39:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:39:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:39:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5337700382788287, 'eval_loss': 0.90541863, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [975, 1108, 1386, 1375, 1388, 1400, 1010, 811, 546, 370, 286, 411], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 50832552, 'remaining_params': 34185048, 'pruned_model_sparsity': 0.5979062217705511, 'expected_sparsity': 0.5961, 'target_sparsity': 0.6, 'step': 15450}


Iteration:  65%|██████▍   | 174/268 [00:35<01:15,  1.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:56,  1.64it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:43,  2.10it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:34,  2.64it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:28,  3.17it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:24,  3.70it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:21,  4.11it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:19,  4.58it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:16,  5.09it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:15,  5.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:14,  5.79it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:14,  5.92it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.08it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:13,  6.18it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.28it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.47it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.37it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.38it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.58it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.44it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.45it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.49it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.55it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.61it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.62it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.57it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.58it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.52it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.45it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.42it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.46it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.41it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:39:31,615 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:39:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:39:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:39:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:39:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:39:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:39:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5334876461854267, 'eval_loss': 0.9173116, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1100, 1380, 1368, 1382, 1394, 1003, 802, 527, 335, 252, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.6015, 'target_sparsity': 0.6, 'step': 15500}


Iteration:  84%|████████▎ | 224/268 [00:45<00:35,  1.25it/s][A04/29/2024 01:39:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 15500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:45<00:25,  1.66it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:19,  2.14it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:15,  2.68it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:12,  3.25it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:10,  3.87it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:08,  4.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:07,  4.88it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.28it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:06,  5.59it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  5.82it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.03it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.10it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  6.19it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.23it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.33it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.45it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.48it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.41it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.37it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.41it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.26it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.18it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.35it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.28it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.23it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.49it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.85it/s][A04/29/2024 01:39:40 - INFO - trainer.trainer_mod_2 - Epoch 57 finished. Took 52.21 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  58%|█████▊    | 58/100 [51:14<36:54, 52.72s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.58it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:39:41,489 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:39:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:39:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:39:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:39:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:39:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:39:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5383825234212567, 'eval_loss': 0.9086893, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1096, 1375, 1363, 1378, 1390, 999, 798, 525, 330, 252, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.6026, 'target_sparsity': 0.6, 'step': 15550}


Iteration:   2%|▏         | 6/268 [00:03<03:52,  1.13it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:48,  1.55it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:07,  2.04it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:38,  2.62it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:20,  3.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:08,  3.77it/s][A
Iteration:   4%|▍         | 12/268 [00:04<00:59,  4.33it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:52,  4.82it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:49,  5.11it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:46,  5.50it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:43,  5.74it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:42,  5.91it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:41,  6.00it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:40,  6.18it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:39,  6.20it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.28it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.33it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.29it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.28it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:37,  6.42it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:36,  6.60it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:36,  6.59it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.62it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.58it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.51it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.54it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.51it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.42it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.43it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.37it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.30it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.34it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.62it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.60it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.46it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 01:39:51,387 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:39:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:39:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:39:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:39:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:39:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:39:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5286324175580216, 'eval_loss': 0.92924035, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [971, 1104, 1383, 1370, 1385, 1397, 1005, 806, 541, 350, 275, 393], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 50916812, 'remaining_params': 34100788, 'pruned_model_sparsity': 0.5988973106744956, 'expected_sparsity': 0.59814, 'target_sparsity': 0.6, 'step': 15600}


Iteration:  21%|██        | 56/268 [00:12<02:49,  1.25it/s][A04/29/2024 01:39:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 15600, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:13<02:08,  1.65it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:38,  2.12it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<01:18,  2.68it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:04,  3.23it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:54,  3.82it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:47,  4.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:42,  4.80it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:39,  5.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:36,  5.55it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:34,  5.83it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:33,  5.99it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:32,  6.13it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:32,  6.21it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.38it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.61it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.49it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.47it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.51it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.59it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.57it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.53it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.51it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.55it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.13it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.16it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:29,  6.12it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:29,  6.10it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.19it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.13it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:28,  6.21it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.29it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.29it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.29it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.43it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.40it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:40:01,342 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:40:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:40:01 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:40:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:40:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:40:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:40:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.539019545585709, 'eval_loss': 0.9003792, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [972, 1105, 1384, 1371, 1386, 1398, 1006, 807, 541, 348, 272, 386], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51111376, 'remaining_params': 33906224, 'pruned_model_sparsity': 0.601185825052695, 'expected_sparsity': 0.59783, 'target_sparsity': 0.6, 'step': 15650}


Iteration:  40%|███▉      | 106/268 [00:22<02:09,  1.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<01:37,  1.65it/s][A
Iteration:  40%|████      | 108/268 [00:23<01:14,  2.14it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:59,  2.68it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:49,  3.18it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:42,  3.71it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:36,  4.22it/s][A
Iteration:  42%|████▏     | 113/268 [00:24<00:33,  4.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:30,  5.01it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:28,  5.37it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:26,  5.70it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:25,  5.84it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:25,  5.97it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:24,  6.13it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:24,  6.15it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.27it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.29it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.40it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.45it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.36it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:27<00:21,  6.41it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.43it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.45it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.50it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.53it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.62it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.62it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.58it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.54it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.45it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.59it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.49it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.36it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.38it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:40:11,267 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:40:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:40:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:40:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:40:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:40:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:40:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5418980827011334, 'eval_loss': 0.903367, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1096, 1375, 1363, 1378, 1390, 996, 796, 525, 327, 251, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51492844, 'remaining_params': 33524756, 'pruned_model_sparsity': 0.605672754817826, 'expected_sparsity': 0.60246, 'target_sparsity': 0.6, 'step': 15700}


Iteration:  58%|█████▊    | 156/268 [00:32<01:29,  1.25it/s][A04/29/2024 01:40:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 15700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:33<01:07,  1.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:52,  2.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:41,  2.64it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:33,  3.19it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:28,  3.74it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:24,  4.28it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:22,  4.77it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:20,  5.19it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:18,  5.51it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:17,  5.81it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:16,  5.98it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:16,  6.13it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.28it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:15,  6.28it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:14,  6.41it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.42it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.35it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.50it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.48it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.61it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.60it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.59it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.56it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.53it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.55it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.52it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.53it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.37it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.38it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.43it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:40:21,158 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:40:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:40:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:40:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:40:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:40:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:40:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5500793243102087, 'eval_loss': 0.89248526, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1097, 1376, 1363, 1378, 1390, 996, 797, 527, 329, 254, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.60198, 'target_sparsity': 0.6, 'step': 15750}


Iteration:  77%|███████▋  | 206/268 [00:42<00:49,  1.25it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:36,  1.65it/s][A
Iteration:  78%|███████▊  | 208/268 [00:43<00:28,  2.14it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:21,  2.68it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:17,  3.24it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:14,  3.82it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:12,  4.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:11,  4.73it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:10,  5.24it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:09,  5.50it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:09,  5.76it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  5.93it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  6.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.20it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.41it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.44it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.50it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.44it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.34it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.33it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.29it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.57it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.55it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.63it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.61it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.40it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.54it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.54it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:40:31,019 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:40:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:40:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:40:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:40:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:40:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:40:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5436218925861311, 'eval_loss': 0.87489444, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [974, 1106, 1385, 1372, 1386, 1399, 1005, 808, 548, 355, 282, 413], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 50854000, 'remaining_params': 34163600, 'pruned_model_sparsity': 0.5981584989461006, 'expected_sparsity': 0.59614, 'target_sparsity': 0.6, 'step': 15800}


Iteration:  96%|█████████▌| 256/268 [00:52<00:09,  1.25it/s][A04/29/2024 01:40:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 15800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:52<00:06,  1.66it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:04,  2.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:03,  2.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:02,  3.21it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  3.78it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  4.24it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  4.75it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.09it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  5.44it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  5.40it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.68it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.22it/s][A04/29/2024 01:40:35 - INFO - trainer.trainer_mod_2 - Epoch 58 finished. Took 54.5 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  59%|█████▉    | 59/100 [52:09<36:23, 53.25s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.37it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.63it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.63it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.52it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.63it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.70it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.65it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.62it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.55it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.30it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.46it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.50it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.66it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.63it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.62it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.40it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:38,  6.31it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.27it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.27it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.36it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.41it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.52it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:40:40,904 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:40:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:40:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:40:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:40:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:40:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:40:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.536662198889055, 'eval_loss': 0.903076, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1102, 1382, 1369, 1384, 1395, 1000, 803, 535, 333, 256, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51394796, 'remaining_params': 33622804, 'pruned_model_sparsity': 0.6045194877295995, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 15850}


Iteration:  14%|█▍        | 38/268 [00:08<03:03,  1.25it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<02:18,  1.65it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:47,  2.13it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:24,  2.67it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:09,  3.25it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:58,  3.84it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:50,  4.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:45,  4.86it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:42,  5.18it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:39,  5.58it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:37,  5.85it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:36,  6.00it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:35,  6.18it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:34,  6.25it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.54it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.51it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.72it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.35it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.41it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.50it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.50it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.50it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.50it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.47it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.45it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.32it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:31,  6.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.32it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.39it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.34it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.39it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.40it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.45it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.48it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.51it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.48it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.52it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:40:50,780 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:40:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:40:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:40:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:40:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:40:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:40:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5454001814167142, 'eval_loss': 0.89697874, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1095, 1375, 1362, 1378, 1390, 993, 796, 525, 324, 251, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.60231, 'target_sparsity': 0.6, 'step': 15900}


Iteration:  33%|███▎      | 88/268 [00:17<02:24,  1.24it/s][A04/29/2024 01:40:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 15900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:18<01:48,  1.64it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<01:24,  2.11it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:06,  2.65it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:54,  3.25it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:45,  3.83it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:40,  4.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:35,  4.81it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:33,  5.21it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:31,  5.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:29,  5.77it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:28,  5.94it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.20it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.40it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.27it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.39it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.50it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.41it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.36it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.32it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.29it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.37it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.42it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:24,  6.16it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.36it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.34it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.30it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.30it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.34it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.31it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.46it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.61it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.48it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 01:41:00,707 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:41:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:41:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:41:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:41:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:41:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:41:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5577353353156735, 'eval_loss': 0.8942413, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1098, 1378, 1364, 1380, 1392, 996, 800, 531, 329, 255, 363], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51443820, 'remaining_params': 33573780, 'pruned_model_sparsity': 0.6050961212737127, 'expected_sparsity': 0.60088, 'target_sparsity': 0.6, 'step': 15950}


Iteration:  51%|█████▏    | 138/268 [00:27<01:44,  1.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<01:18,  1.65it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<01:00,  2.13it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:47,  2.67it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:38,  3.27it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:32,  3.85it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:28,  4.35it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:25,  4.84it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:23,  5.21it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:21,  5.51it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:20,  5.77it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:20,  5.88it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:19,  5.99it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:19,  6.01it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:19,  6.02it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.06it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.17it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.38it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.34it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.42it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.37it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.55it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.45it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.47it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.47it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.47it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.44it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.40it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.40it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.04it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:15,  6.02it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:15,  6.15it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.25it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.16it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.29it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.36it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:12,  6.69it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.63it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.52it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:41:10,639 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:41:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:41:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:41:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:41:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:02, 15.42it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:41:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:41:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5584013487121077, 'eval_loss': 0.8558035, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1105, 1384, 1371, 1386, 1398, 1002, 808, 545, 347, 273, 401], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 50889236, 'remaining_params': 34128364, 'pruned_model_sparsity': 0.5985729543059319, 'expected_sparsity': 0.59694, 'target_sparsity': 0.6, 'step': 16000}


Iteration:  70%|███████   | 188/268 [00:37<01:03,  1.25it/s][A04/29/2024 01:41:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 16000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:37<00:47,  1.65it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:36,  2.12it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:29,  2.65it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:23,  3.22it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:19,  3.78it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:17,  4.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:15,  4.76it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:13,  5.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:12,  5.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:12,  5.73it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  5.97it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:11,  6.13it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.25it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.33it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.42it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.51it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.28it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.28it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.29it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.33it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.41it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.46it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.49it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.36it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.35it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.55it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.50it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.50it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.52it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.45it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.48it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.50it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.56it/s][A[INFO|trainer.py:570] 2024-04-29 01:41:20,534 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:41:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:41:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:41:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:41:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:41:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:41:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.555285279196476, 'eval_loss': 0.8920063, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1101, 1380, 1367, 1381, 1395, 998, 802, 533, 325, 251, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51423904, 'remaining_params': 33593696, 'pruned_model_sparsity': 0.6048618638964167, 'expected_sparsity': 0.60047, 'target_sparsity': 0.6, 'step': 16050}


Iteration:  89%|████████▉ | 238/268 [00:47<00:23,  1.26it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:17,  1.66it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:13,  2.13it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:10,  2.68it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:07,  3.25it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:06,  3.78it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:05,  4.33it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  4.82it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:04,  5.18it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  5.37it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.75it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.94it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.04it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.16it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.26it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.34it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.41it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.40it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.52it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.43it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.44it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.43it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.54it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.87it/s][A04/29/2024 01:41:27 - INFO - trainer.trainer_mod_2 - Epoch 59 finished. Took 52.25 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  60%|██████    | 60/100 [53:01<35:18, 52.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:45,  5.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:43,  6.01it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:42,  6.17it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:42,  6.19it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.29it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.38it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.44it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:38,  6.60it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.51it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.53it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:41:30,420 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:41:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:41:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:41:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:41:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:41:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:41:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5682065493651185, 'eval_loss': 0.8736791, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1097, 1376, 1363, 1378, 1392, 993, 797, 527, 320, 250, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.60163, 'target_sparsity': 0.6, 'step': 16100}


Iteration:   7%|▋         | 20/268 [00:05<03:18,  1.25it/s][A04/29/2024 01:41:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 16100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:29,  1.65it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:56,  2.12it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:32,  2.65it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:15,  3.23it/s][A
Iteration:   9%|▉         | 25/268 [00:06<01:04,  3.76it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:56,  4.30it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:49,  4.84it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:45,  5.23it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:43,  5.50it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:41,  5.79it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:40,  5.91it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:38,  6.06it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.28it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.43it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.44it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.54it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.50it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.50it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.49it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.47it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.50it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.50it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.63it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.63it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.59it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.61it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.59it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.53it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.51it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.60it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.46it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:41:40,277 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:41:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:41:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:41:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:41:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.73it/s]04/29/2024 01:41:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:41:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5606238208505129, 'eval_loss': 0.87733305, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1099, 1378, 1365, 1379, 1394, 994, 799, 530, 323, 254, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51449948, 'remaining_params': 33567652, 'pruned_model_sparsity': 0.6051682004667269, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 16150}


Iteration:  26%|██▌       | 70/268 [00:15<02:39,  1.24it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<02:00,  1.64it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:32,  2.12it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<01:13,  2.66it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:59,  3.24it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:51,  3.76it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:44,  4.27it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:40,  4.72it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:36,  5.15it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:34,  5.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:32,  5.71it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:31,  5.92it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:30,  6.05it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.22it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.30it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.47it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.61it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.57it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.57it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:26,  6.60it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.45it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.51it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.57it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.42it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.48it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.48it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.29it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.29it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:41:50,168 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:41:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:41:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:41:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:41:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:41:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:41:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5629066123861417, 'eval_loss': 0.88545567, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [972, 1104, 1384, 1369, 1385, 1399, 999, 806, 541, 335, 267, 385], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51129760, 'remaining_params': 33887840, 'pruned_model_sparsity': 0.6014020626317375, 'expected_sparsity': 0.59791, 'target_sparsity': 0.6, 'step': 16200}


Iteration:  45%|████▍     | 120/268 [00:25<01:58,  1.25it/s][A04/29/2024 01:41:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 16200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:25<01:29,  1.64it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<01:08,  2.12it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:55,  2.62it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:45,  3.19it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:37,  3.77it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:33,  4.28it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:29,  4.74it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:27,  5.17it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:25,  5.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:23,  5.79it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.00it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:22,  6.17it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.37it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.42it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.37it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.42it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.47it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.51it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.42it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.33it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.40it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.51it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.53it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.45it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.55it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.44it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.41it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.42it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.47it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.32it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.36it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.41it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.40it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.55it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.55it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:42:00,059 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:42:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:42:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:42:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:42:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:42:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:42:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5546789239242798, 'eval_loss': 0.8771349, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1101, 1381, 1367, 1383, 1397, 996, 802, 533, 321, 251, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51417776, 'remaining_params': 33599824, 'pruned_model_sparsity': 0.6047897847034026, 'expected_sparsity': 0.60021, 'target_sparsity': 0.6, 'step': 16250}


Iteration:  63%|██████▎   | 170/268 [00:34<01:17,  1.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:58,  1.65it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:45,  2.12it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:36,  2.64it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:29,  3.17it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:24,  3.74it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:21,  4.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:19,  4.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:17,  5.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:15,  5.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:15,  5.85it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:14,  5.96it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:14,  6.08it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.12it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.16it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.19it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.28it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.35it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.34it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.36it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.46it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.23it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.30it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.45it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.59it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.58it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.64it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.54it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.46it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.45it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.38it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.25it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.22it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.15it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.26it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.26it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.24it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:42:10,053 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:42:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:42:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:42:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:42:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:42:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:42:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5642446874338215, 'eval_loss': 0.88189644, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1097, 1378, 1363, 1380, 1394, 992, 798, 528, 318, 250, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.60116, 'target_sparsity': 0.6, 'step': 16300}


Iteration:  82%|████████▏ | 220/268 [00:44<00:38,  1.25it/s][A04/29/2024 01:42:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 16300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:45<00:28,  1.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:21,  2.13it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:16,  2.67it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:13,  3.23it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:11,  3.75it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:09,  4.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:08,  4.78it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:07,  5.21it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:07,  5.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  5.76it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.97it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.05it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.12it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.27it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.35it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.36it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.57it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.57it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.55it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.55it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.58it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.50it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.54it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.54it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.51it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.53it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.63it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.42it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.47it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.59it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.93it/s][A04/29/2024 01:42:19 - INFO - trainer.trainer_mod_2 - Epoch 60 finished. Took 52.27 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  61%|██████    | 61/100 [53:53<34:17, 52.75s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.86it/s][A[INFO|trainer.py:570] 2024-04-29 01:42:19,872 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:42:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:42:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:42:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:42:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:42:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:42:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.550090073200501, 'eval_loss': 0.90159756, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1099, 1380, 1364, 1381, 1395, 993, 799, 530, 320, 252, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.60042, 'target_sparsity': 0.6, 'step': 16350}


Iteration:   1%|          | 2/268 [00:02<06:15,  1.41s/it][A
Iteration:   1%|          | 3/268 [00:02<03:41,  1.20it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:30,  1.75it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:50,  2.38it/s][A
Iteration:   2%|▏         | 6/268 [00:03<01:25,  3.06it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:10,  3.72it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:00,  4.30it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:52,  4.90it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:49,  5.24it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:46,  5.56it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:43,  5.82it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:41,  6.11it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:40,  6.26it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:40,  6.22it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:39,  6.31it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.31it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.39it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:38,  6.42it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.49it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:37,  6.54it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.37it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.33it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.38it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:38,  6.36it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.45it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.49it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.48it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.43it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.35it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.41it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.50it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.50it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.54it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.35it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.38it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.37it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.30it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:42:29,747 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:42:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:42:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:42:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:42:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:42:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:42:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.556015225978778, 'eval_loss': 0.8860315, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1103, 1384, 1368, 1384, 1398, 997, 804, 538, 328, 262, 373], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51364156, 'remaining_params': 33653444, 'pruned_model_sparsity': 0.6041590917645288, 'expected_sparsity': 0.59861, 'target_sparsity': 0.6, 'step': 16400}


Iteration:  19%|█▉        | 52/268 [00:12<02:51,  1.26it/s][A04/29/2024 01:42:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 16400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:12<02:10,  1.65it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:40,  2.14it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:19,  2.68it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:05,  3.23it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:55,  3.82it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:47,  4.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:43,  4.82it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:41,  5.05it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:38,  5.41it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:36,  5.70it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:34,  5.97it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:33,  6.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:32,  6.23it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:32,  6.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:32,  6.22it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:31,  6.30it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.36it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:31,  6.32it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.61it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.45it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.41it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.54it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.47it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.52it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.55it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.66it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:27,  6.64it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:27,  6.71it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:27,  6.67it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.61it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.60it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:26,  6.73it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:26,  6.66it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:26,  6.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:28,  6.19it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.53it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:42:39,605 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:42:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:42:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:42:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:42:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:42:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:42:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.56217893832047, 'eval_loss': 0.87788147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1101, 1383, 1366, 1383, 1397, 995, 802, 532, 319, 250, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51420840, 'remaining_params': 33596760, 'pruned_model_sparsity': 0.6048258242999097, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 16450}


Iteration:  38%|███▊      | 102/268 [00:22<02:12,  1.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:22<01:40,  1.65it/s][A
Iteration:  39%|███▉      | 104/268 [00:22<01:17,  2.13it/s][A
Iteration:  39%|███▉      | 105/268 [00:22<01:00,  2.69it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<00:49,  3.24it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<00:42,  3.82it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:36,  4.33it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:33,  4.77it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:30,  5.15it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:28,  5.47it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:27,  5.61it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:26,  5.79it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:25,  5.93it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:25,  6.11it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:24,  6.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:23,  6.32it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:23,  6.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.44it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:22,  6.45it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:22,  6.40it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.31it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.41it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.46it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.46it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.46it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.49it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.52it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.50it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.52it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.55it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.48it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.49it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.51it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.44it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.48it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 01:42:49,531 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:42:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:42:49 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:42:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:42:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:42:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:42:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5668277832443891, 'eval_loss': 0.8777396, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1099, 1381, 1364, 1381, 1395, 993, 799, 529, 317, 250, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60052, 'target_sparsity': 0.6, 'step': 16500}


Iteration:  57%|█████▋    | 152/268 [00:32<01:33,  1.24it/s][A04/29/2024 01:42:51 - INFO - trainer.trainer_mod_2 - v4 Global step: 16500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:32<01:10,  1.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:32<00:53,  2.12it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<00:42,  2.66it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:34,  3.22it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:29,  3.77it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:25,  4.31it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:22,  4.81it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:21,  5.13it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:19,  5.47it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:18,  5.83it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:17,  6.01it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:16,  6.17it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:16,  6.15it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:16,  6.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:15,  6.44it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.39it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.24it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.35it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.32it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.62it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.52it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.42it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.57it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.54it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.51it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.51it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.39it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.51it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.54it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.28it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:42:59,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:42:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:42:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:42:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:42:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:43:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:43:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5510400717227824, 'eval_loss': 0.86459965, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1098, 1381, 1364, 1381, 1394, 993, 798, 530, 316, 250, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51457608, 'remaining_params': 33559992, 'pruned_model_sparsity': 0.6052582994579946, 'expected_sparsity': 0.60036, 'target_sparsity': 0.6, 'step': 16550}


Iteration:  75%|███████▌  | 202/268 [00:42<00:52,  1.25it/s][A
Iteration:  76%|███████▌  | 203/268 [00:42<00:39,  1.64it/s][A
Iteration:  76%|███████▌  | 204/268 [00:42<00:30,  2.12it/s][A
Iteration:  76%|███████▋  | 205/268 [00:42<00:23,  2.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:19,  3.24it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:15,  3.82it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:13,  4.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:12,  4.90it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:11,  5.26it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:10,  5.61it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:09,  5.84it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:09,  5.94it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:09,  5.97it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:08,  6.24it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  6.32it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.30it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:07,  6.25it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.24it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.34it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.29it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.39it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.37it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.57it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.48it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.47it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.59it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.37it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.52it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.51it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.57it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.44it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.46it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.44it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:02,  6.67it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.56it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:43:09,306 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:43:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:43:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:43:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:43:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 01:43:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:43:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5590682579959262, 'eval_loss': 0.8658846, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1100, 1384, 1365, 1383, 1397, 995, 800, 533, 318, 252, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51419308, 'remaining_params': 33598292, 'pruned_model_sparsity': 0.6048078045016562, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 16600}


Iteration:  94%|█████████▍| 252/268 [00:51<00:12,  1.25it/s][A04/29/2024 01:43:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 16600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:52<00:09,  1.65it/s][A
Iteration:  95%|█████████▍| 254/268 [00:52<00:06,  2.12it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:04,  2.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:03,  3.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:02,  3.82it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:02,  4.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:01,  4.82it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:01,  5.23it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  5.54it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.79it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  6.10it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  6.23it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  5.94it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  6.10it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.25it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.67it/s][A04/29/2024 01:43:13 - INFO - trainer.trainer_mod_2 - Epoch 61 finished. Took 54.35 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  62%|██████▏   | 62/100 [54:48<33:42, 53.23s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.39it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.29it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.47it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.48it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.46it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.47it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.50it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.37it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.44it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.39it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.42it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.54it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.46it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.50it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.44it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.48it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.40it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.46it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.56it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.48it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:39,  6.06it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:38,  6.13it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:37,  6.25it/s][A[INFO|trainer.py:570] 2024-04-29 01:43:19,210 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:43:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:43:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:43:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:43:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:43:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:43:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5676328410109622, 'eval_loss': 0.8723696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1101, 1385, 1366, 1385, 1399, 995, 801, 534, 317, 250, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51407052, 'remaining_params': 33610548, 'pruned_model_sparsity': 0.6046636461156278, 'expected_sparsity': 0.59957, 'target_sparsity': 0.6, 'step': 16650}


Iteration:  13%|█▎        | 34/268 [00:07<03:07,  1.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:21,  1.64it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:50,  2.10it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:26,  2.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:11,  3.22it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<01:00,  3.80it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:52,  4.33it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:47,  4.75it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:43,  5.17it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:41,  5.38it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:38,  5.76it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:37,  5.97it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:36,  6.14it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.14it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.36it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.33it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.55it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.44it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.56it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.26it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.42it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.43it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.33it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.40it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.65it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.61it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.60it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.42it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.46it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.38it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.42it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:43:29,098 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:43:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:43:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:43:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:43:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:43:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:43:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5536960643334261, 'eval_loss': 0.8624842, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1099, 1383, 1365, 1384, 1397, 993, 799, 531, 315, 249, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51436160, 'remaining_params': 33581440, 'pruned_model_sparsity': 0.605006022282445, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 16700}


Iteration:  31%|███▏      | 84/268 [00:17<02:26,  1.25it/s][A04/29/2024 01:43:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 16700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:17<01:50,  1.65it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<01:25,  2.12it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:07,  2.67it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:55,  3.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:47,  3.80it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:41,  4.31it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:36,  4.82it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:33,  5.20it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:31,  5.63it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:29,  5.81it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:28,  6.00it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.23it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.28it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.32it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.36it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.45it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.50it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.51it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.48it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.49it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.48it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.28it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.46it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.41it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.27it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.40it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.42it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.36it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.33it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.43it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.52it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.51it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:43:38,986 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:43:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:43:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:43:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:43:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:43:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:43:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.562461217631608, 'eval_loss': 0.8727732, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1097, 1382, 1363, 1382, 1396, 991, 797, 530, 313, 249, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 16750}


Iteration:  50%|█████     | 134/268 [00:27<01:46,  1.25it/s][A
Iteration:  50%|█████     | 135/268 [00:27<01:20,  1.65it/s][A
Iteration:  51%|█████     | 136/268 [00:27<01:01,  2.13it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:48,  2.68it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:39,  3.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:33,  3.81it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:29,  4.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:26,  4.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:24,  5.13it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:22,  5.47it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:21,  5.67it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:20,  5.91it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.10it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.25it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.32it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.46it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.45it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.29it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.38it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.25it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.26it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.26it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.34it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.12it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.24it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.25it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.46it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.48it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.62it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.66it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.40it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.34it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.49it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.36it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.42it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.30it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:14,  6.28it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:14,  6.24it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:43:48,933 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:43:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:43:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:43:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:43:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:43:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:43:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5534186082067715, 'eval_loss': 0.8939737, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1097, 1382, 1362, 1382, 1395, 990, 797, 529, 312, 249, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60036, 'target_sparsity': 0.6, 'step': 16800}


Iteration:  69%|██████▊   | 184/268 [00:37<01:07,  1.25it/s][A04/29/2024 01:43:51 - INFO - trainer.trainer_mod_2 - v4 Global step: 16800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:37<00:50,  1.65it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:38,  2.12it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:30,  2.65it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:24,  3.23it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:20,  3.78it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:18,  4.33it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:16,  4.80it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:14,  5.20it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:13,  5.56it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:12,  5.81it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.16it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.39it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.58it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.55it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:09,  6.63it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.60it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.61it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.60it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.59it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.66it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.76it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.80it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.61it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.59it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.50it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.38it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.34it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.38it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.65it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.60it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.39it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:07,  6.29it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.38it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.50it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.37it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:43:58,754 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:43:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:43:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:43:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:43:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:44:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:44:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5564748164739529, 'eval_loss': 0.8849981, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1099, 1384, 1363, 1383, 1397, 991, 798, 532, 312, 250, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 16850}


Iteration:  87%|████████▋ | 234/268 [00:46<00:27,  1.25it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:20,  1.64it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:15,  2.12it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:11,  2.66it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:09,  3.24it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:07,  3.79it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:06,  4.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:05,  4.83it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:05,  5.18it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  5.55it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.81it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.03it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.16it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.18it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.29it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.14it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.27it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.44it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.49it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.42it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.43it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.38it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.77it/s][A04/29/2024 01:44:06 - INFO - trainer.trainer_mod_2 - Epoch 62 finished. Took 52.24 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  63%|██████▎   | 63/100 [55:40<32:38, 52.93s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.41it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.47it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.45it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.48it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.49it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.59it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.50it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:44:08,633 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:44:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:44:08 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:44:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:44:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:44:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:44:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5482141588213076, 'eval_loss': 0.90396595, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1100, 1385, 1365, 1385, 1398, 992, 800, 533, 312, 250, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51420840, 'remaining_params': 33596760, 'pruned_model_sparsity': 0.6048258242999097, 'expected_sparsity': 0.59955, 'target_sparsity': 0.6, 'step': 16900}


Iteration:   6%|▌         | 16/268 [00:04<03:22,  1.24it/s][A04/29/2024 01:44:10 - INFO - trainer.trainer_mod_2 - v4 Global step: 16900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:32,  1.64it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:57,  2.12it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:34,  2.64it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:16,  3.23it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:04,  3.80it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:56,  4.34it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:51,  4.78it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:47,  5.15it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:44,  5.42it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:43,  5.56it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:41,  5.83it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:40,  5.95it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:39,  6.10it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.23it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.35it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.52it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.64it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:34,  6.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.45it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.49it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.42it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.44it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.52it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.46it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.49it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.54it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.64it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.62it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.63it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.56it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.54it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.44it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.50it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.60it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.60it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.49it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.42it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 01:44:18,523 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:44:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:44:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:44:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:44:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:44:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:44:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5702308058201745, 'eval_loss': 0.89191973, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1099, 1384, 1363, 1384, 1397, 991, 798, 531, 311, 249, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51442288, 'remaining_params': 33575312, 'pruned_model_sparsity': 0.6050781014754592, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 16950}


Iteration:  25%|██▍       | 66/268 [00:14<02:41,  1.25it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<02:01,  1.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:34,  2.12it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<01:14,  2.66it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:00,  3.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:51,  3.84it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:44,  4.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:40,  4.80it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:36,  5.27it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:34,  5.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:32,  5.83it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:31,  6.02it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:30,  6.16it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.19it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.18it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.28it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.37it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.51it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.50it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.52it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.55it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.48it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.49it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.58it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.46it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.49it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.34it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.21it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.28it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.29it/s][A[INFO|trainer.py:570] 2024-04-29 01:44:28,424 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:44:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:44:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:44:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:44:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:44:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:44:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5624553233571645, 'eval_loss': 0.8920692, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1097, 1383, 1362, 1382, 1395, 989, 796, 530, 309, 248, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 17000}


Iteration:  43%|████▎     | 116/268 [00:24<02:02,  1.24it/s][A04/29/2024 01:44:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 17000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:24<01:31,  1.65it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<01:10,  2.12it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:55,  2.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:45,  3.25it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:38,  3.82it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:33,  4.31it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:30,  4.79it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:27,  5.21it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:26,  5.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:24,  5.75it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:23,  5.97it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:23,  6.06it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.06it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.08it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.13it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.26it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.33it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:22,  6.09it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.16it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.26it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.38it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.37it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:18,  6.64it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.62it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.63it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.33it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.43it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.45it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.40it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.42it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.37it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.22it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.31it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.38it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.43it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.36it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.42it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.29it/s][A[INFO|trainer.py:570] 2024-04-29 01:44:38,396 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:44:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:44:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:44:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:44:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:44:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:44:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5607990478394429, 'eval_loss': 0.8748985, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1097, 1382, 1362, 1382, 1395, 988, 796, 530, 308, 248, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 17050}


Iteration:  62%|██████▏   | 166/268 [00:34<01:21,  1.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<01:01,  1.64it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:47,  2.11it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:37,  2.65it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:30,  3.20it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:25,  3.78it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:22,  4.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:19,  4.82it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:17,  5.24it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:16,  5.56it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:16,  5.75it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:15,  5.94it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.10it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.20it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:12,  6.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.61it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.51it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.39it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.41it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.28it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.33it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.38it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.42it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.57it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.60it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.57it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.65it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.50it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.50it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.52it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.39it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:44:48,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:44:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:44:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:44:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:44:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:44:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:44:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5460649174667868, 'eval_loss': 0.89914167, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1098, 1384, 1363, 1383, 1397, 989, 797, 532, 309, 249, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 17100}


Iteration:  81%|████████  | 216/268 [00:44<00:41,  1.24it/s][A04/29/2024 01:44:50 - INFO - trainer.trainer_mod_2 - v4 Global step: 17100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:44<00:31,  1.64it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:23,  2.12it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:18,  2.65it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:14,  3.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:12,  3.79it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:10,  4.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:09,  4.85it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:08,  5.27it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  5.60it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:07,  5.87it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  5.94it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.09it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.21it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.29it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.35it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.60it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.04it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.19it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.20it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.18it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  6.21it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.05it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.27it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.44it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.45it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.57it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.45it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.30it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.46it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.40it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.57it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.34it/s][A[INFO|trainer.py:570] 2024-04-29 01:44:58,232 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:44:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:44:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:44:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:44:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:45:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:45:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.54552128338247, 'eval_loss': 0.87540543, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1100, 1385, 1364, 1384, 1398, 990, 799, 534, 310, 248, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51428500, 'remaining_params': 33589100, 'pruned_model_sparsity': 0.6049159232911774, 'expected_sparsity': 0.59965, 'target_sparsity': 0.6, 'step': 17150}


Iteration:  99%|█████████▉| 266/268 [00:54<00:01,  1.25it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  1.64it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  2.15it/s][A04/29/2024 01:45:00 - INFO - trainer.trainer_mod_2 - Epoch 63 finished. Took 54.51 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  64%|██████▍   | 64/100 [56:35<32:02, 53.41s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.47it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.49it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.51it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.52it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.46it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.46it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.57it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.48it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.20it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.29it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.32it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.32it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.30it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.35it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.39it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.43it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.47it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.46it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.46it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.46it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.58it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.48it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.49it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.32it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:38,  6.22it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.35it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.31it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.48it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.58it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.57it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:34,  6.55it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:33,  6.63it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:34,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:45:08,125 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:45:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:45:08 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:45:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:45:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:45:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:45:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5463170422325025, 'eval_loss': 0.88761157, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1099, 1384, 1363, 1383, 1398, 989, 797, 532, 308, 248, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59996, 'target_sparsity': 0.6, 'step': 17200}


Iteration:  18%|█▊        | 48/268 [00:09<02:55,  1.25it/s][A04/29/2024 01:45:10 - INFO - trainer.trainer_mod_2 - v4 Global step: 17200, Alignment: tensor([ 0,  6,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:13,  1.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:42,  2.12it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<01:21,  2.66it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:07,  3.21it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:56,  3.77it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:49,  4.29it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:44,  4.79it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:41,  5.16it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:38,  5.53it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:36,  5.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:35,  5.96it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:34,  6.02it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:34,  6.08it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.30it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.35it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.55it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.49it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.36it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.33it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.48it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.44it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:30,  6.07it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:30,  6.22it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.30it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.55it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.62it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.49it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.41it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:27,  6.29it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.50it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:25,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 01:45:18,029 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:45:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:45:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:45:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:45:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:45:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:45:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5554433905906734, 'eval_loss': 0.881014, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1098, 1383, 1361, 1382, 1396, 988, 796, 531, 306, 247, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 17250}


Iteration:  37%|███▋      | 98/268 [00:19<02:14,  1.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:41,  1.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<01:18,  2.15it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<01:02,  2.68it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:50,  3.26it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:42,  3.87it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:37,  4.35it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:33,  4.83it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:30,  5.27it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:28,  5.61it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:27,  5.86it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:26,  6.03it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.10it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.16it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.23it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.34it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:24,  6.23it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.41it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.26it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.38it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.24it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:23,  6.24it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.40it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.48it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.52it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.49it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.60it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:19,  6.61it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:19,  6.56it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.49it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.51it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.52it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.36it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.43it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:18,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:45:27,915 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:45:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:45:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:45:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:45:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 01:45:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:45:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5577353353156735, 'eval_loss': 0.8992255, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1098, 1383, 1361, 1382, 1395, 987, 796, 532, 305, 248, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 17300}


Iteration:  55%|█████▌    | 148/268 [00:29<01:35,  1.25it/s][A04/29/2024 01:45:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 17300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:29<01:12,  1.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:55,  2.14it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:43,  2.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:35,  3.23it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:30,  3.77it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:26,  4.32it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:23,  4.87it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:20,  5.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:19,  5.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:18,  5.90it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.06it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.20it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.32it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.38it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.34it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.32it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.57it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.40it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.36it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.42it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.33it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.42it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.44it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.46it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.37it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.40it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.33it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.32it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.31it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:12,  6.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.33it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:10,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:45:37,812 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:45:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:45:37 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:45:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:45:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:45:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:45:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5635758105599825, 'eval_loss': 0.8838813, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1099, 1384, 1362, 1383, 1397, 988, 798, 534, 305, 248, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51443820, 'remaining_params': 33573780, 'pruned_model_sparsity': 0.6050961212737127, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 17350}


Iteration:  74%|███████▍  | 198/268 [00:39<00:55,  1.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:41,  1.64it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:32,  2.10it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:25,  2.61it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:20,  3.19it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:17,  3.80it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:14,  4.29it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:13,  4.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:11,  5.19it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:11,  5.54it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:10,  5.88it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.04it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.15it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.29it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.24it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.35it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.43it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.43it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.53it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:06,  6.60it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.61it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.60it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.57it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.54it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.51it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.54it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.54it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.57it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.22it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.27it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.28it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.18it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.32it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.37it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.27it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.23it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:45:47,728 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:45:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:45:47 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:45:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:45:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:45:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:45:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5512772054945002, 'eval_loss': 0.8863976, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1100, 1385, 1363, 1384, 1398, 989, 798, 535, 305, 248, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51433096, 'remaining_params': 33584504, 'pruned_model_sparsity': 0.6049699826859379, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 17400}


Iteration:  93%|█████████▎| 248/268 [00:49<00:15,  1.25it/s][A04/29/2024 01:45:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 17400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:49<00:11,  1.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:08,  2.12it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:06,  2.63it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:04,  3.22it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:03,  3.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:03,  4.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  4.86it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  5.59it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.74it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  5.95it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.14it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.25it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.53it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.54it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.45it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.57it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.94it/s][A04/29/2024 01:45:52 - INFO - trainer.trainer_mod_2 - Epoch 64 finished. Took 52.24 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  65%|██████▌   | 65/100 [57:27<30:57, 53.06s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.36it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.46it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.48it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.57it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.70it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.48it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.53it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.57it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.57it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.66it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.52it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.55it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.68it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.58it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.55it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:37,  6.47it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.48it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.43it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 01:45:57,523 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:45:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:45:57 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:45:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:45:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:45:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:45:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5590682579959262, 'eval_loss': 0.8637692, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1098, 1384, 1362, 1382, 1397, 987, 797, 533, 304, 247, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60005, 'target_sparsity': 0.6, 'step': 17450}


Iteration:  11%|█         | 30/268 [00:06<03:09,  1.26it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:23,  1.66it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:49,  2.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:27,  2.69it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:11,  3.28it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:00,  3.85it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:52,  4.40it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:48,  4.80it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:43,  5.23it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:41,  5.58it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:38,  5.87it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:37,  6.04it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.27it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.38it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.49it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.49it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.58it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.55it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.55it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.29it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.30it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.36it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.49it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.53it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.54it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.56it/s][A
Iteration:  24%|██▍       | 64/268 [00:11<00:31,  6.56it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.60it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.61it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.62it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.59it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.54it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.56it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.66it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.65it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.60it/s][A
Iteration:  29%|██▊       | 77/268 [00:13<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.57it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:46:07,317 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:46:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:46:07 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:46:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:46:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:46:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:46:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5657894359264041, 'eval_loss': 0.883292, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1097, 1384, 1360, 1381, 1395, 985, 794, 532, 302, 247, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 17500}


Iteration:  30%|██▉       | 80/268 [00:16<02:29,  1.26it/s][A04/29/2024 01:46:09 - INFO - trainer.trainer_mod_2 - v4 Global step: 17500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:16<01:52,  1.66it/s][A
Iteration:  31%|███       | 82/268 [00:16<01:27,  2.14it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:09,  2.65it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:57,  3.22it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:48,  3.81it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:41,  4.35it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:36,  4.91it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:34,  5.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:32,  5.55it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:30,  5.80it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:30,  5.90it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:29,  6.06it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:28,  6.19it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.46it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.51it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.43it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.44it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.18it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.41it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.38it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.52it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.54it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.43it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.50it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.50it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.45it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.46it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.44it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.39it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:46:17,204 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:46:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:46:17 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:46:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:46:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:46:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:46:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5468655257933821, 'eval_loss': 0.8827342, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1098, 1384, 1361, 1382, 1396, 985, 795, 533, 302, 247, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 17550}


Iteration:  49%|████▊     | 130/268 [00:26<01:50,  1.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<01:22,  1.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<01:04,  2.12it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:50,  2.67it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:41,  3.24it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:34,  3.82it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:29,  4.40it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:26,  4.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:24,  5.27it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:23,  5.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:27<00:22,  5.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:21,  5.96it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.13it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.12it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.27it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.26it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.47it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 153/268 [00:29<00:17,  6.66it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.51it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.47it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:17,  6.20it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.22it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.23it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.27it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.26it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.16it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.31it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.44it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.49it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:15,  6.39it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.45it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.32it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.25it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.36it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.24it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:14,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 01:46:27,160 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:46:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:46:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:46:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:46:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:46:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:46:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5590682579959262, 'eval_loss': 0.9010493, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1100, 1386, 1362, 1383, 1397, 987, 797, 535, 302, 247, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59971, 'target_sparsity': 0.6, 'step': 17600}


Iteration:  67%|██████▋   | 180/268 [00:36<01:10,  1.24it/s][A04/29/2024 01:46:29 - INFO - trainer.trainer_mod_2 - v4 Global step: 17600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:36<00:53,  1.64it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:40,  2.11it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:32,  2.65it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:26,  3.22it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:21,  3.81it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:18,  4.32it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:16,  4.79it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:15,  5.23it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:14,  5.54it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:13,  5.74it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  5.95it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.04it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.17it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.22it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.28it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.19it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  5.90it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:11,  6.07it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.14it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.23it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.32it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.40it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.43it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.53it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.41it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.37it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.40it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.54it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.51it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.54it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.58it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.69it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.62it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:46:37,103 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:46:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:46:37 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:46:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:46:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.77it/s]04/29/2024 01:46:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:46:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5680628967969402, 'eval_loss': 0.88453764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1099, 1386, 1362, 1383, 1397, 986, 796, 534, 301, 247, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51448416, 'remaining_params': 33569184, 'pruned_model_sparsity': 0.6051501806684734, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 17650}


Iteration:  86%|████████▌ | 230/268 [00:46<00:30,  1.25it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:22,  1.64it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:17,  2.10it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:13,  2.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:10,  3.18it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:08,  3.76it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:07,  4.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:06,  4.73it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:05,  5.15it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:05,  5.52it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  5.71it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  5.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.02it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  6.06it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.12it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.41it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.58it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.57it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.55it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.64it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.56it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.48it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.58it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.60it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.54it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.65it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.52it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.62it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.96it/s][A04/29/2024 01:46:45 - INFO - trainer.trainer_mod_2 - Epoch 65 finished. Took 52.17 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  66%|██████▌   | 66/100 [58:19<29:54, 52.79s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.47it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.44it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.59it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.48it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:46:46,940 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:46:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:46:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:46:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:46:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:46:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:46:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5657894359264041, 'eval_loss': 0.8740852, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1098, 1384, 1360, 1381, 1396, 984, 794, 532, 300, 246, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.60018, 'target_sparsity': 0.6, 'step': 17700}


Iteration:   4%|▍         | 12/268 [00:04<03:27,  1.24it/s][A04/29/2024 01:46:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 17700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:04<02:35,  1.64it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:59,  2.12it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:35,  2.65it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:18,  3.21it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:06,  3.79it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:57,  4.33it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:52,  4.72it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:48,  5.16it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:44,  5.51it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.88it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:40,  6.07it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.13it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.26it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.34it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.38it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.51it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.51it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.21it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:38,  6.20it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.30it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.32it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.29it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.32it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.39it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.35it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.50it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.50it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.60it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.60it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.54it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.32it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.56it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:46:56,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:46:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:46:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:46:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:46:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:46:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:46:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5759158430027601, 'eval_loss': 0.86836666, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1097, 1384, 1360, 1381, 1395, 983, 794, 532, 299, 246, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 17750}


Iteration:  23%|██▎       | 62/268 [00:13<02:44,  1.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<02:04,  1.65it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:35,  2.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<01:16,  2.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:02,  3.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:53,  3.74it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:47,  4.20it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:41,  4.75it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:38,  5.10it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:36,  5.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:34,  5.69it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:32,  5.91it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:31,  6.08it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:31,  6.13it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.24it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.23it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.39it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.41it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.45it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.39it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.46it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.45it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.45it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:26,  6.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.46it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.46it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.29it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.37it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.57it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.37it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.40it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.30it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.39it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.41it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:47:06,767 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:47:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:47:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:47:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:47:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:47:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:47:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.57368884664922, 'eval_loss': 0.8632391, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1099, 1386, 1361, 1383, 1397, 985, 796, 534, 299, 246, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 17800}


Iteration:  42%|████▏     | 112/268 [00:23<02:04,  1.26it/s][A04/29/2024 01:47:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 17800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:23<01:33,  1.65it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<01:12,  2.12it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:57,  2.66it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:46,  3.24it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:39,  3.82it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:34,  4.33it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:31,  4.79it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:28,  5.16it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:26,  5.58it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:25,  5.83it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:24,  6.02it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:23,  6.09it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:23,  6.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:22,  6.18it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.38it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.40it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.35it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.33it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.37it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.51it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.50it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.55it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.56it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.58it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.53it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.52it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.29it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.29it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.33it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.32it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.37it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.39it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.14it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.27it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.17it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 01:47:16,686 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:47:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:47:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:47:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:47:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:47:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:47:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.56217893832047, 'eval_loss': 0.8700193, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1099, 1387, 1361, 1384, 1398, 985, 796, 535, 299, 246, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51445352, 'remaining_params': 33572248, 'pruned_model_sparsity': 0.6051141410719663, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 17850}


Iteration:  60%|██████    | 162/268 [00:33<01:24,  1.25it/s][A
Iteration:  61%|██████    | 163/268 [00:33<01:03,  1.66it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:48,  2.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:38,  2.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:31,  3.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:26,  3.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:23,  4.35it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:20,  4.79it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:19,  5.08it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:17,  5.43it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:16,  5.73it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  5.97it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  5.96it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:15,  6.10it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.26it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.38it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.33it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.49it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.44it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.47it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.45it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.50it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.67it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.60it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.62it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.58it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:10,  6.60it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.13it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.23it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.32it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.55it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.53it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.54it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.50it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.49it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.39it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.28it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:47:26,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:47:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:47:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:47:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:47:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:47:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:47:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5536405531329313, 'eval_loss': 0.86231375, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1097, 1385, 1359, 1381, 1397, 982, 794, 533, 298, 245, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 17900}


Iteration:  79%|███████▉  | 212/268 [00:43<00:44,  1.25it/s][A04/29/2024 01:47:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 17900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:43<00:33,  1.64it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:25,  2.11it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:20,  2.64it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:16,  3.22it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:13,  3.84it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:11,  4.32it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:10,  4.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:09,  5.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:08,  5.47it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:08,  5.69it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  5.74it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  6.00it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  6.12it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.17it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.26it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.33it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.41it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.41it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.34it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.42it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.47it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.57it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.33it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.30it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.38it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.46it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.41it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.46it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.47it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:47:36,518 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:47:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:47:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:47:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:47:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:47:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:47:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5607990478394429, 'eval_loss': 0.88373446, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1096, 1384, 1358, 1380, 1396, 981, 793, 532, 299, 246, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51489780, 'remaining_params': 33527820, 'pruned_model_sparsity': 0.6056367152213189, 'expected_sparsity': 0.6003, 'target_sparsity': 0.6, 'step': 17950}


Iteration:  98%|█████████▊| 262/268 [00:53<00:04,  1.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:03,  1.66it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:01,  2.12it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:01,  2.66it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  3.25it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  3.83it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.51it/s][A04/29/2024 01:47:39 - INFO - trainer.trainer_mod_2 - Epoch 66 finished. Took 54.48 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  67%|██████▋   | 67/100 [59:13<29:18, 53.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.36it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.50it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.35it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.28it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.34it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.37it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.44it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.52it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.53it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.59it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.55it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.39it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.42it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.44it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.44it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:40,  6.07it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:39,  6.20it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.30it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.37it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.41it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.49it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.34it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.43it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.47it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.42it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:47:46,417 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:47:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:47:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:47:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:47:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:47:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:47:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5616581968995631, 'eval_loss': 0.8785656, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1098, 1386, 1359, 1382, 1398, 982, 795, 535, 300, 247, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 18000}


Iteration:  16%|█▋        | 44/268 [00:09<02:59,  1.25it/s][A04/29/2024 01:47:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 18000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:09<02:15,  1.65it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:44,  2.12it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<01:22,  2.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:07,  3.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:58,  3.75it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:50,  4.29it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:45,  4.80it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:41,  5.17it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:39,  5.46it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:37,  5.73it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:37,  5.68it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:35,  5.94it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:35,  6.02it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:34,  6.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.27it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.23it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.38it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.28it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.51it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.42it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.36it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:30,  6.26it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.34it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.53it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.44it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.34it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.36it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:27,  6.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.36it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:47:56,395 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:47:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:47:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:47:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:47:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:47:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:47:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5564748164739529, 'eval_loss': 0.8667231, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1100, 1387, 1360, 1382, 1398, 983, 795, 536, 300, 246, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51453012, 'remaining_params': 33564588, 'pruned_model_sparsity': 0.6052042400632339, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 18050}


Iteration:  35%|███▌      | 94/268 [00:18<02:19,  1.25it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<01:45,  1.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<01:21,  2.12it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<01:04,  2.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:52,  3.24it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:44,  3.81it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:38,  4.40it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:34,  4.89it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:31,  5.27it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:29,  5.61it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:27,  5.87it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.04it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.31it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.30it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.30it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.36it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.41it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.40it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.44it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.49it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.26it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.36it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.42it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.44it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.44it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.41it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.30it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.35it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.60it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:21,  6.38it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.52it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.65it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.53it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.32it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:20,  6.30it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:48:06,288 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:48:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:48:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:48:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:48:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:48:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:48:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5673499023091504, 'eval_loss': 0.8638688, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1097, 1384, 1358, 1380, 1396, 980, 793, 532, 297, 245, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.60032, 'target_sparsity': 0.6, 'step': 18100}


Iteration:  54%|█████▎    | 144/268 [00:28<01:39,  1.25it/s][A04/29/2024 01:48:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 18100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:29<01:14,  1.65it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:57,  2.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:45,  2.65it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:37,  3.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:31,  3.80it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:27,  4.36it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:24,  4.83it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:22,  5.19it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:21,  5.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:20,  5.62it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:19,  5.85it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:18,  6.10it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.35it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.51it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.53it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.39it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.35it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.40it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.30it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.44it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.43it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.47it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:14,  6.24it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:14,  6.20it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.29it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.38it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:13,  6.36it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.33it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.41it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.44it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.50it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.53it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:12,  6.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.27it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:12,  6.21it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.28it/s][A[INFO|trainer.py:570] 2024-04-29 01:48:16,228 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:48:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:48:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:48:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:48:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:48:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:48:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5676328410109622, 'eval_loss': 0.8770461, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1096, 1384, 1358, 1380, 1396, 979, 793, 533, 296, 244, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51492844, 'remaining_params': 33524756, 'pruned_model_sparsity': 0.605672754817826, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 18150}


Iteration:  72%|███████▏  | 194/268 [00:38<00:59,  1.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:44,  1.64it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:34,  2.12it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:26,  2.65it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:21,  3.23it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:18,  3.80it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:15,  4.27it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:14,  4.72it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:12,  5.15it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:11,  5.42it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:11,  5.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  5.97it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  6.15it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.19it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.22it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.31it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.39it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.40it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.41it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.43it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.59it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.59it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.53it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.53it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.50it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.61it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.68it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.62it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.63it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.61it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.60it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.34it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.52it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.51it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.52it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.62it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.63it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.60it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:03,  6.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:48:26,077 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:48:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:48:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:48:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:48:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:48:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:48:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5604772031378175, 'eval_loss': 0.85756433, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1099, 1387, 1360, 1382, 1398, 981, 797, 537, 299, 246, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51446884, 'remaining_params': 33570716, 'pruned_model_sparsity': 0.6051321608702198, 'expected_sparsity': 0.59938, 'target_sparsity': 0.6, 'step': 18200}


Iteration:  91%|█████████ | 244/268 [00:48<00:19,  1.25it/s][A04/29/2024 01:48:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 18200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:48<00:13,  1.65it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:10,  2.12it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:07,  2.67it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:06,  3.27it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:04,  3.82it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:04,  4.40it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  4.90it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:03,  5.28it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  5.59it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.78it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.05it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.21it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.28it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.22it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.32it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.36it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.40it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.40it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.42it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.42it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.34it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.70it/s][A04/29/2024 01:48:31 - INFO - trainer.trainer_mod_2 - Epoch 67 finished. Took 52.35 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  68%|██████▊   | 68/100 [1:00:06<28:16, 53.01s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.25it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.47it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.39it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.44it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.51it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.51it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.54it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.52it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.53it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.52it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.63it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.51it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.41it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.43it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.42it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.48it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.59it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.54it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.57it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:48:35,931 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:48:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:48:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:48:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:48:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:48:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:48:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.574812336075799, 'eval_loss': 0.8538693, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1098, 1386, 1358, 1381, 1398, 979, 796, 535, 297, 244, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51471396, 'remaining_params': 33546204, 'pruned_model_sparsity': 0.6054204776422765, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 18250}


Iteration:  10%|▉         | 26/268 [00:06<03:14,  1.25it/s][A
Iteration:  10%|█         | 27/268 [00:06<02:25,  1.65it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:53,  2.12it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:30,  2.64it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:13,  3.22it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:02,  3.79it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:54,  4.35it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:48,  4.84it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:44,  5.24it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:41,  5.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:39,  5.82it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:38,  6.03it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:37,  6.16it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.37it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.25it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.33it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.41it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.40it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.45it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.43it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.46it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.44it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.48it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.52it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.57it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:34,  6.04it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:33,  6.20it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.23it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:33,  6.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.22it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.34it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.41it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.36it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.36it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:48:45,850 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:48:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:48:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:48:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:48:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:48:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:48:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5715199776370171, 'eval_loss': 0.843797, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1096, 1384, 1355, 1378, 1395, 976, 793, 532, 294, 244, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51509696, 'remaining_params': 33507904, 'pruned_model_sparsity': 0.6058709725986149, 'expected_sparsity': 0.60055, 'target_sparsity': 0.6, 'step': 18300}


Iteration:  28%|██▊       | 76/268 [00:16<02:33,  1.25it/s][A04/29/2024 01:48:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 18300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:16<01:56,  1.64it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<01:30,  2.10it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:11,  2.64it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:58,  3.21it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:49,  3.76it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:43,  4.28it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:38,  4.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:35,  5.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:32,  5.56it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:30,  5.93it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:30,  6.02it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:29,  6.05it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:29,  6.17it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.20it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.21it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.29it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.27it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.26it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.33it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.23it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.35it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.37it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.45it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.38it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.31it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.48it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.55it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.61it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.36it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.45it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.50it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.54it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.59it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:21,  6.66it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.61it/s][A[INFO|trainer.py:570] 2024-04-29 01:48:55,758 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:48:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:48:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:48:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:48:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:48:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:48:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5732046470010711, 'eval_loss': 0.85633093, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1098, 1386, 1357, 1380, 1397, 978, 795, 537, 297, 247, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51466800, 'remaining_params': 33550800, 'pruned_model_sparsity': 0.6053664182475158, 'expected_sparsity': 0.59967, 'target_sparsity': 0.6, 'step': 18350}


Iteration:  47%|████▋     | 126/268 [00:25<01:52,  1.26it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<01:25,  1.66it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<01:05,  2.14it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:52,  2.66it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:42,  3.24it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:36,  3.79it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:31,  4.37it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:28,  4.82it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:26,  5.12it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:24,  5.47it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:22,  5.77it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:21,  5.99it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.06it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.20it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.38it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.34it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.45it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.33it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.42it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.38it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.49it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.53it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.44it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.30it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.34it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.49it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.49it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.42it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.45it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.49it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.50it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.48it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.44it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.56it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.57it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:49:05,661 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:49:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:49:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:49:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:49:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:49:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:49:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5632084517291658, 'eval_loss': 0.87605315, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1100, 1387, 1359, 1382, 1398, 978, 797, 537, 294, 244, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.59964, 'target_sparsity': 0.6, 'step': 18400}


Iteration:  66%|██████▌   | 176/268 [00:35<01:13,  1.25it/s][A04/29/2024 01:49:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 18400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:36<00:55,  1.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:42,  2.13it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:33,  2.67it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:27,  3.24it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:22,  3.81it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:19,  4.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:17,  4.75it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:16,  5.15it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:15,  5.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:14,  5.65it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:13,  5.90it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:13,  6.08it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.20it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.30it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.38it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.38it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.23it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.29it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.28it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.35it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.40it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.50it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.52it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.51it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.46it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.40it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.57it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.46it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.59it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.55it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.47it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.34it/s][A[INFO|trainer.py:570] 2024-04-29 01:49:15,556 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:49:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:49:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:49:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:49:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:49:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:49:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5630491915710935, 'eval_loss': 0.8649638, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [961, 1095, 1382, 1354, 1376, 1394, 972, 791, 531, 291, 243, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51535740, 'remaining_params': 33481860, 'pruned_model_sparsity': 0.606177309168925, 'expected_sparsity': 0.60084, 'target_sparsity': 0.6, 'step': 18450}


Iteration:  84%|████████▍ | 226/268 [00:45<00:33,  1.25it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:24,  1.66it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:18,  2.13it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:14,  2.67it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:11,  3.25it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:09,  3.83it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:08,  4.37it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:07,  4.84it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:06,  5.23it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  5.55it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  5.91it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  6.10it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.21it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.33it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.58it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.46it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.24it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.43it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.46it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.48it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.40it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.57it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.49it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.52it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.52it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.55it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.41it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.44it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.35it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.73it/s][A04/29/2024 01:49:24 - INFO - trainer.trainer_mod_2 - Epoch 68 finished. Took 52.23 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  69%|██████▉   | 69/100 [1:00:58<27:16, 52.78s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.14it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.37it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.63it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.71it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 01:49:25,362 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:49:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:49:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:49:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:49:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:49:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:49:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5678267214677118, 'eval_loss': 0.8673485, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1096, 1383, 1354, 1377, 1394, 973, 792, 534, 293, 246, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51514292, 'remaining_params': 33503308, 'pruned_model_sparsity': 0.6059250319933754, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 18500}


Iteration:   3%|▎         | 8/268 [00:03<03:36,  1.20it/s][A04/29/2024 01:49:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 18500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:40,  1.61it/s][A
Iteration:   4%|▎         | 10/268 [00:03<02:02,  2.10it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:37,  2.64it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:19,  3.22it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:07,  3.80it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:58,  4.33it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:52,  4.84it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:48,  5.21it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:45,  5.56it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:43,  5.78it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:42,  5.93it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:40,  6.19it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.23it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.31it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.22it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.33it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.23it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.24it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.33it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.39it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.46it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:35,  6.62it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.62it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.64it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.62it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.62it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.61it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.59it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.60it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:34,  6.61it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.58it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.60it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.40it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:34,  6.36it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:34,  6.18it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.21it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.25it/s][A[INFO|trainer.py:570] 2024-04-29 01:49:35,241 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:49:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:49:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:49:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:49:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:49:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:49:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.55727640631709, 'eval_loss': 0.8395763, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1101, 1387, 1358, 1381, 1399, 977, 798, 542, 301, 256, 369], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51229340, 'remaining_params': 33788260, 'pruned_model_sparsity': 0.6025733495182174, 'expected_sparsity': 0.59827, 'target_sparsity': 0.6, 'step': 18550}


Iteration:  22%|██▏       | 58/268 [00:13<02:47,  1.25it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<02:06,  1.65it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:37,  2.13it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<01:17,  2.67it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:03,  3.24it/s][A
Iteration:  24%|██▎       | 63/268 [00:13<00:53,  3.86it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:46,  4.34it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:41,  4.84it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:38,  5.28it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:35,  5.59it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:34,  5.88it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:32,  6.09it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.22it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:31,  6.35it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.45it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:15<00:29,  6.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.48it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.34it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.44it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.46it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.53it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.59it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.56it/s][A
Iteration:  33%|███▎      | 89/268 [00:17<00:27,  6.56it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.41it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.39it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.47it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.59it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.65it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.44it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.60it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.51it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:26,  6.23it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.31it/s][A[INFO|trainer.py:570] 2024-04-29 01:49:45,083 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:49:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:49:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:49:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:49:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:49:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:49:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5632084517291658, 'eval_loss': 0.8553893, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [957, 1093, 1379, 1349, 1374, 1392, 969, 789, 530, 288, 242, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51572508, 'remaining_params': 33445092, 'pruned_model_sparsity': 0.60660978432701, 'expected_sparsity': 0.60127, 'target_sparsity': 0.6, 'step': 18600}


Iteration:  40%|████      | 108/268 [00:23<02:08,  1.25it/s][A04/29/2024 01:49:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 18600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:23<01:36,  1.65it/s][A
Iteration:  41%|████      | 110/268 [00:23<01:13,  2.14it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:58,  2.70it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:47,  3.27it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:40,  3.81it/s][A
Iteration:  43%|████▎     | 114/268 [00:23<00:35,  4.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:31,  4.83it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:29,  5.20it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:27,  5.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:26,  5.76it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:24,  5.98it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:25,  5.76it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:25,  5.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:24,  6.05it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.22it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.31it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.36it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.30it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.36it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.37it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.46it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.59it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:20,  6.67it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.56it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.54it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.37it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.36it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.46it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.42it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.51it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.48it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.60it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.56it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.42it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.38it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.31it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 01:49:54,989 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:49:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:49:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:49:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:49:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:49:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:49:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5606238208505129, 'eval_loss': 0.8748029, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [958, 1093, 1379, 1349, 1373, 1391, 969, 789, 532, 290, 245, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51563316, 'remaining_params': 33454284, 'pruned_model_sparsity': 0.6065016655374887, 'expected_sparsity': 0.60084, 'target_sparsity': 0.6, 'step': 18650}


Iteration:  59%|█████▉    | 158/268 [00:32<01:27,  1.25it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<01:06,  1.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:50,  2.13it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:39,  2.68it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:32,  3.24it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:27,  3.81it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:23,  4.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:21,  4.81it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:19,  5.21it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:18,  5.61it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:17,  5.83it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:16,  5.97it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.13it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:15,  6.13it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.10it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.21it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.40it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.25it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.31it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.36it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.42it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.39it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.44it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.38it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.68it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.54it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.62it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.48it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.23it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.34it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:50:04,889 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:50:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:50:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:50:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:50:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:50:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:50:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5652516382961122, 'eval_loss': 0.8762665, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1102, 1387, 1356, 1380, 1397, 974, 795, 548, 310, 270, 389], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51007200, 'remaining_params': 34010400, 'pruned_model_sparsity': 0.5999604787714544, 'expected_sparsity': 0.59666, 'target_sparsity': 0.6, 'step': 18700}


Iteration:  78%|███████▊  | 208/268 [00:42<00:47,  1.25it/s][A04/29/2024 01:50:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 18700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:43<00:35,  1.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:27,  2.12it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:21,  2.67it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:17,  3.24it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:14,  3.79it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:12,  4.37it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:10,  4.83it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:10,  5.19it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:09,  5.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  5.68it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  6.01it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.14it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.18it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.27it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.39it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.56it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.53it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.46it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.33it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.31it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.24it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.49it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.54it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.41it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.49it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.48it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.52it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.39it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.40it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.42it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.39it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:50:14,804 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:50:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:50:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:50:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:50:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:50:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:50:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5517964161621091, 'eval_loss': 0.87232554, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [957, 1093, 1378, 1347, 1371, 1389, 965, 786, 529, 285, 241, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51597020, 'remaining_params': 33420580, 'pruned_model_sparsity': 0.6068981010990665, 'expected_sparsity': 0.60152, 'target_sparsity': 0.6, 'step': 18750}


Iteration:  96%|█████████▋| 258/268 [00:52<00:07,  1.25it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:05,  1.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:03,  2.10it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:02,  2.64it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  3.21it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  3.78it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  4.34it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  4.83it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  5.20it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.56it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.08it/s][A04/29/2024 01:50:18 - INFO - trainer.trainer_mod_2 - Epoch 69 finished. Took 54.34 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  70%|███████   | 70/100 [1:01:52<26:37, 53.25s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.32it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.10it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.36it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.37it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.42it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.49it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.37it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.46it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:38,  6.61it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.59it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.51it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.63it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.31it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:39,  6.25it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.48it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.47it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.43it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.38it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.42it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.34it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.33it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:50:24,703 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:50:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:50:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:50:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:50:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:50:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:50:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5526252359479631, 'eval_loss': 0.8723445, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [954, 1090, 1376, 1344, 1368, 1387, 962, 784, 529, 284, 240, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51629192, 'remaining_params': 33388408, 'pruned_model_sparsity': 0.6072765168623908, 'expected_sparsity': 0.60186, 'target_sparsity': 0.6, 'step': 18800}


Iteration:  15%|█▍        | 40/268 [00:08<03:02,  1.25it/s][A04/29/2024 01:50:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 18800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:17,  1.66it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:46,  2.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:24,  2.68it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:08,  3.26it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:58,  3.81it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:51,  4.31it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:46,  4.80it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:42,  5.21it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:40,  5.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:37,  5.84it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:36,  5.91it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:35,  6.11it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.20it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.27it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.33it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.33it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.51it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.45it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:33,  6.01it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:32,  6.25it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.31it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.37it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.48it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.49it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.19it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.27it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.38it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.46it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.44it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.41it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 01:50:34,627 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:50:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:50:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:50:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:50:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:50:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:50:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5588305747648582, 'eval_loss': 0.8546569, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1100, 1384, 1352, 1376, 1394, 970, 793, 549, 312, 274, 394], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51036308, 'remaining_params': 33981292, 'pruned_model_sparsity': 0.6003028549382716, 'expected_sparsity': 0.59672, 'target_sparsity': 0.6, 'step': 18850}


Iteration:  34%|███▎      | 90/268 [00:18<02:22,  1.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:47,  1.65it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<01:23,  2.11it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<01:06,  2.62it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:54,  3.19it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:45,  3.77it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:39,  4.30it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:35,  4.87it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:32,  5.27it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:30,  5.58it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:28,  5.82it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:27,  6.02it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.26it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.34it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.31it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.27it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.38it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.34it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.40it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.36it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.34it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.42it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.53it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.56it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.55it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.53it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.39it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.33it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.24it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.28it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.29it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.38it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.50it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.50it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.50it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.53it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:19,  6.65it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.40it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.53it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.51it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:50:44,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:50:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:50:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:50:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:50:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:50:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:50:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5538778174700708, 'eval_loss': 0.85512805, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [958, 1094, 1379, 1347, 1372, 1389, 964, 786, 533, 285, 241, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51583232, 'remaining_params': 33434368, 'pruned_model_sparsity': 0.6067359229147847, 'expected_sparsity': 0.60113, 'target_sparsity': 0.6, 'step': 18900}


Iteration:  52%|█████▏    | 140/268 [00:28<01:42,  1.25it/s][A04/29/2024 01:50:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 18900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:28<01:16,  1.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:59,  2.13it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:46,  2.69it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:37,  3.27it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:32,  3.81it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:28,  4.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:24,  4.86it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:22,  5.26it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:21,  5.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:20,  5.81it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:19,  6.01it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:19,  6.08it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.11it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.09it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.20it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.39it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.55it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.37it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.42it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.43it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.28it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.39it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.62it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.49it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.49it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.52it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.49it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.41it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.36it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.44it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 01:50:54,399 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:50:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:50:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:50:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:50:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:50:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:50:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5657894359264041, 'eval_loss': 0.863166, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [953, 1089, 1374, 1342, 1367, 1384, 959, 781, 528, 283, 240, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51655236, 'remaining_params': 33362364, 'pruned_model_sparsity': 0.607582853432701, 'expected_sparsity': 0.60212, 'target_sparsity': 0.6, 'step': 18950}


Iteration:  71%|███████   | 190/268 [00:38<01:02,  1.26it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:46,  1.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:35,  2.16it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:27,  2.70it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:22,  3.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:19,  3.82it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:16,  4.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:14,  4.84it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:13,  5.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:12,  5.58it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:11,  5.78it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:11,  5.96it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.06it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.01it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.10it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.16it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.27it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.37it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.33it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.36it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.44it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.28it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.34it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.47it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.50it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.52it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.50it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.37it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.48it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.33it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 01:51:04,298 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:51:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:51:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:51:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:51:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:51:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:51:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5694075373847854, 'eval_loss': 0.8486306, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [960, 1095, 1381, 1348, 1372, 1388, 964, 788, 541, 298, 258, 374], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51333516, 'remaining_params': 33684084, 'pruned_model_sparsity': 0.603798695799458, 'expected_sparsity': 0.59921, 'target_sparsity': 0.6, 'step': 19000}


Iteration:  90%|████████▉ | 240/268 [00:47<00:22,  1.26it/s][A04/29/2024 01:51:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 19000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:48<00:16,  1.64it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:12,  2.13it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:09,  2.66it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:07,  3.22it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:06,  3.80it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:05,  4.35it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:04,  4.77it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.16it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.51it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.78it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  5.98it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.06it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.19it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.29it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.32it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.37it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.51it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.54it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.40it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.31it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.30it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.19it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.22it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.30it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.65it/s][A04/29/2024 01:51:10 - INFO - trainer.trainer_mod_2 - Epoch 70 finished. Took 52.31 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.12it/s]
Epoch:  71%|███████   | 71/100 [1:02:45<25:36, 52.97s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.11it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.40it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.50it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.65it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.65it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.40it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:41,  6.28it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.38it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.36it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.33it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.36it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.39it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.41it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.31it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:40,  6.20it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:40,  6.21it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.21it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.21it/s][A[INFO|trainer.py:570] 2024-04-29 01:51:14,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:51:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:51:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:51:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:51:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:51:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:51:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5640063794282216, 'eval_loss': 0.8418714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1099, 1384, 1350, 1375, 1391, 967, 791, 547, 303, 264, 381], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51079204, 'remaining_params': 33938396, 'pruned_model_sparsity': 0.6008074092893707, 'expected_sparsity': 0.59787, 'target_sparsity': 0.6, 'step': 19050}


Iteration:   8%|▊         | 22/268 [00:05<03:19,  1.23it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:30,  1.63it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:56,  2.10it/s][A
Iteration:   9%|▉         | 25/268 [00:06<01:31,  2.65it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:16,  3.18it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:03,  3.79it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:56,  4.28it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:50,  4.76it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:45,  5.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<00:42,  5.51it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:40,  5.79it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:39,  5.92it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:38,  6.01it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.17it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.24it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.29it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.33it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.38it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.44it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.50it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.53it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.63it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.70it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.65it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.53it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.55it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.34it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.23it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.28it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.23it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.27it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.41it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:51:24,209 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:51:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:51:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:51:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:51:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:51:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:51:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5661576952804931, 'eval_loss': 0.84585345, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [954, 1090, 1376, 1342, 1368, 1385, 959, 782, 530, 283, 240, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51641448, 'remaining_params': 33376152, 'pruned_model_sparsity': 0.6074206752484191, 'expected_sparsity': 0.60192, 'target_sparsity': 0.6, 'step': 19100}


Iteration:  27%|██▋       | 72/268 [00:15<02:36,  1.25it/s][A04/29/2024 01:51:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 19100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:15<01:57,  1.65it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:31,  2.12it/s][A
Iteration:  28%|██▊       | 75/268 [00:16<01:12,  2.66it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:59,  3.21it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:49,  3.82it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:43,  4.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:39,  4.82it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:35,  5.29it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:33,  5.61it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:31,  5.87it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:30,  6.08it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.22it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.34it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.32it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.35it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.39it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.47it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.46it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.48it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.55it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.46it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.35it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.41it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.47it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.61it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:23,  6.66it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.66it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.50it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.59it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.56it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.68it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:24,  6.20it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.32it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.30it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:51:34,075 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:51:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:51:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:51:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:51:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:51:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:51:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5604772031378175, 'eval_loss': 0.83191586, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [957, 1092, 1378, 1344, 1369, 1386, 961, 784, 534, 287, 245, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51603148, 'remaining_params': 33414452, 'pruned_model_sparsity': 0.6069701802920807, 'expected_sparsity': 0.60111, 'target_sparsity': 0.6, 'step': 19150}


Iteration:  46%|████▌     | 122/268 [00:25<01:57,  1.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<01:28,  1.64it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<01:08,  2.11it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:53,  2.65it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:43,  3.25it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:36,  3.82it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:32,  4.32it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:29,  4.76it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:26,  5.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:25,  5.46it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:23,  5.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:22,  5.90it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:22,  5.93it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.18it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.21it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.40it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.25it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.32it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.51it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.54it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.51it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.51it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.41it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.54it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:16,  6.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:15,  6.63it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:15,  6.69it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.55it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:51:43,934 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:51:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:51:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:51:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:51:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:51:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:51:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.562623167776568, 'eval_loss': 0.82642245, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1101, 1386, 1351, 1376, 1393, 969, 793, 551, 309, 271, 389], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 5, 10], 'pruned_params': 51039372, 'remaining_params': 33978228, 'pruned_model_sparsity': 0.6003388945347787, 'expected_sparsity': 0.59698, 'target_sparsity': 0.6, 'step': 19200}


Iteration:  64%|██████▍   | 172/268 [00:35<01:16,  1.26it/s][A04/29/2024 01:51:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 19200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:35<00:57,  1.66it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:44,  2.14it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:34,  2.69it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:28,  3.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:23,  3.82it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:20,  4.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:18,  4.84it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:16,  5.22it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:15,  5.50it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:14,  5.76it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:14,  5.95it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.15it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.26it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.38it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.41it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.49it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.56it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.57it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.58it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:10,  6.57it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.55it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.35it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.46it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.30it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.40it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.29it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.24it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.32it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.39it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:51:53,805 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:51:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:51:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:51:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:51:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:51:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:51:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5689051637185746, 'eval_loss': 0.8314959, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [958, 1095, 1380, 1346, 1371, 1389, 964, 786, 535, 283, 240, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51581700, 'remaining_params': 33435900, 'pruned_model_sparsity': 0.6067179031165312, 'expected_sparsity': 0.60106, 'target_sparsity': 0.6, 'step': 19250}


Iteration:  83%|████████▎ | 222/268 [00:45<00:36,  1.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:27,  1.65it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:20,  2.13it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:16,  2.62it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:13,  3.19it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:10,  3.73it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:09,  4.27it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:08,  4.78it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:07,  5.21it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.54it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.75it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  5.96it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.11it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.38it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.43it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.47it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.56it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.48it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.32it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.25it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.30it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.35it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.53it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.64it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.55it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.31it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.24it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.62it/s][A04/29/2024 01:52:03 - INFO - trainer.trainer_mod_2 - Epoch 71 finished. Took 52.29 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  72%|███████▏  | 72/100 [1:03:37<24:37, 52.76s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.65it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:52:03,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:52:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:52:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:52:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:52:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:52:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:52:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5715199776370171, 'eval_loss': 0.8423165, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [955, 1092, 1378, 1344, 1369, 1386, 961, 783, 532, 281, 240, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51620000, 'remaining_params': 33397600, 'pruned_model_sparsity': 0.6071683980728696, 'expected_sparsity': 0.60171, 'target_sparsity': 0.6, 'step': 19300}


Iteration:   1%|▏         | 4/268 [00:02<04:24,  1.00s/it][A04/29/2024 01:52:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 19300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<03:03,  1.44it/s][A
Iteration:   2%|▏         | 6/268 [00:03<02:14,  1.95it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:43,  2.53it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:23,  3.13it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:09,  3.71it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:01,  4.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:55,  4.64it/s][A
Iteration:   4%|▍         | 12/268 [00:04<00:50,  5.07it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:46,  5.45it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:44,  5.72it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:42,  5.93it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.04it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:41,  6.08it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.21it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:40,  6.19it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:39,  6.23it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.28it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.36it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.38it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.42it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.38it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.35it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.43it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.43it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.49it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:35,  6.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:35,  6.60it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.42it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.49it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.51it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.30it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.42it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.37it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.45it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.56it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.53it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.52it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:52:13,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:52:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:52:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:52:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:52:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:52:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:52:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5699304939602442, 'eval_loss': 0.83907944, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1098, 1384, 1349, 1374, 1391, 966, 789, 543, 295, 256, 371], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51309004, 'remaining_params': 33708596, 'pruned_model_sparsity': 0.6035103790274013, 'expected_sparsity': 0.59905, 'target_sparsity': 0.6, 'step': 19350}


Iteration:  20%|██        | 54/268 [00:12<02:51,  1.25it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:09,  1.64it/s][A
Iteration:  21%|██        | 56/268 [00:13<01:40,  2.11it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<01:19,  2.65it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:05,  3.22it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:54,  3.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:47,  4.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:43,  4.79it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:38,  5.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:36,  5.60it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:35,  5.78it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:33,  5.98it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:32,  6.14it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:32,  6.24it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:32,  6.18it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:31,  6.31it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.38it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:31,  6.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.35it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.39it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.36it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.34it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.23it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.38it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.34it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.41it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.47it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.28it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.42it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.45it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.50it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.53it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.54it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:52:23,552 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:52:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:52:23 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:52:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:52:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:52:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:52:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5745572299732778, 'eval_loss': 0.82941616, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1100, 1386, 1351, 1376, 1393, 967, 790, 545, 295, 255, 370], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51286024, 'remaining_params': 33731576, 'pruned_model_sparsity': 0.6032400820535984, 'expected_sparsity': 0.59875, 'target_sparsity': 0.6, 'step': 19400}


Iteration:  39%|███▉      | 104/268 [00:22<02:10,  1.25it/s][A04/29/2024 01:52:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 19400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:22<01:38,  1.65it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<01:16,  2.12it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<01:00,  2.66it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:49,  3.26it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:41,  3.83it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:36,  4.29it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:32,  4.77it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:30,  5.18it/s][A
Iteration:  42%|████▏     | 113/268 [00:24<00:28,  5.51it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:27,  5.64it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:26,  5.82it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:24,  6.09it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:23,  6.31it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:23,  6.40it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.26it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:23,  6.28it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.27it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.26it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.43it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:21,  6.59it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.48it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.49it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.21it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.20it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.30it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.29it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.28it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.38it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.32it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.00it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:21,  6.14it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.18it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.25it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.27it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.23it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.42it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.47it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.61it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.61it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.36it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:52:33,522 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:52:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:52:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:52:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:52:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:52:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:52:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5687360893544328, 'eval_loss': 0.842827, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [957, 1095, 1381, 1347, 1372, 1389, 962, 784, 534, 281, 239, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51587828, 'remaining_params': 33429772, 'pruned_model_sparsity': 0.6067899823095453, 'expected_sparsity': 0.60134, 'target_sparsity': 0.6, 'step': 19450}


Iteration:  57%|█████▋    | 154/268 [00:32<01:31,  1.25it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<01:08,  1.66it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:52,  2.14it/s][A
Iteration:  59%|█████▊    | 157/268 [00:33<00:41,  2.68it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:33,  3.25it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:28,  3.82it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:24,  4.36it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:22,  4.85it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:20,  5.25it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:18,  5.60it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:17,  5.85it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:17,  5.95it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:16,  6.15it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:16,  6.25it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:15,  6.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:15,  6.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:14,  6.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:14,  6.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.42it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.37it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.29it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.26it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.43it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.38it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.44it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.59it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.55it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.50it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.48it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.53it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.49it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.48it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.49it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.20it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.29it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:52:43,391 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:52:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:52:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:52:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:52:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:52:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:52:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5650486518446893, 'eval_loss': 0.8264872, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [959, 1097, 1383, 1348, 1373, 1391, 963, 786, 538, 285, 243, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51554124, 'remaining_params': 33463476, 'pruned_model_sparsity': 0.6063935467479675, 'expected_sparsity': 0.60061, 'target_sparsity': 0.6, 'step': 19500}


Iteration:  76%|███████▌  | 204/268 [00:42<00:51,  1.25it/s][A04/29/2024 01:52:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 19500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:42<00:38,  1.65it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:29,  2.13it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:22,  2.67it/s][A
Iteration:  78%|███████▊  | 208/268 [00:43<00:18,  3.24it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:15,  3.79it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:13,  4.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:11,  4.90it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:10,  5.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:09,  5.62it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:09,  5.88it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:08,  6.04it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  6.26it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.33it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.48it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:06,  6.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.56it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.47it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.49it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.48it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.57it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.41it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.37it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.28it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.44it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.46it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.50it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.54it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.52it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.51it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.54it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:52:53,231 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:52:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:52:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:52:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:52:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:52:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:52:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5619111841232217, 'eval_loss': 0.8255783, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1102, 1388, 1353, 1378, 1395, 968, 792, 548, 298, 259, 373], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51253852, 'remaining_params': 33763748, 'pruned_model_sparsity': 0.602861666290274, 'expected_sparsity': 0.59819, 'target_sparsity': 0.6, 'step': 19550}


Iteration:  95%|█████████▍| 254/268 [00:52<00:11,  1.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:07,  1.65it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:05,  2.14it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:04,  2.67it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:03,  3.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:02,  3.76it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:01,  4.32it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  4.71it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.15it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  5.45it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.72it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  5.86it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  6.04it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.17it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.57it/s][A04/29/2024 01:52:57 - INFO - trainer.trainer_mod_2 - Epoch 72 finished. Took 54.46 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  73%|███████▎  | 73/100 [1:04:31<23:58, 53.27s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.30it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.18it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.33it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.40it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.46it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.42it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.41it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.43it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:41,  6.05it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:41,  6.13it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:40,  6.17it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.21it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:40,  6.22it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:39,  6.30it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.40it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.41it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.39it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.43it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.40it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.47it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.59it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.50it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.52it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:53:03,162 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:53:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:53:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:53:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:53:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:53:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:53:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5705082043516121, 'eval_loss': 0.8551324, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [961, 1099, 1385, 1350, 1374, 1393, 965, 788, 539, 282, 241, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51535740, 'remaining_params': 33481860, 'pruned_model_sparsity': 0.606177309168925, 'expected_sparsity': 0.6006, 'target_sparsity': 0.6, 'step': 19600}


Iteration:  13%|█▎        | 36/268 [00:07<03:04,  1.26it/s][A04/29/2024 01:53:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 19600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:19,  1.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:47,  2.14it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<01:26,  2.66it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:10,  3.24it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:59,  3.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:51,  4.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:46,  4.85it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:42,  5.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:39,  5.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:38,  5.78it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:36,  6.00it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.16it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.29it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.35it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.42it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.30it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.46it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.31it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.41it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.53it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.63it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.61it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:29,  6.62it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:29,  6.63it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.65it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.63it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.64it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.71it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.59it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.45it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.31it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 01:53:12,993 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:53:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:53:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:53:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:53:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 01:53:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:53:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5689445008605172, 'eval_loss': 0.8209805, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [959, 1097, 1383, 1348, 1373, 1392, 963, 786, 535, 281, 240, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51566380, 'remaining_params': 33451220, 'pruned_model_sparsity': 0.6065377051339957, 'expected_sparsity': 0.6011, 'target_sparsity': 0.6, 'step': 19650}


Iteration:  32%|███▏      | 86/268 [00:17<02:25,  1.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:49,  1.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<01:24,  2.13it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<01:07,  2.66it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:55,  3.23it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:46,  3.82it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:40,  4.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:36,  4.84it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:32,  5.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:30,  5.68it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:28,  5.94it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:28,  6.05it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.20it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.24it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.21it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.48it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.57it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.43it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.60it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.55it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.65it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.61it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.58it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.54it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.53it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.43it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.32it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.37it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.43it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:53:22,802 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:53:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:53:22 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:53:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:53:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:53:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:53:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5653455197559552, 'eval_loss': 0.8300936, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1101, 1388, 1352, 1377, 1395, 967, 790, 543, 289, 250, 363], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.59929, 'target_sparsity': 0.6, 'step': 19700}


Iteration:  51%|█████     | 136/268 [00:27<01:44,  1.26it/s][A04/29/2024 01:53:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 19700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:27<01:18,  1.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<01:00,  2.14it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:48,  2.65it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:39,  3.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:33,  3.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:29,  4.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:25,  4.83it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:24,  5.11it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:22,  5.49it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:21,  5.76it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:20,  6.00it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.08it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:19,  6.23it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.41it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.45it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.49it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:17,  6.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.46it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.50it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.35it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.58it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:14,  6.66it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.51it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.44it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.35it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.44it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.60it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.57it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.60it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.46it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:53:32,658 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:53:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:53:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:53:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:53:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:53:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:53:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.8428405, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1102, 1389, 1353, 1378, 1396, 967, 791, 544, 287, 247, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.59929, 'target_sparsity': 0.6, 'step': 19750}


Iteration:  69%|██████▉   | 186/268 [00:37<01:05,  1.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:49,  1.65it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:37,  2.12it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:30,  2.63it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:24,  3.23it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:20,  3.79it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:17,  4.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:15,  4.83it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:14,  5.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:13,  5.59it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:12,  5.92it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:11,  6.04it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.58it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.53it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.55it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.18it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.26it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:09,  6.40it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.36it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.40it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.41it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.38it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.42it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.41it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.42it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.46it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.35it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 01:53:42,551 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:53:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:53:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:53:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:53:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:53:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:53:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5707798240133651, 'eval_loss': 0.8524371, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [961, 1098, 1386, 1350, 1375, 1394, 964, 787, 537, 280, 239, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51541868, 'remaining_params': 33475732, 'pruned_model_sparsity': 0.6062493883619392, 'expected_sparsity': 0.6008, 'target_sparsity': 0.6, 'step': 19800}


Iteration:  88%|████████▊ | 236/268 [00:47<00:25,  1.25it/s][A04/29/2024 01:53:44 - INFO - trainer.trainer_mod_2 - v4 Global step: 19800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:47<00:18,  1.64it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:14,  2.12it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:10,  2.67it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:08,  3.26it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:07,  3.84it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:05,  4.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:05,  4.88it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  5.55it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  5.67it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  5.89it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.01it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.12it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.27it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.17it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.04it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.10it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.35it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.48it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.36it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.43it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.33it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.33it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.39it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.45it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.82it/s][A04/29/2024 01:53:49 - INFO - trainer.trainer_mod_2 - Epoch 73 finished. Took 52.13 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  74%|███████▍  | 74/100 [1:05:24<22:56, 52.93s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.24it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.14it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.58it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.53it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.49it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.51it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.66it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.61it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.50it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.54it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.51it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:53:52,434 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:53:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:53:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:53:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:53:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:53:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:53:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5668277832443891, 'eval_loss': 0.83786714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1099, 1387, 1350, 1376, 1395, 965, 788, 538, 281, 241, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51525016, 'remaining_params': 33492584, 'pruned_model_sparsity': 0.6060511705811502, 'expected_sparsity': 0.60046, 'target_sparsity': 0.6, 'step': 19850}


Iteration:   7%|▋         | 18/268 [00:04<03:19,  1.25it/s][A
Iteration:   7%|▋         | 19/268 [00:05<02:30,  1.65it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:56,  2.12it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:33,  2.65it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:16,  3.20it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:04,  3.78it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:56,  4.33it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:50,  4.82it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:46,  5.23it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:43,  5.57it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:41,  5.84it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:39,  6.02it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.13it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.20it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.33it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.47it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.58it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.55it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.60it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.68it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.66it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<00:32,  6.71it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.66it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.58it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.55it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.52it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.62it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.72it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.66it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.53it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:34,  6.09it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:33,  6.21it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:33,  6.14it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.23it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.38it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:54:02,317 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:54:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:54:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:54:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:54:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:54:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:54:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5687360893544328, 'eval_loss': 0.8441871, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1103, 1391, 1354, 1379, 1398, 968, 791, 545, 288, 249, 363], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51456076, 'remaining_params': 33561524, 'pruned_model_sparsity': 0.605240279659741, 'expected_sparsity': 0.59886, 'target_sparsity': 0.6, 'step': 19900}


Iteration:  25%|██▌       | 68/268 [00:14<02:39,  1.25it/s][A04/29/2024 01:54:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 19900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<02:00,  1.65it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:32,  2.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<01:13,  2.69it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:00,  3.22it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:51,  3.80it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:44,  4.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:39,  4.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:36,  5.20it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:34,  5.56it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:32,  5.84it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:31,  6.05it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.17it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.25it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.36it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.30it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.26it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.33it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.45it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.37it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.63it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.63it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.60it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.57it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.45it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.41it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.47it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.45it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.27it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.28it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.43it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.40it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.56it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.56it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.48it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.47it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:54:12,187 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:54:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:54:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:54:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:54:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:54:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:54:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.8397322, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1101, 1389, 1352, 1377, 1397, 966, 789, 540, 280, 240, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51505100, 'remaining_params': 33512500, 'pruned_model_sparsity': 0.6058169132038542, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 19950}


Iteration:  44%|████▍     | 118/268 [00:24<02:00,  1.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<01:30,  1.65it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<01:09,  2.13it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:55,  2.65it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:44,  3.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:38,  3.81it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:32,  4.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:29,  4.84it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:27,  5.25it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:25,  5.51it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:24,  5.64it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:23,  5.90it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.09it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.33it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.30it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:21,  6.26it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.38it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.50it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.44it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.45it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.47it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.54it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.57it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:19,  6.20it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.39it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.34it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.24it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.20it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.03it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.11it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.16it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.28it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.27it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.33it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.31it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:16,  6.29it/s][A[INFO|trainer.py:570] 2024-04-29 01:54:22,143 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:54:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:54:22 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:54:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:54:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:54:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:54:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5580354863452468, 'eval_loss': 0.85165495, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1100, 1388, 1350, 1375, 1395, 964, 787, 537, 279, 239, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51532676, 'remaining_params': 33484924, 'pruned_model_sparsity': 0.606141269572418, 'expected_sparsity': 0.60068, 'target_sparsity': 0.6, 'step': 20000}


Iteration:  63%|██████▎   | 168/268 [00:34<01:20,  1.25it/s][A04/29/2024 01:54:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 20000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:34<01:00,  1.64it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:46,  2.12it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:36,  2.68it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:29,  3.27it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:24,  3.86it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:21,  4.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:19,  4.85it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:17,  5.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:16,  5.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:15,  5.79it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.00it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:14,  6.19it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:14,  6.19it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.29it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.71it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.75it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.59it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.60it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.57it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.56it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.42it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.40it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.55it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.58it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.68it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.63it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.60it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.47it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.39it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.38it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.23it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.36it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.33it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.40it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:54:31,989 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:54:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:54:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:54:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:54:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 01:54:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:54:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5614202266883522, 'eval_loss': 0.8655707, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1102, 1390, 1352, 1377, 1398, 966, 790, 542, 282, 243, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.59978, 'target_sparsity': 0.6, 'step': 20050}


Iteration:  81%|████████▏ | 218/268 [00:44<00:39,  1.25it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:29,  1.65it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:22,  2.11it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:17,  2.66it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:14,  3.24it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:11,  3.81it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:10,  4.33it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:09,  4.75it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:08,  5.13it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:07,  5.47it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  5.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  5.89it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.09it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  6.10it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.15it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.28it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.24it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.27it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.35it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.48it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.48it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.46it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.34it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.28it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.38it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.27it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.33it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.23it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.43it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.50it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.49it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.44it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.55it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.53it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.40it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.49it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.51it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.64it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 01:54:41,894 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:54:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:54:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:54:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:54:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:54:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:54:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5642446874338215, 'eval_loss': 0.85719466, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1392, 1353, 1379, 1399, 967, 791, 544, 284, 243, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.59935, 'target_sparsity': 0.6, 'step': 20100}


Iteration: 100%|██████████| 268/268 [00:54<00:00,  1.26it/s][A04/29/2024 01:54:44 - INFO - trainer.trainer_mod_2 - Epoch 74 finished. Took 54.37 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  75%|███████▌  | 75/100 [1:06:18<22:14, 53.36s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/29/2024 01:54:44 - INFO - trainer.trainer_mod_2 - v4 Global step: 20100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.33it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:42,  6.17it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.31it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.25it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.36it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:42,  6.01it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:41,  6.15it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.28it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.46it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.58it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.53it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:37,  6.65it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.60it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.51it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.53it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.63it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.70it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.66it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.65it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.59it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.61it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.55it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.53it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.35it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.38it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.42it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.39it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.51it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.50it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:36,  6.39it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.38it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.47it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:34,  6.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.49it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:34,  6.43it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:34,  6.39it/s][A
Iteration:  18%|█▊        | 48/268 [00:07<00:35,  6.23it/s][A
Iteration:  18%|█▊        | 49/268 [00:07<00:35,  6.24it/s][A[INFO|trainer.py:570] 2024-04-29 01:54:51,821 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:54:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:54:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:54:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:54:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:54:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:54:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5543972545286807, 'eval_loss': 0.8420088, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1101, 1389, 1351, 1376, 1397, 965, 788, 539, 279, 239, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51515824, 'remaining_params': 33501776, 'pruned_model_sparsity': 0.605943051791629, 'expected_sparsity': 0.60046, 'target_sparsity': 0.6, 'step': 20150}


Iteration:  19%|█▊        | 50/268 [00:10<03:20,  1.09it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<02:29,  1.45it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:54,  1.89it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<01:29,  2.41it/s][A
Iteration:  20%|██        | 54/268 [00:10<01:11,  2.98it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:00,  3.55it/s][A
Iteration:  21%|██        | 56/268 [00:11<00:51,  4.13it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:45,  4.62it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:41,  5.08it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:38,  5.38it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:37,  5.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:35,  5.82it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:33,  6.10it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.25it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.31it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:31,  6.29it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:30,  6.39it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.47it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.43it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.39it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:29,  6.33it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:29,  6.38it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.42it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:16<00:27,  6.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:16<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:28,  6.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.45it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.35it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:17<00:27,  6.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:17<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:26,  6.43it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:26,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:55:02,093 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:55:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:55:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:55:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:55:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:55:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:55:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5642446874338215, 'eval_loss': 0.8380986, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1101, 1389, 1351, 1377, 1397, 965, 788, 539, 279, 239, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51512760, 'remaining_params': 33504840, 'pruned_model_sparsity': 0.605907012195122, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 20200}


Iteration:  37%|███▋      | 100/268 [00:20<02:13,  1.25it/s][A04/29/2024 01:55:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 20200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:20<01:40,  1.66it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<01:17,  2.15it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:01,  2.67it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:50,  3.25it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:42,  3.79it/s][A
Iteration:  40%|███▉      | 106/268 [00:21<00:37,  4.28it/s][A
Iteration:  40%|███▉      | 107/268 [00:21<00:33,  4.78it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:30,  5.19it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:28,  5.53it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:27,  5.79it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:26,  5.94it/s][A
Iteration:  42%|████▏     | 112/268 [00:22<00:25,  6.14it/s][A
Iteration:  42%|████▏     | 113/268 [00:22<00:25,  6.18it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.30it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.29it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.27it/s][A
Iteration:  44%|████▍     | 119/268 [00:23<00:23,  6.37it/s][A
Iteration:  45%|████▍     | 120/268 [00:23<00:23,  6.37it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.26it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:23,  6.26it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:23,  6.26it/s][A
Iteration:  47%|████▋     | 125/268 [00:24<00:23,  6.18it/s][A
Iteration:  47%|████▋     | 126/268 [00:24<00:22,  6.27it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.35it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:25<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 132/268 [00:25<00:21,  6.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:25<00:20,  6.54it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.34it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.37it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.40it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.54it/s][A
Iteration:  51%|█████▏    | 138/268 [00:26<00:20,  6.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:26<00:19,  6.46it/s][A
Iteration:  52%|█████▏    | 140/268 [00:26<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.54it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.28it/s][A
Iteration:  54%|█████▎    | 144/268 [00:27<00:19,  6.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:27<00:19,  6.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:27<00:18,  6.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:19,  6.36it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:18,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:55:12,045 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:55:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:55:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:55:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:55:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:55:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:55:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5657894359264041, 'eval_loss': 0.8686625, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1104, 1392, 1354, 1379, 1400, 967, 791, 544, 283, 244, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.59934, 'target_sparsity': 0.6, 'step': 20250}


Iteration:  56%|█████▌    | 150/268 [00:30<01:34,  1.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:30<01:10,  1.66it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:54,  2.13it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:43,  2.66it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:35,  3.26it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:29,  3.82it/s][A
Iteration:  58%|█████▊    | 156/268 [00:31<00:25,  4.36it/s][A
Iteration:  59%|█████▊    | 157/268 [00:31<00:22,  4.85it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:20,  5.26it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:19,  5.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:18,  5.72it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  5.95it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.13it/s][A
Iteration:  61%|██████    | 163/268 [00:32<00:16,  6.33it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.16it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 169/268 [00:33<00:15,  6.47it/s][A
Iteration:  63%|██████▎   | 170/268 [00:33<00:15,  6.43it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:14,  6.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:34<00:14,  6.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:34<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.43it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.49it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:35<00:13,  6.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:35<00:12,  6.60it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.59it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.68it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.51it/s][A
Iteration:  70%|███████   | 188/268 [00:36<00:12,  6.54it/s][A
Iteration:  71%|███████   | 189/268 [00:36<00:12,  6.52it/s][A
Iteration:  71%|███████   | 190/268 [00:36<00:12,  6.50it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.40it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.41it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:37<00:11,  6.53it/s][A
Iteration:  73%|███████▎  | 196/268 [00:37<00:11,  6.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:37<00:10,  6.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:37<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 199/268 [00:37<00:10,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 01:55:21,899 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:55:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:55:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:55:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:55:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:55:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:55:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5564748164739529, 'eval_loss': 0.86072797, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1104, 1392, 1353, 1379, 1400, 966, 789, 541, 278, 239, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51482120, 'remaining_params': 33535480, 'pruned_model_sparsity': 0.6055466162300512, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 20300}


Iteration:  75%|███████▍  | 200/268 [00:40<00:54,  1.25it/s][A04/29/2024 01:55:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 20300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:40<00:40,  1.65it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:30,  2.13it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:24,  2.67it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:19,  3.25it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:16,  3.83it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:14,  4.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:41<00:12,  4.87it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:11,  5.23it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:10,  5.54it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  5.80it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  5.97it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:09,  6.01it/s][A
Iteration:  79%|███████▉  | 213/268 [00:42<00:08,  6.25it/s][A
Iteration:  80%|███████▉  | 214/268 [00:42<00:08,  6.22it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.15it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.27it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.18it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 220/268 [00:43<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 221/268 [00:43<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.55it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.63it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.63it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.64it/s][A
Iteration:  84%|████████▍ | 226/268 [00:44<00:06,  6.70it/s][A
Iteration:  85%|████████▍ | 227/268 [00:44<00:06,  6.67it/s][A
Iteration:  85%|████████▌ | 228/268 [00:44<00:06,  6.63it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.68it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.67it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:45<00:05,  6.56it/s][A
Iteration:  87%|████████▋ | 234/268 [00:45<00:05,  6.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.47it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:46<00:04,  6.50it/s][A
Iteration:  90%|████████▉ | 240/268 [00:46<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:46<00:04,  6.46it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 246/268 [00:47<00:03,  6.59it/s][A
Iteration:  92%|█████████▏| 247/268 [00:47<00:03,  6.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:47<00:03,  6.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:47<00:02,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 01:55:31,729 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:55:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:55:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:55:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:55:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:55:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:55:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5604772031378175, 'eval_loss': 0.847297, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1102, 1390, 1353, 1377, 1399, 965, 788, 539, 277, 239, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.60031, 'target_sparsity': 0.6, 'step': 20350}


Iteration:  93%|█████████▎| 250/268 [00:49<00:14,  1.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:10,  1.66it/s][A
Iteration:  94%|█████████▍| 252/268 [00:50<00:07,  2.13it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:05,  2.67it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:04,  3.23it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:03,  3.82it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  4.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:02,  4.75it/s][A
Iteration:  96%|█████████▋| 258/268 [00:51<00:01,  5.17it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  5.62it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  5.87it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  5.81it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:01,  6.00it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.06it/s][A
Iteration:  99%|█████████▊| 264/268 [00:52<00:00,  6.18it/s][A
Iteration:  99%|█████████▉| 265/268 [00:52<00:00,  6.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:52<00:00,  6.14it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.26it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.68it/s][A04/29/2024 01:55:36 - INFO - trainer.trainer_mod_2 - Epoch 75 finished. Took 52.63 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.09it/s]
Epoch:  76%|███████▌  | 76/100 [1:07:11<21:15, 53.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.43it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.32it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.24it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.32it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.31it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.29it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:41,  6.19it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.31it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.32it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.35it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.32it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.48it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.52it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.63it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.49it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.43it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.55it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.45it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.55it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.37it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.45it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:55:41,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:55:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:55:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:55:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:55:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:55:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:55:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.57368884664922, 'eval_loss': 0.85893536, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1103, 1391, 1353, 1378, 1400, 965, 788, 540, 278, 239, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.60008, 'target_sparsity': 0.6, 'step': 20400}


Iteration:  12%|█▏        | 32/268 [00:07<03:08,  1.25it/s][A04/29/2024 01:55:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 20400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:07<02:22,  1.65it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:50,  2.12it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:28,  2.64it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:12,  3.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:00,  3.79it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:52,  4.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:47,  4.82it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:43,  5.21it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:41,  5.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:39,  5.73it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:37,  5.97it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:36,  6.10it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.21it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.23it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.32it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.48it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.27it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.29it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.45it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.45it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.46it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.57it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.60it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:31,  6.69it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.67it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.48it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.53it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.35it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.37it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.50it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.51it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.55it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.55it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.63it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.53it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.54it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.46it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.58it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.55it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 01:55:51,487 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:55:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:55:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:55:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:55:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:55:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:55:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5653455197559552, 'eval_loss': 0.8317978, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1104, 1393, 1355, 1379, 1402, 967, 790, 543, 279, 239, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.59963, 'target_sparsity': 0.6, 'step': 20450}


Iteration:  31%|███       | 82/268 [00:16<02:27,  1.26it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:51,  1.66it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<01:26,  2.12it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<01:08,  2.66it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:56,  3.24it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:48,  3.77it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:41,  4.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:37,  4.80it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:33,  5.28it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:31,  5.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:30,  5.81it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:29,  5.95it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:28,  6.14it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:27,  6.24it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.25it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.32it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.25it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.19it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:27,  6.21it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.27it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.26it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.18it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.19it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.36it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.48it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.48it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.51it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.46it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.22it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.32it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.30it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.32it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.41it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.36it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.42it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:56:01,445 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:56:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:56:01 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:56:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:56:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:56:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:56:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5578770438298012, 'eval_loss': 0.86107934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1103, 1392, 1354, 1378, 1401, 965, 788, 541, 277, 238, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 20500}


Iteration:  49%|████▉     | 132/268 [00:26<01:48,  1.25it/s][A04/29/2024 01:56:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 20500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:27<01:21,  1.65it/s][A
Iteration:  50%|█████     | 134/268 [00:27<01:02,  2.13it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:50,  2.65it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:40,  3.22it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:34,  3.84it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:29,  4.38it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:26,  4.85it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:23,  5.34it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:22,  5.73it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:21,  5.96it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.15it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.36it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.40it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.44it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.46it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.59it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.03it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.25it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.58it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.60it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.60it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.48it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.39it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.32it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.38it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:14,  6.28it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.33it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 01:56:11,335 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:56:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:56:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:56:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:56:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:56:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:56:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5606238208505129, 'eval_loss': 0.85408634, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1102, 1391, 1353, 1377, 1400, 964, 787, 540, 277, 238, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 20550}


Iteration:  68%|██████▊   | 182/268 [00:36<01:08,  1.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:51,  1.65it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:39,  2.13it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:31,  2.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:25,  3.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:21,  3.79it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:18,  4.38it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:16,  4.87it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:14,  5.28it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:13,  5.63it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:13,  5.81it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.01it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.17it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.24it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.31it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.46it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.48it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.42it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.52it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.38it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.36it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.39it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.44it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.50it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.62it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.62it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.57it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.49it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.40it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.53it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.66it/s][A[INFO|trainer.py:570] 2024-04-29 01:56:21,181 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:56:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:56:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:56:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:56:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:56:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:56:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5609903802347734, 'eval_loss': 0.8559898, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1104, 1393, 1354, 1379, 1401, 965, 788, 542, 277, 238, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.59994, 'target_sparsity': 0.6, 'step': 20600}


Iteration:  87%|████████▋ | 232/268 [00:46<00:28,  1.25it/s][A04/29/2024 01:56:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 20600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:46<00:21,  1.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:16,  2.12it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:12,  2.66it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:09,  3.21it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:08,  3.76it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:07,  4.22it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:06,  4.74it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:05,  5.18it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  5.47it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.74it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  5.94it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.19it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.15it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.28it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.35it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.33it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.27it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.46it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.42it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.31it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.29it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.26it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.36it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.41it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.44it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.48it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.42it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.81it/s][A04/29/2024 01:56:28 - INFO - trainer.trainer_mod_2 - Epoch 76 finished. Took 52.26 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  77%|███████▋  | 77/100 [1:08:03<20:16, 52.88s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.59it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.50it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.46it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.47it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.49it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.30it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.39it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 01:56:31,106 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:56:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:56:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:56:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:56:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:56:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:56:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5584013487121077, 'eval_loss': 0.86203635, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1105, 1394, 1355, 1380, 1402, 966, 789, 544, 277, 238, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.59971, 'target_sparsity': 0.6, 'step': 20650}


Iteration:   5%|▌         | 14/268 [00:04<03:24,  1.24it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:34,  1.64it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:59,  2.12it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:34,  2.64it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:18,  3.19it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:06,  3.75it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:57,  4.32it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:51,  4.82it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:48,  5.12it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:45,  5.43it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.83it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:40,  6.04it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:39,  6.20it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.24it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.34it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.41it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.43it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.32it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:34,  6.49it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.61it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.42it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.49it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:32,  6.71it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:32,  6.75it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:32,  6.72it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.59it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.57it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.57it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.48it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.50it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.39it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.46it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.53it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.54it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 01:56:40,957 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:56:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:56:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:56:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:56:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 01:56:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:56:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5609903802347734, 'eval_loss': 0.85043955, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1103, 1393, 1353, 1378, 1401, 964, 787, 541, 276, 237, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51489780, 'remaining_params': 33527820, 'pruned_model_sparsity': 0.6056367152213189, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 20700}


Iteration:  24%|██▍       | 64/268 [00:14<02:42,  1.26it/s][A04/29/2024 01:56:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 20700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:14<02:02,  1.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:34,  2.13it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<01:15,  2.68it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:01,  3.25it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:51,  3.84it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:45,  4.40it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:40,  4.87it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:37,  5.27it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:35,  5.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:33,  5.83it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:32,  5.96it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:31,  6.12it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.26it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:30,  6.29it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.35it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.14it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.28it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:29,  6.30it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.55it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.65it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.43it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.37it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.47it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.42it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.48it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.52it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.55it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:25,  6.65it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.56it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.58it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.54it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.57it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.60it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.48it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.60it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:56:50,778 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:56:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:56:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:56:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:56:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 01:56:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:56:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5668277832443891, 'eval_loss': 0.8520658, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1103, 1393, 1353, 1377, 1401, 963, 787, 541, 275, 237, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51494376, 'remaining_params': 33523224, 'pruned_model_sparsity': 0.6056907746160795, 'expected_sparsity': 0.6002, 'target_sparsity': 0.6, 'step': 20750}


Iteration:  43%|████▎     | 114/268 [00:23<02:02,  1.26it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<01:32,  1.66it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<01:11,  2.14it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:56,  2.67it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:46,  3.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:39,  3.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:34,  4.32it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:30,  4.87it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:27,  5.29it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:25,  5.63it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:25,  5.74it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:23,  5.98it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:23,  6.06it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:23,  6.04it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.19it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.16it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.30it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.26it/s][A
Iteration:  50%|████▉     | 133/268 [00:26<00:21,  6.33it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.28it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.36it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.21it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.29it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.50it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.09it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.24it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.51it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.54it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.42it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.54it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.47it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.58it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.58it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.50it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.51it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:57:00,685 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:57:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:57:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:57:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:57:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 01:57:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:57:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5663656369027515, 'eval_loss': 0.8590438, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1395, 1354, 1379, 1403, 965, 789, 543, 275, 237, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 20800}


Iteration:  61%|██████    | 164/268 [00:33<01:22,  1.26it/s][A04/29/2024 01:57:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 20800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:34<01:01,  1.66it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:47,  2.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:37,  2.69it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:30,  3.25it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:25,  3.83it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:22,  4.37it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:19,  4.86it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:18,  5.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:17,  5.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:16,  5.70it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:15,  5.91it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:15,  6.10it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.52it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.52it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.37it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:13,  6.40it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.43it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.48it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.47it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.42it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.39it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.60it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.48it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:10,  6.54it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.51it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.53it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.50it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.43it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.58it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:40<00:08,  6.52it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.54it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 01:57:10,538 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:57:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:57:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:57:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:57:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.18it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.74it/s]04/29/2024 01:57:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:57:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5526838482765232, 'eval_loss': 0.8608385, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1105, 1396, 1355, 1380, 1404, 965, 789, 544, 275, 237, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 20850}


Iteration:  80%|███████▉  | 214/268 [00:43<00:43,  1.25it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:32,  1.65it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:24,  2.12it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:19,  2.66it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:15,  3.26it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:13,  3.73it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:11,  4.25it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:09,  4.70it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:08,  5.12it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:08,  5.43it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  5.72it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  5.97it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.01it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.15it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.24it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.17it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.36it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.41it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.29it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.40it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.54it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.52it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.51it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.31it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.40it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.44it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.49it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.50it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.52it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.41it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.34it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.41it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.28it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.51it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.57it/s][A[INFO|trainer.py:570] 2024-04-29 01:57:20,463 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:57:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:57:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:57:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:57:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 01:57:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:57:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.560464995177653, 'eval_loss': 0.8701555, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1103, 1394, 1353, 1378, 1402, 963, 787, 541, 274, 237, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51489780, 'remaining_params': 33527820, 'pruned_model_sparsity': 0.6056367152213189, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 20900}


Iteration:  99%|█████████▊| 264/268 [00:53<00:03,  1.25it/s][A04/29/2024 01:57:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 20900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:53<00:01,  1.65it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  2.12it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  2.65it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  3.32it/s][A04/29/2024 01:57:23 - INFO - trainer.trainer_mod_2 - Epoch 77 finished. Took 54.28 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.94it/s]
Epoch:  78%|███████▊  | 78/100 [1:08:57<19:32, 53.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.39it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.44it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.58it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.59it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.54it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.44it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.47it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.51it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.38it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.35it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.51it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.53it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.52it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.52it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:36,  6.67it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.73it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.58it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:36,  6.58it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.47it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.20it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:38,  6.20it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:38,  6.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.42it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.61it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.56it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:34,  6.62it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:34,  6.63it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:34,  6.50it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:34,  6.49it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:35,  6.38it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.52it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:34,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:57:30,315 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:57:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:57:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:57:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:57:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:57:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:57:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5489250601752835, 'eval_loss': 0.8657471, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1102, 1393, 1352, 1378, 1402, 962, 786, 541, 273, 236, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 20950}


Iteration:  17%|█▋        | 46/268 [00:09<02:57,  1.25it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<02:13,  1.65it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:43,  2.13it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<01:21,  2.67it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:07,  3.23it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:58,  3.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:51,  4.22it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:45,  4.71it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:41,  5.20it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:38,  5.54it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:36,  5.78it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:35,  5.97it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.21it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.24it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.29it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.39it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.43it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.47it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.38it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:31,  6.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.51it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.33it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.48it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.31it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.30it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.33it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:29,  6.30it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.38it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.49it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.55it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.62it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:27,  6.38it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:27,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 01:57:40,248 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:57:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:57:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:57:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:57:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:57:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:57:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5745572299732778, 'eval_loss': 0.8523882, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1395, 1354, 1380, 1404, 965, 789, 545, 274, 238, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.59961, 'target_sparsity': 0.6, 'step': 21000}


Iteration:  36%|███▌      | 96/268 [00:19<02:17,  1.25it/s][A04/29/2024 01:57:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 21000, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:19<01:44,  1.64it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<01:20,  2.11it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:03,  2.65it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:51,  3.25it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:43,  3.82it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:38,  4.32it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:34,  4.74it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:32,  5.11it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:30,  5.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:28,  5.60it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:27,  5.89it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:26,  6.08it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.22it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.48it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.48it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.54it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.45it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.38it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.52it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.55it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.57it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.69it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.50it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.43it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.56it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.52it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.54it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:19,  6.63it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.42it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:20,  6.26it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.36it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:21,  5.99it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:20,  6.14it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.33it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:19,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 01:57:50,146 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:57:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:57:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:57:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:57:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:57:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:57:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5606238208505129, 'eval_loss': 0.87184083, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1103, 1394, 1354, 1380, 1404, 964, 788, 544, 274, 237, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51469864, 'remaining_params': 33547736, 'pruned_model_sparsity': 0.6054024578440229, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 21050}


Iteration:  54%|█████▍    | 146/268 [00:29<01:37,  1.25it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<01:12,  1.66it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:56,  2.13it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:44,  2.67it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:36,  3.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:30,  3.83it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:26,  4.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:24,  4.76it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:21,  5.19it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:20,  5.61it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:19,  5.84it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:18,  5.98it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:18,  6.08it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.11it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.22it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.32it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.48it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.60it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.40it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.40it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.36it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.45it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.39it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.55it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.43it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.39it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.56it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:11,  6.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:11,  6.56it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.41it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:58:00,044 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:58:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:58:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:58:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:58:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:58:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:58:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5549749054428225, 'eval_loss': 0.84516746, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1102, 1392, 1352, 1378, 1402, 962, 786, 542, 273, 236, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 21100}


Iteration:  73%|███████▎  | 196/268 [00:38<00:57,  1.25it/s][A04/29/2024 01:58:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 21100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:39<00:43,  1.65it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:33,  2.12it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:26,  2.63it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:21,  3.19it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:17,  3.75it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:15,  4.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:13,  4.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:12,  5.27it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:11,  5.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  5.74it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  5.88it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.07it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.22it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.30it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.35it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.43it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.45it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.44it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.42it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.46it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.40it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.46it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.47it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.42it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.37it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.43it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.61it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.56it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.57it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.26it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.32it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.44it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.40it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 01:58:09,944 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:58:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:58:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:58:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:58:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 14.94it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.25it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.65it/s]04/29/2024 01:58:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:58:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5711178585424906, 'eval_loss': 0.84205496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1102, 1392, 1352, 1377, 1402, 962, 786, 542, 273, 236, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 21150}


Iteration:  92%|█████████▏| 246/268 [00:48<00:17,  1.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:12,  1.64it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:09,  2.11it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:07,  2.66it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:05,  3.24it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:04,  3.86it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:03,  4.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:03,  4.85it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.21it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  5.60it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.89it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.04it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.23it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.33it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.37it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.38it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.56it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.58it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.58it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.57it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.89it/s][A04/29/2024 01:58:15 - INFO - trainer.trainer_mod_2 - Epoch 78 finished. Took 52.23 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  79%|███████▉  | 79/100 [1:09:49<18:32, 52.98s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.11it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.31it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.29it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.27it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.33it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.26it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.21it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:42,  6.06it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:41,  6.16it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:41,  6.16it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:41,  6.15it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.34it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.39it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.58it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.56it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.47it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.60it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:36,  6.64it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:36,  6.57it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.56it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 01:58:19,825 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:58:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:58:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:58:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:58:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:58:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:58:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5784786967005595, 'eval_loss': 0.84453195, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1104, 1394, 1354, 1380, 1404, 963, 788, 546, 275, 239, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51459140, 'remaining_params': 33558460, 'pruned_model_sparsity': 0.6052763192562481, 'expected_sparsity': 0.59939, 'target_sparsity': 0.6, 'step': 21200}
04/29/2024 01:58:21 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 79 | Step: 21200 | Model size: 33558460 | Score: 0.57848]

[INFO|configuration_utils.py:439] 2024-04-29 01:58:21,982 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 01:58:22,813 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  10%|█         | 28/268 [00:07<04:12,  1.05s/it][A04/29/2024 01:58:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 21200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:07<03:06,  1.28it/s][A
Iteration:  11%|█         | 30/268 [00:07<02:21,  1.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<01:49,  2.16it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:27,  2.71it/s][A
Iteration:  12%|█▏        | 33/268 [00:08<01:11,  3.29it/s][A
Iteration:  13%|█▎        | 34/268 [00:08<01:00,  3.84it/s][A
Iteration:  13%|█▎        | 35/268 [00:08<00:52,  4.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:08<00:47,  4.89it/s][A
Iteration:  14%|█▍        | 37/268 [00:08<00:43,  5.29it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:40,  5.66it/s][A
Iteration:  15%|█▍        | 39/268 [00:09<00:38,  5.89it/s][A
Iteration:  15%|█▍        | 40/268 [00:09<00:38,  5.98it/s][A
Iteration:  15%|█▌        | 41/268 [00:09<00:36,  6.15it/s][A
Iteration:  16%|█▌        | 42/268 [00:09<00:36,  6.24it/s][A
Iteration:  16%|█▌        | 43/268 [00:09<00:35,  6.31it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:10<00:34,  6.48it/s][A
Iteration:  18%|█▊        | 47/268 [00:10<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 48/268 [00:10<00:33,  6.52it/s][A
Iteration:  18%|█▊        | 49/268 [00:10<00:33,  6.45it/s][A
Iteration:  19%|█▊        | 50/268 [00:10<00:33,  6.51it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.53it/s][A
Iteration:  19%|█▉        | 52/268 [00:11<00:32,  6.55it/s][A
Iteration:  20%|█▉        | 53/268 [00:11<00:33,  6.48it/s][A
Iteration:  20%|██        | 54/268 [00:11<00:32,  6.59it/s][A
Iteration:  21%|██        | 55/268 [00:11<00:32,  6.60it/s][A
Iteration:  21%|██        | 56/268 [00:11<00:32,  6.60it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.56it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.48it/s][A
Iteration:  22%|██▏       | 59/268 [00:12<00:32,  6.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:32,  6.47it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:31,  6.48it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:31,  6.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:31,  6.45it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.19it/s][A
Iteration:  24%|██▍       | 65/268 [00:13<00:32,  6.27it/s][A
Iteration:  25%|██▍       | 66/268 [00:13<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:31,  6.35it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:31,  6.42it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:14<00:29,  6.56it/s][A
Iteration:  27%|██▋       | 73/268 [00:14<00:30,  6.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:29,  6.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:29,  6.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 01:58:30,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:58:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:58:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:58:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:58:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:58:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:58:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5794528111058918, 'eval_loss': 0.8294207, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1102, 1392, 1352, 1378, 1402, 961, 786, 542, 272, 236, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51498972, 'remaining_params': 33518628, 'pruned_model_sparsity': 0.6057448340108401, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 21250}
04/29/2024 01:58:32 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 79 | Step: 21250 | Model size: 33518628 | Score: 0.57945]

[INFO|configuration_utils.py:439] 2024-04-29 01:58:32,674 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 01:58:36,574 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  29%|██▉       | 78/268 [00:21<06:15,  1.97s/it][A
Iteration:  29%|██▉       | 79/268 [00:21<04:32,  1.44s/it][A
Iteration:  30%|██▉       | 80/268 [00:21<03:20,  1.06s/it][A
Iteration:  30%|███       | 81/268 [00:21<02:28,  1.26it/s][A
Iteration:  31%|███       | 82/268 [00:21<01:51,  1.66it/s][A
Iteration:  31%|███       | 83/268 [00:21<01:26,  2.13it/s][A
Iteration:  31%|███▏      | 84/268 [00:22<01:09,  2.66it/s][A
Iteration:  32%|███▏      | 85/268 [00:22<00:57,  3.17it/s][A
Iteration:  32%|███▏      | 86/268 [00:22<00:49,  3.68it/s][A
Iteration:  32%|███▏      | 87/268 [00:22<00:42,  4.24it/s][A
Iteration:  33%|███▎      | 88/268 [00:22<00:37,  4.74it/s][A
Iteration:  33%|███▎      | 89/268 [00:22<00:34,  5.14it/s][A
Iteration:  34%|███▎      | 90/268 [00:23<00:32,  5.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:23<00:30,  5.86it/s][A
Iteration:  34%|███▍      | 92/268 [00:23<00:29,  5.88it/s][A
Iteration:  35%|███▍      | 93/268 [00:23<00:29,  6.01it/s][A
Iteration:  35%|███▌      | 94/268 [00:23<00:28,  6.15it/s][A
Iteration:  35%|███▌      | 95/268 [00:23<00:28,  6.16it/s][A
Iteration:  36%|███▌      | 96/268 [00:24<00:27,  6.28it/s][A
Iteration:  36%|███▌      | 97/268 [00:24<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 98/268 [00:24<00:26,  6.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:24<00:27,  6.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:24<00:26,  6.24it/s][A
Iteration:  38%|███▊      | 101/268 [00:24<00:26,  6.31it/s][A
Iteration:  38%|███▊      | 102/268 [00:24<00:25,  6.40it/s][A
Iteration:  38%|███▊      | 103/268 [00:25<00:25,  6.47it/s][A
Iteration:  39%|███▉      | 104/268 [00:25<00:25,  6.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:25<00:25,  6.40it/s][A
Iteration:  40%|███▉      | 106/268 [00:25<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:25<00:24,  6.50it/s][A
Iteration:  40%|████      | 108/268 [00:25<00:24,  6.54it/s][A
Iteration:  41%|████      | 109/268 [00:26<00:24,  6.40it/s][A
Iteration:  41%|████      | 110/268 [00:26<00:24,  6.46it/s][A
Iteration:  41%|████▏     | 111/268 [00:26<00:24,  6.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:26<00:24,  6.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:26<00:24,  6.35it/s][A
Iteration:  43%|████▎     | 114/268 [00:26<00:24,  6.25it/s][A
Iteration:  43%|████▎     | 115/268 [00:27<00:24,  6.23it/s][A
Iteration:  43%|████▎     | 116/268 [00:27<00:24,  6.25it/s][A
Iteration:  44%|████▎     | 117/268 [00:27<00:23,  6.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:27<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:27<00:23,  6.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:27<00:22,  6.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:27<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:28<00:22,  6.50it/s][A
Iteration:  46%|████▌     | 123/268 [00:28<00:22,  6.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:28<00:21,  6.56it/s][A
Iteration:  47%|████▋     | 125/268 [00:28<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 126/268 [00:28<00:21,  6.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:28<00:21,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 01:58:44,467 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:58:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:58:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:58:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:58:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:58:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:58:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5771272716642352, 'eval_loss': 0.823849, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1101, 1391, 1351, 1377, 1401, 960, 785, 541, 271, 236, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51512760, 'remaining_params': 33504840, 'pruned_model_sparsity': 0.605907012195122, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 21300}


Iteration:  48%|████▊     | 128/268 [00:31<01:51,  1.25it/s][A04/29/2024 01:58:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 21300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:31<01:24,  1.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:31<01:05,  2.12it/s][A
Iteration:  49%|████▉     | 131/268 [00:31<00:51,  2.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:31<00:41,  3.24it/s][A
Iteration:  50%|████▉     | 133/268 [00:31<00:35,  3.81it/s][A
Iteration:  50%|█████     | 134/268 [00:32<00:30,  4.36it/s][A
Iteration:  50%|█████     | 135/268 [00:32<00:27,  4.83it/s][A
Iteration:  51%|█████     | 136/268 [00:32<00:25,  5.25it/s][A
Iteration:  51%|█████     | 137/268 [00:32<00:23,  5.57it/s][A
Iteration:  51%|█████▏    | 138/268 [00:32<00:22,  5.81it/s][A
Iteration:  52%|█████▏    | 139/268 [00:32<00:21,  6.02it/s][A
Iteration:  52%|█████▏    | 140/268 [00:33<00:21,  6.08it/s][A
Iteration:  53%|█████▎    | 141/268 [00:33<00:20,  6.08it/s][A
Iteration:  53%|█████▎    | 142/268 [00:33<00:20,  6.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:33<00:19,  6.35it/s][A
Iteration:  54%|█████▎    | 144/268 [00:33<00:19,  6.39it/s][A
Iteration:  54%|█████▍    | 145/268 [00:33<00:19,  6.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:33<00:19,  6.36it/s][A
Iteration:  55%|█████▍    | 147/268 [00:34<00:18,  6.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:34<00:18,  6.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:34<00:18,  6.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:34<00:18,  6.52it/s][A
Iteration:  56%|█████▋    | 151/268 [00:34<00:18,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:34<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:35<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:35<00:17,  6.53it/s][A
Iteration:  58%|█████▊    | 155/268 [00:35<00:17,  6.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:35<00:17,  6.52it/s][A
Iteration:  59%|█████▊    | 157/268 [00:35<00:17,  6.50it/s][A
Iteration:  59%|█████▉    | 158/268 [00:35<00:17,  6.31it/s][A
Iteration:  59%|█████▉    | 159/268 [00:35<00:17,  6.35it/s][A
Iteration:  60%|█████▉    | 160/268 [00:36<00:16,  6.39it/s][A
Iteration:  60%|██████    | 161/268 [00:36<00:17,  6.29it/s][A
Iteration:  60%|██████    | 162/268 [00:36<00:16,  6.37it/s][A
Iteration:  61%|██████    | 163/268 [00:36<00:16,  6.35it/s][A
Iteration:  61%|██████    | 164/268 [00:36<00:16,  6.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:36<00:16,  6.44it/s][A
Iteration:  62%|██████▏   | 166/268 [00:37<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:37<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 168/268 [00:37<00:15,  6.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:37<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 170/268 [00:37<00:15,  6.41it/s][A
Iteration:  64%|██████▍   | 171/268 [00:37<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:38<00:15,  6.39it/s][A
Iteration:  65%|██████▍   | 173/268 [00:38<00:14,  6.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:38<00:14,  6.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:38<00:14,  6.26it/s][A
Iteration:  66%|██████▌   | 176/268 [00:38<00:14,  6.34it/s][A
Iteration:  66%|██████▌   | 177/268 [00:38<00:14,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 01:58:54,392 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:58:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:58:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:58:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:58:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 01:58:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:58:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5786416039440073, 'eval_loss': 0.84135336, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1105, 1395, 1354, 1380, 1404, 962, 788, 547, 276, 243, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51451480, 'remaining_params': 33566120, 'pruned_model_sparsity': 0.6051862202649805, 'expected_sparsity': 0.59906, 'target_sparsity': 0.6, 'step': 21350}


Iteration:  66%|██████▋   | 178/268 [00:41<01:11,  1.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:41<00:54,  1.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:41<00:41,  2.11it/s][A
Iteration:  68%|██████▊   | 181/268 [00:41<00:32,  2.66it/s][A
Iteration:  68%|██████▊   | 182/268 [00:41<00:26,  3.26it/s][A
Iteration:  68%|██████▊   | 183/268 [00:41<00:22,  3.83it/s][A
Iteration:  69%|██████▊   | 184/268 [00:42<00:19,  4.36it/s][A
Iteration:  69%|██████▉   | 185/268 [00:42<00:17,  4.85it/s][A
Iteration:  69%|██████▉   | 186/268 [00:42<00:15,  5.21it/s][A
Iteration:  70%|██████▉   | 187/268 [00:42<00:14,  5.47it/s][A
Iteration:  70%|███████   | 188/268 [00:42<00:13,  5.74it/s][A
Iteration:  71%|███████   | 189/268 [00:42<00:13,  5.95it/s][A
Iteration:  71%|███████   | 190/268 [00:42<00:12,  6.12it/s][A
Iteration:  71%|███████▏  | 191/268 [00:43<00:12,  6.16it/s][A
Iteration:  72%|███████▏  | 192/268 [00:43<00:12,  6.23it/s][A
Iteration:  72%|███████▏  | 193/268 [00:43<00:11,  6.27it/s][A
Iteration:  72%|███████▏  | 194/268 [00:43<00:11,  6.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:43<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:43<00:11,  6.54it/s][A
Iteration:  74%|███████▎  | 197/268 [00:44<00:10,  6.55it/s][A
Iteration:  74%|███████▍  | 198/268 [00:44<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:44<00:10,  6.58it/s][A
Iteration:  75%|███████▍  | 200/268 [00:44<00:10,  6.65it/s][A
Iteration:  75%|███████▌  | 201/268 [00:44<00:09,  6.73it/s][A
Iteration:  75%|███████▌  | 202/268 [00:44<00:09,  6.68it/s][A
Iteration:  76%|███████▌  | 203/268 [00:44<00:09,  6.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:45<00:09,  6.68it/s][A
Iteration:  76%|███████▋  | 205/268 [00:45<00:09,  6.63it/s][A
Iteration:  77%|███████▋  | 206/268 [00:45<00:09,  6.58it/s][A
Iteration:  77%|███████▋  | 207/268 [00:45<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 208/268 [00:45<00:09,  6.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:45<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 210/268 [00:46<00:09,  6.42it/s][A
Iteration:  79%|███████▊  | 211/268 [00:46<00:08,  6.36it/s][A
Iteration:  79%|███████▉  | 212/268 [00:46<00:08,  6.37it/s][A
Iteration:  79%|███████▉  | 213/268 [00:46<00:08,  6.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:46<00:08,  6.39it/s][A
Iteration:  80%|████████  | 215/268 [00:46<00:08,  6.41it/s][A
Iteration:  81%|████████  | 216/268 [00:46<00:08,  6.48it/s][A
Iteration:  81%|████████  | 217/268 [00:47<00:07,  6.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:47<00:07,  6.62it/s][A
Iteration:  82%|████████▏ | 219/268 [00:47<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 220/268 [00:47<00:07,  6.57it/s][A
Iteration:  82%|████████▏ | 221/268 [00:47<00:07,  6.57it/s][A
Iteration:  83%|████████▎ | 222/268 [00:47<00:06,  6.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:48<00:06,  6.56it/s][A
Iteration:  84%|████████▎ | 224/268 [00:48<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:48<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 226/268 [00:48<00:06,  6.50it/s][A
Iteration:  85%|████████▍ | 227/268 [00:48<00:06,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 01:59:04,219 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:59:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:59:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:59:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:59:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 01:59:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:59:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5691684038863919, 'eval_loss': 0.8477374, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1101, 1393, 1352, 1378, 1402, 960, 785, 542, 270, 236, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.60034, 'target_sparsity': 0.6, 'step': 21400}


Iteration:  85%|████████▌ | 228/268 [00:50<00:31,  1.26it/s][A04/29/2024 01:59:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 21400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:51<00:23,  1.66it/s][A
Iteration:  86%|████████▌ | 230/268 [00:51<00:17,  2.15it/s][A
Iteration:  86%|████████▌ | 231/268 [00:51<00:13,  2.69it/s][A
Iteration:  87%|████████▋ | 232/268 [00:51<00:11,  3.24it/s][A
Iteration:  87%|████████▋ | 233/268 [00:51<00:09,  3.83it/s][A
Iteration:  87%|████████▋ | 234/268 [00:51<00:07,  4.31it/s][A
Iteration:  88%|████████▊ | 235/268 [00:52<00:06,  4.79it/s][A
Iteration:  88%|████████▊ | 236/268 [00:52<00:06,  5.16it/s][A
Iteration:  88%|████████▊ | 237/268 [00:52<00:05,  5.46it/s][A
Iteration:  89%|████████▉ | 238/268 [00:52<00:05,  5.75it/s][A
Iteration:  89%|████████▉ | 239/268 [00:52<00:04,  5.95it/s][A
Iteration:  90%|████████▉ | 240/268 [00:52<00:04,  6.10it/s][A
Iteration:  90%|████████▉ | 241/268 [00:52<00:04,  6.08it/s][A
Iteration:  90%|█████████ | 242/268 [00:53<00:04,  6.05it/s][A
Iteration:  91%|█████████ | 243/268 [00:53<00:04,  6.01it/s][A
Iteration:  91%|█████████ | 244/268 [00:53<00:03,  6.28it/s][A
Iteration:  91%|█████████▏| 245/268 [00:53<00:03,  6.36it/s][A
Iteration:  92%|█████████▏| 246/268 [00:53<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:53<00:03,  6.36it/s][A
Iteration:  93%|█████████▎| 248/268 [00:54<00:03,  6.33it/s][A
Iteration:  93%|█████████▎| 249/268 [00:54<00:02,  6.41it/s][A
Iteration:  93%|█████████▎| 250/268 [00:54<00:02,  6.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:54<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 252/268 [00:54<00:02,  6.51it/s][A
Iteration:  94%|█████████▍| 253/268 [00:54<00:02,  6.45it/s][A
Iteration:  95%|█████████▍| 254/268 [00:54<00:02,  6.34it/s][A
Iteration:  95%|█████████▌| 255/268 [00:55<00:01,  6.52it/s][A
Iteration:  96%|█████████▌| 256/268 [00:55<00:01,  6.55it/s][A
Iteration:  96%|█████████▌| 257/268 [00:55<00:01,  6.44it/s][A
Iteration:  96%|█████████▋| 258/268 [00:55<00:01,  6.61it/s][A
Iteration:  97%|█████████▋| 259/268 [00:55<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:55<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 261/268 [00:56<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:56<00:00,  6.45it/s][A
Iteration:  98%|█████████▊| 263/268 [00:56<00:00,  6.39it/s][A
Iteration:  99%|█████████▊| 264/268 [00:56<00:00,  6.36it/s][A
Iteration:  99%|█████████▉| 265/268 [00:56<00:00,  6.41it/s][A
Iteration:  99%|█████████▉| 266/268 [00:56<00:00,  6.44it/s][A
Iteration: 100%|█████████▉| 267/268 [00:56<00:00,  6.38it/s][A
Iteration: 100%|██████████| 268/268 [00:57<00:00,  6.78it/s][A04/29/2024 01:59:12 - INFO - trainer.trainer_mod_2 - Epoch 79 finished. Took 57.12 seconds.
Iteration: 100%|██████████| 268/268 [00:57<00:00,  4.69it/s]
Epoch:  80%|████████  | 80/100 [1:10:46<18:04, 54.22s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.40it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.36it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.40it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.32it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.37it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 01:59:14,127 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:59:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:59:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:59:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:59:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:59:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:59:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.562461217631608, 'eval_loss': 0.839593, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1100, 1391, 1350, 1377, 1401, 959, 784, 541, 269, 235, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51520420, 'remaining_params': 33497180, 'pruned_model_sparsity': 0.6059971111863897, 'expected_sparsity': 0.60052, 'target_sparsity': 0.6, 'step': 21450}


Iteration:   4%|▎         | 10/268 [00:03<03:31,  1.22it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:38,  1.62it/s][A
Iteration:   4%|▍         | 12/268 [00:04<02:01,  2.11it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:35,  2.66it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:18,  3.24it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:05,  3.85it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:57,  4.39it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:51,  4.87it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:47,  5.29it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:44,  5.60it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:43,  5.71it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:42,  5.87it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.99it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.23it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.30it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.39it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.26it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.25it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.27it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.25it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.32it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.30it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.31it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.32it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.48it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:34,  6.63it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.54it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:34,  6.55it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.37it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.47it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.47it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.48it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.41it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.48it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.61it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.45it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.48it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.48it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.38it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 01:59:24,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:59:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:59:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:59:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:59:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:59:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:59:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5734018405355006, 'eval_loss': 0.8236043, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1104, 1395, 1354, 1380, 1404, 962, 789, 548, 276, 244, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51446884, 'remaining_params': 33570716, 'pruned_model_sparsity': 0.6051321608702198, 'expected_sparsity': 0.59882, 'target_sparsity': 0.6, 'step': 21500}


Iteration:  22%|██▏       | 60/268 [00:13<02:46,  1.25it/s][A04/29/2024 01:59:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 21500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:13<02:05,  1.65it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:37,  2.12it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<01:17,  2.66it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:03,  3.22it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:52,  3.84it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:46,  4.38it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:41,  4.85it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:37,  5.26it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:35,  5.58it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:34,  5.81it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:33,  5.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:32,  6.06it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:31,  6.11it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:31,  6.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:30,  6.30it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.39it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.36it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.47it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.46it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.50it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.55it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.55it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.46it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.56it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.53it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.62it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.29it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.37it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.35it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.50it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.52it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.42it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.43it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.45it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.34it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.40it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.47it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.59it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.27it/s][A[INFO|trainer.py:570] 2024-04-29 01:59:33,918 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:59:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:59:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:59:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:59:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:59:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:59:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5644979995646169, 'eval_loss': 0.8433721, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1101, 1392, 1350, 1377, 1401, 959, 786, 542, 269, 235, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51511228, 'remaining_params': 33506372, 'pruned_model_sparsity': 0.6058889923968684, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 21550}


Iteration:  41%|████      | 110/268 [00:23<02:06,  1.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<01:35,  1.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<01:13,  2.12it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:58,  2.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:48,  3.20it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:40,  3.77it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:35,  4.33it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:31,  4.81it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:28,  5.27it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:26,  5.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:25,  5.86it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:24,  5.98it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:24,  5.98it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:24,  6.03it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:23,  6.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:22,  6.26it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.32it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.36it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.41it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.42it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.44it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.44it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.58it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.53it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.54it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.47it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.40it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.47it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.34it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.44it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.49it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 01:59:43,830 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:59:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:59:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:59:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:59:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 01:59:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:59:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5670814703238499, 'eval_loss': 0.8519631, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [961, 1100, 1391, 1348, 1375, 1399, 958, 784, 540, 268, 235, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51535740, 'remaining_params': 33481860, 'pruned_model_sparsity': 0.606177309168925, 'expected_sparsity': 0.60068, 'target_sparsity': 0.6, 'step': 21600}


Iteration:  60%|█████▉    | 160/268 [00:33<01:26,  1.25it/s][A04/29/2024 01:59:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 21600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:33<01:05,  1.64it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:49,  2.12it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:39,  2.66it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:32,  3.21it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:27,  3.74it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:23,  4.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:21,  4.75it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:19,  5.16it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:17,  5.58it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:16,  5.81it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:16,  6.02it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.20it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.27it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.44it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.27it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:14,  6.22it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.29it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.36it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.42it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.54it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.55it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.54it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.45it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.33it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.56it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.54it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.55it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.42it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.38it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.26it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.31it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.33it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:08,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 01:59:53,729 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 01:59:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 01:59:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 01:59:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 01:59:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 01:59:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 01:59:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5630684232854489, 'eval_loss': 0.85449666, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1395, 1352, 1379, 1403, 961, 789, 550, 279, 247, 365], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51250788, 'remaining_params': 33766812, 'pruned_model_sparsity': 0.6028256266937669, 'expected_sparsity': 0.59845, 'target_sparsity': 0.6, 'step': 21650}


Iteration:  78%|███████▊  | 210/268 [00:43<00:46,  1.26it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:34,  1.66it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:26,  2.14it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:20,  2.70it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:16,  3.27it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:13,  3.81it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:11,  4.39it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:10,  4.83it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:09,  5.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  5.50it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:08,  5.64it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  5.95it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.10it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.23it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  5.92it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  6.07it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.33it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.41it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.38it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.35it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.28it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.40it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.34it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.51it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.37it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.28it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.49it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.53it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.53it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.51it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.43it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.29it/s][A[INFO|trainer.py:570] 2024-04-29 02:00:03,663 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:00:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:00:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:00:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:00:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:00:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:00:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5837588651574037, 'eval_loss': 0.84719557, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [961, 1099, 1390, 1347, 1375, 1399, 957, 784, 540, 268, 234, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51541868, 'remaining_params': 33475732, 'pruned_model_sparsity': 0.6062493883619392, 'expected_sparsity': 0.60078, 'target_sparsity': 0.6, 'step': 21700}
04/29/2024 02:00:05 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 80 | Step: 21700 | Model size: 33475732 | Score: 0.58376]

[INFO|configuration_utils.py:439] 2024-04-29 02:00:05,819 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 02:00:08,782 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  97%|█████████▋| 260/268 [00:56<00:13,  1.69s/it][A04/29/2024 02:00:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 21700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:56<00:08,  1.25s/it][A
Iteration:  98%|█████████▊| 262/268 [00:56<00:05,  1.09it/s][A
Iteration:  98%|█████████▊| 263/268 [00:56<00:03,  1.45it/s][A
Iteration:  99%|█████████▊| 264/268 [00:56<00:02,  1.88it/s][A
Iteration:  99%|█████████▉| 265/268 [00:57<00:01,  2.41it/s][A
Iteration:  99%|█████████▉| 266/268 [00:57<00:00,  2.99it/s][A
Iteration: 100%|█████████▉| 267/268 [00:57<00:00,  3.55it/s][A
Iteration: 100%|██████████| 268/268 [00:57<00:00,  4.26it/s][A04/29/2024 02:00:10 - INFO - trainer.trainer_mod_2 - Epoch 80 finished. Took 57.48 seconds.
Iteration: 100%|██████████| 268/268 [00:57<00:00,  4.66it/s]
Epoch:  81%|████████  | 81/100 [1:11:44<17:28, 55.20s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.57it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.74it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.44it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.49it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.55it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.45it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.47it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.43it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.53it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.57it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.58it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.50it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.55it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.48it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.30it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.40it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.44it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.35it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.43it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.45it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.42it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.35it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.34it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:37,  6.12it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:37,  6.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.26it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 02:00:16,568 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:00:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:00:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:00:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:00:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 02:00:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:00:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5717443823655565, 'eval_loss': 0.8384552, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [961, 1099, 1390, 1347, 1375, 1399, 957, 784, 541, 268, 236, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51537272, 'remaining_params': 33480328, 'pruned_model_sparsity': 0.6061953289671785, 'expected_sparsity': 0.60053, 'target_sparsity': 0.6, 'step': 21750}


Iteration:  16%|█▌        | 42/268 [00:08<02:59,  1.26it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<02:15,  1.66it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:44,  2.14it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<01:22,  2.70it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:08,  3.23it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:58,  3.81it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:49,  4.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:44,  4.90it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:41,  5.29it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:39,  5.56it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:37,  5.82it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:35,  6.01it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.17it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:34,  6.21it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.29it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.36it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.35it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.34it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.39it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.42it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.30it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.32it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.32it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.51it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.54it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.60it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.68it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:30,  6.26it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.44it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.46it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.59it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.68it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.56it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.55it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.40it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.47it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 02:00:26,415 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:00:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:00:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:00:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:00:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 02:00:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:00:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5642446874338215, 'eval_loss': 0.85980606, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1395, 1351, 1379, 1402, 961, 789, 550, 277, 248, 366], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51252320, 'remaining_params': 33765280, 'pruned_model_sparsity': 0.6028436464920205, 'expected_sparsity': 0.59842, 'target_sparsity': 0.6, 'step': 21800}


Iteration:  34%|███▍      | 92/268 [00:18<02:20,  1.25it/s][A04/29/2024 02:00:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 21800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:18<01:45,  1.66it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<01:21,  2.14it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<01:04,  2.69it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:52,  3.25it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:44,  3.83it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:39,  4.34it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:35,  4.82it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:32,  5.24it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:29,  5.58it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:28,  5.85it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:28,  5.82it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:27,  5.97it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.15it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:27,  5.86it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:26,  6.04it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.21it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.33it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.43it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.45it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.48it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.53it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.56it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.67it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.62it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.59it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.62it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:21,  6.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.51it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:22,  6.30it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.26it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:22,  6.26it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.34it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.48it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.52it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.54it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.54it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.49it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.49it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 02:00:36,295 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:00:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:00:36 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:00:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:00:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 02:00:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:00:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5682413241334403, 'eval_loss': 0.83979326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [959, 1097, 1388, 1344, 1373, 1397, 954, 782, 538, 266, 234, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51572508, 'remaining_params': 33445092, 'pruned_model_sparsity': 0.60660978432701, 'expected_sparsity': 0.60115, 'target_sparsity': 0.6, 'step': 21850}


Iteration:  53%|█████▎    | 142/268 [00:28<01:40,  1.25it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<01:15,  1.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:58,  2.12it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:45,  2.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:37,  3.27it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:31,  3.81it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:27,  4.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:24,  4.91it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:22,  5.32it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:21,  5.54it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:19,  5.82it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:19,  6.02it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.20it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.33it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.38it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.43it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.31it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:16,  6.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.48it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.50it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.54it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.43it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:16,  6.40it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.47it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.28it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.34it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.59it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.54it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.42it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.42it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.40it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.42it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.46it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:11,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 02:00:46,166 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:00:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:00:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:00:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:00:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:00:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:00:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5650486518446893, 'eval_loss': 0.8473207, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1100, 1391, 1346, 1375, 1399, 956, 784, 544, 272, 242, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51520420, 'remaining_params': 33497180, 'pruned_model_sparsity': 0.6059971111863897, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 21900}


Iteration:  72%|███████▏  | 192/268 [00:38<01:00,  1.25it/s][A04/29/2024 02:00:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 21900, Alignment: tensor([ 0,  6,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:38<00:45,  1.66it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:34,  2.14it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:27,  2.66it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:22,  3.23it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:18,  3.80it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:16,  4.32it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:14,  4.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:13,  5.09it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:12,  5.43it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:11,  5.82it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.04it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.16it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  6.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.26it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.33it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.42it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.42it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.33it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.26it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.28it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.35it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.33it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.29it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.46it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.35it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.45it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.46it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.48it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.52it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.49it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.53it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 02:00:56,091 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:00:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:00:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:00:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:00:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 02:00:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:00:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5703980726573153, 'eval_loss': 0.8489146, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1103, 1393, 1349, 1377, 1401, 957, 786, 547, 272, 244, 362], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.59923, 'target_sparsity': 0.6, 'step': 21950}


Iteration:  90%|█████████ | 242/268 [00:48<00:20,  1.26it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:15,  1.66it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:11,  2.14it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:08,  2.68it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:06,  3.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:05,  3.79it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:04,  4.33it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  4.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.19it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  5.60it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  5.85it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  5.98it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.12it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.16it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.41it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.57it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.41it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.36it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.77it/s][A04/29/2024 02:01:02 - INFO - trainer.trainer_mod_2 - Epoch 81 finished. Took 52.19 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  82%|████████▏ | 82/100 [1:12:36<16:17, 54.29s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.10it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.37it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.43it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:42,  6.19it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.27it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.49it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.37it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.35it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.29it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.34it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.41it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.45it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:37,  6.49it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 02:01:05,960 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:01:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:01:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:01:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:01:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:01:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:01:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5683668297227801, 'eval_loss': 0.8486548, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [958, 1096, 1387, 1343, 1371, 1395, 951, 779, 538, 264, 234, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51593956, 'remaining_params': 33423644, 'pruned_model_sparsity': 0.6068620615025595, 'expected_sparsity': 0.60142, 'target_sparsity': 0.6, 'step': 22000}


Iteration:   9%|▉         | 24/268 [00:05<03:14,  1.25it/s][A04/29/2024 02:01:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 22000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:06<02:26,  1.66it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:53,  2.14it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:29,  2.68it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:14,  3.21it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:04,  3.72it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:55,  4.27it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:50,  4.73it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:45,  5.22it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:41,  5.61it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:39,  5.89it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:38,  6.01it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.16it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.16it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.27it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.35it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.30it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.24it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.22it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.29it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.50it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.57it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.59it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.40it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.46it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.43it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.48it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.49it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.39it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.36it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.37it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.42it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.50it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.49it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 02:01:15,874 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:01:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:01:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:01:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:01:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 02:01:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:01:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5722385869866928, 'eval_loss': 0.84252566, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1102, 1392, 1347, 1376, 1399, 955, 785, 548, 276, 249, 368], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51293684, 'remaining_params': 33723916, 'pruned_model_sparsity': 0.603330181044866, 'expected_sparsity': 0.59892, 'target_sparsity': 0.6, 'step': 22050}


Iteration:  28%|██▊       | 74/268 [00:15<02:35,  1.25it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:57,  1.65it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<01:31,  2.11it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<01:12,  2.64it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:59,  3.22it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:49,  3.82it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:43,  4.34it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:38,  4.83it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:35,  5.24it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:33,  5.56it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:31,  5.80it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:30,  6.01it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:29,  6.16it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:29,  6.18it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.27it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.36it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.64it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.59it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.57it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.52it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.47it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.48it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.55it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.48it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.40it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:25,  6.27it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.39it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.42it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.58it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.45it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.43it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.38it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.41it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.53it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.53it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 02:01:25,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:01:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:01:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:01:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:01:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:01:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:01:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5665890872682902, 'eval_loss': 0.83375835, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1101, 1391, 1346, 1375, 1399, 954, 783, 544, 267, 235, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51529612, 'remaining_params': 33487988, 'pruned_model_sparsity': 0.6061052299759109, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 22100}


Iteration:  46%|████▋     | 124/268 [00:25<01:54,  1.25it/s][A04/29/2024 02:01:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 22100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:25<01:26,  1.66it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<01:06,  2.13it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:52,  2.67it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:43,  3.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:37,  3.76it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:32,  4.30it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:28,  4.84it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:25,  5.24it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:24,  5.48it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:23,  5.78it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:23,  5.63it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:22,  5.82it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:22,  5.94it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:21,  6.09it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:21,  6.11it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.32it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.25it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.23it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.28it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.43it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.49it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.24it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.48it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.51it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.58it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.66it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.60it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.49it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.51it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.59it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.57it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 02:01:35,649 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:01:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:01:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:01:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:01:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:01:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:01:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.562461217631608, 'eval_loss': 0.83859813, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [959, 1097, 1387, 1342, 1371, 1395, 949, 778, 538, 263, 233, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51597020, 'remaining_params': 33420580, 'pruned_model_sparsity': 0.6068981010990665, 'expected_sparsity': 0.60147, 'target_sparsity': 0.6, 'step': 22150}


Iteration:  65%|██████▍   | 174/268 [00:35<01:15,  1.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:56,  1.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:43,  2.11it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:34,  2.64it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:28,  3.21it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:23,  3.78it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:20,  4.33it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:18,  4.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:16,  5.30it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:14,  5.67it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:14,  5.76it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  5.97it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.16it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.26it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.19it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.27it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.40it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.60it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.46it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.51it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.38it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.47it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.60it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.35it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.33it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.37it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.41it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.44it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.42it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.39it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.38it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.46it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.47it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 02:01:45,562 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:01:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:01:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:01:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:01:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:01:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:01:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5635758105599825, 'eval_loss': 0.8427567, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1393, 1348, 1377, 1400, 955, 785, 552, 279, 254, 374], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51266108, 'remaining_params': 33751492, 'pruned_model_sparsity': 0.6030058246763024, 'expected_sparsity': 0.59816, 'target_sparsity': 0.6, 'step': 22200}


Iteration:  84%|████████▎ | 224/268 [00:45<00:35,  1.25it/s][A04/29/2024 02:01:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 22200, Alignment: tensor([ 0,  6,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:45<00:26,  1.65it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:19,  2.12it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:15,  2.67it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:12,  3.23it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:10,  3.83it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:08,  4.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:07,  4.83it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.23it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:06,  5.51it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:06,  5.65it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  5.88it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.08it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.23it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.23it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.25it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.32it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.38it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.38it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.46it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.48it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.46it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.49it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.63it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.60it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.49it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.51it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.62it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.52it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.44it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.33it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.32it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.48it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.83it/s][A04/29/2024 02:01:54 - INFO - trainer.trainer_mod_2 - Epoch 82 finished. Took 52.27 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  83%|████████▎ | 83/100 [1:13:28<15:12, 53.69s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.67it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.56it/s][A
Iteration:   1%|          | 3/268 [00:00<00:42,  6.23it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.34it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 02:01:55,436 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:01:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:01:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:01:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:01:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:01:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:01:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5799504696103684, 'eval_loss': 0.81700325, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1101, 1390, 1345, 1374, 1397, 952, 782, 542, 264, 233, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51549528, 'remaining_params': 33468072, 'pruned_model_sparsity': 0.6063394873532069, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 22250}


Iteration:   2%|▏         | 6/268 [00:03<03:52,  1.13it/s][A
Iteration:   3%|▎         | 7/268 [00:03<02:49,  1.54it/s][A
Iteration:   3%|▎         | 8/268 [00:03<02:07,  2.03it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:39,  2.59it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:21,  3.18it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:08,  3.75it/s][A
Iteration:   4%|▍         | 12/268 [00:04<01:00,  4.22it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:54,  4.69it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:49,  5.13it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:46,  5.50it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.87it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:42,  5.96it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.14it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:40,  6.16it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:39,  6.28it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.28it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.34it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.27it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.42it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:37,  6.48it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.48it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.35it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.42it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.45it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.30it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.28it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.34it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.22it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.22it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.30it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.32it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.43it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.52it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.54it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.46it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.49it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:35,  6.09it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:35,  6.14it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.27it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.27it/s][A[INFO|trainer.py:570] 2024-04-29 02:02:05,417 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:02:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:02:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:02:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:02:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 02:02:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:02:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.56217893832047, 'eval_loss': 0.82769084, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [960, 1098, 1387, 1342, 1372, 1395, 949, 779, 539, 263, 232, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51589360, 'remaining_params': 33428240, 'pruned_model_sparsity': 0.6068080021077988, 'expected_sparsity': 0.60133, 'target_sparsity': 0.6, 'step': 22300}


Iteration:  21%|██        | 56/268 [00:13<02:50,  1.25it/s][A04/29/2024 02:02:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 22300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:13<02:08,  1.65it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:39,  2.12it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<01:19,  2.63it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:04,  3.21it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:54,  3.77it/s][A
Iteration:  23%|██▎       | 62/268 [00:14<00:47,  4.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:42,  4.83it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:38,  5.24it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:36,  5.58it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:34,  5.82it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:34,  5.87it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:32,  6.07it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:32,  6.18it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.30it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:29,  6.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 75/268 [00:16<00:30,  6.35it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.37it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.30it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.39it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.40it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.37it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.33it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.38it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.43it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.45it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.45it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:27,  6.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.41it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.35it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.57it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.54it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:25,  6.63it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.62it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.60it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:25,  6.64it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.58it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.59it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 02:02:15,290 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:02:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:02:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:02:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:02:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:02:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:02:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5711485966856213, 'eval_loss': 0.82632154, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1105, 1393, 1348, 1377, 1400, 955, 785, 552, 277, 251, 371], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51267640, 'remaining_params': 33749960, 'pruned_model_sparsity': 0.6030238444745558, 'expected_sparsity': 0.59823, 'target_sparsity': 0.6, 'step': 22350}


Iteration:  40%|███▉      | 106/268 [00:22<02:09,  1.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:23<01:37,  1.65it/s][A
Iteration:  40%|████      | 108/268 [00:23<01:15,  2.12it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:59,  2.66it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:48,  3.25it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:41,  3.82it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:36,  4.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:24<00:32,  4.81it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:29,  5.17it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:28,  5.46it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:26,  5.74it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:25,  5.95it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:24,  6.12it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.23it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:23,  6.25it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.24it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.34it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.39it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.45it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.49it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.49it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.54it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.46it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.31it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.35it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.25it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.32it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.37it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.41it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.45it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.48it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.48it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.31it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.29it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.29it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 02:02:25,228 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:02:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:02:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:02:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:02:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:02:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:02:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5799504696103684, 'eval_loss': 0.8180348, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1101, 1390, 1345, 1374, 1397, 952, 780, 543, 264, 234, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51549528, 'remaining_params': 33468072, 'pruned_model_sparsity': 0.6063394873532069, 'expected_sparsity': 0.60074, 'target_sparsity': 0.6, 'step': 22400}


Iteration:  58%|█████▊    | 156/268 [00:32<01:29,  1.25it/s][A04/29/2024 02:02:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 22400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:33<01:07,  1.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:51,  2.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:41,  2.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:33,  3.21it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:28,  3.77it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:24,  4.30it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:21,  4.79it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:20,  5.20it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:18,  5.60it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:17,  5.79it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:16,  5.99it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:16,  6.15it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.28it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:15,  6.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.40it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:14,  6.45it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:15,  6.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:14,  6.43it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.54it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.55it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.41it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:12,  6.56it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.35it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.43it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.50it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.53it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:11,  6.55it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.58it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.65it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.54it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.40it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.42it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.41it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.39it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 02:02:35,133 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:02:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:02:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:02:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:02:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:02:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:02:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5647660677080502, 'eval_loss': 0.84305656, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [962, 1100, 1389, 1343, 1373, 1396, 949, 778, 541, 263, 233, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51572508, 'remaining_params': 33445092, 'pruned_model_sparsity': 0.60660978432701, 'expected_sparsity': 0.60107, 'target_sparsity': 0.6, 'step': 22450}


Iteration:  77%|███████▋  | 206/268 [00:42<00:49,  1.24it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:37,  1.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:43<00:28,  2.12it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:22,  2.66it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:17,  3.24it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:14,  3.81it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:12,  4.36it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:11,  4.84it/s][A
Iteration:  80%|███████▉  | 214/268 [00:44<00:10,  5.18it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:09,  5.46it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  5.80it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.02it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  6.17it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.27it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:07,  6.43it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.56it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:06,  6.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.52it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.37it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.35it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.36it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.40it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.37it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.37it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.18it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.57it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.46it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.61it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.22it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.29it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.32it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.58it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.33it/s][A[INFO|trainer.py:570] 2024-04-29 02:02:45,033 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:02:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:02:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:02:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:02:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:02:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:02:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5740921203389623, 'eval_loss': 0.83446926, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1105, 1394, 1349, 1378, 1401, 955, 785, 553, 276, 251, 371], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51258448, 'remaining_params': 33759152, 'pruned_model_sparsity': 0.6029157256850346, 'expected_sparsity': 0.59827, 'target_sparsity': 0.6, 'step': 22500}


Iteration:  96%|█████████▌| 256/268 [00:52<00:09,  1.25it/s][A04/29/2024 02:02:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 22500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:52<00:06,  1.65it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:04,  2.14it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:03,  2.70it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:02,  3.27it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  3.84it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  4.37it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  4.85it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.27it/s][A
Iteration:  99%|█████████▉| 265/268 [00:54<00:00,  5.58it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  5.84it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.05it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.47it/s][A04/29/2024 02:02:48 - INFO - trainer.trainer_mod_2 - Epoch 83 finished. Took 54.48 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  84%|████████▍ | 84/100 [1:14:23<14:22, 53.93s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.63it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.48it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.47it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.50it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.49it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.40it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.35it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.39it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.26it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.27it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.27it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.34it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.31it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.41it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:39,  6.35it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.40it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.42it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.34it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.38it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.42it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.39it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.41it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.44it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.26it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.32it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.29it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:36,  6.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:36,  6.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:36,  6.42it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 02:02:54,914 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:02:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:02:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:02:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:02:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 02:02:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:02:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5768865343306099, 'eval_loss': 0.8276054, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1101, 1390, 1345, 1374, 1398, 951, 780, 543, 263, 233, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51549528, 'remaining_params': 33468072, 'pruned_model_sparsity': 0.6063394873532069, 'expected_sparsity': 0.6008, 'target_sparsity': 0.6, 'step': 22550}


Iteration:  14%|█▍        | 38/268 [00:08<03:03,  1.25it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<02:19,  1.64it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:48,  2.11it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<01:26,  2.64it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:09,  3.23it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:58,  3.82it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:51,  4.37it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:45,  4.86it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:43,  5.16it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:39,  5.53it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:38,  5.77it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:37,  5.92it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:35,  6.12it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.24it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.46it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.55it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.55it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.56it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.40it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.46it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.46it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.58it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.51it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.41it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.63it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:29,  6.60it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.61it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.45it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.50it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.50it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.52it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.36it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.28it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.29it/s][A[INFO|trainer.py:570] 2024-04-29 02:03:04,794 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:03:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:03:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:03:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:03:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:03:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:03:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.56217893832047, 'eval_loss': 0.83277017, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [963, 1101, 1390, 1345, 1374, 1398, 951, 780, 543, 264, 234, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51549528, 'remaining_params': 33468072, 'pruned_model_sparsity': 0.6063394873532069, 'expected_sparsity': 0.60076, 'target_sparsity': 0.6, 'step': 22600}


Iteration:  33%|███▎      | 88/268 [00:17<02:24,  1.25it/s][A04/29/2024 02:03:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 22600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:18<01:48,  1.65it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<01:23,  2.13it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:06,  2.68it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:54,  3.25it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:45,  3.87it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:40,  4.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:36,  4.78it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:33,  5.08it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:31,  5.39it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:30,  5.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:28,  5.89it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:28,  5.96it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:27,  6.12it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.17it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.27it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.49it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.36it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.43it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.55it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.65it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.58it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.44it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.60it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:22,  6.71it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.70it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.75it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.65it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.61it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.30it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.38it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.30it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.38it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.40it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.45it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.42it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.48it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.47it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.48it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 02:03:14,676 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:03:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:03:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:03:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:03:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:03:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:03:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5668277832443891, 'eval_loss': 0.83760965, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1106, 1395, 1349, 1378, 1403, 955, 786, 553, 274, 247, 367], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51256916, 'remaining_params': 33760684, 'pruned_model_sparsity': 0.602897705886781, 'expected_sparsity': 0.59851, 'target_sparsity': 0.6, 'step': 22650}


Iteration:  51%|█████▏    | 138/268 [00:27<01:44,  1.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<01:18,  1.64it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<01:00,  2.12it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:47,  2.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:38,  3.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:32,  3.87it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:27,  4.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:24,  4.95it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:22,  5.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:21,  5.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:21,  5.53it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:20,  5.87it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:19,  6.16it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.24it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.31it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.10it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.23it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.31it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.38it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.41it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.44it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.49it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.52it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.33it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.41it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.45it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.56it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.54it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.54it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.55it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.57it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.66it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.59it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.58it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.53it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.52it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:13,  6.37it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 02:03:24,534 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:03:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:03:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:03:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:03:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:03:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:03:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5647660677080502, 'eval_loss': 0.827271, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1102, 1391, 1345, 1375, 1400, 951, 781, 544, 263, 233, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51538804, 'remaining_params': 33478796, 'pruned_model_sparsity': 0.6062133487654321, 'expected_sparsity': 0.60074, 'target_sparsity': 0.6, 'step': 22700}


Iteration:  70%|███████   | 188/268 [00:37<01:03,  1.25it/s][A04/29/2024 02:03:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 22700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:37<00:47,  1.65it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:36,  2.14it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:29,  2.65it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:23,  3.21it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:19,  3.77it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:16,  4.36it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:15,  4.77it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:13,  5.19it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:13,  5.44it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:12,  5.74it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  5.81it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:11,  6.09it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.38it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.35it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.32it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.41it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.45it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.57it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.45it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.49it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.52it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.41it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.42it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.55it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.47it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.52it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.44it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.49it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.42it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.53it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.34it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 02:03:34,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:03:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:03:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:03:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:03:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:03:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:03:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.562461217631608, 'eval_loss': 0.8276556, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1102, 1392, 1345, 1376, 1401, 952, 782, 545, 263, 234, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51526548, 'remaining_params': 33491052, 'pruned_model_sparsity': 0.6060691903794038, 'expected_sparsity': 0.60037, 'target_sparsity': 0.6, 'step': 22750}


Iteration:  89%|████████▉ | 238/268 [00:47<00:24,  1.25it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:17,  1.65it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:13,  2.13it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:10,  2.67it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:08,  3.25it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:06,  3.83it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:05,  4.38it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  4.86it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:04,  5.25it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  5.59it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.86it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.06it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.13it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.36it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.42it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.57it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.57it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.55it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.40it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.38it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.41it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.43it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.43it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.45it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.22it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.29it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.72it/s][A04/29/2024 02:03:41 - INFO - trainer.trainer_mod_2 - Epoch 84 finished. Took 52.21 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  85%|████████▌ | 85/100 [1:15:15<13:21, 53.41s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.45it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.60it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.74it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.64it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.58it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.60it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.70it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.63it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.58it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.55it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.52it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.56it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.52it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:40,  6.31it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.36it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:40,  6.24it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.46it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 02:03:44,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:03:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:03:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:03:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:03:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:03:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:03:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5713110471171509, 'eval_loss': 0.8364795, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1106, 1395, 1348, 1379, 1404, 955, 786, 551, 268, 240, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.59899, 'target_sparsity': 0.6, 'step': 22800}


Iteration:   7%|▋         | 20/268 [00:05<03:17,  1.26it/s][A04/29/2024 02:03:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 22800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:05<02:29,  1.65it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:56,  2.12it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:32,  2.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:15,  3.24it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:04,  3.79it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:55,  4.35it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:50,  4.80it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:46,  5.20it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:43,  5.50it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:40,  5.81it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:39,  5.94it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:39,  6.03it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.31it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.31it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.31it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.26it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.18it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.28it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.23it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.25it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.26it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.33it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.50it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.62it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.50it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.45it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.55it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:32,  6.65it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.66it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.66it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.65it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.61it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.63it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.58it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:31,  6.61it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.59it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.50it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.34it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.28it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.27it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 02:03:54,147 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:03:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:03:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:03:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:03:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 02:03:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:03:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5834463254140851, 'eval_loss': 0.84513247, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1102, 1393, 1346, 1377, 1401, 952, 782, 544, 261, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51525016, 'remaining_params': 33492584, 'pruned_model_sparsity': 0.6060511705811502, 'expected_sparsity': 0.60055, 'target_sparsity': 0.6, 'step': 22850}


Iteration:  26%|██▌       | 70/268 [00:15<02:37,  1.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<01:59,  1.65it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:32,  2.13it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<01:12,  2.67it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:00,  3.23it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:50,  3.80it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:44,  4.32it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:39,  4.81it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:36,  5.22it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:34,  5.42it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:32,  5.73it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:31,  5.86it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:30,  6.04it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.20it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:29,  6.22it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.25it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.42it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.21it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.32it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.53it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.56it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.46it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.48it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.36it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.34it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.05it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.29it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.30it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.40it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.53it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.42it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.34it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.43it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.40it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.46it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.40it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 02:04:04,077 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:04:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:04:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:04:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:04:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.86it/s]04/29/2024 02:04:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:04:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5888632696966735, 'eval_loss': 0.83212245, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1103, 1393, 1346, 1377, 1401, 952, 782, 546, 263, 234, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51517356, 'remaining_params': 33500244, 'pruned_model_sparsity': 0.6059610715898825, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 22900}
04/29/2024 02:04:06 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 85 | Step: 22900 | Model size: 33500244 | Score: 0.58886]

[INFO|configuration_utils.py:439] 2024-04-29 02:04:06,226 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 02:04:07,926 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/best/pytorch_model.bin

Iteration:  45%|████▍     | 120/268 [00:26<03:13,  1.31s/it][A04/29/2024 02:04:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 22900, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:26<02:23,  1.03it/s][A
Iteration:  46%|████▌     | 122/268 [00:27<01:46,  1.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:27<01:21,  1.79it/s][A
Iteration:  46%|████▋     | 124/268 [00:27<01:02,  2.29it/s][A
Iteration:  47%|████▋     | 125/268 [00:27<00:50,  2.82it/s][A
Iteration:  47%|████▋     | 126/268 [00:27<00:41,  3.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:27<00:35,  3.98it/s][A
Iteration:  48%|████▊     | 128/268 [00:28<00:31,  4.49it/s][A
Iteration:  48%|████▊     | 129/268 [00:28<00:28,  4.96it/s][A
Iteration:  49%|████▊     | 130/268 [00:28<00:26,  5.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:28<00:24,  5.69it/s][A
Iteration:  49%|████▉     | 132/268 [00:28<00:22,  5.93it/s][A
Iteration:  50%|████▉     | 133/268 [00:28<00:22,  6.13it/s][A
Iteration:  50%|█████     | 134/268 [00:28<00:21,  6.24it/s][A
Iteration:  50%|█████     | 135/268 [00:29<00:20,  6.34it/s][A
Iteration:  51%|█████     | 136/268 [00:29<00:20,  6.44it/s][A
Iteration:  51%|█████     | 137/268 [00:29<00:20,  6.51it/s][A
Iteration:  51%|█████▏    | 138/268 [00:29<00:19,  6.62it/s][A
Iteration:  52%|█████▏    | 139/268 [00:29<00:19,  6.48it/s][A
Iteration:  52%|█████▏    | 140/268 [00:29<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 141/268 [00:30<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 142/268 [00:30<00:19,  6.49it/s][A
Iteration:  53%|█████▎    | 143/268 [00:30<00:19,  6.54it/s][A
Iteration:  54%|█████▎    | 144/268 [00:30<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 145/268 [00:30<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:30<00:18,  6.54it/s][A
Iteration:  55%|█████▍    | 147/268 [00:30<00:18,  6.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:31<00:18,  6.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:31<00:18,  6.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:31<00:18,  6.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:31<00:18,  6.49it/s][A
Iteration:  57%|█████▋    | 152/268 [00:31<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:31<00:17,  6.63it/s][A
Iteration:  57%|█████▋    | 154/268 [00:31<00:17,  6.59it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<00:17,  6.49it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:17,  6.49it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:17,  6.50it/s][A
Iteration:  59%|█████▉    | 158/268 [00:32<00:17,  6.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:32<00:16,  6.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:32<00:16,  6.40it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:16,  6.46it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:16,  6.52it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:16,  6.41it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:16,  6.36it/s][A
Iteration:  62%|██████▏   | 165/268 [00:33<00:16,  6.42it/s][A
Iteration:  62%|██████▏   | 166/268 [00:33<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:15,  6.33it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.34it/s][A[INFO|trainer.py:570] 2024-04-29 02:04:15,674 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:04:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:04:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:04:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:04:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 02:04:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:04:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5794528111058918, 'eval_loss': 0.828057, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1106, 1396, 1349, 1379, 1404, 955, 786, 551, 267, 239, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.59914, 'target_sparsity': 0.6, 'step': 22950}


Iteration:  63%|██████▎   | 170/268 [00:36<01:18,  1.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:36<00:58,  1.65it/s][A
Iteration:  64%|██████▍   | 172/268 [00:36<00:45,  2.13it/s][A
Iteration:  65%|██████▍   | 173/268 [00:37<00:35,  2.67it/s][A
Iteration:  65%|██████▍   | 174/268 [00:37<00:29,  3.20it/s][A
Iteration:  65%|██████▌   | 175/268 [00:37<00:24,  3.81it/s][A
Iteration:  66%|██████▌   | 176/268 [00:37<00:21,  4.27it/s][A
Iteration:  66%|██████▌   | 177/268 [00:37<00:19,  4.76it/s][A
Iteration:  66%|██████▋   | 178/268 [00:37<00:17,  5.14it/s][A
Iteration:  67%|██████▋   | 179/268 [00:38<00:16,  5.50it/s][A
Iteration:  67%|██████▋   | 180/268 [00:38<00:15,  5.77it/s][A
Iteration:  68%|██████▊   | 181/268 [00:38<00:14,  6.06it/s][A
Iteration:  68%|██████▊   | 182/268 [00:38<00:13,  6.18it/s][A
Iteration:  68%|██████▊   | 183/268 [00:38<00:13,  6.36it/s][A
Iteration:  69%|██████▊   | 184/268 [00:38<00:13,  6.39it/s][A
Iteration:  69%|██████▉   | 185/268 [00:38<00:13,  6.36it/s][A
Iteration:  69%|██████▉   | 186/268 [00:39<00:12,  6.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:39<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:39<00:12,  6.36it/s][A
Iteration:  71%|███████   | 189/268 [00:39<00:12,  6.39it/s][A
Iteration:  71%|███████   | 190/268 [00:39<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:39<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 192/268 [00:40<00:11,  6.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:40<00:11,  6.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:40<00:11,  6.62it/s][A
Iteration:  73%|███████▎  | 195/268 [00:40<00:11,  6.57it/s][A
Iteration:  73%|███████▎  | 196/268 [00:40<00:10,  6.57it/s][A
Iteration:  74%|███████▎  | 197/268 [00:40<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:40<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:41<00:10,  6.56it/s][A
Iteration:  75%|███████▍  | 200/268 [00:41<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:41<00:10,  6.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:41<00:10,  6.41it/s][A
Iteration:  76%|███████▌  | 203/268 [00:41<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:41<00:09,  6.50it/s][A
Iteration:  76%|███████▋  | 205/268 [00:42<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:09,  6.58it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:42<00:08,  6.66it/s][A
Iteration:  78%|███████▊  | 210/268 [00:42<00:08,  6.66it/s][A
Iteration:  79%|███████▊  | 211/268 [00:42<00:08,  6.59it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:08,  6.57it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:08,  6.48it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:08,  6.36it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:08,  6.42it/s][A
Iteration:  81%|████████  | 216/268 [00:43<00:08,  6.35it/s][A
Iteration:  81%|████████  | 217/268 [00:43<00:07,  6.38it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:07,  6.34it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 02:04:25,534 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:04:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:04:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:04:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:04:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:04:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:04:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5788207437251082, 'eval_loss': 0.8441248, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1103, 1394, 1346, 1377, 1402, 952, 783, 545, 262, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51515824, 'remaining_params': 33501776, 'pruned_model_sparsity': 0.605943051791629, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 23000}


Iteration:  82%|████████▏ | 220/268 [00:46<00:38,  1.25it/s][A04/29/2024 02:04:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 23000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:46<00:28,  1.64it/s][A
Iteration:  83%|████████▎ | 222/268 [00:46<00:21,  2.12it/s][A
Iteration:  83%|████████▎ | 223/268 [00:46<00:17,  2.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:47<00:13,  3.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:47<00:11,  3.77it/s][A
Iteration:  84%|████████▍ | 226/268 [00:47<00:09,  4.28it/s][A
Iteration:  85%|████████▍ | 227/268 [00:47<00:08,  4.70it/s][A
Iteration:  85%|████████▌ | 228/268 [00:47<00:07,  5.12it/s][A
Iteration:  85%|████████▌ | 229/268 [00:47<00:07,  5.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:48<00:06,  5.69it/s][A
Iteration:  86%|████████▌ | 231/268 [00:48<00:06,  5.78it/s][A
Iteration:  87%|████████▋ | 232/268 [00:48<00:06,  5.90it/s][A
Iteration:  87%|████████▋ | 233/268 [00:48<00:05,  6.06it/s][A
Iteration:  87%|████████▋ | 234/268 [00:48<00:05,  6.17it/s][A
Iteration:  88%|████████▊ | 235/268 [00:48<00:05,  6.27it/s][A
Iteration:  88%|████████▊ | 236/268 [00:49<00:04,  6.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:49<00:04,  6.28it/s][A
Iteration:  89%|████████▉ | 238/268 [00:49<00:04,  6.20it/s][A
Iteration:  89%|████████▉ | 239/268 [00:49<00:04,  6.29it/s][A
Iteration:  90%|████████▉ | 240/268 [00:49<00:04,  6.36it/s][A
Iteration:  90%|████████▉ | 241/268 [00:49<00:04,  6.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:49<00:04,  6.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:50<00:04,  6.19it/s][A
Iteration:  91%|█████████ | 244/268 [00:50<00:03,  6.38it/s][A
Iteration:  91%|█████████▏| 245/268 [00:50<00:03,  6.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:50<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:50<00:03,  6.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:50<00:03,  6.44it/s][A
Iteration:  93%|█████████▎| 249/268 [00:51<00:02,  6.50it/s][A
Iteration:  93%|█████████▎| 250/268 [00:51<00:02,  6.41it/s][A
Iteration:  94%|█████████▎| 251/268 [00:51<00:02,  6.47it/s][A
Iteration:  94%|█████████▍| 252/268 [00:51<00:02,  6.51it/s][A
Iteration:  94%|█████████▍| 253/268 [00:51<00:02,  6.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:51<00:02,  6.40it/s][A
Iteration:  95%|█████████▌| 255/268 [00:51<00:02,  6.42it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:01,  6.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:01,  6.57it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:01,  6.59it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:01,  6.50it/s][A
Iteration:  97%|█████████▋| 260/268 [00:52<00:01,  6.42it/s][A
Iteration:  97%|█████████▋| 261/268 [00:52<00:01,  6.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:00,  6.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  6.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  6.47it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  6.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  6.43it/s][A
Iteration: 100%|█████████▉| 267/268 [00:53<00:00,  6.45it/s][A
Iteration: 100%|██████████| 268/268 [00:53<00:00,  6.83it/s][A04/29/2024 02:04:35 - INFO - trainer.trainer_mod_2 - Epoch 85 finished. Took 53.95 seconds.
Iteration: 100%|██████████| 268/268 [00:53<00:00,  4.97it/s]
Epoch:  86%|████████▌ | 86/100 [1:16:09<12:30, 53.57s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:44,  6.01it/s][A[INFO|trainer.py:570] 2024-04-29 02:04:35,466 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:04:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:04:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:04:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:04:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:04:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:04:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5730897440667784, 'eval_loss': 0.83253217, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1103, 1394, 1346, 1376, 1402, 953, 783, 546, 261, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51514292, 'remaining_params': 33503308, 'pruned_model_sparsity': 0.6059250319933754, 'expected_sparsity': 0.60038, 'target_sparsity': 0.6, 'step': 23050}


Iteration:   1%|          | 2/268 [00:02<06:19,  1.43s/it][A
Iteration:   1%|          | 3/268 [00:02<03:44,  1.18it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:30,  1.75it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:49,  2.40it/s][A
Iteration:   2%|▏         | 6/268 [00:03<01:25,  3.08it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:10,  3.72it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:00,  4.32it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:54,  4.77it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:49,  5.20it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:46,  5.49it/s][A
Iteration:   4%|▍         | 12/268 [00:04<00:44,  5.75it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:43,  5.89it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:42,  5.96it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:41,  6.16it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:39,  6.30it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.28it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:39,  6.36it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:38,  6.40it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.42it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.46it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.44it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.40it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:38,  6.41it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.37it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:37,  6.41it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:36,  6.52it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:36,  6.54it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.55it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.49it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.49it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.51it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.50it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.48it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:34,  6.60it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.50it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.50it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:34,  6.49it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.42it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.43it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.40it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.33it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.14it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.36it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 02:04:45,350 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:04:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:04:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:04:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:04:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:04:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:04:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.56598121537003, 'eval_loss': 0.8412639, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1106, 1396, 1348, 1379, 1405, 955, 786, 551, 265, 237, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51465268, 'remaining_params': 33552332, 'pruned_model_sparsity': 0.6053483984492622, 'expected_sparsity': 0.59925, 'target_sparsity': 0.6, 'step': 23100}


Iteration:  19%|█▉        | 52/268 [00:12<02:52,  1.25it/s][A04/29/2024 02:04:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 23100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:12<02:10,  1.65it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:40,  2.13it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:19,  2.67it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:05,  3.25it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:54,  3.86it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:47,  4.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:42,  4.92it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:39,  5.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:36,  5.64it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:35,  5.78it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:34,  5.99it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:33,  6.15it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:31,  6.38it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:31,  6.39it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:31,  6.47it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:30,  6.50it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:30,  6.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:30,  6.51it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:30,  6.51it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.48it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.43it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.39it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:30,  6.23it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.40it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.43it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.57it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.37it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.57it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.54it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.57it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:26,  6.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.55it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.51it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.35it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.42it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.43it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.45it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.56it/s][A[INFO|trainer.py:570] 2024-04-29 02:04:55,187 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:04:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:04:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:04:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:04:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:04:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:04:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5773829468741973, 'eval_loss': 0.83741194, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1104, 1395, 1346, 1377, 1403, 952, 783, 547, 260, 231, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51508164, 'remaining_params': 33509436, 'pruned_model_sparsity': 0.6058529528003613, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 23150}


Iteration:  38%|███▊      | 102/268 [00:22<02:12,  1.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:22<01:40,  1.64it/s][A
Iteration:  39%|███▉      | 104/268 [00:22<01:17,  2.11it/s][A
Iteration:  39%|███▉      | 105/268 [00:22<01:01,  2.66it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<00:50,  3.24it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<00:42,  3.82it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:36,  4.38it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:32,  4.83it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:30,  5.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:28,  5.54it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:26,  5.79it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:25,  6.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:24,  6.26it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:24,  6.27it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:23,  6.36it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:23,  6.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.32it/s][A
Iteration:  45%|████▍     | 120/268 [00:24<00:23,  6.29it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.27it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:22,  6.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.43it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.25it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.32it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.19it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:22,  6.23it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.32it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.30it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.41it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.41it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.47it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.50it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.59it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.51it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.56it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.65it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.60it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.49it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.50it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.41it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.48it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.49it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.41it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.36it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 02:05:05,096 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:05:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:05:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:05:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:05:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:05:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:05:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.574317075204954, 'eval_loss': 0.84612995, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1103, 1394, 1345, 1376, 1403, 951, 782, 546, 260, 231, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51518888, 'remaining_params': 33498712, 'pruned_model_sparsity': 0.6059790913881361, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 23200}


Iteration:  57%|█████▋    | 152/268 [00:32<01:32,  1.25it/s][A04/29/2024 02:05:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 23200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:32<01:10,  1.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:32<00:53,  2.12it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<00:42,  2.68it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:34,  3.25it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:28,  3.84it/s][A
Iteration:  59%|█████▉    | 158/268 [00:33<00:25,  4.39it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:22,  4.80it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:20,  5.21it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:19,  5.63it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:17,  5.89it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:17,  6.01it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:17,  6.08it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:16,  6.25it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:16,  6.31it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.45it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:14,  6.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:14,  6.49it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.52it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.54it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.58it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.32it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.39it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.63it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.61it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.48it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.41it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.33it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.41it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.53it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:12,  6.12it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.23it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.35it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.41it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 02:05:14,984 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:05:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:05:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:05:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:05:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:05:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:05:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5722385869866928, 'eval_loss': 0.83683246, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1106, 1397, 1348, 1379, 1405, 954, 786, 552, 265, 237, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.59926, 'target_sparsity': 0.6, 'step': 23250}


Iteration:  75%|███████▌  | 202/268 [00:41<00:52,  1.25it/s][A
Iteration:  76%|███████▌  | 203/268 [00:42<00:39,  1.64it/s][A
Iteration:  76%|███████▌  | 204/268 [00:42<00:30,  2.09it/s][A
Iteration:  76%|███████▋  | 205/268 [00:42<00:24,  2.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:19,  3.18it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:16,  3.76it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:13,  4.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:43<00:12,  4.69it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:11,  5.15it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:10,  5.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:09,  5.83it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:09,  6.02it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:08,  6.15it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:08,  6.16it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  6.27it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.36it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:07,  6.45it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.37it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.44it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.41it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.42it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.28it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.20it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.21it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.18it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.41it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.26it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.26it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.23it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.30it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.30it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.48it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.48it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.37it/s][A[INFO|trainer.py:570] 2024-04-29 02:05:24,972 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:05:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:05:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:05:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:05:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:05:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:05:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5679300559602783, 'eval_loss': 0.8351001, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1396, 1347, 1377, 1404, 952, 783, 548, 260, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51500504, 'remaining_params': 33517096, 'pruned_model_sparsity': 0.6057628538090937, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 23300}


Iteration:  94%|█████████▍| 252/268 [00:51<00:12,  1.25it/s][A04/29/2024 02:05:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 23300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:52<00:09,  1.64it/s][A
Iteration:  95%|█████████▍| 254/268 [00:52<00:06,  2.12it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:04,  2.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:03,  3.24it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:02,  3.81it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:02,  4.36it/s][A
Iteration:  97%|█████████▋| 259/268 [00:53<00:01,  4.85it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:01,  5.31it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  5.54it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.68it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  5.89it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  6.00it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  6.23it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  6.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.38it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.75it/s][A04/29/2024 02:05:29 - INFO - trainer.trainer_mod_2 - Epoch 86 finished. Took 54.42 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.92it/s]
Epoch:  87%|████████▋ | 87/100 [1:17:03<11:39, 53.83s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|          | 2/268 [00:00<00:42,  6.22it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.43it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.53it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.57it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.59it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.36it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.42it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.30it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.50it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.49it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.52it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.66it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.18it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:39,  6.19it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.37it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.34it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.42it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:38,  6.32it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.40it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.43it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:37,  6.37it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 02:05:34,849 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:05:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:05:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:05:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:05:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:05:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:05:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5682413241334403, 'eval_loss': 0.8361416, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1104, 1395, 1346, 1377, 1404, 951, 782, 547, 260, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51509696, 'remaining_params': 33507904, 'pruned_model_sparsity': 0.6058709725986149, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 23350}


Iteration:  13%|█▎        | 34/268 [00:07<03:07,  1.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<02:21,  1.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<01:49,  2.12it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<01:26,  2.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:11,  3.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:59,  3.82it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:51,  4.41it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:46,  4.88it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:42,  5.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:40,  5.52it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:39,  5.72it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:37,  5.93it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:36,  6.10it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.21it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:35,  6.23it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.33it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.26it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.35it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.31it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.33it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:34,  6.21it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.21it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:34,  6.17it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.36it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.31it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.47it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.52it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.51it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.49it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.53it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.56it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.48it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.39it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.43it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.42it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.48it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.41it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.55it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.52it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.56it/s][A[INFO|trainer.py:570] 2024-04-29 02:05:44,752 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:05:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:05:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:05:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:05:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:05:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:05:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5725078939425798, 'eval_loss': 0.835454, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1107, 1398, 1348, 1379, 1406, 954, 786, 552, 264, 237, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.59924, 'target_sparsity': 0.6, 'step': 23400}


Iteration:  31%|███▏      | 84/268 [00:17<02:26,  1.25it/s][A04/29/2024 02:05:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 23400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:17<01:51,  1.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<01:25,  2.12it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:07,  2.68it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:55,  3.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:47,  3.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:40,  4.35it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:36,  4.83it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:33,  5.31it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:31,  5.47it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:31,  5.61it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:29,  5.96it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:28,  6.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.27it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:27,  6.21it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.27it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.22it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.31it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.27it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.50it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.42it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.43it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.47it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.29it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.52it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.50it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.57it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.58it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.57it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.41it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.51it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 02:05:54,648 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:05:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:05:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:05:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:05:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:05:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:05:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.557882735147727, 'eval_loss': 0.8446951, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1396, 1346, 1378, 1405, 952, 784, 548, 259, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 23450}


Iteration:  50%|█████     | 134/268 [00:27<01:46,  1.26it/s][A
Iteration:  50%|█████     | 135/268 [00:27<01:20,  1.66it/s][A
Iteration:  51%|█████     | 136/268 [00:27<01:02,  2.12it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:49,  2.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:40,  3.23it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:34,  3.78it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:29,  4.30it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:26,  4.84it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:24,  5.21it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:23,  5.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:21,  5.74it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:20,  5.93it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:19,  6.16it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.34it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.46it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.41it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.44it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.49it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.22it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.28it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.27it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.36it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.42it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.47it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.48it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.48it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.48it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.58it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.55it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.55it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.54it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.44it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.50it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.60it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.57it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.60it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.58it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.55it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.42it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 02:06:04,532 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:06:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:06:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:06:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:06:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:06:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:06:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5595884617444483, 'eval_loss': 0.84508187, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1103, 1395, 1345, 1377, 1404, 951, 783, 547, 258, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51511228, 'remaining_params': 33506372, 'pruned_model_sparsity': 0.6058889923968684, 'expected_sparsity': 0.60044, 'target_sparsity': 0.6, 'step': 23500}


Iteration:  69%|██████▊   | 184/268 [00:37<01:06,  1.26it/s][A04/29/2024 02:06:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 23500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:37<00:50,  1.66it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:38,  2.13it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:30,  2.67it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:24,  3.23it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:20,  3.81it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:17,  4.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:15,  4.85it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:14,  5.20it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:13,  5.46it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:13,  5.62it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:12,  5.95it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:12,  5.88it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  5.95it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.06it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.07it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.24it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.23it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.30it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.35it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.38it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.35it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.17it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.20it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.36it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.42it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.37it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.43it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.37it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.44it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.58it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.59it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.61it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.66it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.61it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.35it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.52it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.53it/s][A[INFO|trainer.py:570] 2024-04-29 02:06:14,474 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:06:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:06:14 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:06:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:06:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:06:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:06:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5630491915710935, 'eval_loss': 0.85855037, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1106, 1398, 1347, 1379, 1406, 954, 786, 552, 263, 236, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.59929, 'target_sparsity': 0.6, 'step': 23550}


Iteration:  87%|████████▋ | 234/268 [00:47<00:27,  1.25it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:19,  1.65it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:14,  2.14it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:11,  2.69it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:09,  3.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:07,  3.84it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:06,  4.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:05,  4.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  5.26it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:04,  5.57it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.84it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.01it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.09it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.22it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.23it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.30it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.25it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.41it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.55it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.56it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.34it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.31it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.31it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.56it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.64it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.70it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.68it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.94it/s][A04/29/2024 02:06:21 - INFO - trainer.trainer_mod_2 - Epoch 87 finished. Took 52.27 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  88%|████████▊ | 88/100 [1:17:56<10:40, 53.36s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.53it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.67it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.44it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.49it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.41it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.35it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.30it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.38it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.44it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.44it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 02:06:24,312 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:06:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:06:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:06:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:06:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 02:06:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:06:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5657894359264041, 'eval_loss': 0.8325647, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1396, 1346, 1377, 1405, 951, 783, 549, 259, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51500504, 'remaining_params': 33517096, 'pruned_model_sparsity': 0.6057628538090937, 'expected_sparsity': 0.6002, 'target_sparsity': 0.6, 'step': 23600}


Iteration:   6%|▌         | 16/268 [00:04<03:21,  1.25it/s][A04/29/2024 02:06:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 23600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:32,  1.65it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:57,  2.12it/s][A
Iteration:   7%|▋         | 19/268 [00:05<01:33,  2.66it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:16,  3.26it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:03,  3.86it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:56,  4.39it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:51,  4.75it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:47,  5.14it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:44,  5.50it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:42,  5.76it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:40,  6.01it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:39,  6.02it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:38,  6.17it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:38,  6.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.49it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.51it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.50it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.45it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.47it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.47it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.36it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.32it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.32it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.25it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.30it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.30it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.47it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.51it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.51it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.36it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.32it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:32,  6.37it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 02:06:34,227 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:06:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:06:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:06:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:06:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.84it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 02:06:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:06:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5611975320184954, 'eval_loss': 0.83785444, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1103, 1395, 1344, 1376, 1404, 949, 782, 547, 258, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51520420, 'remaining_params': 33497180, 'pruned_model_sparsity': 0.6059971111863897, 'expected_sparsity': 0.60049, 'target_sparsity': 0.6, 'step': 23650}


Iteration:  25%|██▍       | 66/268 [00:14<02:40,  1.26it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<02:01,  1.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<01:33,  2.13it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<01:14,  2.67it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:02,  3.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:52,  3.72it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:45,  4.26it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:40,  4.77it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:37,  5.18it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:35,  5.46it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:33,  5.75it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:32,  5.90it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:31,  6.10it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:31,  5.99it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.14it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.25it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.35it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:29,  6.31it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.45it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.61it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.55it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.45it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.44it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:26,  6.57it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.29it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.30it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.28it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.24it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.31it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.30it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.38it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.47it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.51it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.49it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 02:06:44,188 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:06:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:06:44 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:06:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:06:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:06:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:06:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5640063794282216, 'eval_loss': 0.8257912, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1106, 1398, 1347, 1379, 1407, 952, 786, 553, 263, 239, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51460672, 'remaining_params': 33556928, 'pruned_model_sparsity': 0.6052943390545017, 'expected_sparsity': 0.59918, 'target_sparsity': 0.6, 'step': 23700}


Iteration:  43%|████▎     | 116/268 [00:24<02:01,  1.25it/s][A04/29/2024 02:06:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 23700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:24<01:31,  1.66it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<01:10,  2.14it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:55,  2.68it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:45,  3.24it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:38,  3.79it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:34,  4.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:30,  4.68it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:28,  5.13it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:26,  5.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:26<00:24,  5.75it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:23,  5.90it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:23,  6.05it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.11it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.22it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.45it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.38it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.40it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.41it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.31it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:21,  6.23it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.32it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:20,  6.39it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.31it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:20,  6.35it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.38it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.41it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.53it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.62it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:17,  6.63it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.58it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.54it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.55it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.55it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.42it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.29it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:18,  6.12it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:18,  5.99it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.05it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.03it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:17,  6.19it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.26it/s][A
Iteration:  61%|██████    | 164/268 [00:32<00:16,  6.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:16,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 02:06:54,168 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:06:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:06:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:06:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:06:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:06:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:06:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5640063794282216, 'eval_loss': 0.83884513, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1104, 1397, 1345, 1377, 1405, 950, 784, 548, 258, 232, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.60031, 'target_sparsity': 0.6, 'step': 23750}


Iteration:  62%|██████▏   | 166/268 [00:34<01:21,  1.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<01:01,  1.64it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:47,  2.12it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:37,  2.67it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:30,  3.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:25,  3.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:21,  4.37it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:19,  4.85it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:17,  5.31it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:16,  5.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:36<00:15,  5.84it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:15,  5.94it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.10it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.11it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:14,  6.26it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.32it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.31it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:13,  6.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.44it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.47it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.27it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.37it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.43it/s][A
Iteration:  71%|███████   | 189/268 [00:38<00:12,  6.29it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.19it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.23it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.24it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.45it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.49it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.51it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.45it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.36it/s][A
Iteration:  75%|███████▌  | 202/268 [00:40<00:10,  6.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.41it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.55it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.52it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 208/268 [00:41<00:09,  6.54it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.54it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.42it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.46it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.60it/s][A
Iteration:  80%|████████  | 215/268 [00:42<00:08,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 02:07:04,051 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:07:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:07:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:07:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:07:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 02:07:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:07:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5635758105599825, 'eval_loss': 0.8333104, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1104, 1396, 1345, 1377, 1404, 949, 783, 547, 257, 231, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51511228, 'remaining_params': 33506372, 'pruned_model_sparsity': 0.6058889923968684, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 23800}


Iteration:  81%|████████  | 216/268 [00:44<00:41,  1.26it/s][A04/29/2024 02:07:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 23800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:44<00:30,  1.66it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:23,  2.13it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:18,  2.67it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:14,  3.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:45<00:12,  3.81it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:10,  4.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:09,  4.86it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:08,  5.15it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  5.55it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:07,  5.89it/s][A
Iteration:  85%|████████▍ | 227/268 [00:46<00:06,  6.09it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.13it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.24it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.31it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.32it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.37it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.42it/s][A
Iteration:  90%|████████▉ | 240/268 [00:48<00:04,  6.44it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:49<00:03,  6.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.60it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.73it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.65it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.59it/s][A
Iteration:  94%|█████████▍| 253/268 [00:50<00:02,  6.57it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.57it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.43it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:51<00:01,  6.39it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.52it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.38it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.26it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.34it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 02:07:13,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:07:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:07:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:07:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:07:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.74it/s]04/29/2024 02:07:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:07:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5706355604450147, 'eval_loss': 0.83681434, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1107, 1399, 1347, 1379, 1407, 952, 786, 553, 262, 238, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51457608, 'remaining_params': 33559992, 'pruned_model_sparsity': 0.6052582994579946, 'expected_sparsity': 0.59914, 'target_sparsity': 0.6, 'step': 23850}


Iteration:  99%|█████████▉| 266/268 [00:54<00:01,  1.24it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  1.64it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  2.15it/s][A04/29/2024 02:07:16 - INFO - trainer.trainer_mod_2 - Epoch 88 finished. Took 54.55 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.91it/s]
Epoch:  89%|████████▉ | 89/100 [1:18:50<09:50, 53.72s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.50it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.45it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.53it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.65it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.53it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.43it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:38,  6.58it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.57it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.56it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.54it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.43it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.39it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.52it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.50it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.45it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.45it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.47it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.49it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.51it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.51it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.44it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.51it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.51it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:37,  6.35it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.65it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.50it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.42it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.44it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:35,  6.41it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.43it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:35,  6.21it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:35,  6.33it/s][A
Iteration:  18%|█▊        | 47/268 [00:07<00:34,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 02:07:23,807 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:07:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:07:23 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:07:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:07:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 02:07:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:07:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5619111841232217, 'eval_loss': 0.8329647, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1104, 1396, 1345, 1377, 1405, 949, 783, 547, 256, 231, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51511228, 'remaining_params': 33506372, 'pruned_model_sparsity': 0.6058889923968684, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 23900}


Iteration:  18%|█▊        | 48/268 [00:09<02:55,  1.25it/s][A04/29/2024 02:07:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 23900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:09<02:12,  1.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<01:42,  2.13it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<01:21,  2.65it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<01:06,  3.23it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:56,  3.82it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:49,  4.36it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:44,  4.84it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:40,  5.20it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:38,  5.54it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:36,  5.81it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:34,  6.03it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.27it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.42it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.59it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.61it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.63it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.64it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.46it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.59it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.44it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.44it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.45it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.57it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.27it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:30,  6.24it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.51it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.62it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.70it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.63it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.49it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.46it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.47it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:27,  6.50it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.54it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:26,  6.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:26,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 02:07:33,614 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:07:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:07:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:07:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:07:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 02:07:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:07:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5564748164739529, 'eval_loss': 0.84975624, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1104, 1397, 1344, 1377, 1405, 949, 783, 548, 256, 231, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51506632, 'remaining_params': 33510968, 'pruned_model_sparsity': 0.6058349330021078, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 23950}


Iteration:  37%|███▋      | 98/268 [00:19<02:15,  1.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<01:41,  1.66it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<01:18,  2.14it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<01:01,  2.70it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:50,  3.27it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:42,  3.84it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:38,  4.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:34,  4.72it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:31,  5.14it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:29,  5.39it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:27,  5.72it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:27,  5.87it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:26,  6.04it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.13it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:25,  6.19it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.40it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.37it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.34it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.39it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.49it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.52it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.54it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.51it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.48it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.43it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.49it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.44it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.45it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.43it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.49it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.64it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.44it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:19,  6.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:19,  6.50it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:18,  6.53it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:18,  6.57it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:18,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 02:07:43,512 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:07:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:07:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:07:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:07:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 02:07:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:07:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.56217893832047, 'eval_loss': 0.8436234, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1107, 1399, 1346, 1379, 1407, 952, 786, 552, 259, 235, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.59933, 'target_sparsity': 0.6, 'step': 24000}


Iteration:  55%|█████▌    | 148/268 [00:29<01:35,  1.25it/s][A04/29/2024 02:07:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 24000, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:29<01:11,  1.66it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:55,  2.14it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:43,  2.68it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:35,  3.26it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:29,  3.84it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:26,  4.38it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:23,  4.77it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:21,  5.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:20,  5.52it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:18,  5.82it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:18,  6.04it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.17it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.38it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.36it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.41it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.47it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.63it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.70it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.68it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.41it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:32<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.37it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.40it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.47it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.53it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.64it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:12,  6.75it/s][A
Iteration:  69%|██████▉   | 185/268 [00:34<00:12,  6.62it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.59it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.50it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.49it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:35<00:12,  6.03it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:12,  6.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:12,  6.20it/s][A
Iteration:  72%|███████▏  | 194/268 [00:36<00:11,  6.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:36<00:11,  6.29it/s][A
Iteration:  73%|███████▎  | 196/268 [00:36<00:11,  6.28it/s][A
Iteration:  74%|███████▎  | 197/268 [00:36<00:11,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 02:07:53,373 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:07:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:07:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:07:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:07:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:07:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:07:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5647660677080502, 'eval_loss': 0.8360195, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1103, 1396, 1343, 1376, 1404, 948, 782, 547, 255, 230, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51523484, 'remaining_params': 33494116, 'pruned_model_sparsity': 0.6060331507828968, 'expected_sparsity': 0.60055, 'target_sparsity': 0.6, 'step': 24050}


Iteration:  74%|███████▍  | 198/268 [00:39<00:55,  1.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:41,  1.65it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:32,  2.12it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:25,  2.63it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:20,  3.20it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:17,  3.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:14,  4.39it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:12,  4.88it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:11,  5.23it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:10,  5.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:10,  5.78it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:10,  5.83it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.03it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:09,  6.25it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.48it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.50it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.42it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.45it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.53it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:42<00:06,  6.52it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:43<00:06,  6.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.38it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.51it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.22it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.23it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.14it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.23it/s][A
Iteration:  90%|█████████ | 242/268 [00:45<00:04,  6.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:46<00:03,  6.42it/s][A
Iteration:  91%|█████████▏| 245/268 [00:46<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:46<00:03,  6.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:46<00:03,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 02:08:03,293 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:08:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:08:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:08:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:08:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:08:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:08:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5691684038863919, 'eval_loss': 0.8324418, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1106, 1398, 1345, 1378, 1406, 950, 784, 551, 258, 235, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51482120, 'remaining_params': 33535480, 'pruned_model_sparsity': 0.6055466162300512, 'expected_sparsity': 0.59965, 'target_sparsity': 0.6, 'step': 24100}


Iteration:  93%|█████████▎| 248/268 [00:49<00:16,  1.25it/s][A04/29/2024 02:08:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 24100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:49<00:11,  1.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:08,  2.11it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:06,  2.65it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:04,  3.23it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:03,  3.78it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:03,  4.33it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  4.80it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:02,  5.22it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:02,  5.49it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  5.80it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.01it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.05it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.17it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.28it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.35it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.48it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.52it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.85it/s][A04/29/2024 02:08:08 - INFO - trainer.trainer_mod_2 - Epoch 89 finished. Took 52.13 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  90%|█████████ | 90/100 [1:19:42<08:52, 53.24s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.37it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.66it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.52it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:41,  6.33it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:41,  6.28it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.27it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.37it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.49it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.44it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:42,  5.95it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:41,  6.11it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:41,  6.06it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:40,  6.14it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:40,  6.18it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.36it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.34it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.40it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.53it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.50it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.45it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.45it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.47it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:37,  6.42it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.32it/s][A[INFO|trainer.py:570] 2024-04-29 02:08:13,218 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:08:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:08:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:08:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:08:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:08:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:08:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5670814703238499, 'eval_loss': 0.8279152, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1106, 1398, 1345, 1378, 1406, 949, 784, 551, 256, 231, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51489780, 'remaining_params': 33527820, 'pruned_model_sparsity': 0.6056367152213189, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 24150}


Iteration:  11%|█         | 30/268 [00:06<03:10,  1.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:07<02:23,  1.65it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<01:50,  2.14it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<01:27,  2.67it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<01:11,  3.25it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<01:00,  3.84it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:52,  4.42it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:47,  4.85it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:44,  5.19it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:41,  5.47it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:40,  5.69it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:38,  5.84it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:36,  6.11it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:36,  6.11it/s][A
Iteration:  16%|█▋        | 44/268 [00:09<00:35,  6.24it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.30it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.39it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.37it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.39it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.42it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.39it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.46it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.46it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.40it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.42it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.48it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.45it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.45it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.54it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.63it/s][A[INFO|trainer.py:570] 2024-04-29 02:08:23,096 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:08:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:08:23 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:08:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:08:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:08:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:08:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5673499023091504, 'eval_loss': 0.82912135, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1103, 1396, 1343, 1375, 1403, 946, 781, 547, 255, 230, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51531144, 'remaining_params': 33486456, 'pruned_model_sparsity': 0.6061232497741644, 'expected_sparsity': 0.60067, 'target_sparsity': 0.6, 'step': 24200}


Iteration:  30%|██▉       | 80/268 [00:16<02:29,  1.26it/s][A04/29/2024 02:08:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 24200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:16<01:52,  1.66it/s][A
Iteration:  31%|███       | 82/268 [00:17<01:27,  2.13it/s][A
Iteration:  31%|███       | 83/268 [00:17<01:09,  2.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:57,  3.22it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:47,  3.83it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:41,  4.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:37,  4.85it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:34,  5.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:31,  5.60it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:30,  5.87it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:29,  5.99it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:28,  6.15it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.25it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:28,  6.17it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.21it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.19it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.19it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.27it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.37it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.41it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.36it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.43it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.46it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:23,  6.59it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:24,  6.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.33it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.41it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.59it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.30it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.47it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.52it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.54it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.43it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:22,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 02:08:33,027 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:08:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:08:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:08:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:08:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:08:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:08:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5604772031378175, 'eval_loss': 0.82568216, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1107, 1399, 1346, 1378, 1406, 949, 784, 555, 263, 239, 363], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51264576, 'remaining_params': 33753024, 'pruned_model_sparsity': 0.6029878048780488, 'expected_sparsity': 0.59882, 'target_sparsity': 0.6, 'step': 24250}


Iteration:  49%|████▊     | 130/268 [00:26<01:50,  1.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<01:23,  1.65it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<01:04,  2.11it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:51,  2.65it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:41,  3.22it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:35,  3.79it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:30,  4.34it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:26,  4.88it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:24,  5.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:23,  5.61it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:22,  5.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:21,  5.97it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:20,  6.16it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.24it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.36it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.38it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.30it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.38it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.41it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.48it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.47it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.41it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:17,  6.33it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:17,  6.28it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.36it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.43it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.57it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.44it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.43it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.29it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.37it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.43it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.55it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.53it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:13,  6.63it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.70it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.67it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 02:08:42,912 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:08:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:08:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:08:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:08:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:08:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:08:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5588305747648582, 'eval_loss': 0.82332623, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1105, 1396, 1344, 1376, 1403, 946, 780, 548, 255, 230, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51523484, 'remaining_params': 33494116, 'pruned_model_sparsity': 0.6060331507828968, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 24300}


Iteration:  67%|██████▋   | 180/268 [00:36<01:10,  1.26it/s][A04/29/2024 02:08:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 24300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:36<00:52,  1.66it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:40,  2.13it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:31,  2.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:25,  3.26it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:21,  3.81it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:19,  4.31it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:16,  4.79it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:15,  5.16it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:14,  5.58it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:13,  5.75it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:13,  5.87it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  5.96it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.11it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.22it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:11,  6.30it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.40it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.39it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.39it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.58it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.57it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.54it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.39it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.61it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.59it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.67it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.48it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.51it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.61it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.61it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.61it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.57it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.65it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.58it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.57it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.59it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.60it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:05,  6.67it/s][A[INFO|trainer.py:570] 2024-04-29 02:08:52,734 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:08:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:08:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:08:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:08:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:08:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:08:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5616581968995631, 'eval_loss': 0.82504565, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1104, 1396, 1344, 1375, 1403, 945, 780, 548, 255, 232, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51526548, 'remaining_params': 33491052, 'pruned_model_sparsity': 0.6060691903794038, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 24350}


Iteration:  86%|████████▌ | 230/268 [00:46<00:30,  1.26it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:22,  1.66it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:16,  2.13it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:12,  2.70it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:10,  3.27it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:08,  3.86it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:07,  4.39it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:06,  4.69it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:05,  5.14it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:05,  5.50it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  5.70it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  5.94it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.05it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.32it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.25it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.40it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.27it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.18it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.27it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.31it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.41it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.41it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.32it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.37it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.34it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.22it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.21it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.30it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.29it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.53it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.89it/s][A04/29/2024 02:09:00 - INFO - trainer.trainer_mod_2 - Epoch 90 finished. Took 52.28 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  91%|█████████ | 91/100 [1:20:35<07:56, 52.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.46it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.40it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.37it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.53it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.62it/s][A[INFO|trainer.py:570] 2024-04-29 02:09:02,618 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:09:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:09:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:09:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:09:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:09:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:09:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5647660677080502, 'eval_loss': 0.8154467, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1107, 1399, 1347, 1378, 1405, 948, 783, 554, 259, 237, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51471396, 'remaining_params': 33546204, 'pruned_model_sparsity': 0.6054204776422765, 'expected_sparsity': 0.59919, 'target_sparsity': 0.6, 'step': 24400}


Iteration:   4%|▍         | 12/268 [00:03<03:25,  1.25it/s][A04/29/2024 02:09:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 24400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:04<02:34,  1.65it/s][A
Iteration:   5%|▌         | 14/268 [00:04<01:59,  2.13it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:33,  2.70it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:16,  3.27it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:04,  3.88it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:56,  4.43it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:50,  4.91it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:46,  5.36it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:43,  5.62it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:42,  5.79it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:41,  5.94it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.19it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:39,  6.21it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.31it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:37,  6.49it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:37,  6.43it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:36,  6.54it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:37,  6.26it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.29it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.30it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:37,  6.12it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.25it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.33it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.43it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.42it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.47it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.39it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.31it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.30it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.23it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.32it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.29it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.38it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.29it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.33it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.42it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 02:09:12,530 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:09:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:09:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:09:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:09:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 02:09:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:09:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5670814703238499, 'eval_loss': 0.82535625, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1103, 1395, 1343, 1374, 1402, 944, 779, 547, 254, 230, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51541868, 'remaining_params': 33475732, 'pruned_model_sparsity': 0.6062493883619392, 'expected_sparsity': 0.60079, 'target_sparsity': 0.6, 'step': 24450}


Iteration:  23%|██▎       | 62/268 [00:13<02:44,  1.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<02:03,  1.65it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<01:35,  2.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<01:16,  2.67it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<01:02,  3.25it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:52,  3.79it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:46,  4.30it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:41,  4.79it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:38,  5.08it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:36,  5.38it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:34,  5.68it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:32,  5.92it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:31,  6.17it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:31,  6.15it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:30,  6.22it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:30,  6.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.36it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.43it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.47it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.48it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.46it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:27,  6.62it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.55it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.54it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.57it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.33it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:28,  6.26it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.36it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.47it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:27,  6.36it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:27,  6.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.47it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.52it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.48it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.50it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.41it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 02:09:22,435 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:09:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:09:22 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:09:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:09:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:09:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:09:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5759775781817433, 'eval_loss': 0.82604665, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1107, 1398, 1346, 1377, 1405, 948, 783, 553, 260, 236, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.59926, 'target_sparsity': 0.6, 'step': 24500}


Iteration:  42%|████▏     | 112/268 [00:23<02:04,  1.25it/s][A04/29/2024 02:09:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 24500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:23<01:34,  1.65it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<01:13,  2.09it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:58,  2.63it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:47,  3.19it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:40,  3.75it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:34,  4.30it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:30,  4.85it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:28,  5.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:26,  5.58it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:24,  5.86it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:23,  6.07it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:23,  6.20it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.28it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.27it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:22,  6.34it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.42it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:20,  6.54it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.64it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.62it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.62it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.59it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.49it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.61it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.63it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.41it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.45it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.49it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.45it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.45it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.49it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.61it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.45it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.51it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.49it/s][A[INFO|trainer.py:570] 2024-04-29 02:09:32,282 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:09:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:09:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:09:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:09:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:09:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:09:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5705114473535801, 'eval_loss': 0.8191902, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1105, 1397, 1345, 1376, 1405, 947, 782, 550, 253, 230, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51506632, 'remaining_params': 33510968, 'pruned_model_sparsity': 0.6058349330021078, 'expected_sparsity': 0.60029, 'target_sparsity': 0.6, 'step': 24550}


Iteration:  60%|██████    | 162/268 [00:33<01:24,  1.26it/s][A
Iteration:  61%|██████    | 163/268 [00:33<01:03,  1.66it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:48,  2.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:38,  2.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:31,  3.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:26,  3.85it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:22,  4.39it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:20,  4.92it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:18,  5.31it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:17,  5.60it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:16,  5.78it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:16,  5.92it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:15,  6.11it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.23it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.31it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.53it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.46it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.50it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.52it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.41it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.43it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.30it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.46it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:11,  6.57it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:12,  6.10it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:12,  6.07it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.19it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.52it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.39it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.53it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 02:09:42,198 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:09:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:09:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:09:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:09:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:09:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:09:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5608014461364136, 'eval_loss': 0.8266693, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1103, 1394, 1343, 1374, 1403, 945, 780, 547, 252, 229, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51538804, 'remaining_params': 33478796, 'pruned_model_sparsity': 0.6062133487654321, 'expected_sparsity': 0.60076, 'target_sparsity': 0.6, 'step': 24600}


Iteration:  79%|███████▉  | 212/268 [00:43<00:44,  1.25it/s][A04/29/2024 02:09:44 - INFO - trainer.trainer_mod_2 - v4 Global step: 24600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:43<00:33,  1.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:25,  2.12it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:19,  2.66it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:16,  3.21it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:13,  3.78it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:11,  4.29it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:10,  4.78it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:09,  5.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:08,  5.46it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:08,  5.69it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  5.81it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:07,  6.02it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:07,  6.10it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.23it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.24it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.31it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.35it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.44it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  6.31it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.30it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.40it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.38it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.52it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.40it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.47it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.31it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.30it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.34it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.54it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.56it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.46it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.45it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 02:09:52,151 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:09:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:09:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:09:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:09:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.79it/s]04/29/2024 02:09:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:09:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5611393252000734, 'eval_loss': 0.839608, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1108, 1399, 1346, 1378, 1406, 949, 785, 556, 261, 240, 365], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51256916, 'remaining_params': 33760684, 'pruned_model_sparsity': 0.602897705886781, 'expected_sparsity': 0.59863, 'target_sparsity': 0.6, 'step': 24650}


Iteration:  98%|█████████▊| 262/268 [00:53<00:04,  1.25it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:03,  1.65it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:01,  2.13it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:01,  2.66it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  3.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  3.81it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.50it/s][A04/29/2024 02:09:55 - INFO - trainer.trainer_mod_2 - Epoch 91 finished. Took 54.42 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  92%|█████████▏| 92/100 [1:21:29<07:07, 53.39s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:42,  6.33it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.47it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.48it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.39it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:41,  6.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:39,  6.50it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.64it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.63it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.53it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.53it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.26it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.36it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.42it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.37it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.41it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.44it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.54it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:36,  6.68it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:36,  6.66it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.44it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.36it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.50it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:36,  6.59it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:37,  6.41it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:38,  6.29it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:37,  6.35it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:37,  6.27it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.48it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:36,  6.44it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.54it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:36,  6.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:06<00:34,  6.57it/s][A
Iteration:  15%|█▌        | 41/268 [00:06<00:35,  6.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:06<00:35,  6.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:06<00:37,  6.02it/s][A[INFO|trainer.py:570] 2024-04-29 02:10:02,040 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:10:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:10:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:10:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:10:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:10:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:10:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5592599603967259, 'eval_loss': 0.8352551, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1104, 1395, 1343, 1374, 1403, 945, 781, 548, 252, 230, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51532676, 'remaining_params': 33484924, 'pruned_model_sparsity': 0.606141269572418, 'expected_sparsity': 0.6007, 'target_sparsity': 0.6, 'step': 24700}


Iteration:  16%|█▋        | 44/268 [00:08<03:00,  1.24it/s][A04/29/2024 02:10:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 24700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:09<02:16,  1.64it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<01:45,  2.11it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<01:23,  2.65it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<01:08,  3.22it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:57,  3.84it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:50,  4.36it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:44,  4.89it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:40,  5.29it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:38,  5.61it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:36,  5.80it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:36,  5.85it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:35,  6.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:34,  6.08it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.24it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:33,  6.32it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.34it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.45it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.48it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.16it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.28it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.40it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.41it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.47it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.68it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.52it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.49it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.39it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.46it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.36it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.33it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.46it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.39it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:28,  6.41it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:27,  6.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:26,  6.63it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.57it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.65it/s][A[INFO|trainer.py:570] 2024-04-29 02:10:11,904 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:10:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:10:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:10:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:10:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:10:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:10:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5504031254980248, 'eval_loss': 0.8425163, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [966, 1105, 1396, 1344, 1375, 1404, 946, 781, 550, 255, 233, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51511228, 'remaining_params': 33506372, 'pruned_model_sparsity': 0.6058889923968684, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 24750}


Iteration:  35%|███▌      | 94/268 [00:18<02:18,  1.26it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<01:44,  1.66it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<01:20,  2.14it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<01:03,  2.69it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:51,  3.28it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:43,  3.87it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:38,  4.40it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:34,  4.89it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:31,  5.26it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:29,  5.67it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:27,  5.93it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:27,  6.04it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:26,  6.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.31it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.40it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:25,  6.32it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.32it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.34it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.31it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.38it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.36it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:23,  6.30it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.31it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.39it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.54it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:22,  6.39it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.45it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.42it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.38it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.32it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:21,  6.27it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.38it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.40it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.42it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:20,  6.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:19,  6.44it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:19,  6.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:18,  6.59it/s][A[INFO|trainer.py:570] 2024-04-29 02:10:21,781 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:10:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:10:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:10:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:10:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:10:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:10:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5627577880793446, 'eval_loss': 0.82153416, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1107, 1398, 1345, 1376, 1405, 947, 783, 553, 256, 235, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51485184, 'remaining_params': 33532416, 'pruned_model_sparsity': 0.6055826558265582, 'expected_sparsity': 0.59954, 'target_sparsity': 0.6, 'step': 24800}


Iteration:  54%|█████▎    | 144/268 [00:28<01:38,  1.26it/s][A04/29/2024 02:10:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 24800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:28<01:14,  1.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:56,  2.15it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:44,  2.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:36,  3.25it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:31,  3.82it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:26,  4.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:24,  4.85it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:22,  5.22it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:20,  5.61it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:19,  5.71it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:19,  5.88it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:18,  6.08it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:18,  6.13it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.26it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.33it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.41it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.41it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.48it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.51it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.51it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.54it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.55it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.51it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.37it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.29it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.36it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.54it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.46it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:14,  6.42it/s][A
Iteration:  66%|██████▋   | 178/268 [00:33<00:14,  6.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.38it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.31it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.38it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.42it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.45it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.51it/s][A
Iteration:  71%|███████   | 190/268 [00:35<00:12,  6.34it/s][A
Iteration:  71%|███████▏  | 191/268 [00:36<00:12,  6.41it/s][A
Iteration:  72%|███████▏  | 192/268 [00:36<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:36<00:11,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 02:10:31,665 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:10:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:10:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:10:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:10:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:10:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:10:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.557882735147727, 'eval_loss': 0.830861, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1103, 1395, 1342, 1373, 1402, 943, 779, 547, 252, 230, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51547996, 'remaining_params': 33469604, 'pruned_model_sparsity': 0.6063214675549533, 'expected_sparsity': 0.60089, 'target_sparsity': 0.6, 'step': 24850}


Iteration:  72%|███████▏  | 194/268 [00:38<00:58,  1.26it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:44,  1.66it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:33,  2.12it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:26,  2.68it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:21,  3.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:18,  3.82it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:15,  4.37it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:14,  4.75it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:12,  5.15it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:11,  5.46it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:11,  5.72it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  5.94it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:10,  6.14it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.28it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.28it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.34it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.42it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.36it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.45it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.55it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:07,  6.53it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.56it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.68it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.53it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:07,  6.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.47it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.29it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.24it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.16it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.33it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.38it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.40it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:44<00:05,  6.47it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.50it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 240/268 [00:45<00:04,  6.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:45<00:04,  6.47it/s][A
Iteration:  90%|█████████ | 242/268 [00:46<00:04,  6.46it/s][A
Iteration:  91%|█████████ | 243/268 [00:46<00:03,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 02:10:41,580 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:10:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:10:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:10:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:10:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:10:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:10:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5585444842667642, 'eval_loss': 0.82360774, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1107, 1399, 1345, 1377, 1405, 947, 783, 556, 262, 242, 365], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51269172, 'remaining_params': 33748428, 'pruned_model_sparsity': 0.6030418642728094, 'expected_sparsity': 0.5987, 'target_sparsity': 0.6, 'step': 24900}


Iteration:  91%|█████████ | 244/268 [00:48<00:19,  1.25it/s][A04/29/2024 02:10:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 24900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:48<00:13,  1.65it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:10,  2.12it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:07,  2.66it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:06,  3.23it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:04,  3.80it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:04,  4.35it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:03,  4.81it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:03,  5.23it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  5.56it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  5.79it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.07it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.21it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.11it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.12it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.22it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.24it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.23it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.31it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.41it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.40it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.44it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.82it/s][A04/29/2024 02:10:47 - INFO - trainer.trainer_mod_2 - Epoch 92 finished. Took 52.23 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  93%|█████████▎| 93/100 [1:22:21<06:11, 53.04s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.42it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.35it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.40it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.58it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:41,  6.36it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:39,  6.48it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:39,  6.46it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.51it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.42it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.44it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.53it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.51it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.61it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.61it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.57it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.44it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.44it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.38it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 02:10:51,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:10:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:10:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:10:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:10:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:10:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:10:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5474713423103301, 'eval_loss': 0.8336862, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1104, 1396, 1342, 1374, 1403, 943, 779, 549, 252, 230, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51535740, 'remaining_params': 33481860, 'pruned_model_sparsity': 0.606177309168925, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 24950}


Iteration:  10%|▉         | 26/268 [00:06<03:12,  1.26it/s][A
Iteration:  10%|█         | 27/268 [00:06<02:25,  1.66it/s][A
Iteration:  10%|█         | 28/268 [00:06<01:52,  2.13it/s][A
Iteration:  11%|█         | 29/268 [00:06<01:29,  2.67it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:13,  3.25it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:02,  3.77it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:54,  4.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:48,  4.80it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:44,  5.22it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:42,  5.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:40,  5.74it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:38,  5.95it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:37,  6.14it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:37,  6.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.29it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:35,  6.42it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.50it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.44it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.50it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.43it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.45it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.47it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:32,  6.55it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:32,  6.68it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:32,  6.66it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.41it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:31,  6.55it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:31,  6.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.53it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.57it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.67it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.51it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.55it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.48it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.41it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.44it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.50it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.50it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.54it/s][A[INFO|trainer.py:570] 2024-04-29 02:11:01,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:11:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:11:01 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:11:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:11:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.88it/s]04/29/2024 02:11:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:11:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5442538936990396, 'eval_loss': 0.8428067, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [965, 1104, 1396, 1343, 1374, 1403, 943, 779, 550, 254, 232, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51528080, 'remaining_params': 33489520, 'pruned_model_sparsity': 0.6060872101776573, 'expected_sparsity': 0.60032, 'target_sparsity': 0.6, 'step': 25000}


Iteration:  28%|██▊       | 76/268 [00:15<02:32,  1.26it/s][A04/29/2024 02:11:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 25000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:16<01:55,  1.66it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<01:29,  2.12it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<01:11,  2.64it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:58,  3.19it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:49,  3.78it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:42,  4.34it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:38,  4.82it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:35,  5.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:33,  5.53it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:32,  5.66it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:30,  5.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:29,  6.08it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.24it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:28,  6.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.50it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:26,  6.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:26,  6.53it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.63it/s][A
Iteration:  35%|███▌      | 95/268 [00:18<00:26,  6.63it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.54it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.45it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.60it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.63it/s][A
Iteration:  38%|███▊      | 102/268 [00:19<00:25,  6.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.58it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.38it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.44it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:24,  6.49it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.53it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.55it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.54it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:25,  6.07it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.23it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:24,  6.26it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.34it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.34it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:23,  6.32it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:23,  6.26it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:23,  6.22it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:23,  6.26it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 02:11:11,189 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:11:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:11:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:11:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:11:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 02:11:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:11:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.542244787638552, 'eval_loss': 0.840038, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1107, 1399, 1345, 1376, 1406, 946, 783, 555, 258, 236, 359], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.59931, 'target_sparsity': 0.6, 'step': 25050}


Iteration:  47%|████▋     | 126/268 [00:25<01:53,  1.25it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<01:25,  1.66it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<01:06,  2.12it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:52,  2.62it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:43,  3.20it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:36,  3.78it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:31,  4.27it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:28,  4.78it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:25,  5.21it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:23,  5.62it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:22,  5.89it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:21,  5.98it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.34it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.44it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.36it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.39it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.53it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:17,  6.68it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.74it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.70it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.64it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.52it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.66it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.54it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.37it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.35it/s][A
Iteration:  59%|█████▉    | 159/268 [00:30<00:17,  6.40it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.38it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.46it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.40it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.38it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:16,  6.21it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.33it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.38it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.35it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.34it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.33it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.27it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:15,  6.19it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.30it/s][A[INFO|trainer.py:570] 2024-04-29 02:11:21,097 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:11:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:11:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:11:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:11:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.87it/s]04/29/2024 02:11:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:11:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5474713423103301, 'eval_loss': 0.8383307, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [964, 1103, 1395, 1342, 1373, 1403, 941, 778, 548, 252, 229, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51547996, 'remaining_params': 33469604, 'pruned_model_sparsity': 0.6063214675549533, 'expected_sparsity': 0.60089, 'target_sparsity': 0.6, 'step': 25100}


Iteration:  66%|██████▌   | 176/268 [00:35<01:13,  1.25it/s][A04/29/2024 02:11:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 25100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:35<00:55,  1.63it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:42,  2.11it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:33,  2.63it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:27,  3.20it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:23,  3.78it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:19,  4.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:17,  4.83it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:16,  5.23it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:14,  5.57it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:14,  5.83it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:13,  5.89it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:13,  6.08it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.14it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.32it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.51it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.49it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:10,  6.62it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.59it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.73it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.64it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.59it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.64it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.51it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.45it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:08,  6.62it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.61it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.60it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.56it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.54it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.51it/s][A
Iteration:  81%|████████  | 216/268 [00:41<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:08,  6.33it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.47it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.45it/s][A
Iteration:  83%|████████▎ | 222/268 [00:42<00:07,  6.46it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.48it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 02:11:30,932 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:11:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:11:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:11:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:11:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:11:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:11:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5497693861041112, 'eval_loss': 0.8370061, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1108, 1400, 1346, 1376, 1406, 944, 783, 556, 260, 239, 365], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 4, 4, 10], 'pruned_params': 51267640, 'remaining_params': 33749960, 'pruned_model_sparsity': 0.6030238444745558, 'expected_sparsity': 0.5988, 'target_sparsity': 0.6, 'step': 25150}


Iteration:  84%|████████▍ | 226/268 [00:45<00:33,  1.25it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:24,  1.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:18,  2.13it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:14,  2.68it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:11,  3.22it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:09,  3.77it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:08,  4.32it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:07,  4.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:06,  5.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  5.57it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:05,  5.69it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:05,  5.92it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.12it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.05it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.23it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.34it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.43it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.49it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.48it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.39it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:49<00:02,  6.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.49it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.51it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.45it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.48it/s][A
Iteration:  97%|█████████▋| 260/268 [00:50<00:01,  6.43it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.46it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.42it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:51<00:00,  6.53it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.85it/s][A04/29/2024 02:11:39 - INFO - trainer.trainer_mod_2 - Epoch 93 finished. Took 52.12 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.14it/s]
Epoch:  94%|█████████▍| 94/100 [1:23:13<05:16, 52.77s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:40,  6.62it/s][A
Iteration:   1%|          | 2/268 [00:00<00:40,  6.61it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.50it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.43it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.38it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.40it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.48it/s][A[INFO|trainer.py:570] 2024-04-29 02:11:40,780 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:11:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:11:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:11:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:11:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:11:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:11:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5558086597524818, 'eval_loss': 0.8471744, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1105, 1398, 1343, 1374, 1403, 941, 779, 550, 251, 229, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51526548, 'remaining_params': 33491052, 'pruned_model_sparsity': 0.6060691903794038, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 25200}


Iteration:   3%|▎         | 8/268 [00:03<03:37,  1.19it/s][A04/29/2024 02:11:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 25200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:41,  1.60it/s][A
Iteration:   4%|▎         | 10/268 [00:03<02:03,  2.09it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:37,  2.63it/s][A
Iteration:   4%|▍         | 12/268 [00:04<01:20,  3.20it/s][A
Iteration:   5%|▍         | 13/268 [00:04<01:07,  3.78it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:58,  4.34it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:52,  4.78it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:49,  5.11it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:45,  5.54it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:43,  5.69it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:41,  5.94it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:40,  6.13it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:39,  6.22it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:38,  6.45it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.48it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.50it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:37,  6.43it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.28it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.30it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.24it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.32it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.31it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.31it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:37,  6.34it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.42it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:36,  6.41it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.33it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.44it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.60it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.60it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:33,  6.62it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.52it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.35it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.35it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.25it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.32it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.44it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.44it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.46it/s][A[INFO|trainer.py:570] 2024-04-29 02:11:50,719 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:11:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:11:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:11:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:11:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:11:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:11:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5609903802347734, 'eval_loss': 0.84230715, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1105, 1398, 1343, 1374, 1403, 940, 778, 549, 252, 229, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51531144, 'remaining_params': 33486456, 'pruned_model_sparsity': 0.6061232497741644, 'expected_sparsity': 0.60054, 'target_sparsity': 0.6, 'step': 25250}


Iteration:  22%|██▏       | 58/268 [00:13<02:47,  1.25it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<02:06,  1.65it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<01:37,  2.13it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<01:17,  2.67it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<01:03,  3.24it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:53,  3.82it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:46,  4.36it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:42,  4.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:39,  5.10it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:36,  5.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:35,  5.65it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:33,  5.91it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:32,  6.08it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:31,  6.24it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:31,  6.30it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.44it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:29,  6.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:28,  6.65it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:28,  6.63it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:28,  6.62it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:28,  6.60it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.48it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:28,  6.51it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.41it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.42it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.36it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.42it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.55it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.50it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.43it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.39it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.43it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:26,  6.55it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:25,  6.65it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:25,  6.63it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:25,  6.57it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.60it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.61it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:24,  6.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:24,  6.65it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:24,  6.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.41it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 02:12:00,569 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:12:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:12:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:12:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:12:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:12:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:12:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5520779858808869, 'eval_loss': 0.836905, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [971, 1109, 1401, 1346, 1376, 1406, 944, 782, 556, 257, 235, 361], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51466800, 'remaining_params': 33550800, 'pruned_model_sparsity': 0.6053664182475158, 'expected_sparsity': 0.5991, 'target_sparsity': 0.6, 'step': 25300}


Iteration:  40%|████      | 108/268 [00:23<02:08,  1.25it/s][A04/29/2024 02:12:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 25300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:23<01:36,  1.64it/s][A
Iteration:  41%|████      | 110/268 [00:23<01:14,  2.11it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:59,  2.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:48,  3.22it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:40,  3.80it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:35,  4.36it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:31,  4.80it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:29,  5.20it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:27,  5.46it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:26,  5.67it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:25,  5.92it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:24,  6.10it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.23it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.51it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:21,  6.55it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:21,  6.54it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:21,  6.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.05it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:22,  6.21it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.31it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.36it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.43it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.58it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.59it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.58it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.50it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.49it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.61it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.55it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:18,  6.58it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.49it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.42it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:18,  6.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.46it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.58it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.59it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.49it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.55it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.55it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:16,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 02:12:10,443 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:12:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:12:10 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:12:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:12:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 02:12:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:12:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5494735380761103, 'eval_loss': 0.8377938, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1105, 1398, 1343, 1374, 1404, 941, 779, 549, 251, 228, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51528080, 'remaining_params': 33489520, 'pruned_model_sparsity': 0.6060872101776573, 'expected_sparsity': 0.60058, 'target_sparsity': 0.6, 'step': 25350}


Iteration:  59%|█████▉    | 158/268 [00:33<01:28,  1.25it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<01:06,  1.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:50,  2.13it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:39,  2.69it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:32,  3.26it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:27,  3.84it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:23,  4.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:21,  4.83it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:19,  5.25it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:18,  5.47it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:17,  5.85it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:16,  6.12it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:15,  6.24it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:15,  6.42it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:15,  6.27it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.45it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.49it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.52it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.50it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:13,  6.53it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:13,  6.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.52it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:12,  6.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:12,  6.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.54it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.63it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.48it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.36it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.33it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.22it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.19it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.25it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.42it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.28it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.39it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:10,  6.47it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.40it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 02:12:20,335 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:12:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:12:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:12:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:12:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:12:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:12:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5465839960451542, 'eval_loss': 0.83847463, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1107, 1400, 1344, 1376, 1405, 943, 781, 553, 254, 232, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 25400}


Iteration:  78%|███████▊  | 208/268 [00:42<00:48,  1.25it/s][A04/29/2024 02:12:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 25400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:43<00:36,  1.64it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:27,  2.09it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:21,  2.64it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:17,  3.24it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:14,  3.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:12,  4.22it/s][A
Iteration:  80%|████████  | 215/268 [00:44<00:11,  4.78it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:10,  5.12it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:09,  5.55it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  5.88it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:08,  6.05it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.20it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.42it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  6.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.45it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.41it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.58it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.57it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.57it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.62it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.59it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.65it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.70it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.68it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:03,  6.53it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.43it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.53it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.36it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.41it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.23it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.08it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.18it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.27it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 02:12:30,237 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:12:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:12:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:12:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:12:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:12:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:12:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5517964161621091, 'eval_loss': 0.8388155, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1107, 1401, 1345, 1376, 1406, 943, 781, 553, 252, 229, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51491312, 'remaining_params': 33526288, 'pruned_model_sparsity': 0.6056547350195725, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 25450}


Iteration:  96%|█████████▋| 258/268 [00:52<00:08,  1.25it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:05,  1.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:03,  2.12it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:02,  2.64it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  3.19it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:01,  3.76it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  4.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  4.78it/s][A
Iteration:  99%|█████████▉| 266/268 [00:54<00:00,  5.21it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  5.43it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  5.97it/s][A04/29/2024 02:12:33 - INFO - trainer.trainer_mod_2 - Epoch 94 finished. Took 54.38 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch:  95%|█████████▌| 95/100 [1:24:08<04:26, 53.25s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.84it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.47it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:41,  6.30it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:41,  6.41it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.45it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.49it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.48it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.32it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.37it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.45it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.30it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.39it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.46it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.47it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:38,  6.47it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:38,  6.47it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:37,  6.50it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:38,  6.33it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:37,  6.50it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.53it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.54it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.57it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.49it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.52it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:36,  6.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:35,  6.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:35,  6.53it/s][A
Iteration:  13%|█▎        | 36/268 [00:05<00:35,  6.52it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:35,  6.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:35,  6.52it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:34,  6.65it/s][A[INFO|trainer.py:570] 2024-04-29 02:12:40,095 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:12:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:12:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:12:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:12:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.78it/s]04/29/2024 02:12:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:12:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5546789239242798, 'eval_loss': 0.8343392, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [967, 1105, 1399, 1343, 1374, 1404, 941, 779, 550, 250, 228, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51525016, 'remaining_params': 33492584, 'pruned_model_sparsity': 0.6060511705811502, 'expected_sparsity': 0.60056, 'target_sparsity': 0.6, 'step': 25500}


Iteration:  15%|█▍        | 40/268 [00:08<03:01,  1.26it/s][A04/29/2024 02:12:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 25500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:08<02:16,  1.66it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<01:44,  2.15it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<01:24,  2.66it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<01:09,  3.23it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:58,  3.81it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:51,  4.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:47,  4.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:42,  5.13it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:39,  5.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:37,  5.83it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:36,  5.93it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:35,  6.01it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:34,  6.15it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:34,  6.22it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.32it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.39it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.47it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:32,  6.21it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.38it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:31,  6.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:31,  6.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:31,  6.36it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.42it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.40it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:29,  6.49it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.58it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.32it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.25it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:29,  6.25it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.47it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:28,  6.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.53it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 02:12:50,036 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:12:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:12:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:12:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:12:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:12:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:12:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5515294062595535, 'eval_loss': 0.8378198, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [971, 1108, 1402, 1345, 1377, 1406, 944, 782, 556, 255, 235, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.59921, 'target_sparsity': 0.6, 'step': 25550}


Iteration:  34%|███▎      | 90/268 [00:18<02:22,  1.25it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<01:47,  1.65it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<01:23,  2.11it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<01:06,  2.65it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:54,  3.22it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:47,  3.64it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:41,  4.19it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:36,  4.65it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:33,  5.10it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:31,  5.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:29,  5.75it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:28,  5.80it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:28,  5.89it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:27,  5.97it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.25it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:26,  6.24it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:25,  6.34it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:25,  6.29it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.46it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.37it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:22,  6.60it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:22,  6.57it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:22,  6.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.59it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.42it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.43it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:22,  6.48it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:22,  6.36it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.39it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:20,  6.54it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:20,  6.51it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:20,  6.53it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.47it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.38it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:20,  6.46it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:20,  6.49it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:20,  6.39it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:19,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 02:12:59,984 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:12:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:12:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:12:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:13:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.83it/s]04/29/2024 02:13:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:13:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5552849676135797, 'eval_loss': 0.83443314, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1106, 1400, 1343, 1375, 1405, 942, 779, 552, 251, 228, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51512760, 'remaining_params': 33504840, 'pruned_model_sparsity': 0.605907012195122, 'expected_sparsity': 0.60038, 'target_sparsity': 0.6, 'step': 25600}


Iteration:  52%|█████▏    | 140/268 [00:28<01:42,  1.25it/s][A04/29/2024 02:13:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 25600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:28<01:16,  1.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:59,  2.13it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:46,  2.66it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:38,  3.24it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:32,  3.77it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:28,  4.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:25,  4.80it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:23,  5.18it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:21,  5.53it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:20,  5.80it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:19,  6.11it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.22it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.34it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.32it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.31it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:16,  6.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.53it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.54it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.53it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.35it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.47it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.53it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.64it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.63it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.44it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:14,  6.57it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:14,  6.54it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:14,  6.56it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:14,  6.59it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.49it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.50it/s][A
Iteration:  66%|██████▌   | 177/268 [00:33<00:13,  6.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:13,  6.60it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:13,  6.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.39it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:13,  6.36it/s][A
Iteration:  69%|██████▊   | 184/268 [00:34<00:13,  6.33it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:35<00:12,  6.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:35<00:12,  6.61it/s][A
Iteration:  70%|███████   | 188/268 [00:35<00:12,  6.51it/s][A
Iteration:  71%|███████   | 189/268 [00:35<00:12,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 02:13:09,825 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:13:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:13:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:13:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:13:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.75it/s]04/29/2024 02:13:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:13:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5601668097291345, 'eval_loss': 0.83072174, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1106, 1400, 1344, 1376, 1405, 942, 780, 553, 252, 229, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 25650}


Iteration:  71%|███████   | 190/268 [00:38<01:02,  1.25it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:46,  1.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:35,  2.11it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:28,  2.65it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:22,  3.22it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:19,  3.78it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:16,  4.28it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:14,  4.75it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:13,  5.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:12,  5.62it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:11,  5.95it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:11,  6.00it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.16it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.26it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.31it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.52it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.48it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.36it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.46it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.49it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.36it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.32it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.38it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:08,  6.14it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.33it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.47it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:07,  6.52it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.57it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.53it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.50it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.45it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.41it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.47it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.39it/s][A
Iteration:  88%|████████▊ | 236/268 [00:45<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:45<00:04,  6.51it/s][A
Iteration:  89%|████████▉ | 238/268 [00:45<00:04,  6.45it/s][A
Iteration:  89%|████████▉ | 239/268 [00:45<00:04,  6.36it/s][A[INFO|trainer.py:570] 2024-04-29 02:13:19,743 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:13:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:13:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:13:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:13:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:13:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:13:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5497693861041112, 'eval_loss': 0.8246094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [971, 1108, 1402, 1345, 1377, 1407, 943, 781, 555, 252, 229, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51479056, 'remaining_params': 33538544, 'pruned_model_sparsity': 0.6055105766335441, 'expected_sparsity': 0.5997, 'target_sparsity': 0.6, 'step': 25700}


Iteration:  90%|████████▉ | 240/268 [00:47<00:22,  1.24it/s][A04/29/2024 02:13:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 25700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:48<00:16,  1.64it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:12,  2.11it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:09,  2.64it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:07,  3.19it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:06,  3.77it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:05,  4.31it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:04,  4.70it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  5.11it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  5.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:03,  5.78it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  5.97it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.25it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.21it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.35it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.36it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.44it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.35it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.40it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.54it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.46it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.52it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.48it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.85it/s][A04/29/2024 02:13:26 - INFO - trainer.trainer_mod_2 - Epoch 95 finished. Took 52.28 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  96%|█████████▌| 96/100 [1:25:00<03:31, 52.96s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:43,  6.17it/s][A
Iteration:   1%|          | 2/268 [00:00<00:43,  6.14it/s][A
Iteration:   1%|          | 3/268 [00:00<00:41,  6.37it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.57it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.67it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:38,  6.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:39,  6.67it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:38,  6.73it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:38,  6.67it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:38,  6.62it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:38,  6.59it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:38,  6.65it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:38,  6.60it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:38,  6.58it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:38,  6.50it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.54it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:37,  6.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:37,  6.57it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:37,  6.54it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:37,  6.55it/s][A[INFO|trainer.py:570] 2024-04-29 02:13:29,549 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:13:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:13:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:13:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:13:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:13:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:13:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5588956079971924, 'eval_loss': 0.8241448, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1106, 1400, 1343, 1375, 1405, 941, 779, 551, 251, 227, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51515824, 'remaining_params': 33501776, 'pruned_model_sparsity': 0.605943051791629, 'expected_sparsity': 0.60044, 'target_sparsity': 0.6, 'step': 25750}


Iteration:   8%|▊         | 22/268 [00:05<03:15,  1.26it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:27,  1.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:53,  2.14it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:31,  2.65it/s][A
Iteration:  10%|▉         | 26/268 [00:06<01:15,  3.19it/s][A
Iteration:  10%|█         | 27/268 [00:06<01:03,  3.80it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:55,  4.34it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:49,  4.81it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:45,  5.21it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:43,  5.48it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:41,  5.72it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:39,  5.88it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:39,  6.00it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:38,  6.08it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:37,  6.20it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:37,  6.20it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:36,  6.28it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.22it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.41it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:34,  6.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:35,  6.29it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.29it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.34it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.53it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.47it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.41it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:10<00:33,  6.38it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:33,  6.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.41it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.52it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.63it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.62it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.63it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.56it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.57it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:12<00:30,  6.46it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.41it/s][A[INFO|trainer.py:570] 2024-04-29 02:13:39,476 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:13:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:13:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:13:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:13:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.76it/s]04/29/2024 02:13:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:13:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5526838482765232, 'eval_loss': 0.826709, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [971, 1108, 1402, 1345, 1377, 1407, 943, 782, 556, 254, 231, 357], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.59951, 'target_sparsity': 0.6, 'step': 25800}


Iteration:  27%|██▋       | 72/268 [00:15<02:36,  1.25it/s][A04/29/2024 02:13:41 - INFO - trainer.trainer_mod_2 - v4 Global step: 25800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:15<01:58,  1.65it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<01:31,  2.13it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<01:12,  2.67it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:59,  3.25it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:50,  3.80it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:44,  4.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:39,  4.76it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:36,  5.19it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:35,  5.24it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:33,  5.56it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:32,  5.75it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:30,  5.96it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:29,  6.19it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:28,  6.35it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:28,  6.35it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.30it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.30it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.30it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.29it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.49it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.52it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.51it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.56it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.53it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:24,  6.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.57it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.46it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.48it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.51it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.56it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:23,  6.55it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.57it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.48it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.37it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 02:13:49,388 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:13:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:13:49 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:13:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:13:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.83it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:13:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:13:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5481326292844919, 'eval_loss': 0.8438739, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1107, 1401, 1344, 1377, 1406, 942, 780, 554, 251, 230, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51495908, 'remaining_params': 33521692, 'pruned_model_sparsity': 0.605708794414333, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 25850}


Iteration:  46%|████▌     | 122/268 [00:25<01:56,  1.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<01:28,  1.65it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<01:08,  2.10it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:54,  2.63it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:44,  3.23it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:37,  3.80it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:32,  4.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:29,  4.66it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:27,  5.10it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:25,  5.46it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:23,  5.83it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:22,  6.03it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:21,  6.16it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:21,  6.20it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:21,  6.27it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.33it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.32it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:20,  6.35it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:20,  6.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.26it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.30it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.37it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.51it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.54it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.53it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.65it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:17,  6.60it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.46it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.36it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.32it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:17,  6.41it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.47it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.36it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.54it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.36it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.43it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.44it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.45it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.46it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.40it/s][A
Iteration:  64%|██████▍   | 171/268 [00:32<00:15,  6.40it/s][A[INFO|trainer.py:570] 2024-04-29 02:13:59,318 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:13:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:13:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:13:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:13:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:14:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:14:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5526838482765232, 'eval_loss': 0.8307832, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [968, 1106, 1400, 1342, 1375, 1405, 940, 778, 552, 249, 229, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51518888, 'remaining_params': 33498712, 'pruned_model_sparsity': 0.6059790913881361, 'expected_sparsity': 0.60044, 'target_sparsity': 0.6, 'step': 25900}


Iteration:  64%|██████▍   | 172/268 [00:35<01:16,  1.26it/s][A04/29/2024 02:14:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 25900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:35<00:57,  1.65it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:44,  2.13it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:35,  2.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:28,  3.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:24,  3.79it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:20,  4.37it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:18,  4.92it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:16,  5.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:15,  5.60it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:14,  5.80it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:14,  5.88it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.08it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:13,  6.22it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:13,  6.23it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.26it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.35it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.42it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:12,  6.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.39it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.44it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:10,  6.60it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.58it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.23it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.19it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.26it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.28it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.24it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:10,  6.31it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:10,  6.28it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.24it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.32it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.39it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:09,  6.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.48it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.59it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.49it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.51it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.46it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.56it/s][A[INFO|trainer.py:570] 2024-04-29 02:14:09,225 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:14:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:14:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:14:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:14:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:14:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:14:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5598704865754364, 'eval_loss': 0.81989455, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [972, 1108, 1403, 1345, 1378, 1407, 942, 781, 557, 253, 234, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51468332, 'remaining_params': 33549268, 'pruned_model_sparsity': 0.6053844380457694, 'expected_sparsity': 0.59932, 'target_sparsity': 0.6, 'step': 25950}


Iteration:  83%|████████▎ | 222/268 [00:45<00:36,  1.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:27,  1.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:20,  2.12it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:16,  2.66it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:12,  3.23it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:10,  3.75it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:09,  4.29it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:08,  4.82it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:07,  5.24it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:06,  5.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:06,  5.82it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  5.92it/s][A
Iteration:  87%|████████▋ | 234/268 [00:47<00:05,  6.17it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.30it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.46it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.47it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.29it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.40it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.32it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.49it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.54it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.62it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.50it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.44it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.26it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.48it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.47it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:01,  6.59it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.64it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.55it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.57it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.70it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.73it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.65it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.49it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.60it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.95it/s][A04/29/2024 02:14:18 - INFO - trainer.trainer_mod_2 - Epoch 96 finished. Took 52.21 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  97%|█████████▋| 97/100 [1:25:52<02:38, 52.74s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.70it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 02:14:19,025 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:14:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:14:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:14:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:14:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:14:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:14:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5504031254980248, 'eval_loss': 0.8266385, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1106, 1401, 1344, 1376, 1406, 940, 779, 553, 249, 229, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51505100, 'remaining_params': 33512500, 'pruned_model_sparsity': 0.6058169132038542, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 26000}


Iteration:   1%|▏         | 4/268 [00:02<04:23,  1.00it/s][A04/29/2024 02:14:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 26000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<03:02,  1.44it/s][A
Iteration:   2%|▏         | 6/268 [00:03<02:13,  1.96it/s][A
Iteration:   3%|▎         | 7/268 [00:03<01:42,  2.55it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:22,  3.15it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:08,  3.76it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:00,  4.28it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:52,  4.85it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:49,  5.15it/s][A
Iteration:   5%|▍         | 13/268 [00:04<00:46,  5.49it/s][A
Iteration:   5%|▌         | 14/268 [00:04<00:43,  5.78it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:43,  5.87it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.90it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:41,  6.05it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.19it/s][A
Iteration:   7%|▋         | 19/268 [00:05<00:39,  6.31it/s][A
Iteration:   7%|▋         | 20/268 [00:05<00:38,  6.38it/s][A
Iteration:   8%|▊         | 21/268 [00:05<00:38,  6.42it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:39,  6.30it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.38it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:37,  6.43it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:38,  6.29it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:38,  6.25it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:38,  6.23it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:38,  6.25it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:37,  6.35it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:37,  6.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.41it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.45it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:35,  6.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:35,  6.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.46it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:36,  6.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:36,  6.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:36,  6.32it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:36,  6.30it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:33,  6.63it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:34,  6.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:33,  6.55it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:33,  6.57it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:33,  6.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:33,  6.61it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:33,  6.59it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:32,  6.61it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:33,  6.51it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.51it/s][A[INFO|trainer.py:570] 2024-04-29 02:14:28,954 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:14:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:14:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:14:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:14:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 02:14:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:14:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5566616521972554, 'eval_loss': 0.84559387, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1106, 1402, 1344, 1377, 1406, 940, 780, 554, 249, 229, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.60012, 'target_sparsity': 0.6, 'step': 26050}


Iteration:  20%|██        | 54/268 [00:12<02:51,  1.25it/s][A
Iteration:  21%|██        | 55/268 [00:12<02:08,  1.66it/s][A
Iteration:  21%|██        | 56/268 [00:12<01:39,  2.14it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<01:18,  2.70it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<01:04,  3.27it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:54,  3.86it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:47,  4.42it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:42,  4.92it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:38,  5.33it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:36,  5.57it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:35,  5.82it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:34,  5.94it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:33,  6.02it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:33,  6.05it/s][A
Iteration:  25%|██▌       | 68/268 [00:14<00:32,  6.09it/s][A
Iteration:  26%|██▌       | 69/268 [00:14<00:31,  6.24it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:31,  6.22it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:31,  6.34it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:31,  6.29it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:30,  6.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:29,  6.47it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:31,  6.20it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:29,  6.42it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:29,  6.48it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:29,  6.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:29,  6.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:29,  6.46it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:28,  6.47it/s][A
Iteration:  31%|███       | 82/268 [00:16<00:28,  6.51it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.55it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:27,  6.58it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.61it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.58it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.56it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.48it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.33it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:26,  6.48it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.37it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.39it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.42it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:26,  6.40it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.58it/s][A[INFO|trainer.py:570] 2024-04-29 02:14:38,808 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:14:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:14:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:14:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:14:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 02:14:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:14:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.55334515793579, 'eval_loss': 0.8331787, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [971, 1108, 1404, 1345, 1378, 1408, 941, 782, 556, 249, 229, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 26100}


Iteration:  39%|███▉      | 104/268 [00:22<02:10,  1.26it/s][A04/29/2024 02:14:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 26100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:22<01:38,  1.66it/s][A
Iteration:  40%|███▉      | 106/268 [00:22<01:15,  2.14it/s][A
Iteration:  40%|███▉      | 107/268 [00:22<01:00,  2.68it/s][A
Iteration:  40%|████      | 108/268 [00:23<00:49,  3.26it/s][A
Iteration:  41%|████      | 109/268 [00:23<00:42,  3.76it/s][A
Iteration:  41%|████      | 110/268 [00:23<00:36,  4.36it/s][A
Iteration:  41%|████▏     | 111/268 [00:23<00:32,  4.79it/s][A
Iteration:  42%|████▏     | 112/268 [00:23<00:29,  5.20it/s][A
Iteration:  42%|████▏     | 113/268 [00:23<00:28,  5.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:24<00:26,  5.78it/s][A
Iteration:  43%|████▎     | 115/268 [00:24<00:25,  5.93it/s][A
Iteration:  43%|████▎     | 116/268 [00:24<00:25,  6.01it/s][A
Iteration:  44%|████▎     | 117/268 [00:24<00:24,  6.15it/s][A
Iteration:  44%|████▍     | 118/268 [00:24<00:24,  6.21it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<00:23,  6.33it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<00:23,  6.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:23,  6.31it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:23,  6.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:22,  6.51it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:22,  6.45it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:22,  6.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:22,  6.44it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:21,  6.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:21,  6.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:21,  6.50it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:21,  6.54it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:20,  6.57it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:20,  6.58it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:20,  6.56it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.47it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.48it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.52it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:19,  6.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:19,  6.62it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:19,  6.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.67it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:18,  6.73it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:18,  6.71it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:18,  6.64it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:19,  6.49it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.51it/s][A
Iteration:  54%|█████▍    | 146/268 [00:28<00:18,  6.62it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.54it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:17,  6.57it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.45it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:17,  6.51it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:17,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 02:14:48,631 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:14:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:14:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:14:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:14:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.85it/s]04/29/2024 02:14:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:14:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5536960643334261, 'eval_loss': 0.83356696, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1106, 1402, 1344, 1377, 1406, 940, 780, 553, 248, 228, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51502036, 'remaining_params': 33515564, 'pruned_model_sparsity': 0.6057808736073472, 'expected_sparsity': 0.60032, 'target_sparsity': 0.6, 'step': 26150}


Iteration:  57%|█████▋    | 154/268 [00:32<01:30,  1.26it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<01:07,  1.67it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:52,  2.14it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:41,  2.68it/s][A
Iteration:  59%|█████▉    | 158/268 [00:32<00:33,  3.26it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:28,  3.83it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:24,  4.39it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:21,  4.87it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:20,  5.26it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:18,  5.69it/s][A
Iteration:  61%|██████    | 164/268 [00:33<00:17,  5.90it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:16,  6.19it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:17,  5.91it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:16,  6.11it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:16,  6.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:34<00:15,  6.41it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:14,  6.58it/s][A
Iteration:  64%|██████▍   | 171/268 [00:34<00:14,  6.61it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:14,  6.58it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:14,  6.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:14,  6.53it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:14,  6.54it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:14,  6.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:14,  6.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:14,  6.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:14,  6.32it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:13,  6.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:13,  6.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.44it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:36<00:13,  6.43it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.48it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.29it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.37it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.32it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:11,  6.56it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:11,  6.50it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:11,  6.45it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.35it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.54it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.48it/s][A
Iteration:  74%|███████▎  | 197/268 [00:38<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.57it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.54it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.63it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:39<00:09,  6.52it/s][A[INFO|trainer.py:570] 2024-04-29 02:14:58,487 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:14:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:14:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:14:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:14:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:15:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:15:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5536960643334261, 'eval_loss': 0.83172977, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [972, 1107, 1403, 1345, 1379, 1408, 941, 782, 556, 250, 230, 354], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51474460, 'remaining_params': 33543140, 'pruned_model_sparsity': 0.6054565172387835, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 26200}


Iteration:  76%|███████▌  | 204/268 [00:42<00:51,  1.25it/s][A04/29/2024 02:15:00 - INFO - trainer.trainer_mod_2 - v4 Global step: 26200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:42<00:38,  1.65it/s][A
Iteration:  77%|███████▋  | 206/268 [00:42<00:29,  2.13it/s][A
Iteration:  77%|███████▋  | 207/268 [00:42<00:22,  2.66it/s][A
Iteration:  78%|███████▊  | 208/268 [00:42<00:18,  3.20it/s][A
Iteration:  78%|███████▊  | 209/268 [00:42<00:15,  3.74it/s][A
Iteration:  78%|███████▊  | 210/268 [00:43<00:13,  4.21it/s][A
Iteration:  79%|███████▊  | 211/268 [00:43<00:12,  4.66it/s][A
Iteration:  79%|███████▉  | 212/268 [00:43<00:10,  5.15it/s][A
Iteration:  79%|███████▉  | 213/268 [00:43<00:10,  5.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:43<00:09,  5.77it/s][A
Iteration:  80%|████████  | 215/268 [00:43<00:08,  5.98it/s][A
Iteration:  81%|████████  | 216/268 [00:44<00:08,  6.06it/s][A
Iteration:  81%|████████  | 217/268 [00:44<00:08,  6.04it/s][A
Iteration:  81%|████████▏ | 218/268 [00:44<00:08,  6.15it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:07,  6.27it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:07,  6.31it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:07,  6.40it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:07,  6.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:07,  6.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:06,  6.33it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:06,  6.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:06,  6.43it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 228/268 [00:45<00:06,  6.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:05,  6.58it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:05,  6.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.54it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.45it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.48it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.51it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.61it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.58it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.57it/s][A
Iteration:  90%|████████▉ | 241/268 [00:47<00:04,  6.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.27it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.42it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.56it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.59it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.59it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.69it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.63it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.62it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 02:15:08,359 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:15:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:15:08 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:15:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:15:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:15:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:15:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.557882735147727, 'eval_loss': 0.83142877, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [972, 1107, 1404, 1345, 1378, 1408, 941, 781, 555, 248, 228, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51480588, 'remaining_params': 33537012, 'pruned_model_sparsity': 0.6055285964317977, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 26250}


Iteration:  95%|█████████▍| 254/268 [00:52<00:11,  1.26it/s][A
Iteration:  95%|█████████▌| 255/268 [00:52<00:07,  1.66it/s][A
Iteration:  96%|█████████▌| 256/268 [00:52<00:05,  2.13it/s][A
Iteration:  96%|█████████▌| 257/268 [00:52<00:04,  2.66it/s][A
Iteration:  96%|█████████▋| 258/268 [00:52<00:03,  3.22it/s][A
Iteration:  97%|█████████▋| 259/268 [00:52<00:02,  3.79it/s][A
Iteration:  97%|█████████▋| 260/268 [00:53<00:01,  4.33it/s][A
Iteration:  97%|█████████▋| 261/268 [00:53<00:01,  4.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:53<00:01,  5.15it/s][A
Iteration:  98%|█████████▊| 263/268 [00:53<00:00,  5.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:53<00:00,  5.70it/s][A
Iteration:  99%|█████████▉| 265/268 [00:53<00:00,  5.87it/s][A
Iteration:  99%|█████████▉| 266/268 [00:53<00:00,  5.99it/s][A
Iteration: 100%|█████████▉| 267/268 [00:54<00:00,  6.15it/s][A
Iteration: 100%|██████████| 268/268 [00:54<00:00,  6.53it/s][A04/29/2024 02:15:12 - INFO - trainer.trainer_mod_2 - Epoch 97 finished. Took 54.26 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.94it/s]
Epoch:  98%|█████████▊| 98/100 [1:26:47<01:46, 53.19s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.69it/s][A
Iteration:   1%|          | 3/268 [00:00<00:39,  6.64it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:40,  6.46it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:40,  6.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:40,  6.48it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:40,  6.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:40,  6.43it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.44it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:39,  6.49it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.42it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.33it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:39,  6.41it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:39,  6.40it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.45it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:39,  6.41it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:38,  6.42it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:38,  6.48it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:39,  6.33it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:39,  6.20it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:39,  6.22it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:38,  6.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:37,  6.46it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:38,  6.37it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:37,  6.42it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:36,  6.56it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:36,  6.54it/s][A
Iteration:  11%|█         | 29/268 [00:04<00:36,  6.51it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:36,  6.54it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:38,  6.23it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:37,  6.24it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:37,  6.22it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:37,  6.31it/s][A
Iteration:  13%|█▎        | 35/268 [00:05<00:36,  6.39it/s][A[INFO|trainer.py:570] 2024-04-29 02:15:18,294 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:15:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:15:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:15:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:15:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.84it/s]04/29/2024 02:15:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:15:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5601668097291345, 'eval_loss': 0.8342392, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1106, 1402, 1343, 1377, 1406, 939, 779, 553, 247, 228, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51505100, 'remaining_params': 33512500, 'pruned_model_sparsity': 0.6058169132038542, 'expected_sparsity': 0.60034, 'target_sparsity': 0.6, 'step': 26300}


Iteration:  13%|█▎        | 36/268 [00:07<03:05,  1.25it/s][A04/29/2024 02:15:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 26300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:19,  1.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<01:47,  2.13it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<01:25,  2.67it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<01:10,  3.23it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:59,  3.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:52,  4.30it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:47,  4.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:42,  5.29it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:39,  5.63it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:38,  5.76it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:36,  5.97it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:36,  6.06it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:35,  6.21it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.33it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:34,  6.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.26it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.46it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:33,  6.40it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:33,  6.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:32,  6.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.45it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.39it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.36it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.34it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:32,  6.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:32,  6.30it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.41it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:31,  6.42it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:30,  6.46it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:30,  6.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.37it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:30,  6.36it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.43it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:30,  6.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:30,  6.32it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:30,  6.29it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.25it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:29,  6.32it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.36it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.42it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.25it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:28,  6.35it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.42it/s][A[INFO|trainer.py:570] 2024-04-29 02:15:28,226 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:15:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:15:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:15:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:15:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:15:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:15:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5481326292844919, 'eval_loss': 0.844751, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1108, 1405, 1345, 1379, 1408, 942, 782, 557, 251, 232, 356], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51462204, 'remaining_params': 33555396, 'pruned_model_sparsity': 0.6053123588527551, 'expected_sparsity': 0.59938, 'target_sparsity': 0.6, 'step': 26350}


Iteration:  32%|███▏      | 86/268 [00:17<02:25,  1.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<01:49,  1.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<01:24,  2.13it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<01:08,  2.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:55,  3.21it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:47,  3.76it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:40,  4.32it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:36,  4.80it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:33,  5.17it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:30,  5.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:29,  5.86it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:28,  6.07it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:27,  6.18it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:26,  6.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:26,  6.36it/s][A
Iteration:  38%|███▊      | 101/268 [00:20<00:26,  6.27it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:26,  6.22it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:26,  6.32it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:26,  6.30it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.44it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:24,  6.50it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.53it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.45it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.44it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.50it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.48it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:24,  6.45it/s][A
Iteration:  43%|████▎     | 114/268 [00:22<00:23,  6.46it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.40it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:24,  6.33it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.40it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:23,  6.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:23,  6.46it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:22,  6.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:23<00:22,  6.46it/s][A
Iteration:  46%|████▌     | 122/268 [00:23<00:22,  6.60it/s][A
Iteration:  46%|████▌     | 123/268 [00:23<00:22,  6.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:23<00:22,  6.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:24<00:21,  6.58it/s][A
Iteration:  48%|████▊     | 128/268 [00:24<00:21,  6.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:24<00:21,  6.46it/s][A
Iteration:  49%|████▊     | 130/268 [00:24<00:21,  6.51it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:21,  6.44it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:21,  6.44it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:21,  6.40it/s][A
Iteration:  50%|█████     | 134/268 [00:25<00:20,  6.50it/s][A
Iteration:  50%|█████     | 135/268 [00:25<00:20,  6.50it/s][A[INFO|trainer.py:570] 2024-04-29 02:15:38,113 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:15:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:15:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:15:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:15:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.82it/s]04/29/2024 02:15:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:15:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5546789239242798, 'eval_loss': 0.844891, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [971, 1106, 1403, 1343, 1377, 1406, 939, 779, 554, 248, 228, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51500504, 'remaining_params': 33517096, 'pruned_model_sparsity': 0.6057628538090937, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 26400}


Iteration:  51%|█████     | 136/268 [00:27<01:45,  1.25it/s][A04/29/2024 02:15:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 26400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:27<01:19,  1.64it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<01:01,  2.10it/s][A
Iteration:  52%|█████▏    | 139/268 [00:28<00:49,  2.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:40,  3.17it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:33,  3.75it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:29,  4.26it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:26,  4.71it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:24,  5.14it/s][A
Iteration:  54%|█████▍    | 145/268 [00:29<00:22,  5.56it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:21,  5.75it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:20,  5.96it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:19,  6.03it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:19,  6.16it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:19,  6.00it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:18,  6.23it/s][A
Iteration:  57%|█████▋    | 152/268 [00:30<00:18,  6.30it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.30it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:17,  6.40it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.34it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.41it/s][A
Iteration:  59%|█████▉    | 158/268 [00:31<00:17,  6.46it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.60it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.56it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.58it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.40it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.44it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:16,  6.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:32<00:15,  6.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.48it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:32<00:15,  6.61it/s][A
Iteration:  63%|██████▎   | 169/268 [00:32<00:16,  6.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:32<00:15,  6.18it/s][A
Iteration:  64%|██████▍   | 171/268 [00:33<00:15,  6.29it/s][A
Iteration:  64%|██████▍   | 172/268 [00:33<00:15,  6.19it/s][A
Iteration:  65%|██████▍   | 173/268 [00:33<00:15,  6.30it/s][A
Iteration:  65%|██████▍   | 174/268 [00:33<00:15,  6.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:33<00:14,  6.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:33<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:34<00:14,  6.36it/s][A
Iteration:  66%|██████▋   | 178/268 [00:34<00:14,  6.28it/s][A
Iteration:  67%|██████▋   | 179/268 [00:34<00:14,  6.34it/s][A
Iteration:  67%|██████▋   | 180/268 [00:34<00:13,  6.37it/s][A
Iteration:  68%|██████▊   | 181/268 [00:34<00:13,  6.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:34<00:13,  6.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:34<00:12,  6.61it/s][A
Iteration:  69%|██████▊   | 184/268 [00:35<00:12,  6.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:35<00:12,  6.60it/s][A[INFO|trainer.py:570] 2024-04-29 02:15:48,067 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:15:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:15:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:15:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:15:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:15:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:15:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5546789239242798, 'eval_loss': 0.83612835, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1106, 1402, 1342, 1377, 1406, 938, 778, 553, 248, 228, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51509696, 'remaining_params': 33507904, 'pruned_model_sparsity': 0.6058709725986149, 'expected_sparsity': 0.60033, 'target_sparsity': 0.6, 'step': 26450}


Iteration:  69%|██████▉   | 186/268 [00:37<01:05,  1.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:48,  1.66it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:37,  2.14it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:29,  2.68it/s][A
Iteration:  71%|███████   | 190/268 [00:38<00:23,  3.26it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:20,  3.84it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:17,  4.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:15,  4.92it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:13,  5.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:12,  5.62it/s][A
Iteration:  73%|███████▎  | 196/268 [00:39<00:12,  5.86it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.07it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:11,  6.19it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:11,  6.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.47it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.48it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.40it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.42it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.46it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.42it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.51it/s][A
Iteration:  78%|███████▊  | 209/268 [00:41<00:09,  6.55it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.56it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.54it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.56it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.53it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.52it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.38it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:42<00:07,  6.54it/s][A
Iteration:  82%|████████▏ | 219/268 [00:42<00:07,  6.62it/s][A
Iteration:  82%|████████▏ | 220/268 [00:42<00:07,  6.64it/s][A
Iteration:  82%|████████▏ | 221/268 [00:42<00:07,  6.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:43<00:06,  6.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:43<00:06,  6.62it/s][A
Iteration:  84%|████████▎ | 224/268 [00:43<00:06,  6.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:43<00:06,  6.53it/s][A
Iteration:  84%|████████▍ | 226/268 [00:43<00:06,  6.52it/s][A
Iteration:  85%|████████▍ | 227/268 [00:43<00:06,  6.50it/s][A
Iteration:  85%|████████▌ | 228/268 [00:43<00:06,  6.54it/s][A
Iteration:  85%|████████▌ | 229/268 [00:44<00:06,  6.39it/s][A
Iteration:  86%|████████▌ | 230/268 [00:44<00:05,  6.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:44<00:05,  6.27it/s][A
Iteration:  87%|████████▋ | 232/268 [00:44<00:05,  6.29it/s][A
Iteration:  87%|████████▋ | 233/268 [00:44<00:05,  6.36it/s][A
Iteration:  87%|████████▋ | 234/268 [00:44<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 235/268 [00:45<00:05,  6.38it/s][A[INFO|trainer.py:570] 2024-04-29 02:15:57,900 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:15:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:15:57 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:15:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:15:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:16:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:16:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5530076822161095, 'eval_loss': 0.8335311, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1108, 1404, 1344, 1378, 1408, 940, 781, 558, 250, 230, 355], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51471396, 'remaining_params': 33546204, 'pruned_model_sparsity': 0.6054204776422765, 'expected_sparsity': 0.59949, 'target_sparsity': 0.6, 'step': 26500}


Iteration:  88%|████████▊ | 236/268 [00:47<00:25,  1.25it/s][A04/29/2024 02:16:00 - INFO - trainer.trainer_mod_2 - v4 Global step: 26500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:47<00:18,  1.64it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:14,  2.13it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:10,  2.65it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:08,  3.23it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:07,  3.80it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:05,  4.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:05,  4.87it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:04,  5.26it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:04,  5.61it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  5.84it/s][A
Iteration:  92%|█████████▏| 247/268 [00:49<00:03,  6.03it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.03it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:03,  6.24it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.25it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.40it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.35it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.46it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.51it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.61it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.48it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.42it/s][A
Iteration: 100%|██████████| 268/268 [00:52<00:00,  6.82it/s][A04/29/2024 02:16:04 - INFO - trainer.trainer_mod_2 - Epoch 98 finished. Took 52.26 seconds.
Iteration: 100%|██████████| 268/268 [00:52<00:00,  5.13it/s]
Epoch:  99%|█████████▉| 99/100 [1:27:39<00:52, 52.91s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:41,  6.46it/s][A
Iteration:   1%|          | 3/268 [00:00<00:40,  6.47it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:39,  6.65it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:39,  6.63it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:39,  6.64it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:39,  6.60it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.68it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:40,  6.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:40,  6.36it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:40,  6.34it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:40,  6.38it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:40,  6.36it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:40,  6.32it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:39,  6.39it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:39,  6.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:38,  6.47it/s][A[INFO|trainer.py:570] 2024-04-29 02:16:07,716 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:16:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:16:07 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:16:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:16:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:16:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:16:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5552849676135797, 'eval_loss': 0.825573, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1105, 1401, 1341, 1376, 1405, 937, 778, 553, 247, 227, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51521952, 'remaining_params': 33495648, 'pruned_model_sparsity': 0.6060151309846432, 'expected_sparsity': 0.60054, 'target_sparsity': 0.6, 'step': 26550}


Iteration:   7%|▋         | 18/268 [00:04<03:19,  1.25it/s][A
Iteration:   7%|▋         | 19/268 [00:05<02:31,  1.65it/s][A
Iteration:   7%|▋         | 20/268 [00:05<01:55,  2.14it/s][A
Iteration:   8%|▊         | 21/268 [00:05<01:32,  2.68it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:15,  3.26it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:03,  3.83it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:56,  4.31it/s][A
Iteration:   9%|▉         | 25/268 [00:06<00:50,  4.76it/s][A
Iteration:  10%|▉         | 26/268 [00:06<00:46,  5.25it/s][A
Iteration:  10%|█         | 27/268 [00:06<00:44,  5.44it/s][A
Iteration:  10%|█         | 28/268 [00:06<00:41,  5.74it/s][A
Iteration:  11%|█         | 29/268 [00:06<00:40,  5.90it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:39,  6.07it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:38,  6.14it/s][A
Iteration:  12%|█▏        | 32/268 [00:07<00:37,  6.28it/s][A
Iteration:  12%|█▏        | 33/268 [00:07<00:36,  6.36it/s][A
Iteration:  13%|█▎        | 34/268 [00:07<00:36,  6.33it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:37,  6.27it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:36,  6.37it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:35,  6.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:08<00:35,  6.54it/s][A
Iteration:  15%|█▍        | 39/268 [00:08<00:35,  6.54it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:35,  6.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:35,  6.42it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:35,  6.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:34,  6.46it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:35,  6.38it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:35,  6.34it/s][A
Iteration:  17%|█▋        | 46/268 [00:09<00:35,  6.29it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:34,  6.39it/s][A
Iteration:  18%|█▊        | 48/268 [00:09<00:34,  6.36it/s][A
Iteration:  18%|█▊        | 49/268 [00:09<00:34,  6.32it/s][A
Iteration:  19%|█▊        | 50/268 [00:09<00:34,  6.31it/s][A
Iteration:  19%|█▉        | 51/268 [00:10<00:33,  6.40it/s][A
Iteration:  19%|█▉        | 52/268 [00:10<00:34,  6.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:10<00:33,  6.42it/s][A
Iteration:  20%|██        | 54/268 [00:10<00:33,  6.45it/s][A
Iteration:  21%|██        | 55/268 [00:10<00:32,  6.46it/s][A
Iteration:  21%|██        | 56/268 [00:10<00:32,  6.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:33,  6.31it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:32,  6.47it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:32,  6.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:32,  6.38it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:32,  6.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:11<00:31,  6.44it/s][A
Iteration:  24%|██▎       | 63/268 [00:11<00:31,  6.41it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:31,  6.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:30,  6.58it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.53it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:30,  6.56it/s][A[INFO|trainer.py:570] 2024-04-29 02:16:17,633 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:16:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:16:17 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:16:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:16:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.81it/s]04/29/2024 02:16:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:16:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5500793243102087, 'eval_loss': 0.83406043, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1108, 1404, 1343, 1378, 1407, 939, 781, 559, 252, 233, 360], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51466800, 'remaining_params': 33550800, 'pruned_model_sparsity': 0.6053664182475158, 'expected_sparsity': 0.59916, 'target_sparsity': 0.6, 'step': 26600}


Iteration:  25%|██▌       | 68/268 [00:14<02:39,  1.25it/s][A04/29/2024 02:16:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 26600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:14<02:00,  1.65it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<01:32,  2.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<01:13,  2.67it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<01:00,  3.25it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:51,  3.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:15<00:45,  4.26it/s][A
Iteration:  28%|██▊       | 75/268 [00:15<00:40,  4.77it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:38,  5.00it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:35,  5.36it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:33,  5.74it/s][A
Iteration:  29%|██▉       | 79/268 [00:16<00:31,  6.05it/s][A
Iteration:  30%|██▉       | 80/268 [00:16<00:30,  6.20it/s][A
Iteration:  30%|███       | 81/268 [00:16<00:29,  6.31it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:29,  6.38it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:28,  6.54it/s][A
Iteration:  31%|███▏      | 84/268 [00:17<00:28,  6.45it/s][A
Iteration:  32%|███▏      | 85/268 [00:17<00:28,  6.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:17<00:28,  6.45it/s][A
Iteration:  32%|███▏      | 87/268 [00:17<00:27,  6.49it/s][A
Iteration:  33%|███▎      | 88/268 [00:17<00:27,  6.63it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:27,  6.60it/s][A
Iteration:  34%|███▎      | 90/268 [00:18<00:27,  6.50it/s][A
Iteration:  34%|███▍      | 91/268 [00:18<00:27,  6.48it/s][A
Iteration:  34%|███▍      | 92/268 [00:18<00:27,  6.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:18<00:27,  6.42it/s][A
Iteration:  35%|███▌      | 94/268 [00:18<00:27,  6.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:19<00:27,  6.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:19<00:26,  6.39it/s][A
Iteration:  36%|███▌      | 97/268 [00:19<00:26,  6.34it/s][A
Iteration:  37%|███▋      | 98/268 [00:19<00:26,  6.37it/s][A
Iteration:  37%|███▋      | 99/268 [00:19<00:25,  6.52it/s][A
Iteration:  37%|███▋      | 100/268 [00:19<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:19<00:25,  6.50it/s][A
Iteration:  38%|███▊      | 102/268 [00:20<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<00:25,  6.48it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:25,  6.43it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:25,  6.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:24,  6.46it/s][A
Iteration:  40%|████      | 108/268 [00:21<00:24,  6.47it/s][A
Iteration:  41%|████      | 109/268 [00:21<00:24,  6.40it/s][A
Iteration:  41%|████      | 110/268 [00:21<00:24,  6.46it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:24,  6.47it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:24,  6.31it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.48it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 115/268 [00:22<00:23,  6.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:22<00:23,  6.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:22<00:23,  6.44it/s][A[INFO|trainer.py:570] 2024-04-29 02:16:27,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:16:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:16:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:16:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:16:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:16:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:16:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5656564467449968, 'eval_loss': 0.8334356, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1105, 1402, 1342, 1377, 1405, 937, 778, 553, 247, 227, 352], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51514292, 'remaining_params': 33503308, 'pruned_model_sparsity': 0.6059250319933754, 'expected_sparsity': 0.6004, 'target_sparsity': 0.6, 'step': 26650}


Iteration:  44%|████▍     | 118/268 [00:24<01:59,  1.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:24<01:29,  1.66it/s][A
Iteration:  45%|████▍     | 120/268 [00:25<01:09,  2.14it/s][A
Iteration:  45%|████▌     | 121/268 [00:25<00:55,  2.66it/s][A
Iteration:  46%|████▌     | 122/268 [00:25<00:44,  3.25it/s][A
Iteration:  46%|████▌     | 123/268 [00:25<00:37,  3.82it/s][A
Iteration:  46%|████▋     | 124/268 [00:25<00:32,  4.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:25<00:29,  4.90it/s][A
Iteration:  47%|████▋     | 126/268 [00:25<00:26,  5.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:26<00:24,  5.72it/s][A
Iteration:  48%|████▊     | 128/268 [00:26<00:23,  6.02it/s][A
Iteration:  48%|████▊     | 129/268 [00:26<00:22,  6.15it/s][A
Iteration:  49%|████▊     | 130/268 [00:26<00:22,  6.19it/s][A
Iteration:  49%|████▉     | 131/268 [00:26<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 132/268 [00:26<00:21,  6.36it/s][A
Iteration:  50%|████▉     | 133/268 [00:27<00:21,  6.40it/s][A
Iteration:  50%|█████     | 134/268 [00:27<00:20,  6.46it/s][A
Iteration:  50%|█████     | 135/268 [00:27<00:20,  6.40it/s][A
Iteration:  51%|█████     | 136/268 [00:27<00:20,  6.43it/s][A
Iteration:  51%|█████     | 137/268 [00:27<00:20,  6.42it/s][A
Iteration:  51%|█████▏    | 138/268 [00:27<00:20,  6.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:27<00:20,  6.45it/s][A
Iteration:  52%|█████▏    | 140/268 [00:28<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:28<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 142/268 [00:28<00:19,  6.50it/s][A
Iteration:  53%|█████▎    | 143/268 [00:28<00:19,  6.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:28<00:18,  6.59it/s][A
Iteration:  54%|█████▍    | 145/268 [00:28<00:18,  6.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:29<00:19,  6.37it/s][A
Iteration:  55%|█████▍    | 147/268 [00:29<00:18,  6.41it/s][A
Iteration:  55%|█████▌    | 148/268 [00:29<00:18,  6.42it/s][A
Iteration:  56%|█████▌    | 149/268 [00:29<00:18,  6.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:29<00:18,  6.46it/s][A
Iteration:  56%|█████▋    | 151/268 [00:29<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:29<00:18,  6.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:30<00:18,  6.33it/s][A
Iteration:  57%|█████▋    | 154/268 [00:30<00:18,  6.32it/s][A
Iteration:  58%|█████▊    | 155/268 [00:30<00:18,  6.23it/s][A
Iteration:  58%|█████▊    | 156/268 [00:30<00:17,  6.25it/s][A
Iteration:  59%|█████▊    | 157/268 [00:30<00:17,  6.29it/s][A
Iteration:  59%|█████▉    | 158/268 [00:30<00:17,  6.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:31<00:16,  6.51it/s][A
Iteration:  60%|█████▉    | 160/268 [00:31<00:16,  6.39it/s][A
Iteration:  60%|██████    | 161/268 [00:31<00:16,  6.41it/s][A
Iteration:  60%|██████    | 162/268 [00:31<00:16,  6.35it/s][A
Iteration:  61%|██████    | 163/268 [00:31<00:16,  6.41it/s][A
Iteration:  61%|██████    | 164/268 [00:31<00:15,  6.58it/s][A
Iteration:  62%|██████▏   | 165/268 [00:31<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 166/268 [00:32<00:15,  6.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:32<00:15,  6.35it/s][A[INFO|trainer.py:570] 2024-04-29 02:16:37,381 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:16:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:16:37 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:16:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:16:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:16:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:16:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5477951635989807, 'eval_loss': 0.8380136, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [970, 1105, 1401, 1341, 1376, 1404, 936, 778, 554, 247, 228, 353], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51518888, 'remaining_params': 33498712, 'pruned_model_sparsity': 0.6059790913881361, 'expected_sparsity': 0.60042, 'target_sparsity': 0.6, 'step': 26700}


Iteration:  63%|██████▎   | 168/268 [00:34<01:19,  1.25it/s][A04/29/2024 02:16:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 26700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:34<00:59,  1.65it/s][A
Iteration:  63%|██████▎   | 170/268 [00:34<00:46,  2.13it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:36,  2.66it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:29,  3.22it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:24,  3.80it/s][A
Iteration:  65%|██████▍   | 174/268 [00:35<00:21,  4.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:35<00:18,  4.90it/s][A
Iteration:  66%|██████▌   | 176/268 [00:35<00:17,  5.28it/s][A
Iteration:  66%|██████▌   | 177/268 [00:35<00:16,  5.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:15,  5.84it/s][A
Iteration:  67%|██████▋   | 179/268 [00:36<00:15,  5.80it/s][A
Iteration:  67%|██████▋   | 180/268 [00:36<00:14,  6.03it/s][A
Iteration:  68%|██████▊   | 181/268 [00:36<00:14,  6.15it/s][A
Iteration:  68%|██████▊   | 182/268 [00:36<00:13,  6.18it/s][A
Iteration:  68%|██████▊   | 183/268 [00:36<00:13,  6.25it/s][A
Iteration:  69%|██████▊   | 184/268 [00:37<00:13,  6.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:37<00:12,  6.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:37<00:12,  6.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:37<00:12,  6.53it/s][A
Iteration:  70%|███████   | 188/268 [00:37<00:12,  6.61it/s][A
Iteration:  71%|███████   | 189/268 [00:37<00:12,  6.48it/s][A
Iteration:  71%|███████   | 190/268 [00:37<00:12,  6.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:38<00:12,  6.40it/s][A
Iteration:  72%|███████▏  | 192/268 [00:38<00:12,  6.03it/s][A
Iteration:  72%|███████▏  | 193/268 [00:38<00:12,  6.25it/s][A
Iteration:  72%|███████▏  | 194/268 [00:38<00:11,  6.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:38<00:11,  6.31it/s][A
Iteration:  73%|███████▎  | 196/268 [00:38<00:11,  6.36it/s][A
Iteration:  74%|███████▎  | 197/268 [00:39<00:11,  6.41it/s][A
Iteration:  74%|███████▍  | 198/268 [00:39<00:10,  6.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:39<00:10,  6.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:39<00:10,  6.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:39<00:10,  6.33it/s][A
Iteration:  75%|███████▌  | 202/268 [00:39<00:10,  6.38it/s][A
Iteration:  76%|███████▌  | 203/268 [00:40<00:10,  6.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:40<00:09,  6.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:40<00:09,  6.41it/s][A
Iteration:  77%|███████▋  | 206/268 [00:40<00:09,  6.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:40<00:09,  6.25it/s][A
Iteration:  78%|███████▊  | 208/268 [00:40<00:09,  6.32it/s][A
Iteration:  78%|███████▊  | 209/268 [00:40<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 210/268 [00:41<00:08,  6.49it/s][A
Iteration:  79%|███████▊  | 211/268 [00:41<00:08,  6.53it/s][A
Iteration:  79%|███████▉  | 212/268 [00:41<00:08,  6.56it/s][A
Iteration:  79%|███████▉  | 213/268 [00:41<00:08,  6.53it/s][A
Iteration:  80%|███████▉  | 214/268 [00:41<00:08,  6.57it/s][A
Iteration:  80%|████████  | 215/268 [00:41<00:08,  6.41it/s][A
Iteration:  81%|████████  | 216/268 [00:42<00:08,  6.39it/s][A
Iteration:  81%|████████  | 217/268 [00:42<00:07,  6.45it/s][A[INFO|trainer.py:570] 2024-04-29 02:16:47,299 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:16:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:16:47 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:16:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:16:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:16:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:16:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5458722532834043, 'eval_loss': 0.8378961, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [973, 1108, 1404, 1343, 1378, 1407, 938, 780, 559, 250, 231, 358], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.59944, 'target_sparsity': 0.6, 'step': 26750}


Iteration:  81%|████████▏ | 218/268 [00:44<00:39,  1.25it/s][A
Iteration:  82%|████████▏ | 219/268 [00:44<00:29,  1.65it/s][A
Iteration:  82%|████████▏ | 220/268 [00:44<00:22,  2.11it/s][A
Iteration:  82%|████████▏ | 221/268 [00:44<00:17,  2.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:45<00:14,  3.22it/s][A
Iteration:  83%|████████▎ | 223/268 [00:45<00:11,  3.79it/s][A
Iteration:  84%|████████▎ | 224/268 [00:45<00:10,  4.39it/s][A
Iteration:  84%|████████▍ | 225/268 [00:45<00:08,  4.86it/s][A
Iteration:  84%|████████▍ | 226/268 [00:45<00:08,  5.17it/s][A
Iteration:  85%|████████▍ | 227/268 [00:45<00:07,  5.47it/s][A
Iteration:  85%|████████▌ | 228/268 [00:46<00:06,  5.84it/s][A
Iteration:  85%|████████▌ | 229/268 [00:46<00:06,  6.00it/s][A
Iteration:  86%|████████▌ | 230/268 [00:46<00:06,  6.08it/s][A
Iteration:  86%|████████▌ | 231/268 [00:46<00:05,  6.17it/s][A
Iteration:  87%|████████▋ | 232/268 [00:46<00:05,  6.30it/s][A
Iteration:  87%|████████▋ | 233/268 [00:46<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 234/268 [00:46<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 235/268 [00:47<00:05,  6.44it/s][A
Iteration:  88%|████████▊ | 236/268 [00:47<00:04,  6.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:47<00:04,  6.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:47<00:04,  6.48it/s][A
Iteration:  89%|████████▉ | 239/268 [00:47<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:47<00:04,  6.47it/s][A
Iteration:  90%|████████▉ | 241/268 [00:48<00:04,  6.63it/s][A
Iteration:  90%|█████████ | 242/268 [00:48<00:04,  6.49it/s][A
Iteration:  91%|█████████ | 243/268 [00:48<00:03,  6.47it/s][A
Iteration:  91%|█████████ | 244/268 [00:48<00:03,  6.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:48<00:03,  6.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:48<00:03,  6.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:48<00:03,  6.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:49<00:03,  6.46it/s][A
Iteration:  93%|█████████▎| 249/268 [00:49<00:02,  6.46it/s][A
Iteration:  93%|█████████▎| 250/268 [00:49<00:02,  6.45it/s][A
Iteration:  94%|█████████▎| 251/268 [00:49<00:02,  6.48it/s][A
Iteration:  94%|█████████▍| 252/268 [00:49<00:02,  6.42it/s][A
Iteration:  94%|█████████▍| 253/268 [00:49<00:02,  6.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:50<00:02,  6.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:50<00:02,  6.39it/s][A
Iteration:  96%|█████████▌| 256/268 [00:50<00:01,  6.34it/s][A
Iteration:  96%|█████████▌| 257/268 [00:50<00:01,  6.32it/s][A
Iteration:  96%|█████████▋| 258/268 [00:50<00:01,  6.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:50<00:01,  6.35it/s][A
Iteration:  97%|█████████▋| 260/268 [00:51<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:51<00:01,  6.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:51<00:00,  6.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:51<00:00,  6.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:51<00:00,  6.50it/s][A
Iteration:  99%|█████████▉| 266/268 [00:51<00:00,  6.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:52<00:00,  6.43it/s][A[INFO|trainer.py:570] 2024-04-29 02:16:57,176 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence. If idx, sentence are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/29/2024 02:16:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/29/2024 02:16:57 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/29/2024 02:16:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/29/2024 02:16:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 15.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 15.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 15.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 15.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 15.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 15.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 15.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 15.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 15.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 15.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 15.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 15.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:02<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:02<00:00, 15.80it/s]04/29/2024 02:16:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/29/2024 02:16:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5474713423103301, 'eval_loss': 0.8367389, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [969, 1103, 1400, 1340, 1375, 1403, 934, 776, 552, 246, 227, 351], 'head_nums': [11, 6, 6, 8, 9, 11, 8, 9, 6, 3, 4, 10], 'pruned_params': 51541868, 'remaining_params': 33475732, 'pruned_model_sparsity': 0.6062493883619392, 'expected_sparsity': 0.60076, 'target_sparsity': 0.6, 'step': 26800}


Iteration: 100%|██████████| 268/268 [00:54<00:00,  1.26it/s][A04/29/2024 02:16:59 - INFO - trainer.trainer_mod_2 - Epoch 99 finished. Took 54.39 seconds.
Iteration: 100%|██████████| 268/268 [00:54<00:00,  4.93it/s]
Epoch: 100%|██████████| 100/100 [1:28:33<00:00, 53.35s/it]Epoch: 100%|██████████| 100/100 [1:28:33<00:00, 53.14s/it]
[INFO|configuration_utils.py:439] 2024-04-29 02:16:59,332 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/config.json
[INFO|modeling_utils.py:1084] 2024-04-29 02:17:00,172 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-29 02:17:00,174 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-29 02:17:00,175 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.6/special_tokens_map.json
04/29/2024 02:17:00 - INFO - __main__ - Training took 5324.8 seconds.
