Tue Apr 23 23:41:28 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/rte_mod_0.95
nvidia-smi output:
Tue Apr 23 23:41:28 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:65:00.0 Off |                    0 |
| N/A   41C    P0              35W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/23/2024 23:41:33 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/23/2024 23:41:33 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95/runs/Apr23_23-41-33_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/23/2024 23:41:33 - INFO - __main__ - Model Arguments:
04/23/2024 23:41:33 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/23/2024 23:41:33 - INFO - __main__ - config_name = None
04/23/2024 23:41:33 - INFO - __main__ - tokenizer_name = None
04/23/2024 23:41:33 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/23/2024 23:41:33 - INFO - __main__ - use_fast_tokenizer = True
04/23/2024 23:41:33 - INFO - __main__ - model_revision = main
04/23/2024 23:41:33 - INFO - __main__ - use_auth_token = False
04/23/2024 23:41:33 - INFO - __main__ - Data Arguments:
04/23/2024 23:41:33 - INFO - __main__ - task_name = rte
04/23/2024 23:41:33 - INFO - __main__ - dataset_name = None
04/23/2024 23:41:33 - INFO - __main__ - t_name = None
04/23/2024 23:41:33 - INFO - __main__ - dataset_config_name = None
04/23/2024 23:41:33 - INFO - __main__ - max_seq_length = 128
04/23/2024 23:41:33 - INFO - __main__ - overwrite_cache = False
04/23/2024 23:41:33 - INFO - __main__ - pad_to_max_length = True
04/23/2024 23:41:33 - INFO - __main__ - max_train_samples = None
04/23/2024 23:41:33 - INFO - __main__ - max_eval_samples = None
04/23/2024 23:41:33 - INFO - __main__ - max_predict_samples = None
04/23/2024 23:41:33 - INFO - __main__ - train_file = None
04/23/2024 23:41:33 - INFO - __main__ - validation_file = None
04/23/2024 23:41:33 - INFO - __main__ - test_file = None
04/23/2024 23:41:33 - INFO - __main__ - Training Arguments:
04/23/2024 23:41:33 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95
04/23/2024 23:41:33 - INFO - __main__ - overwrite_output_dir = True
04/23/2024 23:41:33 - INFO - __main__ - do_train = True
04/23/2024 23:41:33 - INFO - __main__ - do_eval = True
04/23/2024 23:41:33 - INFO - __main__ - do_predict = False
04/23/2024 23:41:33 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/23/2024 23:41:33 - INFO - __main__ - prediction_loss_only = False
04/23/2024 23:41:33 - INFO - __main__ - per_device_train_batch_size = 32
04/23/2024 23:41:33 - INFO - __main__ - per_device_eval_batch_size = 32
04/23/2024 23:41:33 - INFO - __main__ - per_gpu_train_batch_size = None
04/23/2024 23:41:33 - INFO - __main__ - per_gpu_eval_batch_size = None
04/23/2024 23:41:33 - INFO - __main__ - gradient_accumulation_steps = 1
04/23/2024 23:41:33 - INFO - __main__ - eval_accumulation_steps = None
04/23/2024 23:41:33 - INFO - __main__ - learning_rate = 2e-05
04/23/2024 23:41:33 - INFO - __main__ - weight_decay = 0.0
04/23/2024 23:41:33 - INFO - __main__ - adam_beta1 = 0.9
04/23/2024 23:41:33 - INFO - __main__ - adam_beta2 = 0.999
04/23/2024 23:41:33 - INFO - __main__ - adam_epsilon = 1e-08
04/23/2024 23:41:33 - INFO - __main__ - max_grad_norm = 1.0
04/23/2024 23:41:33 - INFO - __main__ - num_train_epochs = 100.0
04/23/2024 23:41:33 - INFO - __main__ - max_steps = -1
04/23/2024 23:41:33 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/23/2024 23:41:33 - INFO - __main__ - warmup_ratio = 0.0
04/23/2024 23:41:33 - INFO - __main__ - warmup_steps = 0
04/23/2024 23:41:33 - INFO - __main__ - log_level = -1
04/23/2024 23:41:33 - INFO - __main__ - log_level_replica = -1
04/23/2024 23:41:33 - INFO - __main__ - log_on_each_node = True
04/23/2024 23:41:33 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95/runs/Apr23_23-41-33_adroit-h11g2
04/23/2024 23:41:33 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/23/2024 23:41:33 - INFO - __main__ - logging_first_step = False
04/23/2024 23:41:33 - INFO - __main__ - logging_steps = 100
04/23/2024 23:41:33 - INFO - __main__ - logging_nan_inf_filter = True
04/23/2024 23:41:33 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/23/2024 23:41:33 - INFO - __main__ - save_steps = 0
04/23/2024 23:41:33 - INFO - __main__ - save_total_limit = None
04/23/2024 23:41:33 - INFO - __main__ - save_on_each_node = False
04/23/2024 23:41:33 - INFO - __main__ - no_cuda = False
04/23/2024 23:41:33 - INFO - __main__ - seed = 57
04/23/2024 23:41:33 - INFO - __main__ - bf16 = False
04/23/2024 23:41:33 - INFO - __main__ - fp16 = False
04/23/2024 23:41:33 - INFO - __main__ - fp16_opt_level = O1
04/23/2024 23:41:33 - INFO - __main__ - half_precision_backend = auto
04/23/2024 23:41:33 - INFO - __main__ - bf16_full_eval = False
04/23/2024 23:41:33 - INFO - __main__ - fp16_full_eval = False
04/23/2024 23:41:33 - INFO - __main__ - tf32 = None
04/23/2024 23:41:33 - INFO - __main__ - local_rank = -1
04/23/2024 23:41:33 - INFO - __main__ - xpu_backend = None
04/23/2024 23:41:33 - INFO - __main__ - tpu_num_cores = None
04/23/2024 23:41:33 - INFO - __main__ - tpu_metrics_debug = False
04/23/2024 23:41:33 - INFO - __main__ - debug = []
04/23/2024 23:41:33 - INFO - __main__ - dataloader_drop_last = False
04/23/2024 23:41:33 - INFO - __main__ - eval_steps = 50
04/23/2024 23:41:33 - INFO - __main__ - dataloader_num_workers = 0
04/23/2024 23:41:33 - INFO - __main__ - past_index = -1
04/23/2024 23:41:33 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95
04/23/2024 23:41:33 - INFO - __main__ - disable_tqdm = False
04/23/2024 23:41:33 - INFO - __main__ - remove_unused_columns = True
04/23/2024 23:41:33 - INFO - __main__ - label_names = None
04/23/2024 23:41:33 - INFO - __main__ - load_best_model_at_end = False
04/23/2024 23:41:33 - INFO - __main__ - metric_for_best_model = None
04/23/2024 23:41:33 - INFO - __main__ - greater_is_better = None
04/23/2024 23:41:33 - INFO - __main__ - ignore_data_skip = False
04/23/2024 23:41:33 - INFO - __main__ - sharded_ddp = []
04/23/2024 23:41:33 - INFO - __main__ - deepspeed = None
04/23/2024 23:41:33 - INFO - __main__ - label_smoothing_factor = 0.0
04/23/2024 23:41:33 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/23/2024 23:41:33 - INFO - __main__ - adafactor = False
04/23/2024 23:41:33 - INFO - __main__ - group_by_length = False
04/23/2024 23:41:33 - INFO - __main__ - length_column_name = length
04/23/2024 23:41:33 - INFO - __main__ - report_to = []
04/23/2024 23:41:33 - INFO - __main__ - ddp_find_unused_parameters = None
04/23/2024 23:41:33 - INFO - __main__ - ddp_bucket_cap_mb = None
04/23/2024 23:41:33 - INFO - __main__ - dataloader_pin_memory = True
04/23/2024 23:41:33 - INFO - __main__ - skip_memory_metrics = True
04/23/2024 23:41:33 - INFO - __main__ - use_legacy_prediction_loop = False
04/23/2024 23:41:33 - INFO - __main__ - push_to_hub = False
04/23/2024 23:41:33 - INFO - __main__ - resume_from_checkpoint = None
04/23/2024 23:41:33 - INFO - __main__ - hub_model_id = None
04/23/2024 23:41:33 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/23/2024 23:41:33 - INFO - __main__ - hub_token = None
04/23/2024 23:41:33 - INFO - __main__ - gradient_checkpointing = False
04/23/2024 23:41:33 - INFO - __main__ - fp16_backend = auto
04/23/2024 23:41:33 - INFO - __main__ - push_to_hub_model_id = None
04/23/2024 23:41:33 - INFO - __main__ - push_to_hub_organization = None
04/23/2024 23:41:33 - INFO - __main__ - push_to_hub_token = None
04/23/2024 23:41:33 - INFO - __main__ - mp_parameters = 
04/23/2024 23:41:33 - INFO - __main__ - _n_gpu = 1
04/23/2024 23:41:33 - INFO - __main__ - __cached__setup_devices = cuda:0
04/23/2024 23:41:33 - INFO - __main__ - Additional Arguments:
04/23/2024 23:41:33 - INFO - __main__ - test = False
04/23/2024 23:41:33 - INFO - __main__ - ex_name = RTE_sparsity0.95
04/23/2024 23:41:33 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/23/2024 23:41:33 - INFO - __main__ - reg_learning_rate = 0.01
04/23/2024 23:41:33 - INFO - __main__ - scheduler_type = linear
04/23/2024 23:41:33 - INFO - __main__ - freeze_embeddings = True
04/23/2024 23:41:33 - INFO - __main__ - pretrained_pruned_model = None
04/23/2024 23:41:33 - INFO - __main__ - droprate_init = 0.5
04/23/2024 23:41:33 - INFO - __main__ - temperature = 0.6666666666666666
04/23/2024 23:41:33 - INFO - __main__ - prepruning_finetune_epochs = 4
04/23/2024 23:41:33 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/23/2024 23:41:33 - INFO - __main__ - target_sparsity = 0.95
04/23/2024 23:41:33 - INFO - __main__ - sparsity_epsilon = 0
04/23/2024 23:41:33 - INFO - __main__ - distillation_path = textattack/bert-base-uncased-RTE
04/23/2024 23:41:33 - INFO - __main__ - do_distill = True
04/23/2024 23:41:33 - INFO - __main__ - do_layer_distill = True
04/23/2024 23:41:33 - INFO - __main__ - layer_distill_version = 4
04/23/2024 23:41:33 - INFO - __main__ - distill_loss_alpha = 0.9
04/23/2024 23:41:33 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/23/2024 23:41:33 - INFO - __main__ - distill_temp = 2.0
04/23/2024 23:41:33 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/23/2024 23:41:33 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/23/2024 23:41:33 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/23/2024 23:41:33 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 739.21it/s]
[INFO|configuration_utils.py:648] 2024-04-23 23:41:33,621 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 23:41:33,622 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "rte",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-23 23:41:33,623 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 23:41:33,624 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-23 23:41:33,627 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-23 23:41:33,627 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-23 23:41:33,627 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-23 23:41:33,628 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-23 23:41:33,630 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-23 23:41:33,631 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/23/2024 23:41:42 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/23/2024 23:41:42 - INFO - __main__ - Model size: 85054464
04/23/2024 23:41:42 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14edb9f59d30> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/23/2024 23:41:42 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/23/2024 23:41:42 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14edb9f59ee0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/23/2024 23:41:42 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/23/2024 23:41:42 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14edb9f59d30> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/23/2024 23:41:42 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/23/2024 23:41:42 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The CBS Evening News commentary segment "Free Speech" , which made its debut with Katie Couric this month, was accused last Friday by Bill Maher of HBO\'s "Real Time with Bill Maher" of being "anything but free speech". Maher said he was asked by CBS News to appear on the segment. But when he asked if he could talk about religion, "that was a dealbreaker from the start". Instead, he said they would send over a list of "acceptable topics". CBS News executive producer Rome Hartman has since responded in an e-mail to TVNewser saying that, "Bill Maher was never told that he couldn\'t discuss religion in a Free Speech segment," and added, "In fact, Free Speech has already addressed religion and we expect others will in the future."', 'sentence2': 'Free Speech is a part of the CBS Evening News.', 'label': 0, 'idx': 2105, 'input_ids': [101, 1996, 6568, 3944, 2739, 8570, 6903, 1000, 2489, 4613, 1000, 1010, 2029, 2081, 2049, 2834, 2007, 9734, 2522, 9496, 2278, 2023, 3204, 1010, 2001, 5496, 2197, 5958, 2011, 3021, 5003, 5886, 1997, 14633, 1005, 1055, 1000, 2613, 2051, 2007, 3021, 5003, 5886, 1000, 1997, 2108, 1000, 2505, 2021, 2489, 4613, 1000, 1012, 5003, 5886, 2056, 2002, 2001, 2356, 2011, 6568, 2739, 2000, 3711, 2006, 1996, 6903, 1012, 2021, 2043, 2002, 2356, 2065, 2002, 2071, 2831, 2055, 4676, 1010, 1000, 2008, 2001, 1037, 3066, 21204, 2013, 1996, 2707, 1000, 1012, 2612, 1010, 2002, 2056, 2027, 2052, 4604, 2058, 1037, 2862, 1997, 1000, 11701, 7832, 1000, 1012, 6568, 2739, 3237, 3135, 4199, 26766, 2038, 2144, 5838, 102, 2489, 4613, 2003, 1037, 2112, 1997, 1996, 6568, 3944, 2739, 1012, 102], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}.
04/23/2024 23:41:42 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': "He said those three detainees are Khalid Sheikh Mohammed - one of the architects of the September 11th attacks on New York and Washington, Abu Zubaydah - who is believed to have been a top al-Qaida strategist, and Abd al-Rahim al-Nashiri - who is believed to have played a key role in the bombing of the USS Cole. All three are being held at the U.S. detention facility at Guantanamo Bay. Hayden said waterboarding was used against the three detainees nearly five years ago because of circumstances at the time, including the belief that additional attacks against the United States were imminent. Hayden defended the CIA's use of extreme interrogation techniques as lawful, and urged lawmakers not to impose restrictions on such methods. Congress is considering legislation that would restrict the CIA to using only the interrogation techniques authorized by the U.S. Army's field manual, which does not include waterboarding.", 'sentence2': 'Abu Zubaydah belongs to al-Qaida.', 'label': 0, 'idx': 1315, 'input_ids': [101, 2002, 2056, 2216, 2093, 26485, 2024, 21828, 12840, 12619, 1011, 2028, 1997, 1996, 8160, 1997, 1996, 2244, 6252, 4491, 2006, 2047, 2259, 1998, 2899, 1010, 8273, 16950, 15907, 18417, 1011, 2040, 2003, 3373, 2000, 2031, 2042, 1037, 2327, 2632, 1011, 1053, 14326, 2050, 2358, 11657, 24063, 1010, 1998, 19935, 2632, 1011, 10958, 14341, 2632, 1011, 10594, 15735, 1011, 2040, 2003, 3373, 2000, 2031, 2209, 1037, 3145, 2535, 1999, 1996, 8647, 1997, 1996, 7234, 5624, 1012, 2035, 2093, 2024, 2108, 2218, 2012, 1996, 1057, 1012, 1055, 1012, 12345, 4322, 2012, 23094, 3016, 1012, 13872, 2056, 2300, 21172, 2001, 2109, 2114, 1996, 2093, 26485, 3053, 2274, 2086, 3283, 2138, 1997, 6214, 2012, 1996, 2051, 1010, 102, 8273, 16950, 15907, 18417, 7460, 2000, 2632, 1011, 1053, 14326, 2050, 1012, 102], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}.
04/23/2024 23:41:42 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "Please note that Arabic is the language of Quran so it's better to learn it to understand clearly all the miracles in Quran.", 'sentence2': 'Arabic is the language of the Quran.', 'label': 0, 'idx': 1955, 'input_ids': [101, 3531, 3602, 2008, 5640, 2003, 1996, 2653, 1997, 21288, 2061, 2009, 1005, 1055, 2488, 2000, 4553, 2009, 2000, 3305, 4415, 2035, 1996, 17861, 1999, 21288, 1012, 102, 5640, 2003, 1996, 2653, 1997, 1996, 21288, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/23/2024 23:41:42 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/23/2024 23:41:42 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/23/2024 23:41:42 - INFO - __main__ - ************* 2490 Training Examples Loaded *************
04/23/2024 23:41:42 - INFO - __main__ - ************* 277 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-23 23:41:43,168 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:41:43 - INFO - trainer.trainer_mod - Prepruning finetune steps: 100
04/23/2024 23:41:43 - INFO - trainer.trainer_mod - Lagrangian warmup steps: 1560
04/23/2024 23:41:43 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/23/2024 23:41:43 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/23/2024 23:41:43 - INFO - trainer.trainer_mod - ***** Running training *****
04/23/2024 23:41:43 - INFO - trainer.trainer_mod -   Num examples = 2490
04/23/2024 23:41:43 - INFO - trainer.trainer_mod -   Num Epochs = 100
04/23/2024 23:41:43 - INFO - trainer.trainer_mod -   Instantaneous batch size per device = 32
04/23/2024 23:41:43 - INFO - trainer.trainer_mod -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/23/2024 23:41:43 - INFO - trainer.trainer_mod -   Gradient Accumulation steps = 1
04/23/2024 23:41:43 - INFO - trainer.trainer_mod -   Total optimization steps = 7800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-23 23:41:43,173 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:41:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:41:43 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:41:43 - INFO - trainer.trainer_mod -   Batch size = 32

Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A
Evaluation:  11%|█         | 1/9 [00:00<00:01,  6.39it/s][A
Evaluation:  33%|███▎      | 3/9 [00:00<00:00, 10.89it/s][A
Evaluation:  56%|█████▌    | 5/9 [00:00<00:00, 13.35it/s][A
Evaluation:  78%|███████▊  | 7/9 [00:00<00:00, 14.71it/s][AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 14.34it/s]04/23/2024 23:41:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:41:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.5415162454873647, 'eval_loss': 0.691169, 'step': 0}


Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A04/23/2024 23:41:43 - INFO - trainer.trainer_mod - v4 Global step: 0, Alignment: tensor([ 3,  5,  8, 10], device='cuda:0')

Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.02it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:20,  3.67it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:19,  3.76it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:19,  3.82it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:18,  3.85it/s][A
Iteration:   9%|▉         | 7/78 [00:01<00:18,  3.87it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:18,  3.88it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:17,  3.89it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:17,  3.90it/s][A
Iteration:  14%|█▍        | 11/78 [00:02<00:17,  3.90it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:16,  3.91it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:16,  3.91it/s][A
Iteration:  18%|█▊        | 14/78 [00:03<00:16,  3.91it/s][A
Iteration:  19%|█▉        | 15/78 [00:03<00:16,  3.90it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:15,  3.91it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:15,  3.90it/s][A
Iteration:  23%|██▎       | 18/78 [00:04<00:15,  3.91it/s][A
Iteration:  24%|██▍       | 19/78 [00:04<00:15,  3.91it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:14,  3.91it/s][A
Iteration:  27%|██▋       | 21/78 [00:05<00:14,  3.91it/s][A
Iteration:  28%|██▊       | 22/78 [00:05<00:14,  3.90it/s][A
Iteration:  29%|██▉       | 23/78 [00:05<00:14,  3.90it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:13,  3.90it/s][A
Iteration:  32%|███▏      | 25/78 [00:06<00:13,  3.90it/s][A
Iteration:  33%|███▎      | 26/78 [00:06<00:13,  3.90it/s][A
Iteration:  35%|███▍      | 27/78 [00:06<00:13,  3.90it/s][A
Iteration:  36%|███▌      | 28/78 [00:07<00:12,  3.90it/s][A
Iteration:  37%|███▋      | 29/78 [00:07<00:12,  4.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:07<00:12,  3.97it/s][A
Iteration:  40%|███▉      | 31/78 [00:07<00:11,  3.95it/s][A
Iteration:  41%|████      | 32/78 [00:08<00:11,  3.93it/s][A
Iteration:  42%|████▏     | 33/78 [00:08<00:11,  3.93it/s][A
Iteration:  44%|████▎     | 34/78 [00:08<00:11,  3.92it/s][A
Iteration:  45%|████▍     | 35/78 [00:09<00:11,  3.90it/s][A
Iteration:  46%|████▌     | 36/78 [00:09<00:10,  3.90it/s][A
Iteration:  47%|████▋     | 37/78 [00:09<00:10,  3.90it/s][A
Iteration:  49%|████▊     | 38/78 [00:09<00:10,  3.90it/s][A
Iteration:  50%|█████     | 39/78 [00:10<00:09,  3.91it/s][A
Iteration:  51%|█████▏    | 40/78 [00:10<00:09,  3.90it/s][A
Iteration:  53%|█████▎    | 41/78 [00:10<00:10,  3.58it/s][A
Iteration:  54%|█████▍    | 42/78 [00:10<00:09,  3.67it/s][A
Iteration:  55%|█████▌    | 43/78 [00:11<00:09,  3.73it/s][A
Iteration:  56%|█████▋    | 44/78 [00:11<00:08,  3.78it/s][A
Iteration:  58%|█████▊    | 45/78 [00:11<00:08,  3.82it/s][A
Iteration:  59%|█████▉    | 46/78 [00:11<00:08,  3.84it/s][A
Iteration:  60%|██████    | 47/78 [00:12<00:08,  3.85it/s][A
Iteration:  62%|██████▏   | 48/78 [00:12<00:07,  3.87it/s][A
Iteration:  63%|██████▎   | 49/78 [00:12<00:07,  3.88it/s][A[INFO|trainer.py:570] 2024-04-23 23:41:56,761 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:41:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:41:56 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:41:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A

Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 17.03it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 17.03it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.65it/s]04/23/2024 23:41:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:41:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.65587246, 'step': 50}


Iteration:  64%|██████▍   | 50/78 [00:13<00:11,  2.42it/s][A
Iteration:  65%|██████▌   | 51/78 [00:13<00:09,  2.73it/s][A
Iteration:  67%|██████▋   | 52/78 [00:13<00:08,  3.00it/s][A
Iteration:  68%|██████▊   | 53/78 [00:14<00:07,  3.22it/s][A
Iteration:  69%|██████▉   | 54/78 [00:14<00:07,  3.39it/s][A
Iteration:  71%|███████   | 55/78 [00:14<00:06,  3.71it/s][A
Iteration:  72%|███████▏  | 56/78 [00:14<00:05,  3.76it/s][A
Iteration:  73%|███████▎  | 57/78 [00:15<00:05,  3.80it/s][A
Iteration:  74%|███████▍  | 58/78 [00:15<00:05,  3.83it/s][A
Iteration:  76%|███████▌  | 59/78 [00:15<00:04,  3.85it/s][A
Iteration:  77%|███████▋  | 60/78 [00:15<00:04,  3.86it/s][A
Iteration:  78%|███████▊  | 61/78 [00:16<00:04,  3.87it/s][A
Iteration:  79%|███████▉  | 62/78 [00:16<00:04,  3.88it/s][A
Iteration:  81%|████████  | 63/78 [00:16<00:03,  3.88it/s][A
Iteration:  82%|████████▏ | 64/78 [00:17<00:03,  3.88it/s][A
Iteration:  83%|████████▎ | 65/78 [00:17<00:03,  3.89it/s][A
Iteration:  85%|████████▍ | 66/78 [00:17<00:03,  3.89it/s][A
Iteration:  86%|████████▌ | 67/78 [00:17<00:02,  3.89it/s][A
Iteration:  87%|████████▋ | 68/78 [00:18<00:02,  3.89it/s][A
Iteration:  88%|████████▊ | 69/78 [00:18<00:02,  3.89it/s][A
Iteration:  90%|████████▉ | 70/78 [00:18<00:02,  3.88it/s][A
Iteration:  91%|█████████ | 71/78 [00:18<00:01,  3.88it/s][A
Iteration:  92%|█████████▏| 72/78 [00:19<00:01,  3.89it/s][A
Iteration:  94%|█████████▎| 73/78 [00:19<00:01,  3.89it/s][A
Iteration:  95%|█████████▍| 74/78 [00:19<00:01,  3.89it/s][A
Iteration:  96%|█████████▌| 75/78 [00:19<00:00,  3.89it/s][A
Iteration:  97%|█████████▋| 76/78 [00:20<00:00,  3.89it/s][A
Iteration:  99%|█████████▊| 77/78 [00:20<00:00,  3.89it/s][A
Iteration: 100%|██████████| 78/78 [00:20<00:00,  4.12it/s][A04/23/2024 23:42:04 - INFO - trainer.trainer_mod - Epoch 0 finished. Took 20.57 seconds.
Iteration: 100%|██████████| 78/78 [00:20<00:00,  3.79it/s]
Epoch:   1%|          | 1/100 [00:21<34:59, 21.21s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:19,  3.89it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:19,  3.88it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:19,  3.89it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:19,  3.89it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:18,  3.89it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:18,  3.89it/s][A
Iteration:   9%|▉         | 7/78 [00:01<00:18,  3.89it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:18,  3.89it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:17,  3.89it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:17,  3.89it/s][A
Iteration:  14%|█▍        | 11/78 [00:02<00:17,  3.89it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:16,  3.96it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:16,  3.93it/s][A
Iteration:  18%|█▊        | 14/78 [00:03<00:16,  3.92it/s][A
Iteration:  19%|█▉        | 15/78 [00:03<00:16,  3.91it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:15,  3.91it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:15,  3.90it/s][A
Iteration:  23%|██▎       | 18/78 [00:04<00:15,  3.90it/s][A
Iteration:  24%|██▍       | 19/78 [00:04<00:15,  3.90it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:14,  3.89it/s][A
Iteration:  27%|██▋       | 21/78 [00:05<00:14,  3.89it/s][A[INFO|trainer.py:570] 2024-04-23 23:42:10,028 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:42:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:42:10 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:42:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A

Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 17.11it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.91it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.54it/s]04/23/2024 23:42:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:42:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.6440101, 'step': 100}


Iteration:  28%|██▊       | 22/78 [00:06<00:23,  2.42it/s][A04/23/2024 23:42:10 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/23/2024 23:42:10 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/23/2024 23:42:10 - INFO - trainer.trainer_mod - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/23/2024 23:42:10 - INFO - trainer.trainer_mod - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/23/2024 23:42:10 - INFO - trainer.trainer_mod - Starting l0 regularization!
04/23/2024 23:42:10 - INFO - trainer.trainer_mod - v4 Global step: 100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  29%|██▉       | 23/78 [00:06<00:22,  2.49it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:20,  2.59it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:19,  2.70it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:18,  2.78it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:18,  2.83it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:17,  2.87it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:16,  2.89it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:16,  2.92it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:15,  2.94it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:15,  2.94it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:15,  2.94it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  2.95it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:14,  2.96it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:14,  2.96it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  2.96it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:13,  2.96it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:13,  2.97it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  2.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:12,  2.97it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:12,  2.97it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  2.98it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:11,  2.97it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  2.97it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:10,  2.96it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:10,  2.97it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  2.97it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:09,  2.97it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:09,  2.98it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  2.98it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:08,  2.98it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  2.99it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:07,  2.98it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:07,  2.98it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  2.97it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:06,  2.98it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:06,  2.98it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  2.98it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  2.98it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:05,  2.98it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  2.99it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.00it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  2.99it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  2.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:03,  2.94it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  2.96it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 23:42:27,420 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:42:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:42:27 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:42:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:42:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.37it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.35it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.91it/s]04/23/2024 23:42:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:42:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.6374392, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2621, 2612, 2612, 2610, 2606, 2608, 2596, 2596, 2585, 2587, 2585, 2600], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8953800, 'remaining_params': 76063800, 'pruned_model_sparsity': 0.10531701671183379, 'expected_sparsity': 0.10685, 'target_sparsity': 0.030448717948717945, 'step': 150}


Iteration:  92%|█████████▏| 72/78 [00:23<00:03,  1.90it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:02,  2.14it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  2.34it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:01,  2.50it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  2.63it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  2.73it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  2.92it/s][A04/23/2024 23:42:30 - INFO - trainer.trainer_mod - Epoch 1 finished. Took 25.62 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.04it/s]
Epoch:   2%|▏         | 2/100 [00:46<38:52, 23.80s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:26,  2.95it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.97it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.97it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:25,  2.96it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.97it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.99it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  2.98it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.97it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.97it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.98it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.98it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.98it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.95it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.95it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.96it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.97it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  2.96it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.96it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  2.97it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  2.97it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.96it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.96it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  2.98it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.98it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.98it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  2.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.97it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.98it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  2.99it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.99it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.98it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.97it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.96it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.97it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  2.96it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.97it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.98it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.95it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.95it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.95it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.95it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.95it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 23:42:44,826 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:42:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:42:44 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:42:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:42:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.47it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.34it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.89it/s]04/23/2024 23:42:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:42:45 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.65021855, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2673, 2660, 2660, 2654, 2650, 2653, 2629, 2629, 2614, 2620, 2625, 2688], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8131116, 'remaining_params': 76886484, 'pruned_model_sparsity': 0.09564038504968383, 'expected_sparsity': 0.0972, 'target_sparsity': 0.06089743589743589, 'step': 200}


Iteration:  56%|█████▋    | 44/78 [00:15<00:17,  1.90it/s][A04/23/2024 23:42:45 - INFO - trainer.trainer_mod - v4 Global step: 200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  58%|█████▊    | 45/78 [00:15<00:15,  2.18it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:13,  2.37it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:12,  2.52it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:11,  2.65it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:10,  2.74it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.80it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.86it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  2.90it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.93it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.95it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  2.95it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.96it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.96it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.96it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.96it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.96it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.97it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.97it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.97it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.97it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.97it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.98it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.97it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.97it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.96it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.97it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.98it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.97it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.98it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.97it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.96it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.10it/s][A04/23/2024 23:42:56 - INFO - trainer.trainer_mod - Epoch 2 finished. Took 26.81 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.91it/s]
Epoch:   3%|▎         | 3/100 [01:13<40:42, 25.18s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.00it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.00it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.99it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  2.98it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.96it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.95it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:24,  2.95it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.95it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.96it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.96it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.97it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.97it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.97it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.97it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.95it/s][A[INFO|trainer.py:570] 2024-04-23 23:43:02,212 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:43:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:43:02 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:43:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:43:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.39it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.31it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.89it/s]04/23/2024 23:43:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:43:02 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.6857163, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2714, 2699, 2697, 2693, 2686, 2690, 2661, 2662, 2642, 2655, 2669, 2764], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7400352, 'remaining_params': 77617248, 'pruned_model_sparsity': 0.08704494128274616, 'expected_sparsity': 0.08865, 'target_sparsity': 0.09134615384615384, 'step': 250}


Iteration:  21%|██        | 16/78 [00:06<00:32,  1.90it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:28,  2.12it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:25,  2.32it/s][A
Iteration:  24%|██▍       | 19/78 [00:07<00:23,  2.46it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:22,  2.59it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:21,  2.69it/s][A
Iteration:  28%|██▊       | 22/78 [00:08<00:20,  2.77it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.83it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.88it/s][A
Iteration:  32%|███▏      | 25/78 [00:09<00:18,  2.91it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.93it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.93it/s][A
Iteration:  36%|███▌      | 28/78 [00:10<00:16,  2.96it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.96it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.96it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:15,  2.97it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.97it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.97it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:14,  2.99it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  2.98it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.97it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:13,  2.97it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.96it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.96it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:12,  2.97it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  2.98it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.99it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  2.98it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.97it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.97it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  2.97it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.96it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.97it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  2.98it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.97it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.98it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  2.98it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.98it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  2.97it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.96it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.96it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.95it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.97it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.98it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.98it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.98it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.98it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.99it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 23:43:19,660 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:43:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:43:19 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:43:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:43:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.46it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.42it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.36it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.95it/s]04/23/2024 23:43:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:43:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.7069525, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2744, 2728, 2728, 2723, 2714, 2719, 2687, 2688, 2667, 2682, 2705, 2814], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6838108, 'remaining_params': 78179492, 'pruned_model_sparsity': 0.08043167532369769, 'expected_sparsity': 0.08201, 'target_sparsity': 0.12179487179487178, 'step': 300}


Iteration:  85%|████████▍ | 66/78 [00:23<00:06,  1.92it/s][A04/23/2024 23:43:20 - INFO - trainer.trainer_mod - v4 Global step: 300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  86%|████████▌ | 67/78 [00:23<00:05,  2.15it/s][A
Iteration:  87%|████████▋ | 68/78 [00:24<00:04,  2.35it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.51it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:03,  2.63it/s][A
Iteration:  91%|█████████ | 71/78 [00:25<00:02,  2.73it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.80it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.85it/s][A
Iteration:  95%|█████████▍| 74/78 [00:26<00:01,  2.90it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.93it/s][A
Iteration:  99%|█████████▊| 77/78 [00:27<00:00,  2.95it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.11it/s][A04/23/2024 23:43:24 - INFO - trainer.trainer_mod - Epoch 3 finished. Took 27.44 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.84it/s]
Epoch:   4%|▍         | 4/100 [01:41<41:42, 26.07s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.00it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.99it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.00it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.00it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.02it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.00it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.00it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.99it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.99it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.99it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.98it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.97it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.98it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.96it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.95it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.96it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  2.97it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.97it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  2.97it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  2.97it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.98it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.99it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  2.99it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.98it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.95it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  2.95it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.95it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.96it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  2.97it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.96it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.97it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.97it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.97it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  2.98it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.97it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 23:43:37,033 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:43:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:43:37 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:43:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:43:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.47it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.89it/s]04/23/2024 23:43:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:43:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.6907636, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2762, 2747, 2747, 2740, 2731, 2737, 2703, 2705, 2681, 2698, 2726, 2839], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6505664, 'remaining_params': 78511936, 'pruned_model_sparsity': 0.07652137910267992, 'expected_sparsity': 0.07812, 'target_sparsity': 0.15224358974358976, 'step': 350}


Iteration:  49%|████▊     | 38/78 [00:13<00:21,  1.90it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:18,  2.13it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:16,  2.33it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:14,  2.50it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.62it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:12,  2.70it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:12,  2.77it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.82it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:11,  2.86it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.94it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.95it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  2.96it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.96it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.98it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  2.97it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.97it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  2.98it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.01it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  3.00it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.99it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.98it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.98it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.98it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.98it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.98it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.96it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.96it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.97it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.98it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.98it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.99it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.98it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.99it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.99it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.98it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.97it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.97it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.29it/s][A04/23/2024 23:43:50 - INFO - trainer.trainer_mod - Epoch 4 finished. Took 26.72 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.92it/s]
Epoch:   5%|▌         | 5/100 [02:07<41:38, 26.30s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:26,  2.95it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.96it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.95it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  2.97it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.96it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.96it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  2.97it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.98it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 23:43:54,339 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:43:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:43:54 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:43:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:43:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.37it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.31it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.90it/s]04/23/2024 23:43:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:43:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.7003610108303249, 'eval_loss': 0.64051765, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2771, 2755, 2757, 2747, 2737, 2743, 2705, 2709, 2685, 2699, 2729, 2837], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6416808, 'remaining_params': 78600792, 'pruned_model_sparsity': 0.07547623080397471, 'expected_sparsity': 0.07702, 'target_sparsity': 0.18269230769230768, 'step': 400}


Iteration:  13%|█▎        | 10/78 [00:03<00:35,  1.89it/s][A04/23/2024 23:43:55 - INFO - trainer.trainer_mod - v4 Global step: 400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  14%|█▍        | 11/78 [00:04<00:31,  2.12it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:28,  2.32it/s][A
Iteration:  17%|█▋        | 13/78 [00:05<00:26,  2.48it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:24,  2.61it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:23,  2.71it/s][A
Iteration:  21%|██        | 16/78 [00:06<00:22,  2.79it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.85it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.88it/s][A
Iteration:  24%|██▍       | 19/78 [00:07<00:20,  2.90it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.91it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.93it/s][A
Iteration:  28%|██▊       | 22/78 [00:08<00:19,  2.93it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.95it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.96it/s][A
Iteration:  32%|███▏      | 25/78 [00:09<00:17,  2.96it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.96it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.96it/s][A
Iteration:  36%|███▌      | 28/78 [00:10<00:16,  2.97it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.97it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.97it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:15,  2.95it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.95it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.96it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:14,  2.96it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  2.97it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.98it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:13,  2.97it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.97it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.97it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:12,  2.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  2.97it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.96it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  2.97it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.97it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.98it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  2.98it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.99it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.99it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  2.98it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.98it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.00it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  2.99it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.99it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  2.98it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.98it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.98it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.97it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 23:44:11,797 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:44:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:44:11 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:44:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:44:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.36it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.32it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.89it/s]04/23/2024 23:44:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:44:12 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.85780406, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2765, 2749, 2753, 2740, 2729, 2736, 2692, 2699, 2674, 2678, 2704, 2798], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6657332, 'remaining_params': 78360268, 'pruned_model_sparsity': 0.07830533912978019, 'expected_sparsity': 0.07995, 'target_sparsity': 0.21314102564102563, 'step': 450}


Iteration:  77%|███████▋  | 60/78 [00:21<00:09,  1.90it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:07,  2.13it/s][A
Iteration:  79%|███████▉  | 62/78 [00:22<00:06,  2.33it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:06,  2.49it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.63it/s][A
Iteration:  83%|████████▎ | 65/78 [00:23<00:04,  2.72it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:04,  2.80it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.85it/s][A
Iteration:  87%|████████▋ | 68/78 [00:24<00:03,  2.88it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.90it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.91it/s][A
Iteration:  91%|█████████ | 71/78 [00:25<00:02,  2.92it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.94it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.95it/s][A
Iteration:  95%|█████████▍| 74/78 [00:26<00:01,  2.96it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:27<00:00,  2.96it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.11it/s][A04/23/2024 23:44:18 - INFO - trainer.trainer_mod - Epoch 5 finished. Took 27.46 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.84it/s]
Epoch:   6%|▌         | 6/100 [02:35<41:49, 26.70s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.98it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.96it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.97it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  2.97it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.97it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.96it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  2.97it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.96it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.96it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.97it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.97it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.97it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.97it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.98it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.98it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.95it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  2.96it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.96it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  2.97it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  2.97it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.98it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.98it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  2.97it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.97it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  2.96it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.95it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.97it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  2.97it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.98it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.96it/s][A[INFO|trainer.py:570] 2024-04-23 23:44:29,220 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:44:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:44:29 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:44:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:44:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.47it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.36it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.35it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.91it/s]04/23/2024 23:44:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:44:29 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6859205776173285, 'eval_loss': 0.77027255, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2740, 2725, 2732, 2713, 2702, 2711, 2656, 2666, 2638, 2618, 2622, 2656], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7481548, 'remaining_params': 77536052, 'pruned_model_sparsity': 0.08799999059018368, 'expected_sparsity': 0.08976, 'target_sparsity': 0.24358974358974356, 'step': 500}


Iteration:  41%|████      | 32/78 [00:11<00:24,  1.91it/s][A04/23/2024 23:44:29 - INFO - trainer.trainer_mod - v4 Global step: 500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  42%|████▏     | 33/78 [00:11<00:21,  2.13it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:18,  2.33it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:17,  2.50it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:16,  2.62it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:15,  2.72it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:14,  2.79it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.84it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:13,  2.88it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  2.91it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.92it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  2.93it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.95it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.95it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  2.96it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.96it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.97it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  2.97it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.01it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.00it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  2.99it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.98it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  2.99it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.99it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.98it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.98it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.97it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.96it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.97it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.96it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.96it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.95it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.96it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.95it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.96it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.97it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.94it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.96it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.95it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.96it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.95it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.96it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.97it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.12it/s][A04/23/2024 23:44:45 - INFO - trainer.trainer_mod - Epoch 6 finished. Took 26.84 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.91it/s]
Epoch:   7%|▋         | 7/100 [03:02<41:27, 26.75s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:26,  2.94it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.94it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 23:44:46,631 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:44:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:44:46 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:44:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:44:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.36it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.33it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.92it/s]04/23/2024 23:44:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:44:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.80529225, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2684, 2670, 2685, 2654, 2644, 2656, 2578, 2595, 2564, 2482, 2418, 2199], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9549748, 'remaining_params': 75467852, 'pruned_model_sparsity': 0.1123267182324601, 'expected_sparsity': 0.11435, 'target_sparsity': 0.2740384615384615, 'step': 550}


Iteration:   5%|▌         | 4/78 [00:01<00:43,  1.71it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:36,  2.02it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:31,  2.27it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:28,  2.46it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:26,  2.60it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:25,  2.70it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:24,  2.78it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.84it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.87it/s][A
Iteration:  17%|█▋        | 13/78 [00:05<00:22,  2.88it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.91it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.93it/s][A
Iteration:  21%|██        | 16/78 [00:06<00:21,  2.95it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.96it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.96it/s][A
Iteration:  24%|██▍       | 19/78 [00:07<00:19,  2.96it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.96it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.97it/s][A
Iteration:  28%|██▊       | 22/78 [00:08<00:18,  2.97it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.97it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:09<00:17,  2.96it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.96it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.97it/s][A
Iteration:  36%|███▌      | 28/78 [00:10<00:16,  2.97it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.00it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:15,  2.99it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.98it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:14,  2.98it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  2.98it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.98it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:13,  2.98it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.98it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.97it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:12,  2.97it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  2.96it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.95it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  2.97it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.97it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.98it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  2.97it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.96it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.97it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  3.03it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.00it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.97it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  2.97it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.97it/s][A[INFO|trainer.py:570] 2024-04-23 23:45:04,066 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:45:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:45:04 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:45:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:45:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.41it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.38it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.33it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.92it/s]04/23/2024 23:45:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:45:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6931407942238267, 'eval_loss': 0.88114816, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2572, 2562, 2595, 2542, 2535, 2554, 2433, 2466, 2431, 2223, 2071, 1455], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 13211228, 'remaining_params': 71806372, 'pruned_model_sparsity': 0.15539403605841615, 'expected_sparsity': 0.1579, 'target_sparsity': 0.3044871794871795, 'step': 600}


Iteration:  69%|██████▉   | 54/78 [00:19<00:12,  1.91it/s][A04/23/2024 23:45:04 - INFO - trainer.trainer_mod - v4 Global step: 600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.13it/s][A
Iteration:  72%|███████▏  | 56/78 [00:20<00:09,  2.34it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:08,  2.50it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.64it/s][A
Iteration:  76%|███████▌  | 59/78 [00:21<00:06,  2.72it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:06,  2.80it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.85it/s][A
Iteration:  79%|███████▉  | 62/78 [00:22<00:05,  2.87it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:05,  2.90it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.92it/s][A
Iteration:  83%|████████▎ | 65/78 [00:23<00:04,  2.92it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:04,  2.93it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.94it/s][A
Iteration:  87%|████████▋ | 68/78 [00:24<00:03,  2.95it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.96it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.96it/s][A
Iteration:  91%|█████████ | 71/78 [00:25<00:02,  2.96it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.96it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.97it/s][A
Iteration:  95%|█████████▍| 74/78 [00:26<00:01,  2.96it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:27<00:00,  2.96it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.10it/s][A04/23/2024 23:45:12 - INFO - trainer.trainer_mod - Epoch 7 finished. Took 27.46 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.84it/s]
Epoch:   8%|▊         | 8/100 [03:29<41:21, 26.97s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.98it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.02it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  2.99it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.99it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.98it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.00it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.99it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.99it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.99it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.98it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.99it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.98it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.97it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.97it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.98it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  2.98it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.98it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  2.97it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  2.96it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.97it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.98it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  2.98it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 23:45:21,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:45:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:45:21 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:45:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:45:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.38it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.92it/s]04/23/2024 23:45:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:45:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8869728, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2388, 2388, 2447, 2373, 2359, 2388, 2219, 2287, 2246, 1863, 1688, 900], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 17643304, 'remaining_params': 67374296, 'pruned_model_sparsity': 0.20752531240590183, 'expected_sparsity': 0.21127, 'target_sparsity': 0.33493589743589747, 'step': 650}


Iteration:  33%|███▎      | 26/78 [00:09<00:27,  1.91it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.14it/s][A
Iteration:  36%|███▌      | 28/78 [00:10<00:21,  2.33it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:19,  2.49it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:18,  2.62it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:17,  2.72it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:16,  2.80it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.84it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:15,  2.87it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  2.91it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.92it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:14,  2.92it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.94it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.95it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:12,  2.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  2.97it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.97it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  2.97it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.98it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  2.98it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.98it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.98it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  2.97it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.96it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.96it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  2.97it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.97it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  2.97it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.97it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.97it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.96it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.96it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.96it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.96it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.97it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.99it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.98it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.99it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.98it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.98it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.98it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.98it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.98it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.98it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.98it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.98it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.99it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.99it/s][A[INFO|trainer.py:570] 2024-04-23 23:45:38,894 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:45:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:45:38 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:45:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:45:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.49it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.39it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.40it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.96it/s]04/23/2024 23:45:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:45:39 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 0.755975, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2147, 2162, 2240, 2158, 2128, 2171, 1968, 2086, 2026, 1486, 1347, 608], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 22268412, 'remaining_params': 62749188, 'pruned_model_sparsity': 0.2619270833333333, 'expected_sparsity': 0.26854, 'target_sparsity': 0.36538461538461536, 'step': 700}


Iteration:  97%|█████████▋| 76/78 [00:26<00:01,  1.91it/s][A04/23/2024 23:45:39 - INFO - trainer.trainer_mod - v4 Global step: 700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  99%|█████████▊| 77/78 [00:27<00:00,  2.14it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.43it/s][A04/23/2024 23:45:40 - INFO - trainer.trainer_mod - Epoch 8 finished. Took 27.4 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.85it/s]
Epoch:   9%|▉         | 9/100 [03:56<41:06, 27.11s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.97it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.97it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.98it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  2.97it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.98it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.98it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  2.98it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.98it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.97it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.98it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.97it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.97it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.96it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.97it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.98it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.98it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  2.99it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.98it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  2.98it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  2.97it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.96it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.96it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  2.97it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.97it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  2.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.98it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.99it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  2.99it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.99it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.98it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.98it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.98it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  2.99it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.01it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.00it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.99it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.00it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.99it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.01it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.00it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.99it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.97it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.98it/s][A[INFO|trainer.py:570] 2024-04-23 23:45:56,246 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:45:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:45:56 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:45:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:45:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.45it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.43it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.98it/s]04/23/2024 23:45:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:45:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.9454544, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1891, 1923, 2000, 1934, 1878, 1935, 1714, 1884, 1810, 1174, 1075, 482], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 27337800, 'remaining_params': 57679800, 'pruned_model_sparsity': 0.32155459575429085, 'expected_sparsity': 0.32388, 'target_sparsity': 0.3958333333333333, 'step': 750}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.91it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:13,  2.14it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:11,  2.34it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.50it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:09,  2.63it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:09,  2.73it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.80it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.85it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.88it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.91it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.93it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.95it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.98it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.97it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.99it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.99it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.98it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.99it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.01it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.00it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.99it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.99it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.99it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.98it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.99it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.03it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.01it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.01it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.13it/s][A04/23/2024 23:46:06 - INFO - trainer.trainer_mod - Epoch 9 finished. Took 26.7 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.92it/s]
Epoch:  10%|█         | 10/100 [04:23<40:28, 26.98s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.96it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.01it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.98it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.00it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.99it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:23,  3.00it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.01it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.00it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.00it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.99it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.99it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.99it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.99it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.01it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.00it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.00it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  2.99it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 23:46:13,504 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:46:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:46:13 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:46:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:46:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.37it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.39it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.96it/s]04/23/2024 23:46:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:46:14 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 0.93324375, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1645, 1699, 1763, 1723, 1639, 1707, 1488, 1694, 1607, 965, 868, 430], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 31045240, 'remaining_params': 53972360, 'pruned_model_sparsity': 0.36516250752785306, 'expected_sparsity': 0.37574, 'target_sparsity': 0.42628205128205127, 'step': 800}


Iteration:  26%|██▌       | 20/78 [00:07<00:30,  1.92it/s][A04/23/2024 23:46:14 - INFO - trainer.trainer_mod - v4 Global step: 800, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  27%|██▋       | 21/78 [00:07<00:26,  2.16it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.35it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.51it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:20,  2.65it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:19,  2.75it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:18,  2.82it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.88it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:17,  2.91it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.94it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.97it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.98it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.99it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.00it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.02it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.03it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.04it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.04it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.98it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.99it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  3.00it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.00it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.00it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.02it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.00it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.01it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.00it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.02it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.02it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.02it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.00it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  3.00it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.02it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.01it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.02it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.02it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.01it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.01it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.01it/s][A[INFO|trainer.py:570] 2024-04-23 23:46:30,738 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:46:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:46:30 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:46:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:46:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.06it/s]04/23/2024 23:46:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:46:31 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.9957262, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1425, 1500, 1546, 1538, 1427, 1505, 1302, 1518, 1423, 871, 711, 403], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 12, 12], 'pruned_params': 35884828, 'remaining_params': 49132772, 'pruned_model_sparsity': 0.4220870502107799, 'expected_sparsity': 0.41975, 'target_sparsity': 0.4567307692307692, 'step': 850}


Iteration:  90%|████████▉ | 70/78 [00:24<00:04,  1.92it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.16it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.37it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.54it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.67it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.86it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.90it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.08it/s][A04/23/2024 23:46:33 - INFO - trainer.trainer_mod - Epoch 10 finished. Took 27.09 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.88it/s]
Epoch:  11%|█         | 11/100 [04:50<40:04, 27.02s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.04it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.00it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.01it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.02it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.00it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.02it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.02it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.01it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.02it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.01it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.01it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.02it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.01it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.02it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.03it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.03it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.02it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.03it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.04it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.05it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.04it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.02it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.03it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.02it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.03it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.03it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.04it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.03it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.03it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.04it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.03it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.04it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.02it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.04it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.03it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.04it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.05it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A[INFO|trainer.py:570] 2024-04-23 23:46:47,794 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:46:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:46:47 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:46:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:46:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.12it/s]04/23/2024 23:46:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:46:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.87222046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1240, 1327, 1357, 1378, 1245, 1328, 1142, 1360, 1262, 829, 593, 385], 'head_nums': [12, 12, 12, 12, 12, 11, 11, 12, 12, 10, 12, 12], 'pruned_params': 38824736, 'remaining_params': 46192864, 'pruned_model_sparsity': 0.4566670430593195, 'expected_sparsity': 0.45626, 'target_sparsity': 0.4871794871794871, 'step': 900}


Iteration:  54%|█████▍    | 42/78 [00:14<00:18,  1.95it/s][A04/23/2024 23:46:48 - INFO - trainer.trainer_mod - v4 Global step: 900, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  55%|█████▌    | 43/78 [00:14<00:15,  2.19it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:14,  2.38it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:12,  2.55it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.68it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:11,  2.78it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.85it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:10,  2.90it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.93it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.96it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.99it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.00it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.02it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.04it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.03it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.03it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.04it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.04it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.03it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.03it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.04it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.03it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.02it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.03it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.04it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.04it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.03it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.02it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.02it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.03it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.03it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.15it/s][A04/23/2024 23:47:00 - INFO - trainer.trainer_mod - Epoch 11 finished. Took 26.3 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.97it/s]
Epoch:  12%|█▏        | 12/100 [05:17<39:18, 26.80s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.99it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.03it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.00it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.02it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.02it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.02it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.02it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.03it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.04it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.03it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.03it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.03it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 23:47:04,856 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:47:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:47:04 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:47:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:47:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]04/23/2024 23:47:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:47:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 1.0000821, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1083, 1176, 1191, 1239, 1088, 1172, 1006, 1221, 1119, 804, 505, 372], 'head_nums': [12, 12, 12, 12, 12, 10, 11, 12, 12, 10, 12, 11], 'pruned_params': 41410752, 'remaining_params': 43606848, 'pruned_model_sparsity': 0.4870844625112918, 'expected_sparsity': 0.48828, 'target_sparsity': 0.5176282051282051, 'step': 950}


Iteration:  18%|█▊        | 14/78 [00:05<00:32,  1.94it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:28,  2.18it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:26,  2.37it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:24,  2.54it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:22,  2.68it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:21,  2.78it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:20,  2.84it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.89it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.93it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.97it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.99it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.01it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.00it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  3.00it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.99it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.99it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.02it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.03it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.03it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.04it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.04it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.02it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.02it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.03it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.04it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.04it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.03it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.04it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.04it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.03it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.02it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.03it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.03it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.02it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.04it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.04it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.03it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.04it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.03it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.04it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.04it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.02it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.03it/s][A[INFO|trainer.py:570] 2024-04-23 23:47:21,961 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:47:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:47:21 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:47:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:47:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]04/23/2024 23:47:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:47:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.88399804, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [955, 1048, 1053, 1118, 954, 1036, 893, 1099, 993, 786, 442, 362], 'head_nums': [12, 12, 12, 12, 12, 9, 11, 12, 12, 10, 12, 10], 'pruned_params': 43655132, 'remaining_params': 41362468, 'pruned_model_sparsity': 0.5134834669527251, 'expected_sparsity': 0.51739, 'target_sparsity': 0.548076923076923, 'step': 1000}


Iteration:  82%|████████▏ | 64/78 [00:22<00:07,  1.94it/s][A04/23/2024 23:47:22 - INFO - trainer.trainer_mod - v4 Global step: 1000, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.18it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:05,  2.37it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:04,  2.54it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.66it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.76it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.82it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.88it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.93it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.96it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.96it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.01it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.02it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.15it/s][A04/23/2024 23:47:27 - INFO - trainer.trainer_mod - Epoch 12 finished. Took 26.93 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.90it/s]
Epoch:  13%|█▎        | 13/100 [05:43<38:55, 26.84s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:26,  2.94it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.00it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.98it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.03it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.04it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.04it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.04it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.04it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.04it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.03it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.03it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.04it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.04it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.03it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.04it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.04it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.04it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.03it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.01it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.02it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.03it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.02it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.03it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.03it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.03it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.02it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.03it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.04it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.04it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.04it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 23:47:39,050 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:47:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:47:39 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:47:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:47:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/23/2024 23:47:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:47:39 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.7708239, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [846, 937, 933, 1012, 840, 919, 796, 990, 883, 772, 410, 353], 'head_nums': [12, 12, 12, 12, 12, 9, 11, 11, 12, 10, 11, 10], 'pruned_params': 46245744, 'remaining_params': 38771856, 'pruned_model_sparsity': 0.543954945799458, 'expected_sparsity': 0.54434, 'target_sparsity': 0.578525641025641, 'step': 1050}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.94it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.17it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:16,  2.37it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.53it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:14,  2.66it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:13,  2.77it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.85it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.91it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.94it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.97it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.99it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.02it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.03it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.02it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.02it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.02it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.03it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.04it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.05it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.02it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.03it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.03it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.05it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.04it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.04it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.04it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.04it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.05it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.03it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.02it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.16it/s][A04/23/2024 23:47:53 - INFO - trainer.trainer_mod - Epoch 13 finished. Took 26.27 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.97it/s]
Epoch:  14%|█▍        | 14/100 [06:10<38:13, 26.67s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.04it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.02it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.03it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.03it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.02it/s][A[INFO|trainer.py:570] 2024-04-23 23:47:56,087 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:47:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:47:56 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:47:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:47:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/23/2024 23:47:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:47:56 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.80778843, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [756, 840, 831, 918, 743, 817, 714, 894, 787, 759, 397, 346], 'head_nums': [12, 12, 12, 12, 12, 9, 10, 11, 12, 10, 11, 9], 'pruned_params': 47949328, 'remaining_params': 37068272, 'pruned_model_sparsity': 0.5639929614573923, 'expected_sparsity': 0.57087, 'target_sparsity': 0.608974358974359, 'step': 1100}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.90it/s][A04/23/2024 23:47:56 - INFO - trainer.trainer_mod - v4 Global step: 1100, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  12%|█▏        | 9/78 [00:03<00:32,  2.15it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.37it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:26,  2.53it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.67it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.77it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.85it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.90it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.95it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.98it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.03it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.04it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.05it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.05it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.05it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.05it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.04it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.04it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A[INFO|trainer.py:570] 2024-04-23 23:48:13,036 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:48:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:48:13 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:48:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:48:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/23/2024 23:48:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:48:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.77532804, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [680, 757, 743, 837, 660, 729, 645, 808, 703, 746, 390, 338], 'head_nums': [12, 12, 12, 12, 12, 9, 9, 11, 12, 9, 10, 9], 'pruned_params': 51433096, 'remaining_params': 33584504, 'pruned_model_sparsity': 0.6049699826859379, 'expected_sparsity': 0.59798, 'target_sparsity': 0.639423076923077, 'step': 1150}


Iteration:  74%|███████▍  | 58/78 [00:20<00:10,  1.97it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.21it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.41it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.58it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.71it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.80it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.88it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.94it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.99it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.01it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.03it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.03it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.02it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.04it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.04it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.05it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/23/2024 23:48:20 - INFO - trainer.trainer_mod - Epoch 14 finished. Took 26.69 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.92it/s]
Epoch:  15%|█▌        | 15/100 [06:36<37:47, 26.67s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.04it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.10it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A[INFO|trainer.py:570] 2024-04-23 23:48:29,889 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:48:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:48:29 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:48:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:48:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/23/2024 23:48:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:48:30 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 0.8010986, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [617, 686, 671, 763, 589, 653, 588, 732, 629, 733, 385, 330], 'head_nums': [12, 12, 12, 12, 12, 9, 9, 11, 12, 9, 10, 9], 'pruned_params': 52404384, 'remaining_params': 32613216, 'pruned_model_sparsity': 0.6163945347786811, 'expected_sparsity': 0.61675, 'target_sparsity': 0.6698717948717949, 'step': 1200}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.96it/s][A04/23/2024 23:48:30 - INFO - trainer.trainer_mod - v4 Global step: 1200, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.19it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:19,  2.41it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.58it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.71it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:15,  2.82it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.89it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.93it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.94it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.98it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.01it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.03it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.12it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.11it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.10it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.19it/s][A04/23/2024 23:48:46 - INFO - trainer.trainer_mod - Epoch 15 finished. Took 25.93 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  16%|█▌        | 16/100 [07:02<37:01, 26.45s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.04it/s][A[INFO|trainer.py:570] 2024-04-23 23:48:46,723 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:48:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:48:46 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:48:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:48:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/23/2024 23:48:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:48:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.88798046, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [563, 625, 608, 700, 528, 588, 539, 666, 563, 718, 381, 321], 'head_nums': [11, 12, 12, 12, 11, 9, 9, 10, 12, 8, 10, 9], 'pruned_params': 54028304, 'remaining_params': 30989296, 'pruned_model_sparsity': 0.6354955209274314, 'expected_sparsity': 0.63352, 'target_sparsity': 0.7003205128205129, 'step': 1250}


Iteration:   3%|▎         | 2/78 [00:01<00:52,  1.44it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:39,  1.90it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:33,  2.24it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.49it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:26,  2.67it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.80it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.89it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.95it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.99it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.01it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.03it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.04it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.06it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.10it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.10it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.10it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.10it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.11it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.10it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.10it/s][A[INFO|trainer.py:570] 2024-04-23 23:49:03,519 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:49:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:49:03 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:49:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:49:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.83it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.29it/s]04/23/2024 23:49:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:49:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.82693887, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [516, 571, 553, 644, 474, 531, 497, 607, 505, 702, 376, 312], 'head_nums': [11, 12, 12, 12, 11, 8, 9, 10, 12, 7, 10, 9], 'pruned_params': 55158920, 'remaining_params': 29858680, 'pruned_model_sparsity': 0.6487941320385426, 'expected_sparsity': 0.65078, 'target_sparsity': 0.7307692307692307, 'step': 1300}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.98it/s][A04/23/2024 23:49:04 - INFO - trainer.trainer_mod - v4 Global step: 1300, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.21it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:09,  2.42it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.58it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.71it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.82it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.89it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.96it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.99it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.02it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.04it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.22it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.18it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.12it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.11it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.24it/s][A04/23/2024 23:49:12 - INFO - trainer.trainer_mod - Epoch 16 finished. Took 26.43 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  17%|█▋        | 17/100 [07:29<36:34, 26.44s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.12it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.10it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.10it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A[INFO|trainer.py:570] 2024-04-23 23:49:20,263 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:49:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:49:20 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:49:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:49:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.24it/s]04/23/2024 23:49:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:49:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 0.7910551, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [476, 524, 505, 593, 427, 480, 462, 555, 453, 685, 372, 303], 'head_nums': [11, 12, 11, 12, 10, 7, 8, 10, 12, 6, 9, 9], 'pruned_params': 56983532, 'remaining_params': 28034068, 'pruned_model_sparsity': 0.6702557117585065, 'expected_sparsity': 0.66862, 'target_sparsity': 0.7612179487179487, 'step': 1350}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:24,  2.20it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.40it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.56it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.70it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.80it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.88it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.94it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.01it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.04it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.04it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.10it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A[INFO|trainer.py:570] 2024-04-23 23:49:37,098 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:49:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:49:37 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:49:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:49:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.23it/s]04/23/2024 23:49:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:49:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.8918565, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [441, 481, 464, 549, 387, 437, 433, 511, 408, 666, 367, 293], 'head_nums': [11, 12, 11, 12, 10, 7, 8, 9, 12, 5, 9, 9], 'pruned_params': 57933372, 'remaining_params': 27084228, 'pruned_model_sparsity': 0.6814279866757, 'expected_sparsity': 0.68812, 'target_sparsity': 0.7916666666666666, 'step': 1400}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.94it/s][A04/23/2024 23:49:37 - INFO - trainer.trainer_mod - v4 Global step: 1400, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.19it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.40it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.58it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.82it/s][A04/23/2024 23:49:38 - INFO - trainer.trainer_mod - Epoch 17 finished. Took 26.49 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  18%|█▊        | 18/100 [07:55<36:09, 26.46s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.12it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.11it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.11it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.11it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.11it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.10it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.11it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.10it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.10it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.10it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.10it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.08it/s][A[INFO|trainer.py:570] 2024-04-23 23:49:53,848 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:49:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:49:53 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:49:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:49:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.87it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.77it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.73it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.31it/s]04/23/2024 23:49:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:49:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.7437036, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [411, 444, 429, 510, 352, 398, 408, 472, 369, 646, 362, 283], 'head_nums': [10, 11, 11, 12, 9, 6, 8, 9, 12, 4, 9, 9], 'pruned_params': 61165892, 'remaining_params': 23851708, 'pruned_model_sparsity': 0.7194497609906655, 'expected_sparsity': 0.71322, 'target_sparsity': 0.8221153846153846, 'step': 1450}


Iteration:  59%|█████▉    | 46/78 [00:15<00:16,  1.97it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:13,  2.22it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:12,  2.42it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:11,  2.59it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:10,  2.71it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.82it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.89it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.95it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.99it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.01it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.03it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.10it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.10it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.10it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.11it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.11it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.10it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.11it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.11it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.12it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.10it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.25it/s][A04/23/2024 23:50:04 - INFO - trainer.trainer_mod - Epoch 18 finished. Took 25.76 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.03it/s]
Epoch:  19%|█▉        | 19/100 [08:21<35:26, 26.25s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.12it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.11it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.11it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.11it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.12it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.12it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.12it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.12it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A[INFO|trainer.py:570] 2024-04-23 23:50:10,538 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:50:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:50:10 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:50:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:50:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.91it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.88it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.82it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.39it/s]04/23/2024 23:50:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:50:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6028880866425993, 'eval_loss': 0.93030137, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [385, 413, 399, 477, 321, 364, 387, 440, 335, 624, 356, 273], 'head_nums': [9, 11, 11, 11, 9, 6, 8, 8, 12, 3, 8, 9], 'pruned_params': 62563076, 'remaining_params': 22454524, 'pruned_model_sparsity': 0.7358838169978922, 'expected_sparsity': 0.72934, 'target_sparsity': 0.8525641025641025, 'step': 1500}


Iteration:  23%|██▎       | 18/78 [00:06<00:30,  1.98it/s][A04/23/2024 23:50:11 - INFO - trainer.trainer_mod - v4 Global step: 1500, Alignment: tensor([3, 6, 7, 8], device='cuda:0')

Iteration:  24%|██▍       | 19/78 [00:06<00:26,  2.22it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:23,  2.43it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:21,  2.60it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:20,  2.73it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.84it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.91it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.97it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.01it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.10it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.12it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.12it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.11it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.12it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.11it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.11it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.11it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.10it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.11it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.10it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.10it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.11it/s][A[INFO|trainer.py:570] 2024-04-23 23:50:27,253 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:50:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:50:27 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:50:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:50:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.80it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.78it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.72it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.31it/s]04/23/2024 23:50:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:50:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.8082417, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [363, 385, 373, 447, 296, 335, 369, 411, 307, 601, 349, 263], 'head_nums': [9, 11, 11, 10, 9, 6, 8, 8, 12, 3, 8, 8], 'pruned_params': 63119192, 'remaining_params': 21898408, 'pruned_model_sparsity': 0.7424250037639265, 'expected_sparsity': 0.74684, 'target_sparsity': 0.8830128205128205, 'step': 1550}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.23it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:03,  2.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.58it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.71it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.82it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.91it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.99it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.00it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A04/23/2024 23:50:31 - INFO - trainer.trainer_mod - Epoch 19 finished. Took 26.32 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.96it/s]
Epoch:  20%|██        | 20/100 [08:47<35:01, 26.27s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.10it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.11it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.11it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.12it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.10it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.11it/s][A[INFO|trainer.py:570] 2024-04-23 23:50:43,990 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:50:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:50:43 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:50:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:50:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.83it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.85it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.83it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.76it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.36it/s]04/23/2024 23:50:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:50:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.7454054, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [344, 362, 353, 420, 275, 310, 354, 386, 283, 576, 342, 253], 'head_nums': [9, 11, 11, 10, 9, 6, 7, 8, 12, 3, 7, 8], 'pruned_params': 66169404, 'remaining_params': 18848196, 'pruned_model_sparsity': 0.7783024220867208, 'expected_sparsity': 0.7701, 'target_sparsity': 0.9134615384615384, 'step': 1600}


Iteration:  51%|█████▏    | 40/78 [00:13<00:19,  1.99it/s][A04/23/2024 23:50:44 - INFO - trainer.trainer_mod - v4 Global step: 1600, Alignment: tensor([1, 3, 6, 8], device='cuda:0')

Iteration:  53%|█████▎    | 41/78 [00:13<00:16,  2.20it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:14,  2.42it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.59it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.72it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.83it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.91it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.97it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.03it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.10it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.10it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.11it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.11it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.12it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.12it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.11it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.12it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.11it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.11it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.10it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.24it/s][A04/23/2024 23:50:56 - INFO - trainer.trainer_mod - Epoch 20 finished. Took 25.77 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.03it/s]
Epoch:  21%|██        | 21/100 [09:13<34:23, 26.12s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.12it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.12it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.15it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.13it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.13it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.11it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.11it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A[INFO|trainer.py:570] 2024-04-23 23:51:00,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:51:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:51:00 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:51:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:51:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.84it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.81it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.80it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.37it/s]04/23/2024 23:51:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:51:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.83518934, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [327, 342, 335, 395, 257, 287, 341, 362, 262, 550, 335, 243], 'head_nums': [8, 11, 11, 10, 8, 6, 7, 8, 12, 2, 6, 8], 'pruned_params': 67031920, 'remaining_params': 17985680, 'pruned_model_sparsity': 0.7884475685034628, 'expected_sparsity': 0.78319, 'target_sparsity': 0.9439102564102564, 'step': 1650}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.97it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.21it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.39it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.57it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:22,  2.72it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.83it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.91it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  2.96it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.02it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.03it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.05it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.10it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.10it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.22it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.20it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.17it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:14,  3.15it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.14it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.13it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.13it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.12it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.13it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.12it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.11it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.12it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.12it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.12it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.10it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.10it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.10it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.11it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.11it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.12it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.11it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.11it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.12it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.13it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.12it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.12it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.13it/s][A[INFO|trainer.py:570] 2024-04-23 23:51:17,352 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:51:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:51:17 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:51:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:51:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.95it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.87it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.86it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.88it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.46it/s]04/23/2024 23:51:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:51:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.7889925, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [312, 325, 319, 375, 243, 268, 329, 341, 244, 524, 327, 234], 'head_nums': [8, 11, 10, 9, 8, 6, 7, 8, 12, 2, 6, 8], 'pruned_params': 68049168, 'remaining_params': 16968432, 'pruned_model_sparsity': 0.8004127145438121, 'expected_sparsity': 0.79678, 'target_sparsity': 0.95, 'step': 1700}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  2.00it/s][A04/23/2024 23:51:18 - INFO - trainer.trainer_mod - v4 Global step: 1700, Alignment: tensor([1, 2, 3, 8], device='cuda:0')

Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.24it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:05,  2.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.61it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.75it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.86it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.93it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.97it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.03it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.11it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.26it/s][A04/23/2024 23:51:23 - INFO - trainer.trainer_mod - Epoch 21 finished. Took 26.21 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.98it/s]
Epoch:  22%|██▏       | 22/100 [09:39<33:59, 26.15s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.15it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.11it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.13it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.12it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.12it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.12it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.12it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.11it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.13it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.13it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.12it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.12it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.12it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.12it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.13it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.11it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.11it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.12it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.12it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.11it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.11it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.12it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.12it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.12it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:16,  3.12it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.12it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.14it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:15,  3.13it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.13it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.11it/s][A[INFO|trainer.py:570] 2024-04-23 23:51:33,933 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:51:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:51:33 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:51:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:51:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.91it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.87it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.85it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.85it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.44it/s]04/23/2024 23:51:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:51:34 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.6914437, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [300, 311, 305, 356, 233, 253, 320, 323, 229, 497, 318, 225], 'head_nums': [7, 11, 9, 8, 8, 6, 7, 8, 12, 2, 6, 8], 'pruned_params': 68830488, 'remaining_params': 16187112, 'pruned_model_sparsity': 0.8096028116531165, 'expected_sparsity': 0.80859, 'target_sparsity': 0.95, 'step': 1750}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.99it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:19,  2.23it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.45it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.64it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.78it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.87it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.98it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.12it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.12it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.11it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.12it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.13it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.13it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.13it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.13it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.13it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.12it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.12it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.12it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.12it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.13it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.11it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.11it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.13it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.14it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.13it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.13it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.16it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.14it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.14it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.14it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.14it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.16it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.14it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.14it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.15it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.16it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.17it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.17it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.32it/s][A04/23/2024 23:51:48 - INFO - trainer.trainer_mod - Epoch 22 finished. Took 25.46 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.06it/s]
Epoch:  23%|██▎       | 23/100 [10:05<33:17, 25.94s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.14it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.13it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.12it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.14it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.16it/s][A[INFO|trainer.py:570] 2024-04-23 23:51:50,405 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:51:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:51:50 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:51:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:51:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.10it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.10it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.02it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.96it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.57it/s]04/23/2024 23:51:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:51:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.65968657, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [288, 298, 293, 341, 226, 240, 312, 309, 218, 472, 310, 218], 'head_nums': [7, 11, 9, 8, 8, 5, 7, 8, 12, 2, 6, 8], 'pruned_params': 70710252, 'remaining_params': 14307348, 'pruned_model_sparsity': 0.8317131041102078, 'expected_sparsity': 0.82394, 'target_sparsity': 0.95, 'step': 1800}


Iteration:   8%|▊         | 6/78 [00:02<00:37,  1.91it/s][A04/23/2024 23:51:51 - INFO - trainer.trainer_mod - v4 Global step: 1800, Alignment: tensor([2, 3, 6, 8], device='cuda:0')

Iteration:   9%|▉         | 7/78 [00:02<00:32,  2.18it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:28,  2.47it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:26,  2.63it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:24,  2.74it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.86it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.95it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.03it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:20,  3.05it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.06it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.11it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.14it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.14it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.14it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.15it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.14it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.13it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.13it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.13it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.18it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.16it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.17it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.16it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.16it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.13it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.13it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.13it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.13it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.15it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.14it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.13it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.14it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.17it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:11,  3.19it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.16it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.17it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.13it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.16it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.16it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.17it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.17it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.15it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.16it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.18it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.18it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.18it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.19it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.17it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.18it/s][A[INFO|trainer.py:570] 2024-04-23 23:52:06,842 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:52:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:52:06 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:52:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:52:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.06it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.98it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.02it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.02it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.60it/s]04/23/2024 23:52:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:52:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.6507406, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [278, 288, 283, 326, 224, 231, 305, 298, 210, 448, 302, 211], 'head_nums': [7, 11, 9, 8, 8, 4, 7, 7, 12, 2, 5, 8], 'pruned_params': 71225004, 'remaining_params': 13792596, 'pruned_model_sparsity': 0.8377677563233966, 'expected_sparsity': 0.83511, 'target_sparsity': 0.95, 'step': 1850}


Iteration:  72%|███████▏  | 56/78 [00:18<00:10,  2.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.27it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:08,  2.49it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:07,  2.66it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.80it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  2.92it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  2.98it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.13it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.16it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.16it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.17it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.16it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.16it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.14it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.15it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.16it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.15it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.19it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.22it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.21it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.20it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.35it/s][A04/23/2024 23:52:14 - INFO - trainer.trainer_mod - Epoch 23 finished. Took 25.79 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  24%|██▍       | 24/100 [10:31<32:48, 25.90s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.30it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.18it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.18it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.20it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.24it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.20it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.27it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.26it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.24it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.20it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.25it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.21it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.20it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.21it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.21it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:19,  3.21it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.20it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.18it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:18,  3.18it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.18it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.16it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:17,  3.16it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.16it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.20it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.20it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.23it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 23:52:23,027 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:52:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:52:23 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:52:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:52:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.26it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.07it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.02it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.02it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.62it/s]04/23/2024 23:52:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:52:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.6467306, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 278, 275, 314, 222, 226, 299, 290, 204, 425, 294, 205], 'head_nums': [7, 10, 9, 8, 8, 4, 6, 7, 12, 2, 5, 8], 'pruned_params': 72059944, 'remaining_params': 12957656, 'pruned_model_sparsity': 0.8475885463715749, 'expected_sparsity': 0.84852, 'target_sparsity': 0.95, 'step': 1900}


Iteration:  36%|███▌      | 28/78 [00:09<00:24,  2.03it/s][A04/23/2024 23:52:23 - INFO - trainer.trainer_mod - v4 Global step: 1900, Alignment: tensor([0, 3, 6, 8], device='cuda:0')

Iteration:  37%|███▋      | 29/78 [00:09<00:21,  2.28it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:19,  2.51it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:17,  2.67it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:16,  2.84it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:15,  2.92it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.99it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.11it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.13it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.13it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.16it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.16it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.17it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.18it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.19it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.17it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.17it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.16it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.19it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.20it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.19it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.19it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  3.19it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.18it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.15it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.19it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:06,  3.19it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.19it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.21it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:05,  3.21it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.24it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.23it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.22it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.21it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.21it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  3.20it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.24it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.24it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.22it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.20it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.19it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.19it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.18it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.18it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.18it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.18it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.18it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.21it/s][A[INFO|trainer.py:570] 2024-04-23 23:52:39,222 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:52:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:52:39 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:52:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:52:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.09it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.03it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.04it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.05it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.63it/s]04/23/2024 23:52:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:52:39 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.6722693, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 270, 268, 302, 221, 224, 293, 284, 200, 403, 286, 200], 'head_nums': [7, 8, 9, 7, 8, 4, 5, 6, 12, 2, 5, 8], 'pruned_params': 74293600, 'remaining_params': 10724000, 'pruned_model_sparsity': 0.8738614122252334, 'expected_sparsity': 0.86309, 'target_sparsity': 0.95, 'step': 1950}


Iteration: 100%|██████████| 78/78 [00:25<00:00,  2.10it/s][A04/23/2024 23:52:39 - INFO - trainer.trainer_mod - Epoch 24 finished. Took 25.53 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.05it/s]
Epoch:  25%|██▌       | 25/100 [10:56<32:14, 25.79s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.18it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.19it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.19it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.24it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.27it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.24it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.23it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.26it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.24it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.23it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.22it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.21it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.20it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.22it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.24it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:19,  3.22it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.24it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.25it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:18,  3.26it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.26it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.27it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:17,  3.27it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.24it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.23it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.25it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.23it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.23it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.21it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:15,  3.21it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.19it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.21it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:14,  3.21it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.20it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.22it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.24it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.22it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.21it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:12,  3.21it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.20it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.23it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.21it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.19it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.19it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.18it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:10,  3.19it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.22it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.23it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.25it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 23:52:55,317 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:52:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:52:55 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:52:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:52:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.28it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.23it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.85it/s]04/23/2024 23:52:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:52:55 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.6626752, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [257, 263, 261, 293, 221, 223, 288, 278, 197, 383, 278, 195], 'head_nums': [7, 8, 9, 7, 7, 4, 5, 6, 12, 2, 5, 8], 'pruned_params': 74661280, 'remaining_params': 10356320, 'pruned_model_sparsity': 0.8781861638060825, 'expected_sparsity': 0.87132, 'target_sparsity': 0.95, 'step': 2000}


Iteration:  64%|██████▍   | 50/78 [00:16<00:13,  2.05it/s][A04/23/2024 23:52:56 - INFO - trainer.trainer_mod - v4 Global step: 2000, Alignment: tensor([2, 3, 4, 6], device='cuda:0')

Iteration:  65%|██████▌   | 51/78 [00:16<00:11,  2.32it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:10,  2.52it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:09,  2.71it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:08,  2.82it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  2.95it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.12it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:06,  3.12it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.14it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.14it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  3.19it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.20it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.20it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  3.19it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.17it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.22it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.20it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.23it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.22it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.21it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.26it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.28it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.29it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.30it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.28it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.40it/s][A04/23/2024 23:53:04 - INFO - trainer.trainer_mod - Epoch 25 finished. Took 24.71 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.16it/s]
Epoch:  26%|██▌       | 26/100 [11:21<31:24, 25.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.32it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.26it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.22it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.23it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.26it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.25it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.22it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.21it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.25it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.27it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.25it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.27it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.26it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.27it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.24it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:19,  3.26it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.26it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.25it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:18,  3.24it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.21it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.20it/s][A[INFO|trainer.py:570] 2024-04-23 23:53:11,325 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:53:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:53:11 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:53:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:53:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.23it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.17it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.14it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.16it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.76it/s]04/23/2024 23:53:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:53:11 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.679258, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [252, 257, 255, 287, 220, 223, 283, 274, 195, 365, 271, 191], 'head_nums': [6, 7, 9, 7, 7, 4, 4, 6, 12, 2, 5, 8], 'pruned_params': 75298592, 'remaining_params': 9719008, 'pruned_model_sparsity': 0.8856823998795543, 'expected_sparsity': 0.8766, 'target_sparsity': 0.95, 'step': 2050}


Iteration:  28%|██▊       | 22/78 [00:07<00:27,  2.04it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:24,  2.29it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:21,  2.51it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:19,  2.70it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:18,  2.85it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:17,  2.95it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.11it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.16it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:14,  3.17it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.21it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.23it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:13,  3.24it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.26it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.24it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.25it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.26it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.27it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.27it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.24it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.27it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.27it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.28it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.25it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.26it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.24it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.25it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.26it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.27it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.25it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.26it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.27it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.26it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.26it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.27it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.28it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.29it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.29it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.30it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.30it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.32it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.32it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.30it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.30it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.29it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.27it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.28it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.27it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.25it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 23:53:27,216 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:53:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:53:27 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:53:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:53:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.25it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.18it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.18it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.79it/s]04/23/2024 23:53:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:53:27 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.7536965, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 252, 251, 281, 220, 222, 277, 269, 195, 347, 264, 188], 'head_nums': [6, 7, 9, 7, 7, 4, 3, 6, 12, 2, 5, 8], 'pruned_params': 75540648, 'remaining_params': 9476952, 'pruned_model_sparsity': 0.8885295280036134, 'expected_sparsity': 0.88071, 'target_sparsity': 0.95, 'step': 2100}


Iteration:  92%|█████████▏| 72/78 [00:23<00:02,  2.07it/s][A04/23/2024 23:53:27 - INFO - trainer.trainer_mod - v4 Global step: 2100, Alignment: tensor([2, 2, 3, 4], device='cuda:0')

Iteration:  94%|█████████▎| 73/78 [00:23<00:02,  2.33it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  2.55it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:01,  2.74it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  2.86it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  2.96it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.18it/s][A04/23/2024 23:53:29 - INFO - trainer.trainer_mod - Epoch 26 finished. Took 25.07 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.11it/s]
Epoch:  27%|██▋       | 27/100 [11:46<30:50, 25.35s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.21it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.16it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.21it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.21it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.24it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.27it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.24it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.26it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.26it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.25it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.26it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.28it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.28it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.29it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.30it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.29it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.30it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:18,  3.26it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.27it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.29it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.30it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.28it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.27it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.28it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.27it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.28it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.28it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.29it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.23it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.26it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:14,  3.26it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.26it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.27it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.27it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.28it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.28it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:12,  3.28it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.28it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.28it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.31it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.31it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 23:53:43,078 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:53:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:53:43 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:53:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:53:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.26it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.22it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.16it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.77it/s]04/23/2024 23:53:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:53:43 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.7077282, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [244, 247, 246, 276, 219, 221, 271, 264, 194, 331, 257, 185], 'head_nums': [6, 7, 8, 7, 7, 4, 3, 5, 12, 2, 5, 8], 'pruned_params': 75782704, 'remaining_params': 9234896, 'pruned_model_sparsity': 0.8913766561276724, 'expected_sparsity': 0.88409, 'target_sparsity': 0.95, 'step': 2150}


Iteration:  56%|█████▋    | 44/78 [00:14<00:16,  2.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:14,  2.32it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:12,  2.54it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:11,  2.69it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:10,  2.86it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  2.97it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.10it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  3.15it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.16it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.19it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.19it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.21it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.16it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.20it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.21it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.24it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.24it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.26it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.26it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.27it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.26it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.27it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.26it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.24it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.26it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.26it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.26it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.27it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.27it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.24it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.27it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.26it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.39it/s][A04/23/2024 23:53:54 - INFO - trainer.trainer_mod - Epoch 27 finished. Took 24.48 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.19it/s]
Epoch:  28%|██▊       | 28/100 [12:10<30:06, 25.09s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.27it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.25it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.26it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.26it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.25it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.28it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.26it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.28it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.29it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.26it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.28it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.27it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.26it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.27it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.24it/s][A[INFO|trainer.py:570] 2024-04-23 23:53:58,998 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:53:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:53:59 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:53:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:53:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.29it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.22it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.83it/s]04/23/2024 23:53:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:53:59 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.71462864, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [240, 244, 242, 272, 218, 221, 266, 259, 194, 316, 250, 182], 'head_nums': [6, 7, 8, 7, 7, 3, 3, 5, 12, 2, 5, 8], 'pruned_params': 76017100, 'remaining_params': 9000500, 'pruned_model_sparsity': 0.8941336852604637, 'expected_sparsity': 0.8869, 'target_sparsity': 0.95, 'step': 2200}


Iteration:  21%|██        | 16/78 [00:05<00:30,  2.04it/s][A04/23/2024 23:53:59 - INFO - trainer.trainer_mod - v4 Global step: 2200, Alignment: tensor([1, 2, 2, 3], device='cuda:0')

Iteration:  22%|██▏       | 17/78 [00:05<00:26,  2.30it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:23,  2.53it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:21,  2.73it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:20,  2.88it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.98it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.13it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.18it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.18it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.22it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.25it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.27it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.26it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:14,  3.29it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.28it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.30it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.30it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.28it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.30it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.28it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.25it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.27it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.28it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.26it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.24it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.22it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.25it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.24it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.26it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.23it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.25it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.25it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.24it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.25it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  3.24it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.26it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.25it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.26it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.27it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.27it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.28it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.26it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.24it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.25it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.26it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.25it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.32it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.32it/s][A[INFO|trainer.py:570] 2024-04-23 23:54:14,885 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:54:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:54:14 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:54:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:54:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.19it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.13it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.15it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.17it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.75it/s]04/23/2024 23:54:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:54:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.7586565, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [236, 240, 239, 268, 218, 220, 260, 254, 194, 303, 243, 180], 'head_nums': [6, 7, 8, 7, 7, 3, 3, 5, 12, 2, 5, 8], 'pruned_params': 76056932, 'remaining_params': 8960668, 'pruned_model_sparsity': 0.8946022000150557, 'expected_sparsity': 0.88891, 'target_sparsity': 0.95, 'step': 2250}


Iteration:  85%|████████▍ | 66/78 [00:21<00:05,  2.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:04,  2.33it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  2.53it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:03,  2.69it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  2.85it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  2.97it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.15it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.20it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.24it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.26it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.40it/s][A04/23/2024 23:54:19 - INFO - trainer.trainer_mod - Epoch 28 finished. Took 25.03 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.12it/s]
Epoch:  29%|██▉       | 29/100 [12:35<29:40, 25.07s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.29it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.22it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.21it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.18it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.23it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.22it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.21it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.24it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.23it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.21it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.24it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.26it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.23it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.24it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.21it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:19,  3.23it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.25it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.20it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:18,  3.23it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.21it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.20it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:17,  3.24it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.23it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.21it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.24it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.23it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.25it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.25it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:15,  3.23it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.30it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.29it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.29it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.29it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.30it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.30it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.29it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 23:54:30,841 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:54:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:54:30 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:54:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:54:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.36it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.22it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.81it/s]04/23/2024 23:54:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:54:31 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.75355875, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [233, 237, 235, 264, 217, 219, 256, 250, 193, 290, 237, 178], 'head_nums': [6, 7, 7, 7, 6, 3, 2, 5, 12, 2, 5, 8], 'pruned_params': 76482828, 'remaining_params': 8534772, 'pruned_model_sparsity': 0.8996117039295393, 'expected_sparsity': 0.89187, 'target_sparsity': 0.95, 'step': 2300}


Iteration:  49%|████▊     | 38/78 [00:12<00:19,  2.06it/s][A04/23/2024 23:54:31 - INFO - trainer.trainer_mod - v4 Global step: 2300, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  50%|█████     | 39/78 [00:12<00:17,  2.29it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:15,  2.52it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:13,  2.70it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:12,  2.86it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  2.97it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.03it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.15it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.18it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.22it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.23it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.21it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.25it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.25it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.27it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.23it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.26it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.27it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.27it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.28it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.27it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.27it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.28it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.25it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.27it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.26it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.28it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.26it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.28it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.30it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.31it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.27it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.28it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.29it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.28it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.25it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.23it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.26it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.39it/s][A04/23/2024 23:54:43 - INFO - trainer.trainer_mod - Epoch 29 finished. Took 24.53 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.18it/s]
Epoch:  30%|███       | 30/100 [13:00<29:03, 24.91s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.21it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.26it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.23it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.22it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.21it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.23it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.23it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.32it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 23:54:46,713 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:54:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:54:46 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:54:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:54:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.21it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.17it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.14it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.14it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.74it/s]04/23/2024 23:54:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:54:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.70613545, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [230, 234, 232, 261, 217, 219, 251, 245, 193, 278, 231, 176], 'head_nums': [5, 7, 7, 7, 6, 3, 2, 5, 12, 2, 5, 8], 'pruned_params': 76712628, 'remaining_params': 8304972, 'pruned_model_sparsity': 0.90231467366757, 'expected_sparsity': 0.89485, 'target_sparsity': 0.95, 'step': 2350}


Iteration:  13%|█▎        | 10/78 [00:03<00:33,  2.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:28,  2.33it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:25,  2.55it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.74it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:22,  2.87it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.98it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.14it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:18,  3.16it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.20it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.23it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:17,  3.25it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.26it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.25it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.26it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.27it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.28it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.28it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.28it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.28it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.28it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:14,  3.27it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.21it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.19it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:13,  3.21it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.25it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.26it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.26it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.27it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.24it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.26it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.28it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:10,  3.28it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.28it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.28it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.26it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.27it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.27it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.27it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.27it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.28it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.28it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.28it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.28it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.28it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.28it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.28it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.27it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.27it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.28it/s][A[INFO|trainer.py:570] 2024-04-23 23:55:02,592 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:55:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:55:02 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:55:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:55:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.28it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.24it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.84it/s]04/23/2024 23:55:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:55:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6028880866425993, 'eval_loss': 0.7281347, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 232, 230, 257, 216, 218, 247, 241, 193, 268, 226, 174], 'head_nums': [5, 7, 6, 7, 6, 3, 2, 5, 12, 2, 5, 8], 'pruned_params': 76936300, 'remaining_params': 8081300, 'pruned_model_sparsity': 0.9049455642125865, 'expected_sparsity': 0.89862, 'target_sparsity': 0.95, 'step': 2400}


Iteration:  77%|███████▋  | 60/78 [00:19<00:08,  2.07it/s][A04/23/2024 23:55:03 - INFO - trainer.trainer_mod - v4 Global step: 2400, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  78%|███████▊  | 61/78 [00:19<00:07,  2.32it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:06,  2.56it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:05,  2.75it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  2.85it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  2.95it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.12it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.16it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.18it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.15it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.20it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.23it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.24it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.25it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.25it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.23it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.29it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.43it/s][A04/23/2024 23:55:08 - INFO - trainer.trainer_mod - Epoch 30 finished. Took 25.01 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.12it/s]
Epoch:  31%|███       | 31/100 [13:25<28:40, 24.94s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.16it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.24it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.22it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.21it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.18it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.20it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.21it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.23it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.24it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.25it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.25it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.25it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.26it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.26it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.26it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:19,  3.25it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.23it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.23it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:18,  3.22it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.23it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.23it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:17,  3.26it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.27it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.25it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.23it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.25it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.27it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.24it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.27it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.28it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 23:55:18,531 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:55:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:55:18 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:55:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:55:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.30it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.25it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.21it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.84it/s]04/23/2024 23:55:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:55:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.74520767, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [226, 229, 227, 254, 215, 217, 242, 236, 193, 258, 220, 173], 'head_nums': [5, 7, 6, 7, 6, 2, 2, 5, 12, 2, 5, 8], 'pruned_params': 77164568, 'remaining_params': 7853032, 'pruned_model_sparsity': 0.9076305141523637, 'expected_sparsity': 0.90002, 'target_sparsity': 0.95, 'step': 2450}


Iteration:  41%|████      | 32/78 [00:10<00:22,  2.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:19,  2.32it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:17,  2.54it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:15,  2.71it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:14,  2.82it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.95it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.03it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.15it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.19it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.22it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.25it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.25it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.23it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.25it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.24it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.22it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.21it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.24it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.25it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.26it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.27it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.28it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.22it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.24it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.24it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.26it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.27it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.26it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.24it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.26it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.23it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.23it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.25it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.24it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.23it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.26it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.28it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.29it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.29it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.29it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.29it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.31it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.30it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.31it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.30it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.40it/s][A04/23/2024 23:55:33 - INFO - trainer.trainer_mod - Epoch 31 finished. Took 24.53 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.18it/s]
Epoch:  32%|███▏      | 32/100 [13:50<28:07, 24.82s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.31it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.27it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 23:55:34,420 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:55:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:55:34 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:55:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:55:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.22it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.19it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.18it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.17it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.78it/s]04/23/2024 23:55:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:55:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.7264059, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [224, 227, 225, 251, 215, 217, 236, 230, 192, 250, 216, 171], 'head_nums': [5, 7, 6, 7, 6, 2, 2, 5, 12, 2, 5, 7], 'pruned_params': 77196740, 'remaining_params': 7820860, 'pruned_model_sparsity': 0.908008929915688, 'expected_sparsity': 0.90089, 'target_sparsity': 0.95, 'step': 2500}


Iteration:   5%|▌         | 4/78 [00:01<00:39,  1.86it/s][A04/23/2024 23:55:35 - INFO - trainer.trainer_mod - v4 Global step: 2500, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:   6%|▋         | 5/78 [00:02<00:33,  2.18it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:29,  2.47it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:26,  2.70it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.84it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.96it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.13it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:20,  3.17it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.19it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.19it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:19,  3.19it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.18it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.22it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:18,  3.20it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.23it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.23it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:17,  3.25it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.25it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.27it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.23it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.21it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.24it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.23it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.26it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.25it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.28it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:14,  3.27it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.28it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.27it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:13,  3.28it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.28it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.28it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.28it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.29it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.31it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.27it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.29it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.27it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.28it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.27it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.28it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.28it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.25it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.23it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.26it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.28it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.27it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  3.24it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 23:55:50,352 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:55:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:55:50 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:55:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:55:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.24it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.19it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.23it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.80it/s]04/23/2024 23:55:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:55:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.7266153, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [222, 225, 222, 247, 214, 216, 230, 224, 192, 242, 211, 170], 'head_nums': [5, 7, 6, 7, 6, 2, 2, 5, 12, 2, 5, 7], 'pruned_params': 77231976, 'remaining_params': 7785624, 'pruned_model_sparsity': 0.9084233852755195, 'expected_sparsity': 0.90244, 'target_sparsity': 0.95, 'step': 2550}


Iteration:  69%|██████▉   | 54/78 [00:17<00:11,  2.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:09,  2.33it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:08,  2.54it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:07,  2.73it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  2.86it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  2.98it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.12it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.14it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.16it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.19it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.23it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.23it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.25it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.24it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.22it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.24it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.23it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.26it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.25it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.27it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.25it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.24it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.24it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.40it/s][A04/23/2024 23:55:58 - INFO - trainer.trainer_mod - Epoch 32 finished. Took 25.08 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.11it/s]
Epoch:  33%|███▎      | 33/100 [14:15<27:48, 24.90s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.19it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.22it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.20it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.23it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.21it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.24it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.26it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.24it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.26it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.27it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.25it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.25it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.26it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.25it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.24it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:19,  3.26it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.27it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.27it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:18,  3.27it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.28it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.26it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:17,  3.25it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.24it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.26it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.25it/s][A[INFO|trainer.py:570] 2024-04-23 23:56:06,274 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:56:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:56:06 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:56:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:56:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.29it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.26it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.85it/s]04/23/2024 23:56:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:56:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 0.83621395, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [221, 223, 220, 245, 213, 215, 224, 218, 192, 235, 207, 169], 'head_nums': [5, 7, 6, 7, 6, 2, 2, 5, 12, 2, 5, 7], 'pruned_params': 77261084, 'remaining_params': 7756516, 'pruned_model_sparsity': 0.9087657614423367, 'expected_sparsity': 0.90357, 'target_sparsity': 0.95, 'step': 2600}


Iteration:  33%|███▎      | 26/78 [00:08<00:25,  2.06it/s][A04/23/2024 23:56:06 - INFO - trainer.trainer_mod - v4 Global step: 2600, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  35%|███▍      | 27/78 [00:08<00:22,  2.30it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:19,  2.53it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:18,  2.70it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:16,  2.85it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.96it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.04it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.10it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.10it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.16it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.18it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:12,  3.18it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.22it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.20it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.23it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.24it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.21it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.25it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.27it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.28it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.27it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.25it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.24it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.26it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.24it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.22it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.25it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.24it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.26it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.25it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.27it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.25it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.23it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.22it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.26it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.24it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.26it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.28it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.23it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.26it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.25it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.27it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.25it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.26it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.28it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.27it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.26it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.27it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.26it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 23:56:22,260 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:56:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:56:22 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:56:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:56:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.31it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.24it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.26it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.84it/s]04/23/2024 23:56:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:56:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.7469124, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [220, 222, 218, 242, 212, 214, 218, 212, 192, 229, 203, 168], 'head_nums': [5, 7, 6, 7, 6, 2, 1, 5, 12, 2, 5, 7], 'pruned_params': 77486288, 'remaining_params': 7531312, 'pruned_model_sparsity': 0.9114146717856068, 'expected_sparsity': 0.90417, 'target_sparsity': 0.95, 'step': 2650}


Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  2.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  2.33it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  2.62it/s][A04/23/2024 23:56:23 - INFO - trainer.trainer_mod - Epoch 33 finished. Took 25.15 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.10it/s]
Epoch:  34%|███▍      | 34/100 [14:40<27:28, 24.97s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.36it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.40it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.32it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.31it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.31it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.30it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.30it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.30it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.30it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.29it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.29it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.30it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.30it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.29it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.29it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.30it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.29it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.29it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.31it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.31it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.30it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.31it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.30it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.30it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.29it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.28it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.29it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.28it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.23it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.25it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:14,  3.28it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.24it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.25it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.24it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.27it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.24it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:12,  3.26it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.27it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.28it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.29it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.28it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.28it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.26it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:10,  3.25it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.26it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 23:56:38,022 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:56:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:56:38 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:56:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:56:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.37it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.23it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.18it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.17it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.77it/s]04/23/2024 23:56:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:56:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.70111674, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [219, 220, 217, 240, 212, 214, 212, 206, 191, 223, 199, 166], 'head_nums': [5, 7, 6, 7, 5, 2, 1, 5, 12, 2, 5, 7], 'pruned_params': 77513864, 'remaining_params': 7503736, 'pruned_model_sparsity': 0.9117390281541704, 'expected_sparsity': 0.90477, 'target_sparsity': 0.95, 'step': 2700}


Iteration:  62%|██████▏   | 48/78 [00:15<00:14,  2.08it/s][A04/23/2024 23:56:38 - INFO - trainer.trainer_mod - v4 Global step: 2700, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  63%|██████▎   | 49/78 [00:15<00:12,  2.35it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:10,  2.57it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:09,  2.74it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  2.89it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:08,  3.00it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:07,  3.12it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.17it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.23it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.27it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.30it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.29it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.27it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.29it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.30it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.27it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.26it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.28it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.28it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.29it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.27it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.25it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.27it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.28it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.29it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.29it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.26it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.28it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.43it/s][A04/23/2024 23:56:47 - INFO - trainer.trainer_mod - Epoch 34 finished. Took 24.29 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.21it/s]
Epoch:  35%|███▌      | 35/100 [15:04<26:49, 24.77s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.17it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.28it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.23it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.27it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.27it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.27it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.27it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.25it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.26it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.28it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.28it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.30it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.30it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.29it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.26it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.28it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.31it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.31it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.29it/s][A[INFO|trainer.py:570] 2024-04-23 23:56:53,820 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:56:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:56:53 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:56:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:56:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.37it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.32it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.31it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.89it/s]04/23/2024 23:56:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:56:54 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.8128759, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [218, 219, 215, 238, 211, 213, 207, 201, 191, 217, 196, 165], 'head_nums': [5, 7, 6, 7, 5, 2, 1, 4, 12, 2, 5, 7], 'pruned_params': 77538376, 'remaining_params': 7479224, 'pruned_model_sparsity': 0.9120273449262271, 'expected_sparsity': 0.90601, 'target_sparsity': 0.95, 'step': 2750}


Iteration:  26%|██▌       | 20/78 [00:06<00:27,  2.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:24,  2.34it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:21,  2.57it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:19,  2.76it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:18,  2.89it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.99it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.13it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.19it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.22it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:14,  3.22it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.24it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.26it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.26it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.28it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.26it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.26it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.27it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.28it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.26it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.28it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.26it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.28it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.28it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.26it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.27it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.28it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.28it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.29it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.29it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.30it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.30it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.47it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.38it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:06,  3.33it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.33it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.33it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.32it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.31it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.28it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.29it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.29it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.30it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.29it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.25it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.27it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.26it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.25it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.27it/s][A[INFO|trainer.py:570] 2024-04-23 23:57:09,624 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:57:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:57:09 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:57:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:57:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.31it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.27it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.82it/s]04/23/2024 23:57:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:57:10 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.8011056, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [217, 217, 214, 236, 210, 212, 202, 195, 191, 213, 193, 165], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 11, 2, 5, 7], 'pruned_params': 77760516, 'remaining_params': 7257084, 'pruned_model_sparsity': 0.91464021567299, 'expected_sparsity': 0.90735, 'target_sparsity': 0.95, 'step': 2800}


Iteration:  90%|████████▉ | 70/78 [00:22<00:03,  2.07it/s][A04/23/2024 23:57:10 - INFO - trainer.trainer_mod - v4 Global step: 2800, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  91%|█████████ | 71/78 [00:22<00:03,  2.32it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:02,  2.55it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  2.74it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  2.88it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.13it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.31it/s][A04/23/2024 23:57:12 - INFO - trainer.trainer_mod - Epoch 35 finished. Took 24.9 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.13it/s]
Epoch:  36%|███▌      | 36/100 [15:29<26:27, 24.81s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.25it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.24it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.26it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.28it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.29it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.29it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.27it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.29it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.28it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.29it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.29it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.31it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.32it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.30it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.30it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.30it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.31it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.32it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.31it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.30it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.32it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:17,  3.28it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.29it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.30it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.30it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.30it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.31it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.31it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.32it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.31it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.33it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.33it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.33it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.30it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.26it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.26it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.25it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:12,  3.28it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.28it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.26it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 23:57:25,372 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:57:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:57:25 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:57:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:57:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.29it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.17it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.13it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.78it/s]04/23/2024 23:57:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:57:25 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.8146344, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [216, 216, 213, 235, 209, 211, 197, 190, 190, 208, 190, 164], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 10, 2, 5, 7], 'pruned_params': 77781964, 'remaining_params': 7235636, 'pruned_model_sparsity': 0.9148924928485396, 'expected_sparsity': 0.90799, 'target_sparsity': 0.95, 'step': 2850}


Iteration:  54%|█████▍    | 42/78 [00:13<00:17,  2.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:15,  2.33it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:13,  2.54it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:12,  2.72it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:11,  2.87it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:10,  2.97it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.14it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.19it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.21it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  3.24it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.26it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.28it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:06,  3.29it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.28it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.28it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.30it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.29it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.28it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.28it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.28it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.30it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.31it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.28it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.27it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.26it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.27it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.28it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.28it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.29it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.27it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.28it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.29it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.30it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.24it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.42it/s][A04/23/2024 23:57:36 - INFO - trainer.trainer_mod - Epoch 36 finished. Took 24.27 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.21it/s]
Epoch:  37%|███▋      | 37/100 [15:53<25:52, 24.65s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.27it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.21it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.23it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.27it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.27it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.26it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.26it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.29it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.30it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.27it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.26it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.25it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.26it/s][A[INFO|trainer.py:570] 2024-04-23 23:57:41,152 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:57:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:57:41 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:57:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:57:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.31it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.21it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.21it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.79it/s]04/23/2024 23:57:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:57:41 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.8653372, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [215, 215, 212, 233, 209, 210, 192, 185, 190, 205, 187, 163], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 77804944, 'remaining_params': 7212656, 'pruned_model_sparsity': 0.9151627898223427, 'expected_sparsity': 0.90861, 'target_sparsity': 0.95, 'step': 2900}


Iteration:  18%|█▊        | 14/78 [00:04<00:30,  2.09it/s][A04/23/2024 23:57:41 - INFO - trainer.trainer_mod - v4 Global step: 2900, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  19%|█▉        | 15/78 [00:05<00:26,  2.35it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:24,  2.57it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:22,  2.73it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.89it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.00it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.16it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.19it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.20it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.20it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.20it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.24it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.27it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.26it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.25it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.27it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:14,  3.29it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:13,  3.29it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.28it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.26it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.27it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.30it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.27it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.27it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.29it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.30it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.32it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:10,  3.32it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.31it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.28it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.30it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.31it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.29it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.31it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.31it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.33it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.31it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.33it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.32it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:07,  3.31it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:06,  3.32it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.30it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.30it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.29it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.30it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.29it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.27it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.29it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.31it/s][A[INFO|trainer.py:570] 2024-04-23 23:57:56,931 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:57:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:57:56 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:57:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:57:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.36it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.31it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.23it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.85it/s]04/23/2024 23:57:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:57:57 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.8382433, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [214, 214, 210, 232, 208, 210, 188, 180, 190, 201, 185, 162], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 77826392, 'remaining_params': 7191208, 'pruned_model_sparsity': 0.9154150669978922, 'expected_sparsity': 0.91004, 'target_sparsity': 0.95, 'step': 2950}


Iteration:  82%|████████▏ | 64/78 [00:20<00:06,  2.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:05,  2.34it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:04,  2.55it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:04,  2.74it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  2.87it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:03,  2.99it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.13it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.15it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.20it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.20it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.22it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.22it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.26it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.40it/s][A04/23/2024 23:58:01 - INFO - trainer.trainer_mod - Epoch 37 finished. Took 24.88 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.14it/s]
Epoch:  38%|███▊      | 38/100 [16:18<25:32, 24.72s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.33it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.34it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.29it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.29it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.30it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.31it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.31it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.31it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.31it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.29it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.31it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.27it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.29it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.29it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.28it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.29it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.30it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.31it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.29it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.29it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.31it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.31it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.32it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.29it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.31it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.30it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.33it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.29it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:15,  3.26it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.33it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.34it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.34it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.32it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.33it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.33it/s][A[INFO|trainer.py:570] 2024-04-23 23:58:12,651 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:58:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:58:12 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:58:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:58:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.34it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.34it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.32it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.90it/s]04/23/2024 23:58:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:58:13 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.8004455, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [213, 213, 209, 231, 207, 209, 185, 177, 189, 198, 183, 161], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 78112876, 'remaining_params': 6904724, 'pruned_model_sparsity': 0.9187847692713038, 'expected_sparsity': 0.91169, 'target_sparsity': 0.95, 'step': 3000}


Iteration:  46%|████▌     | 36/78 [00:11<00:20,  2.09it/s][A04/23/2024 23:58:13 - INFO - trainer.trainer_mod - v4 Global step: 3000, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  47%|████▋     | 37/78 [00:11<00:17,  2.35it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:15,  2.58it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:14,  2.75it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:13,  2.91it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:12,  2.99it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.16it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.21it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.25it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.30it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.31it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.25it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.27it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.25it/s][A
Iteration:  65%|██████▌   | 51/78 [00:16<00:08,  3.27it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.28it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.30it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.32it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:06,  3.32it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.31it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.32it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:05,  3.36it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.35it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.35it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.33it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.31it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.31it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.31it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.32it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.32it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.29it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.31it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.34it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.34it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.30it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.32it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.33it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.32it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.33it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.29it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.31it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.46it/s][A04/23/2024 23:58:25 - INFO - trainer.trainer_mod - Epoch 38 finished. Took 24.11 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.23it/s]
Epoch:  39%|███▉      | 39/100 [16:42<24:56, 24.53s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.19it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.29it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.30it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.26it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.29it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.31it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.31it/s][A[INFO|trainer.py:570] 2024-04-23 23:58:28,298 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:58:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:58:28 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:58:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:58:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.34it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.22it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.02it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.15it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.75it/s]04/23/2024 23:58:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:58:28 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.75583845, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [212, 212, 208, 230, 206, 208, 181, 176, 189, 195, 181, 161], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 78125132, 'remaining_params': 6892468, 'pruned_model_sparsity': 0.9189289276573321, 'expected_sparsity': 0.91281, 'target_sparsity': 0.95, 'step': 3050}


Iteration:  10%|█         | 8/78 [00:03<00:34,  2.04it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:29,  2.33it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:26,  2.56it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:24,  2.76it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.90it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.03it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.13it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:19,  3.15it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.23it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.26it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:18,  3.29it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.30it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.31it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.30it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:16,  3.32it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.33it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.33it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:15,  3.37it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.36it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.35it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.35it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.36it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.31it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.33it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.28it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.30it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.32it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:12,  3.31it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.30it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.28it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.30it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.26it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.24it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.26it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:10,  3.29it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.31it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.32it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:09,  3.32it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.29it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.31it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.32it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.33it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.26it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.29it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.32it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.33it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.33it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:06,  3.33it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.34it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.34it/s][A[INFO|trainer.py:570] 2024-04-23 23:58:43,950 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:58:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:58:43 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:58:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:58:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.41it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.28it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.30it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.89it/s]04/23/2024 23:58:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:58:44 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6064981949458483, 'eval_loss': 0.7492453, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [211, 212, 207, 228, 205, 207, 178, 176, 189, 192, 179, 160], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 78135856, 'remaining_params': 6881744, 'pruned_model_sparsity': 0.9190550662451069, 'expected_sparsity': 0.91416, 'target_sparsity': 0.95, 'step': 3100}


Iteration:  74%|███████▍  | 58/78 [00:18<00:09,  2.10it/s][A04/23/2024 23:58:44 - INFO - trainer.trainer_mod - v4 Global step: 3100, Alignment: tensor([1, 2, 2, 3], device='cuda:0')

Iteration:  76%|███████▌  | 59/78 [00:18<00:07,  2.38it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:06,  2.62it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:06,  2.80it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  2.94it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.14it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  3.20it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.20it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.25it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.28it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.32it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.33it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.34it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.34it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:01,  3.34it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.34it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.34it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  3.36it/s][A
Iteration:  99%|█████████▊| 77/78 [00:24<00:00,  3.35it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.49it/s][A04/23/2024 23:58:50 - INFO - trainer.trainer_mod - Epoch 39 finished. Took 24.59 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.17it/s]
Epoch:  40%|████      | 40/100 [17:07<24:33, 24.55s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.30it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.31it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.26it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.27it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.30it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.26it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.28it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.25it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.28it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.28it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.25it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:20,  3.28it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.31it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.32it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.37it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.37it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.36it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.36it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.36it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.37it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.34it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.35it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.34it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.30it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.30it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.35it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.35it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.37it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.37it/s][A[INFO|trainer.py:570] 2024-04-23 23:58:59,481 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:58:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:58:59 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:58:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:58:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.43it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.29it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.22it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.19it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.81it/s]04/23/2024 23:59:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:59:00 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.8660117, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [211, 211, 206, 227, 204, 206, 175, 175, 188, 190, 177, 159], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 78145048, 'remaining_params': 6872552, 'pruned_model_sparsity': 0.9191631850346281, 'expected_sparsity': 0.91499, 'target_sparsity': 0.95, 'step': 3150}


Iteration:  38%|███▊      | 30/78 [00:09<00:22,  2.11it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:19,  2.39it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:17,  2.62it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:15,  2.82it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  2.96it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.16it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.22it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:12,  3.22it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.22it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.25it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.29it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:10,  3.30it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.27it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.29it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:09,  3.31it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.32it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.33it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.36it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.34it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.35it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.30it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.31it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.31it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.29it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:06,  3.31it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.30it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.30it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.31it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.31it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.29it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.32it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.32it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.31it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.34it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.32it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.35it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.39it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:02,  3.38it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.35it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.37it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.32it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.32it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.31it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.32it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.35it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.35it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.36it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.49it/s][A04/23/2024 23:59:14 - INFO - trainer.trainer_mod - Epoch 40 finished. Took 23.96 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.26it/s]
Epoch:  41%|████      | 41/100 [17:31<23:58, 24.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.39it/s][A[INFO|trainer.py:570] 2024-04-23 23:59:15,019 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:59:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:59:15 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:59:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:59:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.40it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.38it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.98it/s]04/23/2024 23:59:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:59:15 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.76314324, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [210, 210, 206, 226, 203, 205, 172, 175, 188, 187, 176, 159], 'head_nums': [5, 7, 6, 7, 5, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 78350336, 'remaining_params': 6667264, 'pruned_model_sparsity': 0.9215778380006022, 'expected_sparsity': 0.91633, 'target_sparsity': 0.95, 'step': 3200}


Iteration:   3%|▎         | 2/78 [00:01<00:48,  1.55it/s][A04/23/2024 23:59:15 - INFO - trainer.trainer_mod - v4 Global step: 3200, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:   4%|▍         | 3/78 [00:01<00:36,  2.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:30,  2.43it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:27,  2.70it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:25,  2.85it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  2.98it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:21,  3.17it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.22it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.28it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:19,  3.32it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.29it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.34it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:18,  3.37it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.32it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.35it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.37it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.36it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.39it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.38it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:16,  3.37it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:15,  3.42it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.38it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.37it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.40it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.39it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.39it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.36it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:13,  3.35it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.37it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.34it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.34it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.35it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.33it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.37it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.39it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.40it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.39it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:10,  3.39it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.48it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.44it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.43it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.41it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.38it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.35it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.34it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.31it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.31it/s][A[INFO|trainer.py:570] 2024-04-23 23:59:30,456 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:59:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:59:30 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:59:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:59:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.34it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.30it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.26it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.87it/s]04/23/2024 23:59:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:59:31 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.9130614, 'head_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [209, 209, 205, 225, 202, 204, 170, 174, 188, 185, 174, 158], 'head_nums': [5, 6, 6, 7, 5, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 78555624, 'remaining_params': 6461976, 'pruned_model_sparsity': 0.9239924909665763, 'expected_sparsity': 0.91792, 'target_sparsity': 0.95, 'step': 3250}


Iteration:  67%|██████▋   | 52/78 [00:16<00:12,  2.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:10,  2.38it/s][A
Iteration:  69%|██████▉   | 54/78 [00:17<00:09,  2.62it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:08,  2.80it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:07,  2.97it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.15it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.20it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.27it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.34it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.37it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.33it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  3.34it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.32it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.35it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  3.35it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:02,  3.37it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.39it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.39it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.40it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.52it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.48it/s][A
Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  3.45it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.41it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.42it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.43it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.56it/s][A04/23/2024 23:59:38 - INFO - trainer.trainer_mod - Epoch 41 finished. Took 24.22 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.22it/s]
Epoch:  42%|████▏     | 42/100 [17:55<23:31, 24.33s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.41it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.43it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.39it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.35it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.33it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.37it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.30it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.36it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.35it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:20,  3.32it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.35it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.35it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.37it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.34it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.37it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.35it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.36it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.37it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.37it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:17,  3.37it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.37it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.35it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.38it/s][A[INFO|trainer.py:570] 2024-04-23 23:59:45,783 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/23/2024 23:59:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/23/2024 23:59:45 - INFO - trainer.trainer_mod -   Num examples = 277
04/23/2024 23:59:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/23/2024 23:59:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.42it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.03it/s]04/23/2024 23:59:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/23/2024 23:59:46 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.77170604, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [209, 209, 204, 223, 202, 203, 168, 174, 187, 183, 173, 158], 'head_nums': [5, 6, 6, 7, 4, 1, 1, 4, 10, 2, 4, 7], 'pruned_params': 78759380, 'remaining_params': 6258220, 'pruned_model_sparsity': 0.9263891241342969, 'expected_sparsity': 0.91887, 'target_sparsity': 0.95, 'step': 3300}


Iteration:  31%|███       | 24/78 [00:07<00:25,  2.13it/s][A04/23/2024 23:59:46 - INFO - trainer.trainer_mod - v4 Global step: 3300, Alignment: tensor([1, 2, 2, 3], device='cuda:0')

Iteration:  32%|███▏      | 25/78 [00:08<00:22,  2.40it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:19,  2.64it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:18,  2.82it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:16,  2.97it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.18it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.26it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.23it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.24it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.30it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.31it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.30it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.35it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.38it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.39it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.41it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.38it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:10,  3.39it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.40it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.37it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.35it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.39it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.38it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.37it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:08,  3.37it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.37it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.40it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:07,  3.41it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.36it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.38it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.38it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.38it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.39it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.40it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.42it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.40it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.36it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.34it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.33it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.28it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.29it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.32it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.36it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.36it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.36it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.39it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.40it/s][A[INFO|trainer.py:570] 2024-04-24 00:00:01,179 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:00:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:00:01 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:00:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:00:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.47it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.39it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.00it/s]04/24/2024 00:00:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:00:01 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.8338272, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [208, 208, 203, 221, 201, 203, 167, 174, 187, 181, 172, 157], 'head_nums': [5, 6, 6, 7, 4, 1, 1, 4, 9, 2, 4, 7], 'pruned_params': 78768572, 'remaining_params': 6249028, 'pruned_model_sparsity': 0.9264972429238181, 'expected_sparsity': 0.91953, 'target_sparsity': 0.95, 'step': 3350}


Iteration:  95%|█████████▍| 74/78 [00:23<00:01,  2.13it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:01,  2.40it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  2.64it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  2.82it/s][A
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.10it/s][A04/24/2024 00:00:02 - INFO - trainer.trainer_mod - Epoch 42 finished. Took 24.25 seconds.
Iteration: 100%|██████████| 78/78 [00:24<00:00,  3.22it/s]
Epoch:  43%|████▎     | 43/100 [18:19<23:05, 24.30s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.40it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.32it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:22,  3.28it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.27it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.34it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.34it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.31it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.36it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:20,  3.39it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.42it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.43it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.43it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.44it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.45it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:17,  3.47it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.42it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.38it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.40it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.36it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.38it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.39it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.37it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:15,  3.39it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.43it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.43it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.45it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.45it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.40it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.36it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.34it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.33it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:12,  3.36it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.38it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.41it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:11,  3.38it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.33it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.35it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.37it/s][A
Iteration:  56%|█████▋    | 44/78 [00:12<00:09,  3.40it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.36it/s][A[INFO|trainer.py:570] 2024-04-24 00:00:16,489 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:00:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:00:16 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:00:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:00:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.47it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.41it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.03it/s]04/24/2024 00:00:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:00:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.8029103, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [207, 208, 203, 219, 200, 202, 166, 173, 186, 179, 171, 157], 'head_nums': [5, 6, 6, 7, 4, 1, 1, 4, 9, 2, 4, 7], 'pruned_params': 78774700, 'remaining_params': 6242900, 'pruned_model_sparsity': 0.9265693221168323, 'expected_sparsity': 0.92016, 'target_sparsity': 0.95, 'step': 3400}


Iteration:  59%|█████▉    | 46/78 [00:14<00:15,  2.05it/s][A04/24/2024 00:00:17 - INFO - trainer.trainer_mod - v4 Global step: 3400, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  60%|██████    | 47/78 [00:14<00:13,  2.31it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:11,  2.55it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:10,  2.73it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:09,  2.88it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  3.11it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.19it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.26it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.31it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:06,  3.32it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.37it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.40it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.39it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.39it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.39it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.42it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.44it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.43it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.44it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.41it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.41it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.37it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.37it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.40it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.41it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.41it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.37it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.34it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.36it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.39it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.54it/s][A04/24/2024 00:00:26 - INFO - trainer.trainer_mod - Epoch 43 finished. Took 23.62 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.30it/s]
Epoch:  44%|████▍     | 44/100 [18:43<22:29, 24.10s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.47it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.42it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.42it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.42it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.42it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.42it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.39it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.40it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.42it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.40it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.40it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.42it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.44it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.43it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.42it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.43it/s][A[INFO|trainer.py:570] 2024-04-24 00:00:31,775 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:00:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:00:31 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:00:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:00:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.44it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.42it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.03it/s]04/24/2024 00:00:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:00:32 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.7895474, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [207, 207, 202, 217, 199, 201, 165, 173, 186, 178, 170, 156], 'head_nums': [5, 6, 6, 7, 4, 1, 1, 4, 8, 2, 4, 6], 'pruned_params': 78782360, 'remaining_params': 6235240, 'pruned_model_sparsity': 0.9266594211081, 'expected_sparsity': 0.92157, 'target_sparsity': 0.95, 'step': 3450}


Iteration:  23%|██▎       | 18/78 [00:05<00:27,  2.15it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:24,  2.40it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:22,  2.60it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:20,  2.77it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.94it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.17it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.24it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.30it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.33it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.35it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.37it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.40it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.51it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.50it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.47it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.46it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.46it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.46it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.45it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.40it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.42it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.42it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.42it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.40it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.43it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.41it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.41it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.42it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.40it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.39it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.41it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.40it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.37it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.40it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.42it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.43it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.45it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.43it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.43it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.43it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.44it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.44it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.46it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.45it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.42it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.37it/s][A[INFO|trainer.py:570] 2024-04-24 00:00:46,987 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:00:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:00:46 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:00:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:00:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.07it/s]04/24/2024 00:00:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:00:47 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.8011027, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [206, 207, 201, 215, 198, 200, 164, 172, 186, 177, 169, 156], 'head_nums': [5, 6, 6, 7, 4, 1, 1, 4, 8, 2, 3, 6], 'pruned_params': 79041268, 'remaining_params': 5976332, 'pruned_model_sparsity': 0.9297047670129479, 'expected_sparsity': 0.92299, 'target_sparsity': 0.95, 'step': 3500}


Iteration:  87%|████████▋ | 68/78 [00:21<00:04,  2.13it/s][A04/24/2024 00:00:47 - INFO - trainer.trainer_mod - v4 Global step: 3500, Alignment: tensor([1, 4, 6, 7], device='cuda:0')

Iteration:  88%|████████▊ | 69/78 [00:21<00:03,  2.41it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:03,  2.65it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  2.85it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:02,  3.00it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.20it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.26it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.32it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.35it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.51it/s][A04/24/2024 00:00:50 - INFO - trainer.trainer_mod - Epoch 44 finished. Took 23.93 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.26it/s]
Epoch:  45%|████▌     | 45/100 [19:07<22:02, 24.05s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.33it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.38it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.40it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.42it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.41it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.43it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.43it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.40it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.41it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.43it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.44it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.41it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.41it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.42it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.41it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.41it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.42it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.40it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.39it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:17,  3.39it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.41it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.43it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.43it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.42it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.43it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.43it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.44it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.44it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.44it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.43it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.43it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.43it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:13,  3.36it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.39it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.40it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:12,  3.41it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.42it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.40it/s][A[INFO|trainer.py:570] 2024-04-24 00:01:02,156 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:01:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:01:02 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:01:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:01:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.54it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.47it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.09it/s]04/24/2024 00:01:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:01:02 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.83299434, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [206, 206, 200, 213, 197, 199, 164, 172, 185, 175, 168, 156], 'head_nums': [5, 6, 6, 7, 4, 1, 1, 4, 7, 2, 3, 6], 'pruned_params': 79047396, 'remaining_params': 5970204, 'pruned_model_sparsity': 0.929776846205962, 'expected_sparsity': 0.92402, 'target_sparsity': 0.95, 'step': 3550}


Iteration:  51%|█████▏    | 40/78 [00:12<00:17,  2.14it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:15,  2.41it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:13,  2.63it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:12,  2.79it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:11,  2.96it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.19it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.26it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.32it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.36it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.37it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.38it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.37it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.40it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.42it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.43it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.44it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.40it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.41it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.42it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.43it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.44it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.43it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.44it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.45it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.45it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.45it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.46it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.43it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.40it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.41it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.41it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.37it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.38it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.42it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.42it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.44it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.59it/s][A04/24/2024 00:01:13 - INFO - trainer.trainer_mod - Epoch 45 finished. Took 23.36 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.34it/s]
Epoch:  46%|████▌     | 46/100 [19:30<21:27, 23.84s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.32it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.39it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.39it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.37it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.37it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.41it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.37it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.41it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.42it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.43it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:01:17,330 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:01:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:01:17 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:01:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:01:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.46it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.08it/s]04/24/2024 00:01:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:01:17 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 0.81619865, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [205, 206, 199, 211, 196, 198, 164, 172, 185, 174, 167, 155], 'head_nums': [5, 6, 6, 7, 4, 1, 1, 4, 7, 2, 3, 6], 'pruned_params': 79053524, 'remaining_params': 5964076, 'pruned_model_sparsity': 0.9298489253989762, 'expected_sparsity': 0.92508, 'target_sparsity': 0.95, 'step': 3600}


Iteration:  15%|█▌        | 12/78 [00:04<00:31,  2.13it/s][A04/24/2024 00:01:18 - INFO - trainer.trainer_mod - v4 Global step: 3600, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  17%|█▋        | 13/78 [00:04<00:27,  2.39it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:24,  2.62it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:22,  2.82it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.98it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.10it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.17it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.24it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.30it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.34it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:16,  3.37it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.33it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.34it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.38it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.36it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.38it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.37it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.39it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.41it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.42it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.44it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.44it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.45it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.45it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.44it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.46it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.44it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.46it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.42it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.41it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.43it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.44it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.45it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.45it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.39it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.39it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.37it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.40it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.41it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.42it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.42it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.42it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.43it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.44it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.42it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.38it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.39it/s][A[INFO|trainer.py:570] 2024-04-24 00:01:32,559 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:01:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:01:32 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:01:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:01:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.10it/s]04/24/2024 00:01:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:01:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.79421496, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [205, 205, 198, 209, 195, 197, 164, 171, 185, 173, 166, 155], 'head_nums': [5, 5, 6, 7, 4, 1, 1, 4, 7, 2, 3, 6], 'pruned_params': 79255748, 'remaining_params': 5761852, 'pruned_model_sparsity': 0.9322275387684432, 'expected_sparsity': 0.92555, 'target_sparsity': 0.95, 'step': 3650}


Iteration:  79%|███████▉  | 62/78 [00:19<00:07,  2.13it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:06,  2.41it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:05,  2.65it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  2.82it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:04,  2.97it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.19it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.27it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.29it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.35it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.38it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.41it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.40it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.42it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.44it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.44it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.60it/s][A04/24/2024 00:01:37 - INFO - trainer.trainer_mod - Epoch 46 finished. Took 23.96 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.26it/s]
Epoch:  47%|████▋     | 47/100 [19:54<21:05, 23.88s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.46it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.45it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.35it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.39it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.41it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.40it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.41it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.44it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.44it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.43it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.44it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.44it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.42it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.43it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.37it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.39it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.40it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.44it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.45it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.45it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.40it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.39it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.40it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.42it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.42it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.43it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.43it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.45it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.45it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.44it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:01:47,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:01:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:01:47 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:01:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:01:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.46it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.07it/s]04/24/2024 00:01:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:01:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.8991303, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [204, 205, 198, 208, 194, 196, 164, 171, 184, 172, 166, 155], 'head_nums': [5, 5, 6, 7, 3, 1, 1, 4, 7, 2, 3, 6], 'pruned_params': 79258812, 'remaining_params': 5758788, 'pruned_model_sparsity': 0.9322635783649503, 'expected_sparsity': 0.92586, 'target_sparsity': 0.95, 'step': 3700}


Iteration:  44%|████▎     | 34/78 [00:10<00:20,  2.14it/s][A04/24/2024 00:01:48 - INFO - trainer.trainer_mod - v4 Global step: 3700, Alignment: tensor([1, 2, 2, 3], device='cuda:0')

Iteration:  45%|████▍     | 35/78 [00:10<00:17,  2.42it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:15,  2.66it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:14,  2.85it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:13,  3.01it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:12,  3.11it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.20it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.28it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.30it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.31it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.36it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.35it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.36it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.39it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.38it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.41it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.43it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.41it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.39it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.40it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.39it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.41it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.39it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.42it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.43it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.43it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.42it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.39it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.39it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.37it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.41it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.43it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.43it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.43it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.43it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.42it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.44it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.42it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.40it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.43it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.41it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.43it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:02:01 - INFO - trainer.trainer_mod - Epoch 47 finished. Took 23.35 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.34it/s]
Epoch:  48%|████▊     | 48/100 [20:17<20:33, 23.72s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.48it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.41it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.38it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.40it/s][A[INFO|trainer.py:570] 2024-04-24 00:02:02,876 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:02:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:02:02 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:02:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:02:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.39it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.00it/s]04/24/2024 00:02:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:02:03 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.8509788, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [204, 205, 197, 207, 193, 195, 164, 170, 184, 171, 165, 154], 'head_nums': [5, 5, 6, 7, 3, 1, 1, 4, 7, 2, 3, 6], 'pruned_params': 79261876, 'remaining_params': 5755724, 'pruned_model_sparsity': 0.9322996179614574, 'expected_sparsity': 0.92618, 'target_sparsity': 0.95, 'step': 3750}


Iteration:   8%|▊         | 6/78 [00:02<00:35,  2.03it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:30,  2.35it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:26,  2.62it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:24,  2.81it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.98it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:20,  3.18it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.25it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.32it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.33it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.37it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:17,  3.40it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.40it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.42it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:16,  3.42it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.42it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:16,  3.40it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.41it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.42it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.41it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.42it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.38it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.42it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.40it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.41it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.41it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.42it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.38it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.40it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.42it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.44it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.39it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:11,  3.41it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.39it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.41it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.44it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.45it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.44it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.39it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:09,  3.42it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.43it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.44it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.41it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.41it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.42it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.43it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.45it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:02:18,072 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:02:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:02:18 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:02:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:02:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.14it/s]04/24/2024 00:02:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:02:18 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6101083032490975, 'eval_loss': 0.8956295, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [204, 204, 196, 206, 192, 194, 164, 170, 183, 170, 165, 154], 'head_nums': [5, 5, 6, 7, 2, 1, 1, 3, 7, 2, 3, 6], 'pruned_params': 79266472, 'remaining_params': 5751128, 'pruned_model_sparsity': 0.932353677356218, 'expected_sparsity': 0.92655, 'target_sparsity': 0.95, 'step': 3800}


Iteration:  72%|███████▏  | 56/78 [00:17<00:10,  2.15it/s][A04/24/2024 00:02:18 - INFO - trainer.trainer_mod - v4 Global step: 3800, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  73%|███████▎  | 57/78 [00:17<00:08,  2.42it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:07,  2.66it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:06,  2.83it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:06,  2.97it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  3.17it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.23it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.30it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.34it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.35it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.38it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:02,  3.40it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.40it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.39it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.40it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.43it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.43it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.44it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.45it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.60it/s][A04/24/2024 00:02:25 - INFO - trainer.trainer_mod - Epoch 48 finished. Took 23.93 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.26it/s]
Epoch:  49%|████▉     | 49/100 [20:41<20:12, 23.78s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.45it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.44it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.46it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.48it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.46it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.47it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.46it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.46it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.42it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.44it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.44it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.42it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.43it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.44it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.45it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.43it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.40it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.39it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.42it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.40it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.42it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.43it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.44it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:02:33,201 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:02:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:02:33 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:02:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:02:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.37it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.98it/s]04/24/2024 00:02:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:02:33 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.8569244, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [203, 204, 196, 205, 191, 193, 164, 169, 183, 169, 164, 154], 'head_nums': [5, 5, 6, 7, 2, 1, 1, 3, 6, 2, 3, 6], 'pruned_params': 79269536, 'remaining_params': 5748064, 'pruned_model_sparsity': 0.9323897169527251, 'expected_sparsity': 0.92705, 'target_sparsity': 0.95, 'step': 3850}


Iteration:  36%|███▌      | 28/78 [00:08<00:23,  2.14it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:20,  2.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:18,  2.64it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:16,  2.82it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:15,  2.99it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.11it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.22it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.29it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.30it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.32it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.37it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.36it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.37it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.39it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.41it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.42it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.42it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.43it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.44it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.42it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.43it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.44it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.45it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.45it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.43it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.37it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.39it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.40it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.41it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.42it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.44it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.42it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.39it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.39it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.39it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.41it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.42it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.39it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.40it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.42it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.40it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.41it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.44it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.42it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.40it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.42it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.43it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:02:48,369 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:02:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:02:48 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:02:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:02:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.38it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.00it/s]04/24/2024 00:02:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:02:48 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.88342875, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [203, 203, 196, 205, 190, 192, 164, 169, 183, 169, 164, 153], 'head_nums': [5, 5, 6, 7, 2, 1, 1, 3, 6, 2, 3, 6], 'pruned_params': 79271068, 'remaining_params': 5746532, 'pruned_model_sparsity': 0.9324077367509787, 'expected_sparsity': 0.92831, 'target_sparsity': 0.95, 'step': 3900}


Iteration: 100%|██████████| 78/78 [00:23<00:00,  2.20it/s][A04/24/2024 00:02:48 - INFO - trainer.trainer_mod - Epoch 49 finished. Took 23.91 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.26it/s]
Epoch:  50%|█████     | 50/100 [21:05<19:51, 23.82s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A04/24/2024 00:02:49 - INFO - trainer.trainer_mod - v4 Global step: 3900, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.34it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.38it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.42it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.44it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.44it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.38it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.42it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.41it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.39it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.41it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.43it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.44it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.55it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.51it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.49it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.49it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.48it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.47it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.41it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:17,  3.37it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.38it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.40it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.38it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.43it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.41it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.41it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.42it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.40it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:14,  3.41it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.40it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.42it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.44it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.43it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.44it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.44it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.44it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.43it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:11,  3.41it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.42it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.43it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.43it/s][A
Iteration:  56%|█████▋    | 44/78 [00:12<00:09,  3.42it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.40it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.40it/s][A
Iteration:  60%|██████    | 47/78 [00:13<00:09,  3.39it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.40it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:03:03,570 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:03:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:03:03 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:03:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:03:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.11it/s]04/24/2024 00:03:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:03:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.7983791, 'head_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [203, 203, 195, 205, 189, 191, 164, 169, 182, 168, 163, 153], 'head_nums': [5, 5, 6, 7, 2, 1, 1, 3, 6, 2, 3, 6], 'pruned_params': 79272600, 'remaining_params': 5745000, 'pruned_model_sparsity': 0.9324257565492322, 'expected_sparsity': 0.9317, 'target_sparsity': 0.95, 'step': 3950}


Iteration:  64%|██████▍   | 50/78 [00:15<00:13,  2.12it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:11,  2.39it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:09,  2.62it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:08,  2.81it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:08,  2.99it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:07,  3.12it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.21it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.27it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:06,  3.30it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.34it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.36it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.39it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.41it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.43it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.45it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.45it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.42it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.50it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.46it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.46it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.46it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.41it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.43it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.43it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.42it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.43it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.44it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.60it/s][A04/24/2024 00:03:12 - INFO - trainer.trainer_mod - Epoch 50 finished. Took 23.3 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.35it/s]
Epoch:  51%|█████     | 51/100 [21:29<19:19, 23.66s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.34it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.40it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.40it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.43it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.42it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.42it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.42it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.43it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.43it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.44it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.43it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.45it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.46it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.47it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.46it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.44it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.41it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:17,  3.40it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:03:18,671 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:03:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:03:18 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:03:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:03:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.09it/s]04/24/2024 00:03:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:03:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.6531839, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [202, 202, 195, 204, 188, 191, 163, 168, 182, 167, 163, 153], 'head_nums': [4, 5, 6, 7, 2, 1, 1, 3, 6, 2, 3, 6], 'pruned_params': 80845964, 'remaining_params': 4171636, 'pruned_model_sparsity': 0.9509320893556158, 'expected_sparsity': 0.93957, 'target_sparsity': 0.95, 'step': 4000}


Iteration:  28%|██▊       | 22/78 [00:07<00:26,  2.13it/s][A04/24/2024 00:03:19 - INFO - trainer.trainer_mod - v4 Global step: 4000, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  29%|██▉       | 23/78 [00:07<00:22,  2.41it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:20,  2.66it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:18,  2.87it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.03it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.15it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.19it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.28it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.33it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.36it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.37it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.41it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.42it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.43it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.45it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.47it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.47it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.44it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.44it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.44it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.45it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.43it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.45it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.47it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.42it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.44it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.44it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.42it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.42it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.40it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.39it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.42it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.39it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.44it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.45it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.46it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.47it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.47it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.44it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.42it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.44it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.46it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.40it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:03:33,786 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:03:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:03:33 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:03:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:03:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.10it/s]04/24/2024 00:03:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:03:34 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.74685144, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [202, 202, 194, 204, 187, 190, 163, 168, 181, 167, 162, 153], 'head_nums': [4, 5, 6, 7, 2, 1, 1, 3, 6, 2, 3, 6], 'pruned_params': 80847496, 'remaining_params': 4170104, 'pruned_model_sparsity': 0.9509501091538693, 'expected_sparsity': 0.94305, 'target_sparsity': 0.95, 'step': 4050}


Iteration:  92%|█████████▏| 72/78 [00:22<00:02,  2.14it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:02,  2.42it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  2.66it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.00it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.13it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.35it/s][A04/24/2024 00:03:36 - INFO - trainer.trainer_mod - Epoch 51 finished. Took 23.81 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  52%|█████▏    | 52/100 [21:52<18:58, 23.71s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.48it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.49it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.44it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.45it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.41it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.42it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.44it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.46it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.46it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.47it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:18,  3.48it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.48it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.48it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.49it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.47it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.44it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.44it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.45it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.45it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.44it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.43it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.45it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.46it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.47it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.48it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.48it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.48it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.45it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.40it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.40it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.39it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.42it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.43it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.44it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.45it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.45it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:10,  3.48it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.48it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.47it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:03:48,819 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:03:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:03:48 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:03:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:03:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:03:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:03:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 0.6867033, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [202, 202, 194, 204, 186, 189, 163, 167, 181, 166, 162, 152], 'head_nums': [4, 5, 6, 7, 1, 1, 1, 3, 5, 2, 3, 6], 'pruned_params': 80847496, 'remaining_params': 4170104, 'pruned_model_sparsity': 0.9509501091538693, 'expected_sparsity': 0.94401, 'target_sparsity': 0.95, 'step': 4100}


Iteration:  56%|█████▋    | 44/78 [00:13<00:15,  2.15it/s][A04/24/2024 00:03:49 - INFO - trainer.trainer_mod - v4 Global step: 4100, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  58%|█████▊    | 45/78 [00:13<00:13,  2.41it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:12,  2.65it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:10,  2.85it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:09,  3.14it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.18it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.23it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.30it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.34it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.37it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.41it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.43it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.46it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.43it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.43it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.42it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.41it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.43it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.46it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.44it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.44it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.45it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.46it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.41it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.40it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.43it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.42it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.44it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.42it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.44it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:03:59 - INFO - trainer.trainer_mod - Epoch 52 finished. Took 23.2 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  53%|█████▎    | 53/100 [22:16<18:27, 23.56s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.49it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.42it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.41it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.42it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.43it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.51it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.52it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.47it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.47it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.47it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.47it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:18,  3.47it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.49it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.48it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.47it/s][A[INFO|trainer.py:570] 2024-04-24 00:04:03,876 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:04:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:04:03 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:04:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:04:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:04:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:04:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.7771328, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [202, 201, 193, 203, 185, 188, 163, 167, 180, 165, 162, 152], 'head_nums': [4, 5, 6, 7, 1, 1, 1, 3, 5, 2, 3, 6], 'pruned_params': 80852092, 'remaining_params': 4165508, 'pruned_model_sparsity': 0.9510041685486299, 'expected_sparsity': 0.94442, 'target_sparsity': 0.95, 'step': 4150}


Iteration:  21%|██        | 16/78 [00:05<00:28,  2.16it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:25,  2.42it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:22,  2.64it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.83it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  2.99it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.12it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:17,  3.22it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.27it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.33it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.34it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.37it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.40it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.39it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.39it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.38it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.41it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.40it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.42it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.42it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.38it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.41it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.43it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.42it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.43it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.46it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.44it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.45it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.46it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.44it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.41it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.45it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.46it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.68it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.62it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.55it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.53it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.49it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.49it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.49it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.45it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.40it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.42it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.43it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:04:18,960 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:04:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:04:18 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:04:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:04:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.16it/s]04/24/2024 00:04:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:04:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.79577935, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 201, 193, 203, 185, 187, 163, 167, 180, 165, 162, 152], 'head_nums': [4, 5, 6, 7, 1, 1, 1, 3, 5, 2, 3, 5], 'pruned_params': 80853624, 'remaining_params': 4163976, 'pruned_model_sparsity': 0.9510221883468835, 'expected_sparsity': 0.94461, 'target_sparsity': 0.95, 'step': 4200}


Iteration:  85%|████████▍ | 66/78 [00:20<00:05,  2.16it/s][A04/24/2024 00:04:19 - INFO - trainer.trainer_mod - v4 Global step: 4200, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  86%|████████▌ | 67/78 [00:20<00:04,  2.43it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:03,  2.67it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:03,  2.85it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.01it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.11it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.20it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.25it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.34it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.35it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.38it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.55it/s][A04/24/2024 00:04:23 - INFO - trainer.trainer_mod - Epoch 53 finished. Took 23.75 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  54%|█████▍    | 54/100 [22:39<18:06, 23.61s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:21,  3.52it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.42it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.45it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.46it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.48it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.44it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.46it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.43it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.44it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.41it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.42it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.43it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.43it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.41it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.43it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.41it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.43it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.44it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.46it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.46it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.46it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.46it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.45it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.47it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.47it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:14,  3.42it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.44it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.42it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.44it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.45it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.42it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.45it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:04:34,043 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:04:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:04:34 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:04:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:04:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.11it/s]04/24/2024 00:04:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:04:34 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.7806743, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 201, 192, 202, 184, 187, 163, 166, 180, 164, 161, 152], 'head_nums': [4, 5, 6, 6, 1, 1, 1, 3, 5, 2, 3, 5], 'pruned_params': 80856688, 'remaining_params': 4160912, 'pruned_model_sparsity': 0.9510582279433906, 'expected_sparsity': 0.94472, 'target_sparsity': 0.95, 'step': 4250}


Iteration:  49%|████▊     | 38/78 [00:11<00:18,  2.16it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:16,  2.42it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:14,  2.64it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:13,  2.84it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:12,  2.99it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.12it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.23it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.30it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.35it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.39it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.39it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.41it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.43it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.41it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.44it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.41it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.38it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.41it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.44it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.46it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.42it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.43it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.42it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.43it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.45it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.43it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.44it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.46it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.47it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.48it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.48it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.49it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.41it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.42it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.40it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.38it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.39it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.55it/s][A04/24/2024 00:04:46 - INFO - trainer.trainer_mod - Epoch 54 finished. Took 23.22 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  55%|█████▌    | 55/100 [23:03<17:37, 23.49s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.46it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.47it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.52it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.46it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.56it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.52it/s][A
Iteration:   9%|▉         | 7/78 [00:01<00:20,  3.50it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.49it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:04:49,101 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:04:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:04:49 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:04:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:04:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.13it/s]04/24/2024 00:04:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:04:49 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.7594146, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 201, 192, 202, 183, 186, 163, 166, 179, 164, 161, 152], 'head_nums': [4, 5, 6, 6, 1, 1, 1, 3, 5, 2, 3, 5], 'pruned_params': 80856688, 'remaining_params': 4160912, 'pruned_model_sparsity': 0.9510582279433906, 'expected_sparsity': 0.94492, 'target_sparsity': 0.95, 'step': 4300}


Iteration:  13%|█▎        | 10/78 [00:03<00:31,  2.13it/s][A04/24/2024 00:04:49 - INFO - trainer.trainer_mod - v4 Global step: 4300, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  14%|█▍        | 11/78 [00:03<00:27,  2.41it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:25,  2.63it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.81it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.99it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.12it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.23it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.30it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.32it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.33it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.37it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.34it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.35it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.39it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.37it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.40it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.39it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.42it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.41it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.44it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.45it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.43it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.44it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.42it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.43it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.45it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.47it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.43it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.42it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.44it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.44it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.44it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.45it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.44it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.45it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.46it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.47it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.44it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.46it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.43it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.45it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.42it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.41it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.42it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.44it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.45it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.47it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.48it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:05:04,246 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:05:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:05:04 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:05:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:05:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.16it/s]04/24/2024 00:05:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:05:04 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6064981949458483, 'eval_loss': 0.7528962, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 200, 192, 201, 182, 185, 163, 165, 179, 163, 161, 151], 'head_nums': [4, 5, 6, 6, 1, 1, 1, 3, 5, 2, 3, 5], 'pruned_params': 80859752, 'remaining_params': 4157848, 'pruned_model_sparsity': 0.9510942675398977, 'expected_sparsity': 0.94561, 'target_sparsity': 0.95, 'step': 4350}


Iteration:  77%|███████▋  | 60/78 [00:18<00:08,  2.16it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:07,  2.42it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:06,  2.66it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:05,  2.84it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  2.99it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  3.11it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.18it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.24it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:03,  3.27it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.29it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.33it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.36it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.36it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.39it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.38it/s][A
Iteration:  96%|█████████▌| 75/78 [00:23<00:00,  3.40it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.39it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.43it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:05:10 - INFO - trainer.trainer_mod - Epoch 55 finished. Took 23.84 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.27it/s]
Epoch:  56%|█████▌    | 56/100 [23:26<17:18, 23.60s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.44it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.41it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.46it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.46it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.47it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.48it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.48it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.48it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.49it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.46it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.46it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.46it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.47it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.45it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.43it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.42it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.42it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.43it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.44it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.39it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.41it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.41it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.41it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.42it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:14,  3.43it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:05:19,378 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:05:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:05:19 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:05:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:05:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.12it/s]04/24/2024 00:05:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:05:19 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.7644221, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 200, 192, 201, 181, 184, 163, 165, 178, 163, 160, 151], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 3, 4, 2, 3, 5], 'pruned_params': 81057380, 'remaining_params': 3960220, 'pruned_model_sparsity': 0.953418821514604, 'expected_sparsity': 0.94664, 'target_sparsity': 0.95, 'step': 4400}


Iteration:  41%|████      | 32/78 [00:09<00:21,  2.14it/s][A04/24/2024 00:05:20 - INFO - trainer.trainer_mod - v4 Global step: 4400, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  42%|████▏     | 33/78 [00:10<00:18,  2.40it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:16,  2.65it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:15,  2.85it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:14,  2.99it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.12it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:12,  3.22it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.27it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.29it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.32it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.37it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.41it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.43it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.45it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.44it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.45it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.46it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.43it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.44it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.42it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.44it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.50it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.50it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.46it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.44it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.44it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.46it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.45it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.45it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.44it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.45it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.42it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.44it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.44it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.42it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.43it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.44it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.46it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.47it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.48it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.48it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.48it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.49it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.49it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.62it/s][A04/24/2024 00:05:33 - INFO - trainer.trainer_mod - Epoch 56 finished. Took 23.19 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  57%|█████▋    | 57/100 [23:50<16:49, 23.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.44it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.40it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.43it/s][A[INFO|trainer.py:570] 2024-04-24 00:05:34,421 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:05:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:05:34 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:05:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:05:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.16it/s]04/24/2024 00:05:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:05:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.81092894, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 200, 191, 201, 180, 184, 163, 165, 178, 162, 160, 151], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 3, 4, 2, 3, 5], 'pruned_params': 81058912, 'remaining_params': 3958688, 'pruned_model_sparsity': 0.9534368413128576, 'expected_sparsity': 0.94703, 'target_sparsity': 0.95, 'step': 4450}


Iteration:   5%|▌         | 4/78 [00:01<00:38,  1.93it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:31,  2.29it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:27,  2.59it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.83it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.01it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:21,  3.14it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.24it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.30it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:19,  3.35it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.38it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.41it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.44it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.44it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:17,  3.44it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.44it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.45it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:16,  3.45it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.46it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.47it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.43it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.43it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.46it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.44it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.40it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.40it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.40it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.41it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.43it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.40it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.43it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.45it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.43it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.41it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.39it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.42it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.44it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.45it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.46it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.40it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.42it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.40it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.38it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.37it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.40it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.39it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.40it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.40it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:05:49,562 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:05:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:05:49 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:05:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:05:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.54it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.07it/s]04/24/2024 00:05:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:05:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.8156436, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 199, 191, 200, 179, 183, 163, 164, 178, 162, 160, 151], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 3, 3, 2, 3, 5], 'pruned_params': 81061976, 'remaining_params': 3955624, 'pruned_model_sparsity': 0.9534728809093647, 'expected_sparsity': 0.94724, 'target_sparsity': 0.95, 'step': 4500}


Iteration:  69%|██████▉   | 54/78 [00:16<00:11,  2.15it/s][A04/24/2024 00:05:50 - INFO - trainer.trainer_mod - v4 Global step: 4500, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  71%|███████   | 55/78 [00:17<00:09,  2.43it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:08,  2.67it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:07,  2.85it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.01it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:06,  3.11it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.22it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.29it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.34it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.37it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.37it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.41it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.43it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.45it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.46it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.48it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.48it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.48it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.47it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.48it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.45it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.39it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.40it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.42it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:05:57 - INFO - trainer.trainer_mod - Epoch 57 finished. Took 23.8 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  58%|█████▊    | 58/100 [24:13<16:30, 23.57s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:23,  3.33it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.43it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.46it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.47it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.48it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.44it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.45it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.43it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.45it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.47it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.47it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.48it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.48it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.45it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.42it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.45it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.46it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.46it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.42it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.39it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:06:04,614 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:06:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:06:04 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:06:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:06:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.15it/s]04/24/2024 00:06:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:06:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6028880866425993, 'eval_loss': 0.85766155, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 199, 191, 200, 178, 182, 163, 164, 177, 161, 160, 151], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 3, 3, 2, 3, 5], 'pruned_params': 81061976, 'remaining_params': 3955624, 'pruned_model_sparsity': 0.9534728809093647, 'expected_sparsity': 0.94736, 'target_sparsity': 0.95, 'step': 4550}


Iteration:  33%|███▎      | 26/78 [00:08<00:24,  2.14it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:21,  2.41it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:18,  2.65it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:17,  2.85it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:16,  2.99it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:15,  3.13it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:14,  3.23it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.30it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.35it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.40it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.43it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.45it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.46it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.46it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.47it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.48it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.47it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.46it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.46it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.47it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.48it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.44it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.43it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.50it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.49it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.49it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.49it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.49it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.49it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.49it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.49it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.50it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.46it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.42it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.45it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.46it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.47it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.41it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.42it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.41it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.43it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.43it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.39it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.38it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.40it/s][A[INFO|trainer.py:570] 2024-04-24 00:06:19,663 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:06:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:06:19 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:06:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:06:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.14it/s]04/24/2024 00:06:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:06:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.80569327, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 199, 191, 199, 178, 182, 163, 164, 177, 161, 159, 151], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 3, 3, 2, 3, 4], 'pruned_params': 81063508, 'remaining_params': 3954092, 'pruned_model_sparsity': 0.9534909007076182, 'expected_sparsity': 0.94742, 'target_sparsity': 0.95, 'step': 4600}


Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  2.14it/s][A04/24/2024 00:06:20 - INFO - trainer.trainer_mod - v4 Global step: 4600, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  2.42it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  2.75it/s][A04/24/2024 00:06:20 - INFO - trainer.trainer_mod - Epoch 58 finished. Took 23.73 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  59%|█████▉    | 59/100 [24:37<16:08, 23.62s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.48it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.35it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.38it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.42it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.40it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.42it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.41it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.43it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.44it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.42it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.44it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.46it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.46it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.46it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.47it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.48it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.49it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.48it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:16,  3.48it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.48it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.49it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.49it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.49it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.49it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.47it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.46it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.46it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.44it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.42it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.44it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.45it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.45it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.47it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.42it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.44it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.43it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.44it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:11,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.47it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.47it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.48it/s][A
Iteration:  56%|█████▋    | 44/78 [00:12<00:09,  3.48it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.41it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.44it/s][A
Iteration:  60%|██████    | 47/78 [00:13<00:09,  3.43it/s][A[INFO|trainer.py:570] 2024-04-24 00:06:34,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:06:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:06:34 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:06:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:06:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.47it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.08it/s]04/24/2024 00:06:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:06:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6137184115523465, 'eval_loss': 0.9124934, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [199, 199, 191, 199, 177, 181, 163, 163, 176, 161, 159, 151], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 3, 2, 2, 3, 4], 'pruned_params': 81065040, 'remaining_params': 3952560, 'pruned_model_sparsity': 0.9535089205058718, 'expected_sparsity': 0.94747, 'target_sparsity': 0.95, 'step': 4650}


Iteration:  62%|██████▏   | 48/78 [00:14<00:13,  2.15it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:12,  2.41it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:10,  2.65it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:09,  2.85it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:08,  3.02it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.14it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.23it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.29it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.34it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.33it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.37it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.41it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.43it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.45it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.43it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.41it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.40it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.40it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.43it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.43it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.42it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.42it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.43it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.43it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.45it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.43it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.45it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.46it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.62it/s][A04/24/2024 00:06:43 - INFO - trainer.trainer_mod - Epoch 59 finished. Took 23.18 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  60%|██████    | 60/100 [25:00<15:39, 23.49s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.42it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.41it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.43it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.45it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.47it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.48it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.48it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.49it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.46it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.46it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.44it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.43it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.46it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.46it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.47it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.47it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.47it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:16,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:06:49,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:06:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:06:49 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:06:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:06:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.15it/s]04/24/2024 00:06:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:06:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.852246, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [199, 198, 190, 199, 176, 180, 163, 163, 175, 160, 159, 150], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 3, 2, 2, 3, 4], 'pruned_params': 81068104, 'remaining_params': 3949496, 'pruned_model_sparsity': 0.9535449601023788, 'expected_sparsity': 0.94752, 'target_sparsity': 0.95, 'step': 4700}


Iteration:  26%|██▌       | 20/78 [00:06<00:26,  2.17it/s][A04/24/2024 00:06:50 - INFO - trainer.trainer_mod - v4 Global step: 4700, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  27%|██▋       | 21/78 [00:06<00:23,  2.44it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:20,  2.69it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:19,  2.86it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.02it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.13it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.23it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.30it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.32it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.37it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.41it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.40it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.41it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.38it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.40it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.43it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.45it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.46it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.44it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.45it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.47it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.46it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.46it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.46it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.47it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.44it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.45it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.42it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.40it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.39it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.42it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.43it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.44it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.45it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.46it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.47it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.44it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.44it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.41it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.43it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.43it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.45it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.46it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.43it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.42it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.42it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.44it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:07:04,853 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:07:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:07:04 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:07:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:07:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.15it/s]04/24/2024 00:07:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:07:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6101083032490975, 'eval_loss': 0.8287154, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [199, 198, 190, 199, 176, 180, 163, 163, 175, 160, 159, 150], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 3, 2, 2, 3, 4], 'pruned_params': 81068104, 'remaining_params': 3949496, 'pruned_model_sparsity': 0.9535449601023788, 'expected_sparsity': 0.94765, 'target_sparsity': 0.95, 'step': 4750}


Iteration:  90%|████████▉ | 70/78 [00:21<00:03,  2.15it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  2.41it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:02,  2.65it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  2.86it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.02it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.15it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.21it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.26it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.45it/s][A04/24/2024 00:07:07 - INFO - trainer.trainer_mod - Epoch 60 finished. Took 23.76 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  61%|██████    | 61/100 [25:24<15:19, 23.57s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.43it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.47it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.44it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.45it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.38it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.37it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.40it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.39it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.43it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.44it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.46it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.47it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.42it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.40it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.42it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.42it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.39it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:17,  3.39it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.41it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.40it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.43it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.44it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.45it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.43it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.45it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.46it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.47it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.47it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.52it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.53it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.48it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.48it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.47it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.47it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.45it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.44it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:11,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:07:19,942 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:07:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:07:19 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:07:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:07:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.06it/s]04/24/2024 00:07:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:07:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.84384364, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [199, 198, 190, 199, 175, 179, 163, 162, 174, 159, 158, 150], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 2, 2, 2, 3, 3], 'pruned_params': 81068104, 'remaining_params': 3949496, 'pruned_model_sparsity': 0.9535449601023788, 'expected_sparsity': 0.94779, 'target_sparsity': 0.95, 'step': 4800}


Iteration:  54%|█████▍    | 42/78 [00:12<00:16,  2.13it/s][A04/24/2024 00:07:20 - INFO - trainer.trainer_mod - v4 Global step: 4800, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  55%|█████▌    | 43/78 [00:13<00:14,  2.41it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:12,  2.65it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:11,  2.86it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:10,  3.00it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.14it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.20it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.25it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.30it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.32it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.35it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.35it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.36it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.39it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.41it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.43it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.47it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.48it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.47it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.47it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.46it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.47it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.48it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.49it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.55it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.53it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.49it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.49it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.45it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.42it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.43it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.37it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.43it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:07:30 - INFO - trainer.trainer_mod - Epoch 61 finished. Took 23.21 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  62%|██████▏   | 62/100 [25:47<14:51, 23.46s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.45it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.38it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.42it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.45it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.44it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.47it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.42it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.40it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.43it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.42it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.40it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.43it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:07:35,021 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:07:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:07:35 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:07:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:07:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.16it/s]04/24/2024 00:07:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:07:35 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.9102024, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [199, 198, 190, 199, 175, 178, 163, 162, 173, 159, 158, 150], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 2, 2, 2, 3, 3], 'pruned_params': 81068104, 'remaining_params': 3949496, 'pruned_model_sparsity': 0.9535449601023788, 'expected_sparsity': 0.94787, 'target_sparsity': 0.95, 'step': 4850}


Iteration:  18%|█▊        | 14/78 [00:04<00:30,  2.13it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:26,  2.42it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:23,  2.64it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:21,  2.85it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.11it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.17it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.25it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:16,  3.32it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.36it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.40it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.42it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.44it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.45it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.48it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.49it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.48it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.49it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.46it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.47it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.38it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.40it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.42it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.40it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.42it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.44it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.45it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.46it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.46it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.46it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.47it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.44it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.45it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.46it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.46it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.47it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.42it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.42it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.43it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.43it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.42it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.41it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.43it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.45it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.46it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.44it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:07:50,109 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:07:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:07:50 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:07:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:07:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.09it/s]04/24/2024 00:07:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:07:50 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.826733, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 189, 198, 174, 178, 163, 162, 173, 159, 158, 150], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 2, 2, 2, 3, 3], 'pruned_params': 81072700, 'remaining_params': 3944900, 'pruned_model_sparsity': 0.9535990194971394, 'expected_sparsity': 0.94795, 'target_sparsity': 0.95, 'step': 4900}


Iteration:  82%|████████▏ | 64/78 [00:19<00:06,  2.16it/s][A04/24/2024 00:07:50 - INFO - trainer.trainer_mod - v4 Global step: 4900, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  83%|████████▎ | 65/78 [00:20<00:05,  2.41it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:04,  2.64it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  2.82it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:03,  2.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.13it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.22it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.29it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.35it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.35it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.35it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.36it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.40it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.37it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.54it/s][A04/24/2024 00:07:54 - INFO - trainer.trainer_mod - Epoch 62 finished. Took 23.82 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.27it/s]
Epoch:  63%|██████▎   | 63/100 [26:11<14:32, 23.57s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.41it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.45it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.46it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.45it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.48it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.47it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.48it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.44it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.42it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.43it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.42it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.42it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.39it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.39it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.42it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:18,  3.38it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.38it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.41it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.44it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.45it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.46it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.44it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.43it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.40it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.42it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.44it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.46it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.44it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.44it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.45it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.45it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.42it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:08:05,238 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:08:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:08:05 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:08:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:08:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.08it/s]04/24/2024 00:08:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:08:05 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.86783123, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 189, 198, 173, 177, 163, 161, 172, 158, 158, 150], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 2, 2, 2, 3, 3], 'pruned_params': 81072700, 'remaining_params': 3944900, 'pruned_model_sparsity': 0.9535990194971394, 'expected_sparsity': 0.948, 'target_sparsity': 0.95, 'step': 4950}


Iteration:  46%|████▌     | 36/78 [00:11<00:19,  2.15it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:16,  2.42it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:15,  2.66it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:13,  2.86it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.02it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.15it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:11,  3.25it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.29it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.31it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.36it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.39it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.45it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.43it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.44it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.45it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.43it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.41it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.44it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.45it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.43it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.39it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.42it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.41it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.42it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.44it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.42it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.45it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.39it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.38it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.40it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.44it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.46it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.44it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.42it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.43it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.44it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.45it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.47it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.61it/s][A04/24/2024 00:08:17 - INFO - trainer.trainer_mod - Epoch 63 finished. Took 23.24 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  64%|██████▍   | 64/100 [26:34<14:04, 23.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.42it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.39it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.43it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.45it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.46it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:08:20,316 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:08:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:08:20 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:08:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:08:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.45it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.03it/s]04/24/2024 00:08:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:08:20 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.8458557, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 188, 198, 173, 177, 163, 161, 171, 158, 157, 150], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 2, 2, 2, 3, 2], 'pruned_params': 81074232, 'remaining_params': 3943368, 'pruned_model_sparsity': 0.953617039295393, 'expected_sparsity': 0.94804, 'target_sparsity': 0.95, 'step': 5000}


Iteration:  10%|█         | 8/78 [00:02<00:33,  2.09it/s][A04/24/2024 00:08:21 - INFO - trainer.trainer_mod - v4 Global step: 5000, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  12%|█▏        | 9/78 [00:03<00:28,  2.39it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.65it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:23,  2.86it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.04it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.16it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.24it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.31it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.33it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.34it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.38it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.41it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:16,  3.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.44it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.44it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.43it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.42it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.40it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.43it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.45it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.43it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.43it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.45it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.41it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.43it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.45it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.41it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.40it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.40it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.42it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.42it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.43it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.44it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.45it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.44it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.46it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.47it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.44it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.52it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.46it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.47it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.47it/s][A[INFO|trainer.py:570] 2024-04-24 00:08:35,423 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:08:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:08:35 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:08:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:08:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:08:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:08:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6064981949458483, 'eval_loss': 0.815095, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 188, 198, 173, 176, 163, 161, 170, 158, 157, 150], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 2, 2, 3, 2], 'pruned_params': 81074232, 'remaining_params': 3943368, 'pruned_model_sparsity': 0.953617039295393, 'expected_sparsity': 0.94811, 'target_sparsity': 0.95, 'step': 5050}


Iteration:  74%|███████▍  | 58/78 [00:18<00:09,  2.15it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:07,  2.41it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:06,  2.63it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  2.84it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  2.99it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.19it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.25it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.32it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.36it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.39it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.38it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.43it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.45it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.46it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.42it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.44it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.45it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.43it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.57it/s][A04/24/2024 00:08:41 - INFO - trainer.trainer_mod - Epoch 64 finished. Took 23.81 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  65%|██████▌   | 65/100 [26:58<13:44, 23.57s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.48it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.42it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.37it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.37it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.40it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.42it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.44it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.46it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.47it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.47it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.47it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.47it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.47it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.44it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.46it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.47it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.47it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:16,  3.48it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.48it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.44it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.45it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.41it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.39it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.42it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:08:50,508 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:08:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:08:50 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:08:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:08:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.13it/s]04/24/2024 00:08:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:08:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.8169809, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 188, 198, 172, 176, 163, 161, 169, 157, 157, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 2, 2, 3, 2], 'pruned_params': 81074232, 'remaining_params': 3943368, 'pruned_model_sparsity': 0.953617039295393, 'expected_sparsity': 0.9482, 'target_sparsity': 0.95, 'step': 5100}


Iteration:  38%|███▊      | 30/78 [00:09<00:22,  2.16it/s][A04/24/2024 00:08:51 - INFO - trainer.trainer_mod - v4 Global step: 5100, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  40%|███▉      | 31/78 [00:09<00:19,  2.42it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:17,  2.66it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:15,  2.87it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.03it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.15it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.24it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.28it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.33it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.37it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.40it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.48it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.44it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.43it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.45it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.43it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.39it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.35it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.40it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.39it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.42it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.44it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.45it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.46it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.44it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.45it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.44it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.41it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.44it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.45it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.43it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.42it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.39it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.41it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.39it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.39it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.36it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.37it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.40it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.45it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.46it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.47it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.44it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.42it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.44it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.45it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.60it/s][A04/24/2024 00:09:05 - INFO - trainer.trainer_mod - Epoch 65 finished. Took 23.23 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  66%|██████▌   | 66/100 [27:21<13:17, 23.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A[INFO|trainer.py:570] 2024-04-24 00:09:05,599 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:09:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:09:05 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:09:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:09:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.18it/s]04/24/2024 00:09:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:09:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.8514424, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 188, 198, 171, 175, 162, 160, 169, 157, 157, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 2, 2, 3, 2], 'pruned_params': 81074232, 'remaining_params': 3943368, 'pruned_model_sparsity': 0.953617039295393, 'expected_sparsity': 0.94828, 'target_sparsity': 0.95, 'step': 5150}


Iteration:   3%|▎         | 2/78 [00:01<00:47,  1.60it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:35,  2.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:30,  2.46it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:26,  2.75it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.93it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.16it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:21,  3.23it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.27it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.33it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:19,  3.35it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.38it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.41it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.43it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.44it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:17,  3.41it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.43it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.41it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:16,  3.43it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.45it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.46it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:15,  3.47it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.48it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.45it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.45it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.45it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.46it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.47it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.47it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.47it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.41it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.45it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.46it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.47it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.48it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.48it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.48it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.48it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.47it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.44it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.43it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.41it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.46it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.46it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.47it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:09:20,700 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:09:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:09:20 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:09:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:09:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.09it/s]04/24/2024 00:09:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:09:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6101083032490975, 'eval_loss': 0.8345363, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 188, 197, 171, 175, 162, 160, 168, 157, 156, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 3, 2], 'pruned_params': 81075764, 'remaining_params': 3941836, 'pruned_model_sparsity': 0.9536350590936465, 'expected_sparsity': 0.94833, 'target_sparsity': 0.95, 'step': 5200}


Iteration:  67%|██████▋   | 52/78 [00:16<00:12,  2.15it/s][A04/24/2024 00:09:21 - INFO - trainer.trainer_mod - v4 Global step: 5200, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  68%|██████▊   | 53/78 [00:16<00:10,  2.41it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:09,  2.65it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:08,  2.83it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:07,  2.99it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.20it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.29it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.35it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.39it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.42it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.44it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.43it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.45it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.42it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.44it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.45it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.46it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.42it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.44it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.42it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.40it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.38it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.38it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.41it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.52it/s][A04/24/2024 00:09:28 - INFO - trainer.trainer_mod - Epoch 66 finished. Took 23.8 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  67%|██████▋   | 67/100 [27:45<12:57, 23.57s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.46it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.48it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.49it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.48it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.47it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.45it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.42it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.42it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.43it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.44it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.45it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.45it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.45it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.45it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.47it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.46it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.47it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.47it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.48it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.47it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:09:35,771 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:09:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:09:35 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:09:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:09:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:09:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:09:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.917152, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 188, 197, 171, 174, 162, 160, 168, 156, 156, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 3, 2], 'pruned_params': 81075764, 'remaining_params': 3941836, 'pruned_model_sparsity': 0.9536350590936465, 'expected_sparsity': 0.94836, 'target_sparsity': 0.95, 'step': 5250}


Iteration:  31%|███       | 24/78 [00:07<00:25,  2.16it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:21,  2.43it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:19,  2.65it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:17,  2.85it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:16,  3.01it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:15,  3.13it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.24it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.31it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.36it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.37it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.42it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.43it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.45it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.46it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.47it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.43it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.44it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.44it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.45it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.46it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.47it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.48it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.48it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.47it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.48it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.48it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.44it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.45it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.40it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.42it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.40it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.42it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.43it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.43it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.47it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.47it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.48it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.43it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.41it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.41it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.42it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.44it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.45it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.46it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:09:50,837 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:09:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:09:50 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:09:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:09:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.14it/s]04/24/2024 00:09:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:09:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.8935126, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 197, 170, 174, 162, 160, 167, 156, 156, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 3, 2], 'pruned_params': 81077296, 'remaining_params': 3940304, 'pruned_model_sparsity': 0.9536530788919, 'expected_sparsity': 0.94839, 'target_sparsity': 0.95, 'step': 5300}


Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  2.16it/s][A04/24/2024 00:09:51 - INFO - trainer.trainer_mod - v4 Global step: 5300, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  96%|█████████▌| 75/78 [00:22<00:01,  2.44it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  2.66it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  2.84it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.11it/s][A04/24/2024 00:09:52 - INFO - trainer.trainer_mod - Epoch 67 finished. Took 23.72 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  68%|██████▊   | 68/100 [28:09<12:35, 23.61s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.36it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.44it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.46it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.44it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.45it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.43it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.42it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.44it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.41it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.43it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.46it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.44it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.44it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.46it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.43it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.43it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.44it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.45it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.45it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.43it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.45it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.47it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.46it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.47it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.49it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.46it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.47it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.47it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.48it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.48it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.49it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.48it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.48it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:10,  3.48it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.49it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.45it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.41it/s][A
Iteration:  56%|█████▋    | 44/78 [00:12<00:09,  3.44it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:10:05,888 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:10:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:10:05 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:10:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:10:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.20it/s]04/24/2024 00:10:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:10:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.85886437, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 197, 170, 174, 162, 159, 167, 156, 156, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 3, 2], 'pruned_params': 81077296, 'remaining_params': 3940304, 'pruned_model_sparsity': 0.9536530788919, 'expected_sparsity': 0.94844, 'target_sparsity': 0.95, 'step': 5350}


Iteration:  59%|█████▉    | 46/78 [00:13<00:14,  2.15it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:12,  2.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:11,  2.68it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:10,  2.88it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.16it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:08,  3.22it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.30it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.32it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.37it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.40it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.43it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.45it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.45it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.46it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.48it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.45it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.45it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.47it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.48it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.45it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.42it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.45it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.47it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.47it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.46it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.47it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.47it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.44it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.59it/s][A04/24/2024 00:10:15 - INFO - trainer.trainer_mod - Epoch 68 finished. Took 23.12 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  69%|██████▉   | 69/100 [28:32<12:07, 23.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.44it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.40it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.44it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.41it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.40it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.42it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.44it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.46it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.46it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.43it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.42it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.46it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:10:20,904 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:10:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:10:20 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:10:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:10:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.20it/s]04/24/2024 00:10:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:10:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.86934876, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 197, 169, 173, 162, 159, 166, 155, 156, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81077296, 'remaining_params': 3940304, 'pruned_model_sparsity': 0.9536530788919, 'expected_sparsity': 0.94847, 'target_sparsity': 0.95, 'step': 5400}


Iteration:  23%|██▎       | 18/78 [00:05<00:27,  2.16it/s][A04/24/2024 00:10:21 - INFO - trainer.trainer_mod - v4 Global step: 5400, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  24%|██▍       | 19/78 [00:06<00:24,  2.42it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:21,  2.66it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:19,  2.87it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.16it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.25it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.32it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.34it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.38it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.37it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.40it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.43it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.44it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.42it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.44it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:11,  3.70it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:11,  3.63it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:11,  3.58it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.55it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.59it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:10,  3.57it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.51it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.50it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.47it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.46it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.42it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.40it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.39it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.42it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.45it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.46it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.47it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.48it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.48it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.48it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.49it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.48it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.49it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.49it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.49it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.49it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.48it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.38it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.37it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.38it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.42it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.44it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.43it/s][A[INFO|trainer.py:570] 2024-04-24 00:10:35,891 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:10:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:10:35 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:10:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:10:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:10:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:10:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.94864994, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 197, 169, 173, 162, 159, 166, 155, 155, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81077296, 'remaining_params': 3940304, 'pruned_model_sparsity': 0.9536530788919, 'expected_sparsity': 0.94848, 'target_sparsity': 0.95, 'step': 5450}


Iteration:  87%|████████▋ | 68/78 [00:20<00:04,  2.16it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:03,  2.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  2.67it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  2.86it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.02it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.13it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.22it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.27it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.31it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.35it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.53it/s][A04/24/2024 00:10:39 - INFO - trainer.trainer_mod - Epoch 69 finished. Took 23.66 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.30it/s]
Epoch:  70%|███████   | 70/100 [28:56<11:45, 23.53s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.42it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.41it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.39it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.42it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.41it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.41it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.39it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.41it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.44it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.42it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.43it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.44it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.46it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.44it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.41it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.43it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.44it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.42it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.43it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.45it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.45it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.45it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.45it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.46it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.46it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.47it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.48it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.45it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.45it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.46it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.45it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.46it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.45it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.43it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:10:50,959 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:10:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:10:50 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:10:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:10:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.45it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.08it/s]04/24/2024 00:10:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:10:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.8620009, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 197, 168, 173, 162, 159, 165, 155, 155, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81077296, 'remaining_params': 3940304, 'pruned_model_sparsity': 0.9536530788919, 'expected_sparsity': 0.94848, 'target_sparsity': 0.95, 'step': 5500}


Iteration:  51%|█████▏    | 40/78 [00:12<00:17,  2.16it/s][A04/24/2024 00:10:51 - INFO - trainer.trainer_mod - v4 Global step: 5500, Alignment: tensor([4, 4, 5, 6], device='cuda:0')

Iteration:  53%|█████▎    | 41/78 [00:12<00:15,  2.43it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:13,  2.68it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:12,  2.88it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:11,  3.03it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:10,  3.15it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.21it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.29it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.32it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.36it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.39it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.42it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.43it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.45it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.42it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.44it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.45it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.46it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.41it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.44it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.45it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.46it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.46it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.46it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.39it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.42it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.41it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.44it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.43it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.37it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.37it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.37it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.39it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.42it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.56it/s][A04/24/2024 00:11:02 - INFO - trainer.trainer_mod - Epoch 70 finished. Took 23.23 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  71%|███████   | 71/100 [29:19<11:19, 23.44s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.35it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.41it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.40it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.40it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.43it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.44it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.46it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.47it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.47it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.44it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:11:06,071 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:11:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:11:06 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:11:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:11:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.12it/s]04/24/2024 00:11:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:11:06 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.8481427, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 197, 168, 172, 162, 159, 165, 155, 155, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81077296, 'remaining_params': 3940304, 'pruned_model_sparsity': 0.9536530788919, 'expected_sparsity': 0.94849, 'target_sparsity': 0.95, 'step': 5550}


Iteration:  15%|█▌        | 12/78 [00:04<00:31,  2.13it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:26,  2.41it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:24,  2.66it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:21,  2.87it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.02it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.11it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.19it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.29it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.31it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.36it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.40it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.44it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.45it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.46it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.46it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.47it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.47it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.47it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.48it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.46it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.46it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.47it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.48it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.48it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.48it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.48it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.47it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.47it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.48it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.48it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.48it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.45it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.40it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.44it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.45it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.44it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.42it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.45it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.45it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.45it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.46it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.44it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.46it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.44it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.45it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.42it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:11:21,124 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:11:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:11:21 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:11:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:11:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.20it/s]04/24/2024 00:11:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:11:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.881948, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 197, 168, 172, 162, 159, 165, 155, 155, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81077296, 'remaining_params': 3940304, 'pruned_model_sparsity': 0.9536530788919, 'expected_sparsity': 0.94849, 'target_sparsity': 0.95, 'step': 5600}


Iteration:  79%|███████▉  | 62/78 [00:19<00:07,  2.15it/s][A04/24/2024 00:11:21 - INFO - trainer.trainer_mod - v4 Global step: 5600, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  81%|████████  | 63/78 [00:19<00:06,  2.40it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:05,  2.65it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  2.85it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:04,  2.99it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:03,  3.17it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.22it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.30it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.35it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.39it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.42it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.42it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.44it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.45it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.55it/s][A04/24/2024 00:11:26 - INFO - trainer.trainer_mod - Epoch 71 finished. Took 23.77 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  72%|███████▏  | 72/100 [29:43<10:59, 23.54s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.41it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.44it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.40it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.43it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.44it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.42it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.45it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.43it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.45it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.46it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.47it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.41it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.36it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.37it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.40it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.43it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.44it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.45it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:17,  3.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.45it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.46it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.46it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.46it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:14,  3.49it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.50it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.46it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.47it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.47it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.43it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.45it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:11:36,221 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:11:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:11:36 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:11:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:11:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.11it/s]04/24/2024 00:11:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:11:36 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6028880866425993, 'eval_loss': 0.86698806, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 196, 167, 171, 162, 158, 164, 154, 155, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81078828, 'remaining_params': 3938772, 'pruned_model_sparsity': 0.9536710986901535, 'expected_sparsity': 0.9485, 'target_sparsity': 0.95, 'step': 5650}


Iteration:  44%|████▎     | 34/78 [00:10<00:20,  2.16it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:17,  2.41it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:15,  2.66it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:14,  2.85it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:13,  3.02it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:12,  3.14it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.23it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.30it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.35it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.40it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.42it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.43it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.41it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.42it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.42it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.43it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.40it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.41it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.42it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.46it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.43it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.44it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.44it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.42it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.40it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.43it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.46it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.44it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.45it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.44it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.46it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.47it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.44it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.42it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.43it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.41it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.42it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:11:49 - INFO - trainer.trainer_mod - Epoch 72 finished. Took 23.21 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  73%|███████▎  | 73/100 [30:06<10:32, 23.44s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.35it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.36it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.41it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.45it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:11:51,306 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:11:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:11:51 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:11:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:11:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.14it/s]04/24/2024 00:11:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:11:51 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.906023, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 196, 167, 171, 162, 158, 164, 154, 154, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81078828, 'remaining_params': 3938772, 'pruned_model_sparsity': 0.9536710986901535, 'expected_sparsity': 0.94851, 'target_sparsity': 0.95, 'step': 5700}


Iteration:   8%|▊         | 6/78 [00:02<00:35,  2.05it/s][A04/24/2024 00:11:52 - INFO - trainer.trainer_mod - v4 Global step: 5700, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:   9%|▉         | 7/78 [00:02<00:30,  2.35it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:26,  2.60it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:24,  2.83it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.99it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.12it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:20,  3.20it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.28it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.33it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.36it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.38it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.37it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.37it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.37it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.40it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:16,  3.42it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.40it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.38it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.41it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.37it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.39it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.37it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.40it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.41it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.43it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.45it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.46it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.46it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.47it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:11,  3.51it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.48it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.47it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.48it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.48it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.49it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.49it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.48it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.42it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.44it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.39it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.42it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.46it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.47it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.42it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.41it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.41it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.45it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.50it/s][A[INFO|trainer.py:570] 2024-04-24 00:12:06,430 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:12:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:12:06 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:12:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:12:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.14it/s]04/24/2024 00:12:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:12:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.8923678, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 196, 167, 171, 162, 158, 164, 154, 154, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81078828, 'remaining_params': 3938772, 'pruned_model_sparsity': 0.9536710986901535, 'expected_sparsity': 0.94852, 'target_sparsity': 0.95, 'step': 5750}


Iteration:  72%|███████▏  | 56/78 [00:17<00:10,  2.17it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:08,  2.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:07,  2.68it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:06,  2.85it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.01it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.11it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  3.20it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.27it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.33it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.38it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.41it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.48it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.45it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.47it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.56it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:01,  3.52it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.52it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.49it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.49it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.46it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.46it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.47it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.66it/s][A04/24/2024 00:12:13 - INFO - trainer.trainer_mod - Epoch 73 finished. Took 23.74 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  74%|███████▍  | 74/100 [30:30<10:11, 23.53s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.44it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.39it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.42it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.45it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.47it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.47it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.47it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.48it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.48it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.45it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.45it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.39it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.42it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.41it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.41it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:16,  3.51it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.50it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.50it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.48it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.48it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.48it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.46it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.45it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:12:21,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:12:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:12:21 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:12:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:12:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.17it/s]04/24/2024 00:12:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:12:21 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.8772705, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 196, 166, 170, 162, 158, 163, 153, 154, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81078828, 'remaining_params': 3938772, 'pruned_model_sparsity': 0.9536710986901535, 'expected_sparsity': 0.94853, 'target_sparsity': 0.95, 'step': 5800}


Iteration:  36%|███▌      | 28/78 [00:08<00:23,  2.16it/s][A04/24/2024 00:12:22 - INFO - trainer.trainer_mod - v4 Global step: 5800, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  37%|███▋      | 29/78 [00:08<00:20,  2.44it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:18,  2.66it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:16,  2.86it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:15,  3.02it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.12it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.21it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.27it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.32it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.38it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.41it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.44it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.46it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.45it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.45it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.41it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.43it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.44it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.42it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.43it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.40it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.43it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.39it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.41it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.44it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.45it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.46it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.47it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.41it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.44it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.47it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.48it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.48it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.49it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.45it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.44it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.45it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.43it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.46it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.46it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.46it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.47it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.43it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.45it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:12:36,446 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:12:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:12:36 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:12:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:12:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.05it/s]04/24/2024 00:12:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:12:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.9624521, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 196, 166, 170, 162, 158, 163, 153, 154, 149], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81078828, 'remaining_params': 3938772, 'pruned_model_sparsity': 0.9536710986901535, 'expected_sparsity': 0.94853, 'target_sparsity': 0.95, 'step': 5850}


Iteration: 100%|██████████| 78/78 [00:23<00:00,  2.21it/s][A04/24/2024 00:12:37 - INFO - trainer.trainer_mod - Epoch 74 finished. Took 23.73 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  75%|███████▌  | 75/100 [30:53<09:49, 23.59s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.45it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.41it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:22,  3.39it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.39it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.38it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.39it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.39it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.41it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.41it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.41it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.43it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.45it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.46it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.48it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.48it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.48it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.46it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.46it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.43it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.45it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.41it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.41it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.43it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.43it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.41it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.43it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.45it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.46it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.47it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.45it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.46it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.47it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.48it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.48it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.49it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.47it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.39it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.42it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:11,  3.44it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.45it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.47it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.48it/s][A
Iteration:  56%|█████▋    | 44/78 [00:12<00:09,  3.47it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.46it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.47it/s][A
Iteration:  60%|██████    | 47/78 [00:13<00:08,  3.48it/s][A
Iteration:  62%|██████▏   | 48/78 [00:13<00:08,  3.54it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.52it/s][A[INFO|trainer.py:570] 2024-04-24 00:12:51,522 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:12:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:12:51 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:12:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:12:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.15it/s]04/24/2024 00:12:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:12:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.90163904, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 196, 166, 170, 162, 158, 162, 153, 154, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81078828, 'remaining_params': 3938772, 'pruned_model_sparsity': 0.9536710986901535, 'expected_sparsity': 0.94854, 'target_sparsity': 0.95, 'step': 5900}


Iteration:  64%|██████▍   | 50/78 [00:15<00:12,  2.17it/s][A04/24/2024 00:12:52 - INFO - trainer.trainer_mod - v4 Global step: 5900, Alignment: tensor([0, 4, 6, 7], device='cuda:0')

Iteration:  65%|██████▌   | 51/78 [00:15<00:11,  2.43it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:09,  2.64it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:08,  2.85it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.02it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:07,  3.14it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.24it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.27it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.34it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.34it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.37it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.40it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.42it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.45it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.46it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.44it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.46it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.47it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.46it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.49it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.42it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.38it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.39it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.38it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.42it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.45it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.61it/s][A04/24/2024 00:13:00 - INFO - trainer.trainer_mod - Epoch 75 finished. Took 23.18 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  76%|███████▌  | 76/100 [31:17<09:23, 23.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.46it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.41it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.45it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.47it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.48it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.48it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.48it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.48it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.46it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.47it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.48it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:18,  3.53it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.48it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.48it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.48it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.49it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.46it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.46it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.46it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.39it/s][A[INFO|trainer.py:570] 2024-04-24 00:13:06,565 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:13:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:13:06 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:13:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:13:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.21it/s]04/24/2024 00:13:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:13:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.9393264, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 187, 195, 165, 169, 162, 157, 162, 153, 153, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81080360, 'remaining_params': 3937240, 'pruned_model_sparsity': 0.9536891184884071, 'expected_sparsity': 0.94854, 'target_sparsity': 0.95, 'step': 5950}


Iteration:  28%|██▊       | 22/78 [00:06<00:26,  2.14it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:22,  2.40it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:20,  2.64it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:18,  2.83it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  2.97it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:15,  3.20it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:15,  3.27it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.32it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.37it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.40it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.43it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.43it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.44it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.46it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.46it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.47it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.46it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.46it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.47it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.48it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.45it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.44it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.45it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.46it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.47it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.48it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.49it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.50it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.50it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.46it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.43it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.41it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.40it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.40it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.42it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.44it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.42it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.40it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.43it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.41it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.43it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.46it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.47it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.48it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.49it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.49it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.46it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.48it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:13:21,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:13:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:13:21 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:13:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:13:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.22it/s]04/24/2024 00:13:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:13:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6064981949458483, 'eval_loss': 0.9955312, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 186, 195, 165, 169, 162, 157, 162, 153, 153, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81081892, 'remaining_params': 3935708, 'pruned_model_sparsity': 0.9537071382866606, 'expected_sparsity': 0.94854, 'target_sparsity': 0.95, 'step': 6000}


Iteration:  92%|█████████▏| 72/78 [00:22<00:02,  2.15it/s][A04/24/2024 00:13:22 - INFO - trainer.trainer_mod - v4 Global step: 6000, Alignment: tensor([4, 4, 5, 6], device='cuda:0')

Iteration:  94%|█████████▎| 73/78 [00:22<00:02,  2.43it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  2.66it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:01,  2.87it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.03it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.16it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s][A04/24/2024 00:13:23 - INFO - trainer.trainer_mod - Epoch 76 finished. Took 23.7 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  77%|███████▋  | 77/100 [31:40<09:01, 23.54s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.49it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.41it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.45it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.47it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.48it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.49it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.50it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.46it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.46it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.43it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.46it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.47it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.46it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.44it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.45it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.46it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.45it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.44it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.46it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.48it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.49it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.49it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.50it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:14,  3.50it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.49it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.49it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.49it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.49it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.50it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.47it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.47it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.48it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.45it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.42it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.44it/s][A
Iteration:  49%|████▊     | 38/78 [00:10<00:11,  3.43it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.45it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:10,  3.47it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.48it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.48it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.49it/s][A[INFO|trainer.py:570] 2024-04-24 00:13:36,595 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:13:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:13:36 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:13:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:13:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.08it/s]04/24/2024 00:13:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:13:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6028880866425993, 'eval_loss': 0.9994073, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 186, 195, 165, 169, 161, 157, 161, 152, 153, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81081892, 'remaining_params': 3935708, 'pruned_model_sparsity': 0.9537071382866606, 'expected_sparsity': 0.94855, 'target_sparsity': 0.95, 'step': 6050}


Iteration:  56%|█████▋    | 44/78 [00:13<00:15,  2.17it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:13,  2.41it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:12,  2.64it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:10,  2.85it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:09,  3.11it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.17it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.26it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.30it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.35it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.38it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.42it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.44it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.46it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.47it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.48it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.48it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.48it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.47it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.48it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.48it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.45it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.45it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.40it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.42it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.41it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.40it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.42it/s][A
Iteration:  95%|█████████▍| 74/78 [00:21<00:01,  3.44it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.42it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.42it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.45it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:13:47 - INFO - trainer.trainer_mod - Epoch 77 finished. Took 23.12 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  78%|███████▊  | 78/100 [32:03<08:35, 23.41s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.37it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.44it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.46it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.43it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.44it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.42it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.44it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.45it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.43it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.44it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.41it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.43it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.44it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:13:51,676 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:13:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:13:51 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:13:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:13:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.09it/s]04/24/2024 00:13:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:13:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.87461317, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 198, 186, 195, 164, 169, 161, 157, 161, 152, 153, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81081892, 'remaining_params': 3935708, 'pruned_model_sparsity': 0.9537071382866606, 'expected_sparsity': 0.94856, 'target_sparsity': 0.95, 'step': 6100}


Iteration:  21%|██        | 16/78 [00:05<00:28,  2.15it/s][A04/24/2024 00:13:52 - INFO - trainer.trainer_mod - v4 Global step: 6100, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  22%|██▏       | 17/78 [00:05<00:25,  2.42it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:22,  2.67it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.87it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.01it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.12it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:17,  3.18it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.28it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.35it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.39it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.41it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.50it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.46it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.47it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.47it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.47it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.47it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.48it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.48it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.47it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.47it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.48it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.47it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.43it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.47it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.47it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.48it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.47it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.48it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.48it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.49it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.48it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.45it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.45it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.46it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.43it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.41it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.43it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.44it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.43it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.47it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.48it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.46it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.48it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.45it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.45it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:14:06,694 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:14:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:14:06 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:14:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:14:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.16it/s]04/24/2024 00:14:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:14:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.9151706, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 197, 186, 195, 164, 168, 161, 157, 160, 152, 153, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81083424, 'remaining_params': 3934176, 'pruned_model_sparsity': 0.9537251580849142, 'expected_sparsity': 0.94858, 'target_sparsity': 0.95, 'step': 6150}


Iteration:  85%|████████▍ | 66/78 [00:20<00:05,  2.16it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:04,  2.44it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:03,  2.66it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:03,  2.86it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.02it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.12it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.22it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.26it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.32it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.33it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.39it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.41it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:14:10 - INFO - trainer.trainer_mod - Epoch 78 finished. Took 23.69 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  79%|███████▉  | 79/100 [32:27<08:13, 23.50s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.36it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.43it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.44it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:20,  3.55it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.55it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.49it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.43it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.45it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.46it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.44it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.45it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.47it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.47it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.48it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.48it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.49it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.49it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.49it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.46it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.47it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.47it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.47it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.45it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.43it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.41it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.44it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.45it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.47it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.48it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.48it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.48it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.46it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.46it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:14:21,692 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:14:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:14:21 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:14:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:14:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.18it/s]04/24/2024 00:14:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:14:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.85843015, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 197, 185, 195, 164, 168, 161, 157, 160, 152, 153, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81084956, 'remaining_params': 3932644, 'pruned_model_sparsity': 0.9537431778831678, 'expected_sparsity': 0.9486, 'target_sparsity': 0.95, 'step': 6200}


Iteration:  49%|████▊     | 38/78 [00:11<00:18,  2.16it/s][A04/24/2024 00:14:22 - INFO - trainer.trainer_mod - v4 Global step: 6200, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  50%|█████     | 39/78 [00:11<00:16,  2.43it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:14,  2.67it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:13,  2.84it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:11,  3.02it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.12it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.23it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:10,  3.30it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.32it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.39it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.35it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.38it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.39it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.42it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.45it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.46it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.47it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.48it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.48it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.46it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.43it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.45it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.46it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.43it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.45it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.46it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.43it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.44it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.42it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.43it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.45it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.46it/s][A
Iteration:  95%|█████████▍| 74/78 [00:21<00:01,  3.48it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.48it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.48it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.44it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.61it/s][A04/24/2024 00:14:33 - INFO - trainer.trainer_mod - Epoch 79 finished. Took 23.11 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.38it/s]
Epoch:  80%|████████  | 80/100 [32:50<07:47, 23.38s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.43it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.45it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.49it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.48it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.46it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.43it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.45it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.47it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:14:36,723 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:14:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:14:36 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:14:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:14:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.16it/s]04/24/2024 00:14:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:14:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.8920722, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 197, 184, 195, 163, 168, 161, 157, 160, 151, 152, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81086488, 'remaining_params': 3931112, 'pruned_model_sparsity': 0.9537611976814213, 'expected_sparsity': 0.9486, 'target_sparsity': 0.95, 'step': 6250}


Iteration:  13%|█▎        | 10/78 [00:03<00:31,  2.13it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:27,  2.40it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.65it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.82it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.00it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.11it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.21it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.30it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.35it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.40it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.39it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.42it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.43it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:15,  3.46it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.47it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.47it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:14,  3.49it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.48it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.48it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.46it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.49it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.49it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.49it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.46it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.43it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.45it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.46it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.47it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.48it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.48it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.44it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.44it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.46it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.46it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.44it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.48it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.48it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.47it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.48it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.49it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.49it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.46it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.42it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.44it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.45it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.43it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:14:51,749 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:14:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:14:51 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:14:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:14:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.47it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.10it/s]04/24/2024 00:14:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:14:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 0.8939782, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 197, 184, 195, 163, 168, 161, 157, 159, 151, 152, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81086488, 'remaining_params': 3931112, 'pruned_model_sparsity': 0.9537611976814213, 'expected_sparsity': 0.94863, 'target_sparsity': 0.95, 'step': 6300}


Iteration:  77%|███████▋  | 60/78 [00:18<00:08,  2.16it/s][A04/24/2024 00:14:52 - INFO - trainer.trainer_mod - v4 Global step: 6300, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  78%|███████▊  | 61/78 [00:18<00:06,  2.43it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  2.67it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:05,  2.83it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.20it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.28it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.34it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.38it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.43it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.50it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.50it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.50it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.50it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.50it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.50it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.63it/s][A04/24/2024 00:14:57 - INFO - trainer.trainer_mod - Epoch 80 finished. Took 23.65 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.30it/s]
Epoch:  81%|████████  | 81/100 [33:14<07:25, 23.46s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.46it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.46it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.47it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.44it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.44it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.45it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.44it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.44it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.47it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.49it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.48it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:18,  3.48it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.49it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.48it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.49it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.46it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.48it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.48it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.46it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.46it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.38it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.41it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.44it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.46it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:14,  3.47it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.45it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.46it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.42it/s][A[INFO|trainer.py:570] 2024-04-24 00:15:06,748 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:15:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:15:06 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:15:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:15:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.23it/s]04/24/2024 00:15:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:15:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.86918896, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 183, 195, 163, 167, 161, 156, 159, 151, 152, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81089552, 'remaining_params': 3928048, 'pruned_model_sparsity': 0.9537972372779283, 'expected_sparsity': 0.94865, 'target_sparsity': 0.95, 'step': 6350}


Iteration:  41%|████      | 32/78 [00:09<00:21,  2.15it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:18,  2.40it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:16,  2.65it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:15,  2.82it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:14,  2.96it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.10it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:12,  3.21it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.30it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.36it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.40it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.43it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.45it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.46it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.43it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.41it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.41it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.43it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.45it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.45it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.46it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.47it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.45it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.46it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.43it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.46it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.43it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.44it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.46it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.47it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.47it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.46it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.46it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.48it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.45it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.46it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.44it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.45it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.46it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.47it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.48it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.48it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.48it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.63it/s][A04/24/2024 00:15:20 - INFO - trainer.trainer_mod - Epoch 81 finished. Took 23.13 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  82%|████████▏ | 82/100 [33:37<07:00, 23.36s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.48it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.41it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:15:21,769 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:15:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:15:21 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:15:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:15:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.14it/s]04/24/2024 00:15:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:15:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.88790274, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 183, 195, 163, 167, 161, 156, 158, 151, 152, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81089552, 'remaining_params': 3928048, 'pruned_model_sparsity': 0.9537972372779283, 'expected_sparsity': 0.94866, 'target_sparsity': 0.95, 'step': 6400}


Iteration:   5%|▌         | 4/78 [00:01<00:38,  1.92it/s][A04/24/2024 00:15:22 - INFO - trainer.trainer_mod - v4 Global step: 6400, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:   6%|▋         | 5/78 [00:02<00:31,  2.30it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:28,  2.55it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.80it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.99it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:22,  3.12it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.23it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.28it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:19,  3.32it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.33it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.37it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.40it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.40it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.38it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.38it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.39it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:16,  3.42it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.41it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.42it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:15,  3.44it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.43it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.44it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.44it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.45it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.43it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.43it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.44it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.44it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.42it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.41it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.36it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.37it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.42it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.44it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.46it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.44it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.46it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.47it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.44it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.45it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.47it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.48it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.44it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.46it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.47it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.47it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.41it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.42it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:15:36,908 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:15:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:15:36 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:15:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:15:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.18it/s]04/24/2024 00:15:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:15:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.9041346, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 183, 195, 162, 167, 161, 156, 158, 151, 152, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81089552, 'remaining_params': 3928048, 'pruned_model_sparsity': 0.9537972372779283, 'expected_sparsity': 0.94867, 'target_sparsity': 0.95, 'step': 6450}


Iteration:  69%|██████▉   | 54/78 [00:16<00:11,  2.15it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:09,  2.43it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:08,  2.68it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:07,  2.87it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:06,  3.17it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.24it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.31it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.36it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.38it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.40it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.35it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:03,  3.39it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.42it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.40it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.39it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.42it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.44it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.45it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.46it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.44it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.42it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.44it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.61it/s][A04/24/2024 00:15:44 - INFO - trainer.trainer_mod - Epoch 82 finished. Took 23.77 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  83%|████████▎ | 83/100 [34:01<06:39, 23.48s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:21,  3.51it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.45it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.41it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.45it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.45it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.47it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.49it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.49it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.43it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.46it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.47it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.45it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.45it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.44it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.42it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.44it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.47it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.43it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.45it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.47it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.44it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.45it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.46it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.47it/s][A[INFO|trainer.py:570] 2024-04-24 00:15:51,890 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:15:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:15:51 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:15:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:15:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.17it/s]04/24/2024 00:15:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:15:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.9496493, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 183, 194, 162, 166, 161, 156, 158, 150, 152, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81091084, 'remaining_params': 3926516, 'pruned_model_sparsity': 0.9538152570761819, 'expected_sparsity': 0.94868, 'target_sparsity': 0.95, 'step': 6500}


Iteration:  33%|███▎      | 26/78 [00:08<00:23,  2.17it/s][A04/24/2024 00:15:52 - INFO - trainer.trainer_mod - v4 Global step: 6500, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  35%|███▍      | 27/78 [00:08<00:20,  2.44it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:18,  2.69it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:16,  2.89it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.05it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.17it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:14,  3.26it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.32it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.32it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.37it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.41it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.43it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.42it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.43it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.46it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.44it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.46it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.47it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.45it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.45it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.42it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.41it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.44it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:07,  3.51it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.47it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.48it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.48it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.49it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.43it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.42it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.42it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.46it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.43it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.45it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.47it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.48it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.47it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.47it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.45it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.46it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.42it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.40it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.43it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.45it/s][A
Iteration:  95%|█████████▍| 74/78 [00:21<00:01,  3.43it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:16:06,943 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:16:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:16:06 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:16:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:16:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.45it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.06it/s]04/24/2024 00:16:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:16:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.879655, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 183, 194, 162, 166, 161, 156, 157, 150, 152, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81091084, 'remaining_params': 3926516, 'pruned_model_sparsity': 0.9538152570761819, 'expected_sparsity': 0.94869, 'target_sparsity': 0.95, 'step': 6550}


Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  2.15it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  2.42it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  2.75it/s][A04/24/2024 00:16:08 - INFO - trainer.trainer_mod - Epoch 83 finished. Took 23.7 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  84%|████████▍ | 84/100 [34:24<06:16, 23.55s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.39it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.45it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.48it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.47it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.48it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.42it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.44it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.42it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.42it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.41it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.43it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.44it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.45it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.47it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.48it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.48it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.44it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.45it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.46it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.46it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.48it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.46it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.48it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.47it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:14,  3.48it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.49it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.49it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.49it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.50it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.49it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.48it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.44it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.45it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.47it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:12,  3.40it/s][A
Iteration:  49%|████▊     | 38/78 [00:10<00:11,  3.42it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.44it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:11,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.47it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.48it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.48it/s][A
Iteration:  56%|█████▋    | 44/78 [00:12<00:09,  3.48it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.45it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.45it/s][A
Iteration:  60%|██████    | 47/78 [00:13<00:08,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:16:21,950 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:16:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:16:21 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:16:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:16:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:16:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:16:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.8867892, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 182, 194, 162, 166, 161, 156, 157, 150, 152, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81092616, 'remaining_params': 3924984, 'pruned_model_sparsity': 0.9538332768744354, 'expected_sparsity': 0.9487, 'target_sparsity': 0.95, 'step': 6600}


Iteration:  62%|██████▏   | 48/78 [00:14<00:13,  2.16it/s][A04/24/2024 00:16:22 - INFO - trainer.trainer_mod - v4 Global step: 6600, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  63%|██████▎   | 49/78 [00:14<00:11,  2.44it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:10,  2.68it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:09,  2.87it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:08,  3.01it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.14it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.23it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.30it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.35it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.39it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.40it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.43it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.45it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.44it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.46it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.47it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.47it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.46it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.44it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.42it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.44it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.41it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.44it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.42it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.43it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.42it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.58it/s][A04/24/2024 00:16:31 - INFO - trainer.trainer_mod - Epoch 84 finished. Took 23.12 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  85%|████████▌ | 85/100 [34:48<05:51, 23.42s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:21,  3.52it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.47it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.42it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.46it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.47it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.43it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.45it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.46it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.47it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.48it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.48it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:18,  3.49it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.49it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.49it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.46it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.46it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.47it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.44it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:16:36,963 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:16:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:16:36 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:16:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:16:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.46it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.07it/s]04/24/2024 00:16:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:16:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.91765827, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 182, 194, 161, 166, 160, 156, 157, 150, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81092616, 'remaining_params': 3924984, 'pruned_model_sparsity': 0.9538332768744354, 'expected_sparsity': 0.9487, 'target_sparsity': 0.95, 'step': 6650}


Iteration:  26%|██▌       | 20/78 [00:06<00:26,  2.16it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:23,  2.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:20,  2.68it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:19,  2.89it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.04it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.17it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.26it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.33it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.38it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.41it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.44it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.45it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.47it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.50it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.49it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.45it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.47it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.48it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.47it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.46it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.47it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.48it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.49it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.46it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.45it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.46it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.48it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.48it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.45it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.47it/s][A
Iteration:  64%|██████▍   | 50/78 [00:14<00:08,  3.45it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.45it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.46it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.45it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.46it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.47it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.48it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.44it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.43it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.42it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.44it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.46it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.45it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.46it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.47it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.45it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:16:51,961 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:16:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:16:51 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:16:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:16:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.26it/s]04/24/2024 00:16:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:16:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.8943485, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 182, 194, 161, 166, 160, 156, 156, 150, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81092616, 'remaining_params': 3924984, 'pruned_model_sparsity': 0.9538332768744354, 'expected_sparsity': 0.94871, 'target_sparsity': 0.95, 'step': 6700}


Iteration:  90%|████████▉ | 70/78 [00:21<00:03,  2.16it/s][A04/24/2024 00:16:52 - INFO - trainer.trainer_mod - v4 Global step: 6700, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  91%|█████████ | 71/78 [00:21<00:02,  2.44it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:02,  2.68it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  2.88it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.16it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.23it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.31it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.50it/s][A04/24/2024 00:16:54 - INFO - trainer.trainer_mod - Epoch 85 finished. Took 23.61 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.30it/s]
Epoch:  86%|████████▌ | 86/100 [35:11<05:28, 23.48s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.48it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.47it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.47it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.48it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.40it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.43it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.42it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.43it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.45it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.43it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.45it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.47it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.43it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.44it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.45it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.39it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:17,  3.39it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.45it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.46it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.43it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.42it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.43it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.44it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.45it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.44it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.44it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.42it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.40it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.42it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.41it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.40it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:11,  3.43it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:17:07,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:17:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:17:07 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:17:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:17:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.22it/s]04/24/2024 00:17:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:17:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.89341146, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 182, 193, 161, 165, 160, 155, 156, 150, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81094148, 'remaining_params': 3923452, 'pruned_model_sparsity': 0.953851296672689, 'expected_sparsity': 0.94873, 'target_sparsity': 0.95, 'step': 6750}


Iteration:  54%|█████▍    | 42/78 [00:12<00:16,  2.14it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:14,  2.42it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:12,  2.66it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:11,  2.86it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:10,  3.00it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.13it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.22it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.25it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.32it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.37it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.40it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:07,  3.43it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.43it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.44it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.46it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.48it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.47it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.46it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.44it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.42it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.44it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.39it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.43it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.41it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.37it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.40it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.42it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.42it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.44it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.46it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.47it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.47it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.48it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.49it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.63it/s][A04/24/2024 00:17:18 - INFO - trainer.trainer_mod - Epoch 86 finished. Took 23.22 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.36it/s]
Epoch:  87%|████████▋ | 87/100 [35:34<05:04, 23.40s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.46it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.46it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.48it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.49it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.42it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.45it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.46it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.47it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.47it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.47it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.43it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.42it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:17:22,061 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:17:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:17:22 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:17:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:17:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:17:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:17:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 0.899461, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 196, 181, 193, 161, 165, 160, 155, 156, 149, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81095680, 'remaining_params': 3921920, 'pruned_model_sparsity': 0.9538693164709425, 'expected_sparsity': 0.94873, 'target_sparsity': 0.95, 'step': 6800}


Iteration:  18%|█▊        | 14/78 [00:04<00:29,  2.16it/s][A04/24/2024 00:17:22 - INFO - trainer.trainer_mod - v4 Global step: 6800, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  19%|█▉        | 15/78 [00:04<00:26,  2.42it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:23,  2.67it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:21,  2.85it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.15it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.24it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.31it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.34it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.34it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.38it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.38it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.41it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.43it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.45it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.46it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.47it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.44it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.46it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.43it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.45it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:11,  3.54it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.51it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.48it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.48it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.49it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.45it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.44it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.45it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.46it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.47it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.46it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.38it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.38it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.41it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.40it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.42it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.40it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.43it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.51it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.47it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.47it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.45it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.46it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.48it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.47it/s][A[INFO|trainer.py:570] 2024-04-24 00:17:37,122 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:17:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:17:37 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:17:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:17:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.17it/s]04/24/2024 00:17:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:17:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.92951113, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 195, 181, 193, 160, 165, 160, 155, 156, 149, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81097212, 'remaining_params': 3920388, 'pruned_model_sparsity': 0.953887336269196, 'expected_sparsity': 0.94874, 'target_sparsity': 0.95, 'step': 6850}


Iteration:  82%|████████▏ | 64/78 [00:19<00:06,  2.17it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:05,  2.43it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:04,  2.67it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  2.84it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:03,  2.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.12it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.22it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.29it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.34it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.39it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.50it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.45it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.47it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.47it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.63it/s][A04/24/2024 00:17:41 - INFO - trainer.trainer_mod - Epoch 87 finished. Took 23.68 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  88%|████████▊ | 88/100 [35:58<04:41, 23.48s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.48it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.49it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.48it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.43it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.45it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:21,  3.37it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.40it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.42it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.46it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.47it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.47it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.48it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.48it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.48it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.48it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.45it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.44it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.42it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.42it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.40it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:16,  3.42it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.44it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.45it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.46it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.47it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.44it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.43it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.45it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.46it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.44it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:17:52,139 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:17:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:17:52 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:17:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:17:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.18it/s]04/24/2024 00:17:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:17:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.8858688, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 195, 181, 193, 160, 165, 160, 155, 155, 149, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81097212, 'remaining_params': 3920388, 'pruned_model_sparsity': 0.953887336269196, 'expected_sparsity': 0.94876, 'target_sparsity': 0.95, 'step': 6900}


Iteration:  46%|████▌     | 36/78 [00:11<00:19,  2.16it/s][A04/24/2024 00:17:52 - INFO - trainer.trainer_mod - v4 Global step: 6900, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  47%|████▋     | 37/78 [00:11<00:16,  2.42it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:15,  2.66it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:13,  2.85it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.13it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:11,  3.23it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.30it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.35it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.36it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.40it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.39it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.39it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.39it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.39it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.41it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.43it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.44it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.44it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.47it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.48it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.49it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.49it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.46it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.46it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.47it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.44it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.47it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.44it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.42it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.45it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.46it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.47it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.47it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.47it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.49it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.45it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.46it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.62it/s][A04/24/2024 00:18:04 - INFO - trainer.trainer_mod - Epoch 88 finished. Took 23.15 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  89%|████████▉ | 89/100 [36:21<04:17, 23.38s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.48it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.48it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.48it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.45it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.44it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.46it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.47it/s][A[INFO|trainer.py:570] 2024-04-24 00:18:07,152 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:18:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:18:07 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:18:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:18:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:18:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:18:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.8757347, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 195, 181, 193, 160, 164, 160, 155, 155, 149, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81097212, 'remaining_params': 3920388, 'pruned_model_sparsity': 0.953887336269196, 'expected_sparsity': 0.94877, 'target_sparsity': 0.95, 'step': 6950}


Iteration:  10%|█         | 8/78 [00:02<00:32,  2.12it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:28,  2.41it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.65it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:23,  2.86it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  3.00it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.13it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.24it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.28it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.34it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:18,  3.38it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.43it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:16,  3.45it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.47it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.47it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:15,  3.48it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.49it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.49it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.46it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.46it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.47it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.44it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.46it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.48it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.45it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.42it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.43it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.45it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.46it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.46it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.53it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.50it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.48it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:09,  3.53it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.48it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.45it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.45it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.44it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.41it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.40it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.41it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.43it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.44it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.45it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.46it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.48it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.47it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:05,  3.61it/s][A[INFO|trainer.py:570] 2024-04-24 00:18:22,145 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:18:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:18:22 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:18:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:18:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.15it/s]04/24/2024 00:18:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:18:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6245487364620939, 'eval_loss': 0.8835155, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 195, 180, 193, 159, 164, 160, 155, 155, 149, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81098744, 'remaining_params': 3918856, 'pruned_model_sparsity': 0.9539053560674495, 'expected_sparsity': 0.94878, 'target_sparsity': 0.95, 'step': 7000}


Iteration:  74%|███████▍  | 58/78 [00:17<00:09,  2.20it/s][A04/24/2024 00:18:22 - INFO - trainer.trainer_mod - v4 Global step: 7000, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  76%|███████▌  | 59/78 [00:18<00:07,  2.47it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:06,  2.70it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  2.88it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  3.03it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.16it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.26it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.29it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.34it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.38it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.41it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.40it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.42it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.44it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.46it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.43it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.44it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.46it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.47it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.48it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.62it/s][A04/24/2024 00:18:28 - INFO - trainer.trainer_mod - Epoch 89 finished. Took 23.62 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.30it/s]
Epoch:  90%|█████████ | 90/100 [36:45<03:54, 23.45s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.37it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.45it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.47it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.49it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.49it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.50it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.51it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.47it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.45it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.44it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.46it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.46it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.43it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.45it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.47it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.47it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.47it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.48it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:16,  3.48it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.49it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.46it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.46it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.44it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.39it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.42it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.45it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.46it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:18:37,147 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:18:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:18:37 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:18:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:18:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.15it/s]04/24/2024 00:18:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:18:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.9674773, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [198, 195, 180, 193, 159, 164, 160, 154, 155, 149, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81098744, 'remaining_params': 3918856, 'pruned_model_sparsity': 0.9539053560674495, 'expected_sparsity': 0.94879, 'target_sparsity': 0.95, 'step': 7050}


Iteration:  38%|███▊      | 30/78 [00:09<00:22,  2.16it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:19,  2.43it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:17,  2.65it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:15,  2.83it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.13it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.23it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.30it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.34it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.38it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.41it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.40it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.42it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.43it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.45it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.46it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.47it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.47it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.45it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.46it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.41it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.37it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.40it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.42it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.44it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.43it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.47it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.44it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.46it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.42it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.44it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.45it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.45it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.46it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.48it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.48it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.48it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.46it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.47it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.45it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.41it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.43it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.44it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.45it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.48it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.63it/s][A04/24/2024 00:18:51 - INFO - trainer.trainer_mod - Epoch 90 finished. Took 23.13 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  91%|█████████ | 91/100 [37:08<03:30, 23.36s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:18:52,178 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:18:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:18:52 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:18:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:18:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.22it/s]04/24/2024 00:18:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:18:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6209386281588448, 'eval_loss': 0.8922006, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 180, 193, 159, 164, 160, 154, 155, 149, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81100276, 'remaining_params': 3917324, 'pruned_model_sparsity': 0.9539233758657031, 'expected_sparsity': 0.9488, 'target_sparsity': 0.95, 'step': 7100}


Iteration:   3%|▎         | 2/78 [00:01<00:47,  1.59it/s][A04/24/2024 00:18:52 - INFO - trainer.trainer_mod - v4 Global step: 7100, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:   4%|▍         | 3/78 [00:01<00:35,  2.11it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:29,  2.50it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:26,  2.76it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.94it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:21,  3.20it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:21,  3.27it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:20,  3.33it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:20,  3.34it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:19,  3.38it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.40it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.42it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.44it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.41it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:17,  3.40it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.42it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.41it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.44it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.43it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.45it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.46it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.44it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.42it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.41it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:14,  3.40it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.42it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.43it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.45it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.46it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.47it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.48it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.48it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.48it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.48it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.48it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.48it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.49it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.49it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.49it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.50it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.50it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.49it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.49it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.46it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.46it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:07,  3.55it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.53it/s][A[INFO|trainer.py:570] 2024-04-24 00:19:07,217 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:19:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:19:07 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:19:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:19:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.14it/s]04/24/2024 00:19:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:19:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.89699167, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 180, 192, 159, 164, 160, 154, 155, 148, 151, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81101808, 'remaining_params': 3915792, 'pruned_model_sparsity': 0.9539413956639566, 'expected_sparsity': 0.9488, 'target_sparsity': 0.95, 'step': 7150}


Iteration:  67%|██████▋   | 52/78 [00:16<00:11,  2.18it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:10,  2.44it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:08,  2.68it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  2.88it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:07,  3.04it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.16it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:06,  3.25it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:05,  3.29it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.31it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.37it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.39it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.43it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.42it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.43it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.45it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.46it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.45it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.46it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.44it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.42it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.44it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.45it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.44it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.59it/s][A04/24/2024 00:19:15 - INFO - trainer.trainer_mod - Epoch 91 finished. Took 23.7 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  92%|█████████▏| 92/100 [37:32<03:07, 23.46s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.37it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.43it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.45it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.47it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.47it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.45it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.47it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.47it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.48it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.42it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.44it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.45it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.47it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.47it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.48it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.48it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.49it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.46it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.46it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.45it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.47it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:19:22,226 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:19:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:19:22 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:19:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:19:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.08it/s]04/24/2024 00:19:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:19:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.88771814, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 180, 192, 159, 164, 160, 154, 155, 148, 150, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81101808, 'remaining_params': 3915792, 'pruned_model_sparsity': 0.9539413956639566, 'expected_sparsity': 0.94881, 'target_sparsity': 0.95, 'step': 7200}


Iteration:  31%|███       | 24/78 [00:07<00:24,  2.16it/s][A04/24/2024 00:19:22 - INFO - trainer.trainer_mod - v4 Global step: 7200, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  32%|███▏      | 25/78 [00:07<00:21,  2.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:19,  2.66it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:17,  2.86it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:16,  3.01it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:15,  3.12it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.22it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:14,  3.29it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.35it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.39it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.39it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.42it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.44it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.42it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.44it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:10,  3.49it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.49it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.44it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.46it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.47it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.43it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.41it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.44it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.45it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.46it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.44it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.44it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.44it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.46it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.46it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.47it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.44it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.43it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.41it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.40it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.39it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.38it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.40it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.41it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.40it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.42it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.41it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.44it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.45it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.44it/s][A[INFO|trainer.py:570] 2024-04-24 00:19:37,349 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:19:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:19:37 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:19:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:19:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.49it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.13it/s]04/24/2024 00:19:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:19:37 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.88705605, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 180, 192, 158, 164, 160, 154, 154, 148, 150, 148], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81101808, 'remaining_params': 3915792, 'pruned_model_sparsity': 0.9539413956639566, 'expected_sparsity': 0.94882, 'target_sparsity': 0.95, 'step': 7250}


Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  2.14it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:01,  2.41it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  2.65it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  2.82it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.10it/s][A04/24/2024 00:19:39 - INFO - trainer.trainer_mod - Epoch 92 finished. Took 23.76 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.28it/s]
Epoch:  93%|█████████▎| 93/100 [37:55<02:44, 23.55s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.45it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.47it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.49it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.49it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.49it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.49it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.47it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.42it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.45it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.47it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.48it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:18,  3.48it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.44it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.46it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.47it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.44it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.46it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.47it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.44it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.45it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.42it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:15,  3.52it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.51it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.49it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.42it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.41it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.43it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.44it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.46it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.48it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.48it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:12,  3.47it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.48it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.48it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.45it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.46it/s][A
Iteration:  49%|████▊     | 38/78 [00:10<00:11,  3.47it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.46it/s][A
Iteration:  51%|█████▏    | 40/78 [00:11<00:10,  3.47it/s][A
Iteration:  53%|█████▎    | 41/78 [00:11<00:10,  3.44it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.45it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.45it/s][A
Iteration:  56%|█████▋    | 44/78 [00:12<00:09,  3.44it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:19:52,356 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:19:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:19:52 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:19:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:19:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.18it/s]04/24/2024 00:19:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:19:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.88912046, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 158, 163, 160, 154, 154, 148, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94883, 'target_sparsity': 0.95, 'step': 7300}


Iteration:  59%|█████▉    | 46/78 [00:13<00:14,  2.16it/s][A04/24/2024 00:19:53 - INFO - trainer.trainer_mod - v4 Global step: 7300, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  60%|██████    | 47/78 [00:14<00:12,  2.43it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:11,  2.68it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:10,  2.88it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:09,  3.01it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.11it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:08,  3.19it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.28it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.34it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.38it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.42it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.43it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.43it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.47it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.47it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.47it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.43it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.46it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.45it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.46it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.47it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.44it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.43it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.45it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.46it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.47it/s][A
Iteration:  95%|█████████▍| 74/78 [00:21<00:01,  3.46it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.47it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.44it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.45it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.62it/s][A04/24/2024 00:20:02 - INFO - trainer.trainer_mod - Epoch 93 finished. Took 23.09 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.38it/s]
Epoch:  94%|█████████▍| 94/100 [38:18<02:20, 23.41s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.40it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.44it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.41it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.44it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.46it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.48it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.49it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.50it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.49it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.49it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.49it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:18,  3.49it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.49it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.49it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.47it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.45it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.46it/s][A[INFO|trainer.py:570] 2024-04-24 00:20:07,335 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:20:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:20:07 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:20:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:20:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.17it/s]04/24/2024 00:20:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:20:07 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.88406205, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 158, 163, 160, 154, 154, 148, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94884, 'target_sparsity': 0.95, 'step': 7350}


Iteration:  23%|██▎       | 18/78 [00:05<00:27,  2.16it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:24,  2.44it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:21,  2.69it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:19,  2.87it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.16it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:16,  3.24it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:16,  3.27it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.33it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:15,  3.37it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.36it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.36it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.37it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.39it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.44it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.47it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.48it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.44it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.45it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.43it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.45it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.47it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.46it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.48it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.47it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.48it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.48it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.47it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.47it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.48it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.44it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.46it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.47it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.47it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.48it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.48it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.48it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.49it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.49it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.46it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.45it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.43it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.45it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.42it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.44it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.44it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.46it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.42it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:20:22,391 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:20:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:20:22 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:20:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:20:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.18it/s]04/24/2024 00:20:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:20:22 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6028880866425993, 'eval_loss': 0.96442753, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 158, 163, 160, 154, 154, 148, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94883, 'target_sparsity': 0.95, 'step': 7400}


Iteration:  87%|████████▋ | 68/78 [00:20<00:04,  2.15it/s][A04/24/2024 00:20:23 - INFO - trainer.trainer_mod - v4 Global step: 7400, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  88%|████████▊ | 69/78 [00:21<00:03,  2.42it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  2.67it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  2.87it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.13it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.19it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.26it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.33it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.38it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.56it/s][A04/24/2024 00:20:25 - INFO - trainer.trainer_mod - Epoch 94 finished. Took 23.67 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  95%|█████████▌| 95/100 [38:42<01:57, 23.49s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.47it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.46it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.46it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.46it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.47it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.44it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.45it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.42it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.44it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.44it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.44it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:19,  3.41it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.40it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.42it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.44it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.45it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.46it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:17,  3.47it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.48it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.48it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.49it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.49it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.47it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.46it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.44it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.46it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.47it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:14,  3.41it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.40it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.43it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.44it/s][A
Iteration:  44%|████▎     | 34/78 [00:09<00:12,  3.43it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.46it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.47it/s][A
Iteration:  47%|████▋     | 37/78 [00:10<00:11,  3.47it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.42it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.41it/s][A[INFO|trainer.py:570] 2024-04-24 00:20:37,432 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:20:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:20:37 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:20:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:20:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.14it/s]04/24/2024 00:20:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:20:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 0.8892918, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 158, 163, 160, 154, 153, 148, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94885, 'target_sparsity': 0.95, 'step': 7450}


Iteration:  51%|█████▏    | 40/78 [00:12<00:17,  2.15it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:15,  2.43it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:13,  2.69it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:12,  2.86it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:11,  3.02it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:10,  3.14it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.23it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.25it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.31it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.36it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.39it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.43it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.45it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.44it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.43it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.43it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.44it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.47it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.48it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.47it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.44it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.45it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.43it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.44it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.42it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.40it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.43it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.38it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.42it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.45it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.43it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.45it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.46it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.47it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.48it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.63it/s][A04/24/2024 00:20:48 - INFO - trainer.trainer_mod - Epoch 95 finished. Took 23.16 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.37it/s]
Epoch:  96%|█████████▌| 96/100 [39:05<01:33, 23.39s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.46it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.49it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.50it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.50it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.49it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.49it/s][A
Iteration:   9%|▉         | 7/78 [00:01<00:20,  3.52it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:19,  3.51it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.51it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.51it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:20:52,415 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:20:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:20:52 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:20:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:20:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.18it/s]04/24/2024 00:20:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:20:52 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.88899255, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 157, 163, 160, 154, 153, 148, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94886, 'target_sparsity': 0.95, 'step': 7500}


Iteration:  15%|█▌        | 12/78 [00:04<00:30,  2.16it/s][A04/24/2024 00:20:53 - INFO - trainer.trainer_mod - v4 Global step: 7500, Alignment: tensor([1, 1, 2, 3], device='cuda:0')

Iteration:  17%|█▋        | 13/78 [00:04<00:26,  2.44it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:23,  2.67it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:21,  2.87it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.03it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.16it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:18,  3.25it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.28it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:17,  3.29it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:17,  3.32it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.38it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:16,  3.38it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.41it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.42it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:15,  3.40it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.43it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.44it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.42it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:14,  3.41it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.43it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.43it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:13,  3.44it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.45it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.44it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.44it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.42it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.42it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.43it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.45it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.43it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.39it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.42it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.43it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.44it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.41it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.39it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.41it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.43it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.45it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.45it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.46it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.44it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.45it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.47it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.45it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.47it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.47it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:21:07,526 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:21:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:21:07 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:21:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:21:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.19it/s]04/24/2024 00:21:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:21:08 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6064981949458483, 'eval_loss': 0.98592883, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 157, 163, 160, 153, 153, 148, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94886, 'target_sparsity': 0.95, 'step': 7550}


Iteration:  79%|███████▉  | 62/78 [00:19<00:07,  2.17it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:06,  2.45it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:05,  2.67it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:04,  2.87it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.01it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.14it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:03,  3.25it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.32it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.37it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.41it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.37it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.37it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.40it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.43it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.42it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.43it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.60it/s][A04/24/2024 00:21:12 - INFO - trainer.trainer_mod - Epoch 96 finished. Took 23.72 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  97%|█████████▋| 97/100 [39:29<01:10, 23.49s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.35it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.42it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.46it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.48it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.53it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:20,  3.52it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.48it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.49it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:19,  3.46it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.42it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.41it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.43it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.45it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.47it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.43it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:18,  3.44it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.46it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.47it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:16,  3.48it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.47it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.48it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:15,  3.71it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.60it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.56it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.53it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:14,  3.48it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.41it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.42it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:13,  3.46it/s][A
Iteration:  40%|███▉      | 31/78 [00:08<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.44it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:13,  3.43it/s][A[INFO|trainer.py:570] 2024-04-24 00:21:22,500 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:21:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:21:22 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:21:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:21:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.22it/s]04/24/2024 00:21:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:21:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6028880866425993, 'eval_loss': 0.95866644, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 157, 163, 160, 153, 153, 148, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94886, 'target_sparsity': 0.95, 'step': 7600}


Iteration:  44%|████▎     | 34/78 [00:10<00:20,  2.15it/s][A04/24/2024 00:21:23 - INFO - trainer.trainer_mod - v4 Global step: 7600, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  45%|████▍     | 35/78 [00:10<00:17,  2.43it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:15,  2.68it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:14,  2.88it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:12,  3.17it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.25it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:11,  3.32it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.37it/s][A
Iteration:  55%|█████▌    | 43/78 [00:12<00:10,  3.42it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:10,  3.40it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.41it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.38it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:09,  3.38it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.42it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.44it/s][A
Iteration:  64%|██████▍   | 50/78 [00:14<00:08,  3.45it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.46it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.46it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.42it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.43it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.46it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.47it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.45it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.46it/s][A
Iteration:  77%|███████▋  | 60/78 [00:17<00:05,  3.47it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.47it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.47it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.48it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.48it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.48it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.46it/s][A
Iteration:  86%|████████▌ | 67/78 [00:19<00:03,  3.47it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.48it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.49it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.49it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.47it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.45it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.46it/s][A
Iteration:  95%|█████████▍| 74/78 [00:21<00:01,  3.47it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.47it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.47it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.48it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.60it/s][A04/24/2024 00:21:35 - INFO - trainer.trainer_mod - Epoch 97 finished. Took 23.04 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.39it/s]
Epoch:  98%|█████████▊| 98/100 [39:52<00:46, 23.35s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.43it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.48it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.49it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.49it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:20,  3.49it/s][A[INFO|trainer.py:570] 2024-04-24 00:21:37,462 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:21:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:21:37 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:21:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:21:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.53it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.50it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.09it/s]04/24/2024 00:21:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:21:38 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.8861854, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 157, 163, 160, 153, 153, 148, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94888, 'target_sparsity': 0.95, 'step': 7650}


Iteration:   8%|▊         | 6/78 [00:02<00:34,  2.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:29,  2.38it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:26,  2.62it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:24,  2.85it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.02it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.12it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:20,  3.22it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:19,  3.29it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:19,  3.33it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.37it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:18,  3.40it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:17,  3.43it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:17,  3.44it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:16,  3.45it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.45it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.46it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:15,  3.47it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:15,  3.44it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.47it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:14,  3.47it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:14,  3.48it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:14,  3.45it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:14,  3.45it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:13,  3.46it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:13,  3.46it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:13,  3.47it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:12,  3.48it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:12,  3.49it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:12,  3.49it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:12,  3.49it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:11,  3.45it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.45it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.45it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.42it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.44it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.46it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.44it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.41it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.44it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.43it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.44it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.45it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.45it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.45it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.43it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.44it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.42it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:06,  3.44it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:21:52,520 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:21:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:21:52 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:21:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:21:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.20it/s]04/24/2024 00:21:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:21:53 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.8990081, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 157, 163, 160, 153, 152, 147, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94889, 'target_sparsity': 0.95, 'step': 7700}


Iteration:  72%|███████▏  | 56/78 [00:17<00:10,  2.16it/s][A04/24/2024 00:21:53 - INFO - trainer.trainer_mod - v4 Global step: 7700, Alignment: tensor([4, 4, 6, 7], device='cuda:0')

Iteration:  73%|███████▎  | 57/78 [00:17<00:08,  2.44it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:07,  2.68it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:06,  2.87it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.02it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:05,  3.16it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:04,  3.24it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:04,  3.32it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.32it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.36it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:03,  3.37it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.40it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.39it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:02,  3.40it/s][A
Iteration:  90%|████████▉ | 70/78 [00:21<00:02,  3.42it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.44it/s][A
Iteration:  92%|█████████▏| 72/78 [00:22<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:22<00:01,  3.44it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.45it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.45it/s][A
Iteration:  97%|█████████▋| 76/78 [00:23<00:00,  3.45it/s][A
Iteration:  99%|█████████▊| 77/78 [00:23<00:00,  3.43it/s][A
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.59it/s][A04/24/2024 00:21:59 - INFO - trainer.trainer_mod - Epoch 98 finished. Took 23.7 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch:  99%|█████████▉| 99/100 [40:16<00:23, 23.46s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:22,  3.37it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:22,  3.40it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:21,  3.45it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:21,  3.46it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:21,  3.44it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:21,  3.41it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:20,  3.43it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:20,  3.42it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:20,  3.43it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:19,  3.45it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:19,  3.43it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:19,  3.45it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:18,  3.44it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:18,  3.45it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:18,  3.45it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:17,  3.47it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:17,  3.47it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:17,  3.47it/s][A
Iteration:  24%|██▍       | 19/78 [00:05<00:16,  3.47it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:16,  3.48it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:16,  3.43it/s][A
Iteration:  28%|██▊       | 22/78 [00:06<00:16,  3.44it/s][A
Iteration:  29%|██▉       | 23/78 [00:06<00:15,  3.46it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:15,  3.46it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:15,  3.45it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:15,  3.44it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:14,  3.45it/s][A[INFO|trainer.py:570] 2024-04-24 00:22:07,572 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:22:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:22:07 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:22:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:22:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.58it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.21it/s]04/24/2024 00:22:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:22:08 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.6173285198555957, 'eval_loss': 0.8955384, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 156, 163, 160, 153, 152, 147, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.9489, 'target_sparsity': 0.95, 'step': 7750}


Iteration:  36%|███▌      | 28/78 [00:08<00:23,  2.16it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:20,  2.43it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:18,  2.67it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:16,  2.87it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:15,  3.03it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.13it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:13,  3.24it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:13,  3.30it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:12,  3.37it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:12,  3.38it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:11,  3.39it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:11,  3.42it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:11,  3.44it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:10,  3.41it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:10,  3.39it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:10,  3.41it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:09,  3.41it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:09,  3.44it/s][A
Iteration:  59%|█████▉    | 46/78 [00:13<00:09,  3.42it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:08,  3.45it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:08,  3.45it/s][A
Iteration:  63%|██████▎   | 49/78 [00:14<00:08,  3.47it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:08,  3.47it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:07,  3.46it/s][A
Iteration:  67%|██████▋   | 52/78 [00:15<00:07,  3.43it/s][A
Iteration:  68%|██████▊   | 53/78 [00:15<00:07,  3.40it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.39it/s][A
Iteration:  71%|███████   | 55/78 [00:16<00:06,  3.42it/s][A
Iteration:  72%|███████▏  | 56/78 [00:16<00:06,  3.35it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.39it/s][A
Iteration:  74%|███████▍  | 58/78 [00:17<00:05,  3.41it/s][A
Iteration:  76%|███████▌  | 59/78 [00:17<00:05,  3.43it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.45it/s][A
Iteration:  78%|███████▊  | 61/78 [00:18<00:04,  3.46it/s][A
Iteration:  79%|███████▉  | 62/78 [00:18<00:04,  3.47it/s][A
Iteration:  81%|████████  | 63/78 [00:18<00:04,  3.48it/s][A
Iteration:  82%|████████▏ | 64/78 [00:19<00:04,  3.48it/s][A
Iteration:  83%|████████▎ | 65/78 [00:19<00:03,  3.49it/s][A
Iteration:  85%|████████▍ | 66/78 [00:19<00:03,  3.49it/s][A
Iteration:  86%|████████▌ | 67/78 [00:20<00:03,  3.49it/s][A
Iteration:  87%|████████▋ | 68/78 [00:20<00:02,  3.50it/s][A
Iteration:  88%|████████▊ | 69/78 [00:20<00:02,  3.49it/s][A
Iteration:  90%|████████▉ | 70/78 [00:20<00:02,  3.48it/s][A
Iteration:  91%|█████████ | 71/78 [00:21<00:02,  3.45it/s][A
Iteration:  92%|█████████▏| 72/78 [00:21<00:01,  3.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:21<00:01,  3.44it/s][A
Iteration:  95%|█████████▍| 74/78 [00:22<00:01,  3.46it/s][A
Iteration:  96%|█████████▌| 75/78 [00:22<00:00,  3.48it/s][A
Iteration:  97%|█████████▋| 76/78 [00:22<00:00,  3.47it/s][A
Iteration:  99%|█████████▊| 77/78 [00:22<00:00,  3.48it/s][A[INFO|trainer.py:570] 2024-04-24 00:22:22,599 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/24/2024 00:22:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/24/2024 00:22:22 - INFO - trainer.trainer_mod -   Num examples = 277
04/24/2024 00:22:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/24/2024 00:22:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 16.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.48it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.09it/s]04/24/2024 00:22:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/24/2024 00:22:23 - INFO - trainer.trainer_mod - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.8988357, 'head_layers': [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [197, 195, 179, 192, 156, 163, 160, 152, 152, 147, 150, 147], 'head_nums': [4, 5, 5, 6, 1, 1, 1, 1, 1, 2, 2, 2], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94891, 'target_sparsity': 0.95, 'step': 7800}


Iteration: 100%|██████████| 78/78 [00:23<00:00,  2.21it/s][A04/24/2024 00:22:23 - INFO - trainer.trainer_mod - Epoch 99 finished. Took 23.74 seconds.
Iteration: 100%|██████████| 78/78 [00:23<00:00,  3.29it/s]
Epoch: 100%|██████████| 100/100 [40:40<00:00, 23.54s/it]Epoch: 100%|██████████| 100/100 [40:40<00:00, 24.40s/it]
[INFO|configuration_utils.py:439] 2024-04-24 00:22:23,193 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95/config.json
[INFO|modeling_utils.py:1084] 2024-04-24 00:22:24,409 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-24 00:22:24,411 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-24 00:22:24,411 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod/RTE_sparsity0.95/special_tokens_map.json
04/24/2024 00:22:24 - INFO - __main__ - Training took 2450.94 seconds.
